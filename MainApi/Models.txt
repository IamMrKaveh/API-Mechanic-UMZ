namespace DataAccessLayer.Models.Auth;

public class LoginRequestDto
{
    [Required]
    [Phone]
    public string PhoneNumber { get; set; } = string.Empty;
}

public class VerifyOtpRequestDto
{
    [Required]
    [Phone]
    public string PhoneNumber { get; set; } = string.Empty;

    [Required]
    [Length(6, 6)]
    public string Code { get; set; } = string.Empty;
}

public class AuthResponseDto
{
    public string Token { get; set; } = string.Empty;
    public UserProfileDto User { get; set; } = new();
    public DateTime ExpiresAt { get; set; }
    public string RefreshToken { get; set; } = string.Empty;
}

public class UserProfileDto
{
    public int Id { get; set; }
    public string PhoneNumber { get; set; } = string.Empty;
    public DateTime? CreatedAt { get; set; }
}

namespace DataAccessLayer.Models.Auth;

public class TRefreshToken
{
    [Key]
    public int Id { get; set; }
    public int UserId { get; set; }
    public string TokenHash { get; set; } = string.Empty;
    public DateTime ExpiresAt { get; set; }
    public DateTime CreatedAt { get; set; }
    public string CreatedByIp { get; set; } = string.Empty;
    public DateTime? RevokedAt { get; set; }
    public string? ReplacedByTokenHash { get; set; }
    public string? UserAgent { get; set; }
}

namespace DataAccessLayer.Models.Cart;

public class TCartItems : ICartItem
{
    [Key]
    public int Id { get; set; }

    public virtual TCarts? Cart { get; set; }
    public int CartId { get; set; }

    public virtual TProducts? Product { get; set; }
    public int ProductId { get; set; }

    public int Quantity { get; set; }
}

namespace DataAccessLayer.Models.Cart;

public class TCarts : ICart
{
    [Key]
    public int Id { get; set; }
    public virtual TUsers? User { get; set; }
    public int UserId { get; set; }

    public virtual ICollection<TCartItems>? CartItems 
    { get; set; }
}

namespace DataAccessLayer.Models.DTO;

public class AddToCartDto
{
    public int ProductId { get; set; }
    public int Quantity { get; set; } = 1;
}

public class UpdateCartItemDto
{
    public int Quantity { get; set; }
}

public class CartDto
{
    public int Id { get; set; }
    public int UserId { get; set; }
    public List<CartItemDto> CartItems { get; set; } = new();
    public int TotalItems { get; set; }
    public int TotalPrice { get; set; }
}

public class CartItemDto
{
    public int Id { get; set; }
    public int ProductId { get; set; }
    public string ProductName { get; set; }
    public int SellingPrice { get; set; }
    public int Quantity { get; set; }
    public int TotalPrice { get; set; }
}

namespace DataAccessLayer.Models.DTO;

public class CreateOrderDto
{
    public int UserId { get; set; }
    public string? Name { get; set; }
    public string? Address { get; set; }
    public string? PostalCode { get; set; }
    public int OrderStatusId { get; set; }
    public DateTime? DeliveryDate { get; set; }
    public List<CreateOrderItemDto> OrderItems { get; set; } = new();
}

public class UpdateOrderDto
{
    public string? Name { get; set; }
    public string? Address { get; set; }
    public string? PostalCode { get; set; }
    public int? OrderStatusId { get; set; }
    public DateTime? DeliveryDate { get; set; }
}

public class CreateOrderStatusDto
{
    public string? Name { get; set; }
    public string? Icon { get; set; }
}

public class UpdateOrderStatusDto
{
    public int OrderStatusId { get; set; }
    public string? Name { get; set; }
    public string? Icon { get; set; }
}

public class CreateOrderItemDto
{
    public int UserOrderId { get; set; }
    public int ProductId { get; set; }
    public int SellingPrice { get; set; }
    public int Quantity { get; set; }
}

public class UpdateOrderItemDto
{
    public int? SellingPrice { get; set; }
    public int? Quantity { get; set; }
}

namespace DataAccessLayer.Models.DTO;

public class ProductDto
{
    public int Id { get; set; }
    [Required]
    [StringLength(200)]
    public string Name { get; set; }
    public string? Icon { get; set; }
    [Range(0, int.MaxValue)]
    public int? PurchasePrice { get; set; }
    [Range(0, int.MaxValue)]
    public int? SellingPrice { get; set; }
    [Range(0, int.MaxValue)]
    public int? Count { get; set; }
    public int? ProductTypeId { get; set; }
}

public class ProductTypeDto
{
    public int Id { get; set; }
    [Required]
    [StringLength(100)]
    public string Name { get; set; }
    public string? Icon { get; set; }
}

public class ProductSearchDto
{
    public string? Name { get; set; }
    public int? ProductTypeId { get; set; }
    public int? MinPrice { get; set; }
    public int? MaxPrice { get; set; }
    public bool? InStock { get; set; }
    public int Page { get; set; } = 1;
    public int PageSize { get; set; } = 10;
}

public class ProductStockDto
{
    [Required]
    public int ProductId { get; set; }
    [Required]
    [Range(1, int.MaxValue)]
    public int Quantity { get; set; }
    public string? Notes { get; set; }
}

public class TOrderItems : IOrderItem
{
    [Key]
    public int Id { get; set; }
    public virtual TOrders? UserOrder { get; set; }
    public int UserOrderId { get; set; }
    public virtual TProducts? Product { get; set; }
    public int ProductId { get; set; }
    public int PurchasePrice { get; set; }
    public int SellingPrice { get; set; }
    public int Quantity { get; set; }
    public int Amount { get; set; }
    public int Profit { get; set; }
}

namespace DataAccessLayer.Models.Order;

public class TOrders : IOrder
{
    [Key]
    public int Id { get; set; }

    public virtual TUsers? User { get; set; }
    public int UserId { get; set; }
    public string? Name { get; set; }

    public string? Address { get; set; }
    public string? PostalCode { get; set; }

    public virtual ICollection<TOrderItems> OrderItems 
    { get; set; } = new List<TOrderItems>();

    public int TotalAmount { get; set; }
    public int TotalProfit { get; set; }

    public DateTime CreatedAt { get; set; }
    public DateTime? DeliveryDate { get; set; }

    public virtual TOrderStatus? OrderStatus { get; set; }
    public int OrderStatusId { get; set; }
}

namespace DataAccessLayer.Models.Order;

public class TOrderStatus : IOrderStatus
{
    public int Id { get; set; }
    public string? Name { get; set; }
    public string? Icon { get; set; }

    public virtual ICollection<TOrders>? Orders { get; set; }
}

namespace DataAccessLayer.Models.Product;

public class TProducts : IProduct
{
    [Key]
    public int Id { get; set; }

    public string? Name { get; set; }
    public string? Icon { get; set; }

    public int? PurchasePrice { get; set; }
    public int? SellingPrice { get; set; }
    public int? Count { get; set; }

    public virtual TProductTypes? ProductType { get; set; }
    public int? ProductTypeId { get; set; }

    public virtual ICollection<TOrderItems>? OrderDetails
    { get; set; }

    [Timestamp]
    public byte[] RowVersion { get; set; }
}

namespace DataAccessLayer.Models.Product;

public class TProductTypes : IProductType
{
    [Key]
    public int Id { get; set; }

    public string? Name { get; set; }
    public string? Icon { get; set; }

    public virtual ICollection<TProducts>? Products { get; set; }
}

namespace DataAccessLayer.Models.User;

public class TUserOtp : IUserOtp
{
    [Key]
    public int Id { get; set; }

    public int UserId { get; set; }
    public virtual TUsers User { get; set; }

    [Required]
    public string OtpHash { get; set; }

    [Required]
    public DateTime ExpiresAt { get; set; }

    public DateTime CreatedAt { get; set; } = DateTime.UtcNow;

    public bool IsUsed { get; set; } = false;
}

namespace DataAccessLayer.Models.User;
public class TUsers : IUser
{
    [Key]
    public int Id { get; set; }

    [Required]
    [Phone]
    public string PhoneNumber { get; set; } = string.Empty;
    public string? FirstName { get; set; }
    public string? LastName { get; set; }

    public DateTime CreatedAt { get; set; }
    public bool IsActive { get; set; } = true;
    public bool IsAdmin { get; set; } = false;

    public virtual ICollection<TOrders> UserOrders 
    { get; set; } = new List<TOrders>();

    public virtual ICollection<TUserOtp> UserOtps { get; set; } = new List<TUserOtp>();

}