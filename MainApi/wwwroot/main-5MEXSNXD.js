import{a as vt}from"./chunk-LWL7INIR.js";import"./chunk-APFCOE5L.js";import{c as X,d as L,f as S,g as Ce,h as j}from"./chunk-DUKSTT3K.js";import{a as ue}from"./chunk-TKWCHRVU.js";import{a as M}from"./chunk-VCGXWPRB.js";import{A as bt,b as yt,d as _t,h as xt}from"./chunk-6R33SLKE.js";import{b as W}from"./chunk-N4ILYDNY.js";import{a as T}from"./chunk-U4BXHFS4.js";import{a as z}from"./chunk-HEUSUCDJ.js";import{A as dt,B as mt,C as pt,D as ft,E as ht,F as gt,G as Q,b as qe,c as oe,d as B,e as se,f as et,i as O,j as D,k as tt,l as it,o as nt,p as be,q as ae,r as rt,s as ot,t as st,u as at,v as ut,w as ct,y as lt,z as Z}from"./chunk-QOTKPPKC.js";import{$a as Ye,Ab as u,Ba as re,Bb as k,Ca as c,Cb as Y,D as Me,E as Re,Fb as Xe,Ga as He,Gb as Ge,Hb as Ke,Ia as Ve,Jb as xe,L as q,La as Be,M as _,N as A,Na as h,Nb as E,O as Pe,Oa as ze,Ob as N,P as Fe,Pb as Ze,Qb as Qe,S as V,Sa as I,Sb as Je,V as Ne,W as F,X as b,Xa as g,Y as Oe,aa as v,ba as y,ca as ge,da as ve,ea as Le,f as R,fa as je,g as J,gb as d,ha as De,hb as o,ib as s,j as U,jb as w,k as C,ka as $e,n as te,nb as ye,ob as _e,pb as x,qa as ne,sb as f,tb as p,u as H,ua as K,v as ie,va as Ue,w as ke,x as Ee,xb as We,y as G,z as P,zb as ee}from"./chunk-6VZDFBBI.js";import{a as fe,b as he}from"./chunk-4CLCTAJ7.js";var Ct=[{path:"",loadComponent:()=>import("./chunk-7KNK37M7.js").then(t=>t.Home)},{path:"auth",loadChildren:()=>import("./chunk-X42FYWYC.js").then(t=>t.AUTH_ROUTES)},{path:"cart",loadComponent:()=>import("./chunk-PV3XRJ2P.js").then(t=>t.CartPage),canActivate:[ue]},{path:"products",loadChildren:()=>import("./chunk-2XJH4F7J.js").then(t=>t.PRODUCTS_ROUTES)},{path:"checkout",loadChildren:()=>import("./chunk-BFOZAL5R.js").then(t=>t.CHECKOUT_ROUTES),canActivate:[ue]},{path:"payment",loadChildren:()=>import("./chunk-4OUOZTVW.js").then(t=>t.PAYMENT_ROUTES)},{path:"dashboard",loadChildren:()=>import("./chunk-DTBNGTAZ.js").then(t=>t.DASHBOARD_ROUTES),canActivate:[ue]},{path:"admin",loadChildren:()=>import("./chunk-3YQLKH3S.js").then(t=>t.ADMIN_ROUTES),canActivate:[vt]},{path:"**",redirectTo:"",pathMatch:"full"}];var Vt="@",Bt=(()=>{class t{doc;delegate;zone;animationType;moduleImpl;_rendererFactoryPromise=null;scheduler=null;injector=b(Le);loadingSchedulerFn=b(zt,{optional:!0});_engine;constructor(r,i,n,a,l){this.doc=r,this.delegate=i,this.zone=n,this.animationType=a,this.moduleImpl=l}ngOnDestroy(){this._engine?.flush()}loadImpl(){let r=()=>this.moduleImpl??import("./chunk-Z4DPPWOF.js").then(n=>n),i;return this.loadingSchedulerFn?i=this.loadingSchedulerFn(r):i=r(),i.catch(n=>{throw new Fe(5300,!1)}).then(({\u0275createEngine:n,\u0275AnimationRendererFactory:a})=>{this._engine=n(this.animationType,this.doc);let l=new a(this.delegate,this._engine,this.zone);return this.delegate=l,l})}createRenderer(r,i){let n=this.delegate.createRenderer(r,i);if(n.\u0275type===0)return n;typeof n.throwOnSyntheticProps=="boolean"&&(n.throwOnSyntheticProps=!1);let a=new we(n);return i?.data?.animation&&!this._rendererFactoryPromise&&(this._rendererFactoryPromise=this.loadImpl()),this._rendererFactoryPromise?.then(l=>{let m=l.createRenderer(r,i);a.use(m),this.scheduler??=this.injector.get($e,null,{optional:!0}),this.scheduler?.notify(10)}).catch(l=>{a.use(n)}),a}begin(){this.delegate.begin?.()}end(){this.delegate.end?.()}whenRenderingDone(){return this.delegate.whenRenderingDone?.()??Promise.resolve()}componentReplaced(r){this._engine?.flush(),this.delegate.componentReplaced?.(r)}static \u0275fac=function(i){ze()};static \u0275prov=V({token:t,factory:t.\u0275fac})}return t})(),we=class{delegate;replay=[];\u0275type=1;constructor(e){this.delegate=e}use(e){if(this.delegate=e,this.replay!==null){for(let r of this.replay)r(e);this.replay=null}}get data(){return this.delegate.data}destroy(){this.replay=null,this.delegate.destroy()}createElement(e,r){return this.delegate.createElement(e,r)}createComment(e){return this.delegate.createComment(e)}createText(e){return this.delegate.createText(e)}get destroyNode(){return this.delegate.destroyNode}appendChild(e,r){this.delegate.appendChild(e,r)}insertBefore(e,r,i,n){this.delegate.insertBefore(e,r,i,n)}removeChild(e,r,i,n){this.delegate.removeChild(e,r,i,n)}selectRootElement(e,r){return this.delegate.selectRootElement(e,r)}parentNode(e){return this.delegate.parentNode(e)}nextSibling(e){return this.delegate.nextSibling(e)}setAttribute(e,r,i,n){this.delegate.setAttribute(e,r,i,n)}removeAttribute(e,r,i){this.delegate.removeAttribute(e,r,i)}addClass(e,r){this.delegate.addClass(e,r)}removeClass(e,r){this.delegate.removeClass(e,r)}setStyle(e,r,i,n){this.delegate.setStyle(e,r,i,n)}removeStyle(e,r,i){this.delegate.removeStyle(e,r,i)}setProperty(e,r,i){this.shouldReplay(r)&&this.replay.push(n=>n.setProperty(e,r,i)),this.delegate.setProperty(e,r,i)}setValue(e,r){this.delegate.setValue(e,r)}listen(e,r,i,n){return this.shouldReplay(r)&&this.replay.push(a=>a.listen(e,r,i,n)),this.delegate.listen(e,r,i,n)}shouldReplay(e){return this.replay!==null&&e.startsWith(Vt)}},zt=new Ne("");function wt(t="animations"){return He("NgAsyncAnimations"),Oe([{provide:Be,useFactory:(e,r,i)=>new Bt(e,r,i,t),deps:[je,tt,Ve]},{provide:Ue,useValue:t==="noop"?"NoopAnimations":"BrowserAnimations"}])}var ce=!1,Se=new J(null),le=()=>{if(typeof window>"u")return!1;let t=window.location.pathname.toLowerCase(),e=window.location.search.toLowerCase();return t.includes("/payment")||t.includes("/callback")||e.includes("authority=")||e.includes("status=")},Yt=t=>{let e=t.toLowerCase();return e.includes("/verify-payment")||e.includes("/orders/verify-payment")||e.includes("payment")},de=(t,e)=>{let r=M.getAuthToken();if(r&&!t.url.includes("/refresh"))return t.clone({setHeaders:{Authorization:`Bearer ${r}`}});let i=W.getGuestToken();return i?t.clone({setHeaders:{"X-Guest-Token":i}}):t},Wt=(t,e,r,i)=>ce?Se.pipe(G(n=>n!=null),Me(1),q(()=>e(de(t,r)))):(ce=!0,Se.next(null),r.refreshToken().pipe(q(n=>(ce=!1,n&&n.token?(Se.next(n.token),e(de(t,r))):(le()||(r.logout(),i.clearLocalCart()),C(()=>new Error("Session expired."))))),P(n=>(ce=!1,le()||(r.logout(!1),i.clearLocalCart()),C(()=>n))))),St=(t,e)=>{let r=b(M),i=b(W),n=t.url.startsWith(z.API_URL),a=t;return le()||Yt(t.url)?(n&&(a=de(t,r)),a=a.clone({withCredentials:!0})):n&&(a=de(t,r),a=a.clone({withCredentials:!0})),e(a).pipe(P(l=>{let m=t.url.includes("/login")||t.url.includes("/refresh")||t.url.includes("/verify-otp");return l instanceof be&&l.status===401&&m?(le()||r.logout(!1),C(()=>l)):l instanceof be&&l.status===401&&n?Wt(t,e,r,i):C(()=>l)}))};var Xt=t=>{let e=t.url.toLowerCase(),r=t.headers.has("X-Payment-Verification");return e.includes("/verify-payment")||e.includes("/payment")||e.includes("/checkout")||r},Gt=()=>{if(typeof window>"u")return!1;let t=window.location.pathname.toLowerCase(),e=window.location.search.toLowerCase();return t.includes("/payment/callback")||t.includes("/payment/success")||t.includes("/payment/failure")||t.includes("/payment")||e.includes("authority=")||e.includes("status=")},It=(t,e)=>{let r=b(T),i=b(M);return e(t).pipe(P(n=>{let a=t.url.includes("/login")||t.url.includes("/refresh")||t.url.includes("/verify-otp");if(Xt(t)||Gt())return C(()=>n);if(n.status===401&&a)return i.logout(!1),C(()=>n);if(n.status===401&&!a)return C(()=>n);let m="\u06CC\u06A9 \u062E\u0637\u0627\u06CC \u067E\u06CC\u0634\u200C\u0628\u06CC\u0646\u06CC \u0646\u0634\u062F\u0647 \u0631\u062E \u062F\u0627\u062F.  \u0644\u0637\u0641\u0627 \u062F\u0648\u0628\u0627\u0631\u0647 \u062A\u0644\u0627\u0634 \u06A9\u0646\u06CC\u062F.";return n.status===429?m="\u062A\u0639\u062F\u0627\u062F \u062F\u0631\u062E\u0648\u0627\u0633\u062A\u200C\u0647\u0627\u06CC \u0634\u0645\u0627 \u0628\u06CC\u0634 \u0627\u0632 \u062D\u062F \u0645\u062C\u0627\u0632 \u0627\u0633\u062A. \u0644\u0637\u0641\u0627\u064B \u0686\u0646\u062F \u0644\u062D\u0638\u0647 \u0628\u0639\u062F \u062F\u0648\u0628\u0627\u0631\u0647 \u062A\u0644\u0627\u0634 \u06A9\u0646\u06CC\u062F.":n.status===409?n.error?.message?.includes("modified by another user")||n.error?.message?.includes("Cart was updated")?m="\u0627\u06CC\u0646 \u0631\u06A9\u0648\u0631\u062F \u062A\u0648\u0633\u0637 \u06A9\u0627\u0631\u0628\u0631 \u062F\u06CC\u06AF\u0631\u06CC \u062A\u063A\u06CC\u06CC\u0631 \u06A9\u0631\u062F\u0647 \u0627\u0633\u062A. \u0644\u0637\u0641\u0627\u064B \u0635\u0641\u062D\u0647 \u0631\u0627 \u0631\u0641\u0631\u0634 \u06A9\u0646\u06CC\u062F.":m=n.error?.message||"\u0627\u0637\u0644\u0627\u0639\u0627\u062A \u062A\u0648\u0633\u0637 \u06A9\u0627\u0631\u0628\u0631 \u062F\u06CC\u06AF\u0631\u06CC \u062A\u063A\u06CC\u06CC\u0631 \u06A9\u0631\u062F\u0647 \u0627\u0633\u062A.  \u0644\u0637\u0641\u0627\u064B \u0635\u0641\u062D\u0647 \u0631\u0627 \u0631\u0641\u0631\u0634 \u06A9\u0631\u062F\u0647 \u0648 \u062F\u0648\u0628\u0627\u0631\u0647 \u062A\u0644\u0627\u0634 \u06A9\u0646\u06CC\u062F.":n.error instanceof ErrorEvent?m=`\u062E\u0637\u0627: ${n.error.message}`:n.error&&typeof n.error.message=="string"?m=n.error.message:typeof n.error=="string"&&n.error.length<200?m=n.error:n.statusText&&(m=`\u062E\u0637\u0627: ${n.statusText}`),r.show(m,"error"),C(()=>n)}))};var Tt=(t,e)=>{let r=b(T);return e(t).pipe(P(i=>i.status===429?Kt(i,t,e,r):C(()=>i)))};function Kt(t,e,r,i){let n=t.headers.get("Retry-After"),a=parseInt(n||"60",10),l=a*1e3,m=n?`\u062F\u0631\u062E\u0648\u0627\u0633\u062A\u200C\u0647\u0627\u06CC \u0634\u0645\u0627 \u0628\u06CC\u0634 \u0627\u0632 \u062D\u062F \u0645\u062C\u0627\u0632 \u0627\u0633\u062A. \u0644\u0637\u0641\u0627 ${a} \u062B\u0627\u0646\u06CC\u0647 \u0635\u0628\u0631 \u06A9\u0646\u06CC\u062F.`:"\u062F\u0631\u062E\u0648\u0627\u0633\u062A\u200C\u0647\u0627\u06CC \u0634\u0645\u0627 \u0628\u06CC\u0634 \u0627\u0632 \u062D\u062F \u0645\u062C\u0627\u0632 \u0627\u0633\u062A. \u0644\u0637\u0641\u0627 \u0686\u0646\u062F \u0644\u062D\u0638\u0647 \u0635\u0628\u0631 \u06A9\u0646\u06CC\u062F.";return i.show(m,"error"),typeof window<"u"&&!window.navigator.onLine&&console.warn("[Rate Limit] Network appears to be offline"),console.warn("[Rate Limit] Too many requests. Retrying after:",a,"seconds"),ie(l).pipe(A(()=>{console.info("[Rate Limit] Retrying request..."),i.show("\u062F\u0631 \u062D\u0627\u0644 \u062A\u0644\u0627\u0634 \u0645\u062C\u062F\u062F...","info")}),q(()=>r(e)),P(pe=>pe.status===429?(i.show("\u062F\u0631\u062E\u0648\u0627\u0633\u062A \u0634\u0645\u0627 \u0647\u0645\u0686\u0646\u0627\u0646 \u0645\u062D\u062F\u0648\u062F \u0627\u0633\u062A. \u0644\u0637\u0641\u0627 \u0628\u0639\u062F\u0627\u064B \u062A\u0644\u0627\u0634 \u06A9\u0646\u06CC\u062F.","error"),C(()=>pe)):C(()=>pe)))}function Zt(t){let e=t&&(t.hasOwnProperty("items")||t.hasOwnProperty("Items")),r=t&&(t.hasOwnProperty("totalItems")||t.hasOwnProperty("TotalItems")||t.hasOwnProperty("totalCount")||t.hasOwnProperty("TotalCount"));return e&&r}var At=(t,e)=>e(t).pipe(te(r=>{if(r instanceof nt&&r.body&&Zt(r.body)){let i=r.body,n={items:i.items??i.Items??[],totalItems:i.totalItems??i.TotalItems??i.totalCount??i.TotalCount??0,page:i.page??i.Page??i.pageNumber??i.PageNumber??1,pageSize:i.pageSize??i.PageSize??10,totalPages:i.totalPages??i.TotalPages??1};return r.clone({body:n})}return r}));var kt=(t,e)=>{let r=b(rt);if(!(Qt(t.method)&&Jt(t.url)&&!qt(t.url)))return e(t);let n=r.getToken();if(n){let a=t.clone({headers:t.headers.set("X-XSRF-TOKEN",n)});return e(a)}return e(t)};function Qt(t){return["POST","PUT","PATCH","DELETE"].includes(t.toUpperCase())}function Jt(t){return t.startsWith(z.API_URL)||t.startsWith("/api")}function qt(t){return["/api/Users/login","/api/Users/verify-otp","/api/Users/refresh"].some(r=>t.includes(r))}var Et=(()=>{let e=class e{constructor(i,n){this.http=i,this.platformId=n,this.apiUrl=`${z.API_URL}Security/csrf-token`,this.tokenFetched=!1}isPaymentPage(){if(!D(this.platformId))return!1;let i=window.location.pathname.toLowerCase(),n=window.location.search.toLowerCase();return i.includes("/payment")||i.includes("/callback")||n.includes("authority=")||n.includes("status=")}initializeCsrfToken(){return D(this.platformId)?this.tokenFetched?U(void 0):this.isPaymentPage()?(console.log("[CSRF] Skipping token fetch on payment page"),U(void 0)):this.http.get(this.apiUrl).pipe(A(i=>{i&&i.token&&(this.tokenFetched=!0,console.log("[CSRF] Token initialized successfully"))}),P(i=>(console.warn("[CSRF] Token fetch failed:",i),U(void 0))),te(()=>{})):U(void 0)}refreshCsrfToken(){return this.isPaymentPage()?U(void 0):(this.tokenFetched=!1,this.initializeCsrfToken())}};e.\u0275fac=function(n){return new(n||e)(F(ae),F(K))},e.\u0275prov=V({token:e,factory:e.\u0275fac,providedIn:"root"});let t=e;return t})();function ti(t){return()=>{if(typeof window<"u"){let e=window.location.pathname.toLowerCase(),r=window.location.search.toLowerCase();if(e.includes("/payment")||r.includes("authority=")||r.includes("status="))return U(void 0)}return t.initializeCsrfToken()}}var Ie=class{constructor(){this.notificationService=b(T)}isPaymentPage(){if(typeof window>"u")return!1;let e=window.location.pathname.toLowerCase(),r=window.location.search.toLowerCase();return e.includes("/payment")||e.includes("/checkout")||r.includes("authority=")||r.includes("status=")}handleError(e){if(e?.message?.includes("Loading chunk")||e?.message?.includes("ChunkLoadError")||e?.message?.includes("Failed to fetch dynamically imported module")){console.warn("Chunk loading error detected:",e.message),typeof window<"u"&&(sessionStorage.getItem("chunk_reload_attempted")?(sessionStorage.removeItem("chunk_reload_attempted"),this.notificationService.show("\u062E\u0637\u0627 \u062F\u0631 \u0628\u0627\u0631\u06AF\u0630\u0627\u0631\u06CC \u0635\u0641\u062D\u0647. \u0644\u0637\u0641\u0627\u064B \u0635\u0641\u062D\u0647 \u0631\u0627 \u0631\u0641\u0631\u0634 \u06A9\u0646\u06CC\u062F.","error")):(sessionStorage.setItem("chunk_reload_attempted","true"),window.location.reload()));return}console.error("Unhandled error:",e),!e.rejection&&e.status!==401&&!this.isPaymentPage()&&this.notificationService.show("\u06CC\u06A9 \u062E\u0637\u0627\u06CC \u063A\u06CC\u0631\u0645\u0646\u062A\u0638\u0631\u0647 \u0631\u062E \u062F\u0627\u062F. \u0644\u0637\u0641\u0627\u064B \u062F\u0648\u0628\u0627\u0631\u0647 \u062A\u0644\u0627\u0634 \u06A9\u0646\u06CC\u062F.","error")}},Mt={providers:[Je({eventCoalescing:!0}),ft(Ct,gt(),ht(pt)),ot(ut(),st([St,Tt,It,At,kt]),at({headerName:"X-XSRF-TOKEN",cookieName:"XSRF-TOKEN"})),wt(),{provide:De,useClass:Ie},{provide:Ye,useFactory:ti,deps:[Et],multi:!0}]};var Rt=(()=>{let e=class e{constructor(i){this.http=i,this.apiUrl=`${z.API_URL}Notifications`,this.notificationsSubject=new J([]),this.notifications$=this.notificationsSubject.asObservable(),this.unreadCountSubject=new J(0),this.unreadCount$=this.unreadCountSubject.asObservable()}getNotifications(i=!1){return this.http.get(`${this.apiUrl}?unreadOnly=${i}`).pipe(A(n=>{if(this.notificationsSubject.next(n),!i){let a=n.filter(l=>!l.isRead).length;this.unreadCountSubject.next(a)}}))}getUnreadCount(){return this.http.get(`${this.apiUrl}/count`).pipe(A(i=>this.unreadCountSubject.next(i)))}markAsRead(i){return this.http.patch(`${this.apiUrl}/${i}/read`,{}).pipe(A(()=>{this.getUnreadCount().subscribe();let a=this.notificationsSubject.value.map(l=>l.id===i?he(fe({},l),{isRead:!0}):l);this.notificationsSubject.next(a)}))}markAllAsRead(){return this.http.patch(`${this.apiUrl}/read-all`,{}).pipe(A(()=>{this.getUnreadCount().subscribe();let n=this.notificationsSubject.value.map(a=>he(fe({},a),{isRead:!0}));this.notificationsSubject.next(n)}))}};e.\u0275fac=function(n){return new(n||e)(F(ae))},e.\u0275prov=V({token:e,factory:e.\u0275fac,providedIn:"root"});let t=e;return t})();function ni(t,e){if(t&1&&(o(0,"span",4),u(1),s()),t&2){let r=e.ngIf;ee("hidden",r===0),c(),Y(" ",r," ")}}function ri(t,e){t&1&&(o(0,"div",13)(1,"span",14),u(2,"sync"),s()())}function oi(t,e){t&1&&(o(0,"div",15),u(1," \u0627\u0639\u0644\u0627\u0646 \u062C\u062F\u06CC\u062F\u06CC \u0648\u062C\u0648\u062F \u0646\u062F\u0627\u0631\u062F. "),s())}function si(t,e){if(t&1){let r=x();o(0,"a",16),f("click",function(){let n=v(r).$implicit,a=p(2);return y(a.handleNotificationClick(n))}),o(1,"div")(2,"div",17)(3,"p",18),u(4),s(),o(5,"span",19),u(6),E(7,"date"),s()(),o(8,"p",20),u(9),s()()()}if(t&2){let r=e.$implicit;ee("font-semibold",!r.isRead)("text-foreground",!r.isRead)("text-muted-foreground",r.isRead),c(3),ee("font-bold",!r.isRead),c(),k(r.title),c(2),k(Ze(7,13,r.createdAt,"short")),c(2),ee("font-normal",!r.isRead),c(),k(r.message)}}function ai(t,e){if(t&1){let r=x();o(0,"div",5)(1,"div",6)(2,"h3",7),u(3,"\u0627\u0639\u0644\u0627\u0646\u200C\u0647\u0627"),s(),o(4,"button",8),E(5,"async"),f("click",function(){v(r);let n=p();return y(n.markAllAsRead())}),u(6,"\u0639\u0644\u0627\u0645\u062A\u200C\u06AF\u0630\u0627\u0631\u06CC \u0647\u0645\u0647 \u0628\u0647 \u0639\u0646\u0648\u0627\u0646 \u062E\u0648\u0627\u0646\u062F\u0647 \u0634\u062F\u0647"),s()(),o(7,"div",9),g(8,ri,3,0,"div",10)(9,oi,2,0,"div",11),E(10,"async"),g(11,si,10,16,"a",12),E(12,"async"),s()()}if(t&2){let r,i=p();d("@slideFade",void 0),c(4),d("disabled",N(5,5,i.unreadCount$)===0),c(4),d("ngIf",i.isLoading),c(),d("ngIf",!i.isLoading&&((r=N(10,7,i.notifications$))==null?null:r.length)===0),c(2),d("ngForOf",N(12,9,i.notifications$))}}var Pt=(()=>{let e=class e{constructor(i,n,a){this.notificationService=i,this.elementRef=n,this.router=a,this.isMenuOpen=!1,this.isLoading=!1,this.destroy$=new R,this.notifications$=this.notificationService.notifications$,this.unreadCount$=this.notificationService.unreadCount$}ngOnInit(){this.notificationService.getUnreadCount().pipe(_(this.destroy$)).subscribe()}toggleMenu(){this.isMenuOpen=!this.isMenuOpen,this.isMenuOpen&&this.loadNotifications()}loadNotifications(){this.isLoading=!0,this.notificationService.getNotifications().pipe(_(this.destroy$)).subscribe(()=>{this.isLoading=!1})}markAllAsRead(){this.notificationService.markAllAsRead().pipe(_(this.destroy$)).subscribe()}handleNotificationClick(i){i.isRead||this.notificationService.markAsRead(i.id).pipe(_(this.destroy$)).subscribe(),i.actionUrl&&this.router.navigateByUrl(i.actionUrl),this.isMenuOpen=!1}onDocumentClick(i){this.elementRef.nativeElement.contains(i.target)||(this.isMenuOpen=!1)}ngOnDestroy(){this.destroy$.next(),this.destroy$.complete()}};e.\u0275fac=function(n){return new(n||e)(h(Rt),h(ne),h(Z))},e.\u0275cmp=I({type:e,selectors:[["app-notification-bell"]],hostBindings:function(n,a){n&1&&f("click",function(m){return a.onDocumentClick(m)},re)},decls:6,vars:4,consts:[["aria-label","Notifications",1,"relative","btn","btn-ghost","btn-icon","rounded-full",3,"click"],[1,"material-icons-outlined"],["class","absolute -right-1 -top-1 flex h-5 w-5 items-center justify-center rounded-full bg-primary text-xs font-bold text-primary-foreground",3,"hidden",4,"ngIf"],["class","absolute start-0 mt-2 w-80 origin-top-left rounded-md bg-popover text-popover-foreground shadow-lg ring-1 ring-black ring-opacity-5 focus:outline-none",4,"ngIf"],[1,"absolute","-right-1","-top-1","flex","h-5","w-5","items-center","justify-center","rounded-full","bg-primary","text-xs","font-bold","text-primary-foreground"],[1,"absolute","start-0","mt-2","w-80","origin-top-left","rounded-md","bg-popover","text-popover-foreground","shadow-lg","ring-1","ring-black","ring-opacity-5","focus:outline-none"],[1,"p-4","border-b","border-border","flex","justify-between","items-center"],[1,"font-semibold"],[1,"btn","btn-link","btn-sm","p-0","h-auto",3,"click","disabled"],[1,"max-h-80","overflow-y-auto"],["class","flex justify-center items-center p-6",4,"ngIf"],["class","p-6 text-center text-muted-foreground",4,"ngIf"],["class","flex items-start gap-3 p-4 hover:bg-accent cursor-pointer",3,"font-semibold","text-foreground","text-muted-foreground","click",4,"ngFor","ngForOf"],[1,"flex","justify-center","items-center","p-6"],[1,"material-icons","animate-spin","text-primary"],[1,"p-6","text-center","text-muted-foreground"],[1,"flex","items-start","gap-3","p-4","hover:bg-accent","cursor-pointer",3,"click"],[1,"flex","items-center","justify-between"],[1,"text-sm"],[1,"text-xs"],[1,"text-xs","mt-1"]],template:function(n,a){n&1&&(o(0,"button",0),f("click",function(){return a.toggleMenu()}),o(1,"span",1),u(2,"notifications"),s(),g(3,ni,2,3,"span",2),E(4,"async"),s(),g(5,ai,13,11,"div",3)),n&2&&(c(3),d("ngIf",N(4,2,a.unreadCount$)),c(2),d("ngIf",a.isMenuOpen))},dependencies:[O,oe,B,Q,se,et],encapsulation:2,data:{animation:[X("slideFade",[j(":enter",[S({opacity:0,transform:"translateY(-10px)"}),L("150ms ease-out",S({opacity:1,transform:"translateY(0)"}))]),j(":leave",[L("150ms ease-in",S({opacity:0,transform:"translateY(-10px)"}))])])]}});let t=e;return t})();var Nt=()=>({exact:!0});function ci(t,e){if(t&1){let r=x();o(0,"a",32),f("click",function(){v(r);let n=p(3);return y(n.closeMenu())}),o(1,"span",28),u(2,"admin_panel_settings"),s(),o(3,"span"),u(4,"\u067E\u0646\u0644 \u0627\u062F\u0645\u06CC\u0646"),s()()}}function li(t,e){if(t&1){let r=x();o(0,"div",25)(1,"div",26)(2,"a",27),f("click",function(){v(r);let n=p(2);return y(n.closeMenu())}),o(3,"span",28),u(4,"dashboard"),s(),o(5,"span"),u(6,"\u062F\u0627\u0634\u0628\u0648\u0631\u062F"),s()(),g(7,ci,5,0,"a",29),E(8,"async"),w(9,"div",30),o(10,"button",31),f("click",function(){v(r);let n=p(2);return y(n.logout())}),o(11,"span",28),u(12,"logout"),s(),o(13,"span"),u(14,"\u062E\u0631\u0648\u062C"),s()()()()}if(t&2){let r,i=p(2);d("@slideFade",void 0),c(7),d("ngIf",(r=N(8,2,i.userProfile$))==null?null:r.isAdmin)}}function di(t,e){if(t&1){let r=x();ye(0),w(1,"app-notification-bell"),o(2,"div",22)(3,"button",23),f("click",function(n){v(r);let a=p();return y(a.toggleMenu(n))}),o(4,"span",5),u(5,"person"),s()(),g(6,li,15,4,"div",24),s(),_e()}if(t&2){let r=p();c(6),d("ngIf",r.isMenuOpen)}}function mi(t,e){t&1&&(o(0,"a",33),u(1," \u0648\u0631\u0648\u062F | \u062B\u0628\u062A\u200C\u0646\u0627\u0645 "),s())}function pi(t,e){if(t&1&&(o(0,"span",35),u(1),s()),t&2){let r=p().ngIf;c(),Y(" ",r," ")}}function fi(t,e){if(t&1&&(ye(0),g(1,pi,2,1,"span",34),_e()),t&2){let r=e.ngIf;c(),d("ngIf",r>0)}}function hi(t,e){if(t&1){let r=x();o(0,"div",36),f("click",function(){v(r);let n=p();return y(n.isMobileMenuOpen=!1)}),s()}}function gi(t,e){if(t&1){let r=x();o(0,"a",45),f("click",function(){v(r);let n=p(2);return y(n.isMobileMenuOpen=!1)}),o(1,"span",46),u(2),s(),u(3),s()}if(t&2){let r=e.$implicit;d("routerLink",r.link)("routerLinkActiveOptions",xe(4,Nt)),c(2),k(r.icon),c(),Y(" ",r.title," ")}}function vi(t,e){if(t&1){let r=x();o(0,"div",47)(1,"a",48),f("click",function(){v(r);let n=p(2);return y(n.isMobileMenuOpen=!1)}),u(2,"\u0648\u0631\u0648\u062F | \u062B\u0628\u062A\u200C\u0646\u0627\u0645"),s()()}}function yi(t,e){if(t&1){let r=x();o(0,"div",37)(1,"div",38)(2,"a",39),w(3,"img",8),o(4,"span"),u(5,"\u0641\u0631\u0648\u0634\u06AF\u0627\u0647 \u0644\u0650\u062F\u06A9\u0627"),s()(),o(6,"button",40),f("click",function(){v(r);let n=p();return y(n.isMobileMenuOpen=!1)}),o(7,"span",5),u(8,"close"),s()()(),o(9,"div",41)(10,"nav",42),g(11,gi,4,5,"a",43),s()(),g(12,vi,3,0,"div",44),E(13,"async"),s()}if(t&2){let r=p();c(11),d("ngForOf",r.mobileMenuItems),c(),d("ngIf",!N(13,2,r.isLoggedIn$))}}var Ot=(()=>{let e=class e{constructor(i,n,a){this.authService=i,this.cartService=n,this.elementRef=a,this.isMenuOpen=!1,this.isMobileMenuOpen=!1,this.destroy$=new R,this.mobileMenuItems=[{title:"\u062E\u0627\u0646\u0647",link:"/",icon:"home"},{title:"\u0645\u062D\u0635\u0648\u0644\u0627\u062A",link:"/products",icon:"storefront"},{title:"\u062A\u062E\u0641\u06CC\u0641\u200C\u0647\u0627",link:"/discounts",icon:"local_offer"}]}onDocumentClick(i){let n=this.elementRef.nativeElement.querySelector(".user-menu-container");n&&!n.contains(i.target)&&(this.isMenuOpen=!1)}ngOnInit(){this.isLoggedIn$=this.authService.isLoggedIn$,this.userProfile$=this.authService.userProfile$,this.cartItemCount$=this.cartService.cartItemCount$,this.isLoggedIn$.pipe(Re(),_(this.destroy$)).subscribe(i=>{i?this.cartService.getCartItemsCount().subscribe():this.cartService.clearLocalCart()}),this.authService.isAuthenticated()&&this.cartService.getMyCart().subscribe()}ngOnDestroy(){this.destroy$.next(),this.destroy$.complete()}toggleMenu(i){i.stopPropagation(),this.isMenuOpen=!this.isMenuOpen}closeMenu(){this.isMenuOpen=!1}logout(){this.closeMenu(),this.authService.logout()}};e.\u0275fac=function(n){return new(n||e)(h(M),h(W),h(ne))},e.\u0275cmp=I({type:e,selectors:[["app-header"]],hostBindings:function(n,a){n&1&&f("click",function(m){return a.onDocumentClick(m)},re)},decls:31,vars:11,consts:[["loggedOut",""],[1,"sticky","top-0","z-50","w-full","border-b","border-border","bg-background/95","backdrop-blur","supports-[backdrop-filter]:bg-background/60"],[1,"container","flex","h-16","items-center"],[1,"mr-auto","flex","items-center","gap-4","lg:hidden"],[1,"btn","btn-ghost","btn-icon",3,"click"],[1,"material-icons"],[1,"flex","items-center","gap-6"],["routerLink","/","aria-label","\u0628\u0627\u0632\u06AF\u0634\u062A \u0628\u0647 \u0635\u0641\u062D\u0647 \u0627\u0635\u0644\u06CC",1,"flex","items-center","gap-2"],["src","/assets/icons/ledka-icon.jpg","alt","\u0644\u0648\u06AF\u0648 \u0641\u0631\u0648\u0634\u06AF\u0627\u0647",1,"h-8","w-auto"],[1,"hidden","font-bold","sm:inline-block"],[1,"hidden","items-center","gap-6","text-sm","font-medium","lg:flex"],["routerLink","/","routerLinkActive","text-foreground font-semibold",1,"text-muted-foreground","transition-colors","hover:text-foreground",3,"routerLinkActiveOptions"],["routerLink","/products","routerLinkActive","text-foreground font-semibold",1,"text-muted-foreground","transition-colors","hover:text-foreground"],["routerLink","/discounts","routerLinkActive","text-foreground font-semibold",1,"text-muted-foreground","transition-colors","hover:text-foreground"],[1,"flex","flex-1","items-center","justify-end","gap-4"],[4,"ngIf","ngIfElse"],[1,"h-6","w-px","bg-border"],["routerLink","/cart","aria-label","\u0645\u0634\u0627\u0647\u062F\u0647 \u0633\u0628\u062F \u062E\u0631\u06CC\u062F",1,"relative","btn","btn-ghost","btn-icon"],[1,"material-icons-outlined"],[4,"ngIf"],["class","fixed inset-0 z-40 bg-black/60 lg:hidden",3,"click",4,"ngIf"],["class","fixed inset-y-0 right-0 z-50 flex w-full max-w-xs flex-col bg-background lg:hidden",4,"ngIf"],[1,"relative","user-menu-container"],["aria-label","\u0628\u0627\u0632 \u06A9\u0631\u062F\u0646 \u0645\u0646\u0648\u06CC \u06A9\u0627\u0631\u0628\u0631",1,"btn","btn-ghost","btn-icon","rounded-full",3,"click"],["class","absolute start-0 mt-2 w-48 origin-top-left rounded-md bg-popover text-popover-foreground shadow-lg ring-1 ring-black ring-opacity-5 focus:outline-none",4,"ngIf"],[1,"absolute","start-0","mt-2","w-48","origin-top-left","rounded-md","bg-popover","text-popover-foreground","shadow-lg","ring-1","ring-black","ring-opacity-5","focus:outline-none"],["role","menu","aria-orientation","vertical",1,"py-1"],["routerLink","/dashboard","role","menuitem",1,"flex","items-center","px-4","py-2","text-sm","hover:bg-accent",3,"click"],[1,"material-icons-outlined","me-2","text-base"],["routerLink","/admin","class","flex items-center px-4 py-2 text-sm hover:bg-accent","role","menuitem",3,"click",4,"ngIf"],[1,"border-t","border-border","my-1"],["role","menuitem",1,"flex","w-full","items-center","px-4","py-2","text-sm","text-destructive","hover:bg-accent",3,"click"],["routerLink","/admin","role","menuitem",1,"flex","items-center","px-4","py-2","text-sm","hover:bg-accent",3,"click"],["routerLink","/auth",1,"btn","btn-primary","btn-sm","hidden","md:inline-flex"],["class","absolute -right-1 -top-1 flex h-5 w-5 items-center justify-center rounded-full bg-primary text-xs font-bold text-primary-foreground","aria-live","polite",4,"ngIf"],["aria-live","polite",1,"absolute","-right-1","-top-1","flex","h-5","w-5","items-center","justify-center","rounded-full","bg-primary","text-xs","font-bold","text-primary-foreground"],[1,"fixed","inset-0","z-40","bg-black/60","lg:hidden",3,"click"],[1,"fixed","inset-y-0","right-0","z-50","flex","w-full","max-w-xs","flex-col","bg-background","lg:hidden"],[1,"flex","h-16","items-center","border-b","border-border","px-6"],["routerLink","/",1,"flex","items-center","gap-2","font-semibold","text-foreground"],[1,"btn","btn-icon","btn-ghost","ms-auto",3,"click"],[1,"flex-1","overflow-auto","py-2"],[1,"grid","items-start","px-4","text-base","font-medium"],["routerLinkActive","bg-accent text-accent-foreground","class","btn btn-ghost rtl:justify-start gap-3 px-3 py-2 text-muted-foreground",3,"routerLink","routerLinkActiveOptions","click",4,"ngFor","ngForOf"],["class","border-t border-border p-4",4,"ngIf"],["routerLinkActive","bg-accent text-accent-foreground",1,"btn","btn-ghost","rtl:justify-start","gap-3","px-3","py-2","text-muted-foreground",3,"click","routerLink","routerLinkActiveOptions"],[1,"material-icons-outlined","text-lg","w-6","text-center"],[1,"border-t","border-border","p-4"],["routerLink","/auth",1,"btn","btn-primary","w-full",3,"click"]],template:function(n,a){if(n&1){let l=x();o(0,"header",1)(1,"div",2)(2,"div",3)(3,"button",4),f("click",function(){return v(l),y(a.isMobileMenuOpen=!a.isMobileMenuOpen)}),o(4,"span",5),u(5,"menu"),s()()(),o(6,"div",6)(7,"a",7),w(8,"img",8),o(9,"span",9),u(10,"\u0641\u0631\u0648\u0634\u06AF\u0627\u0647 \u0644\u0650\u062F\u06A9\u0627"),s()(),o(11,"nav",10)(12,"a",11),u(13,"\u062E\u0627\u0646\u0647"),s(),o(14,"a",12),u(15,"\u0645\u062D\u0635\u0648\u0644\u0627\u062A"),s(),o(16,"a",13),u(17,"\u062A\u062E\u0641\u06CC\u0641\u200C\u0647\u0627"),s()()(),o(18,"div",14),g(19,di,7,1,"ng-container",15),E(20,"async"),g(21,mi,2,0,"ng-template",null,0,Qe),w(23,"div",16),o(24,"a",17)(25,"span",18),u(26,"shopping_cart"),s(),g(27,fi,2,1,"ng-container",19),E(28,"async"),s()()(),g(29,hi,1,0,"div",20)(30,yi,14,4,"div",21),s()}if(n&2){let l=We(22);c(12),d("routerLinkActiveOptions",xe(10,Nt)),c(7),d("ngIf",N(20,6,a.isLoggedIn$))("ngIfElse",l),c(8),d("ngIf",N(28,8,a.cartItemCount$)),c(2),d("ngIf",a.isMobileMenuOpen),c(),d("ngIf",a.isMobileMenuOpen)}},dependencies:[O,oe,B,Q,dt,mt,Pt,se],encapsulation:2,data:{animation:[X("slideFade",[j(":enter",[S({opacity:0,transform:"translateY(-10px)"}),L("150ms ease-out",S({opacity:1,transform:"translateY(0)"}))]),j(":leave",[L("150ms ease-in",S({opacity:0,transform:"translateY(-10px)"}))])])]}});let t=e;return t})();var jt=(()=>{let e=class e{constructor(i){this.notificationService=i,this.newsletterEmail="",this.currentYear=new Date().getFullYear()}subscribeNewsletter(){this.newsletterEmail&&(this.notificationService.show("\u0628\u0627 \u0645\u0648\u0641\u0642\u06CC\u062A \u062F\u0631 \u062E\u0628\u0631\u0646\u0627\u0645\u0647 \u0639\u0636\u0648 \u0634\u062F\u06CC\u062F","success"),this.newsletterEmail="")}};e.\u0275fac=function(n){return new(n||e)(h(T))},e.\u0275cmp=I({type:e,selectors:[["app-footer"]],decls:59,vars:2,consts:[[1,"border-t","border-border","bg-background"],[1,"container","py-12"],[1,"grid","grid-cols-1","gap-8","md:grid-cols-2","lg:grid-cols-4"],[1,"space-y-4"],[1,"text-lg","font-semibold","text-foreground"],[1,"text-muted-foreground","text-sm","leading-relaxed"],[1,"flex","gap-4"],["href","#",1,"text-muted-foreground","hover:text-primary"],[1,"sr-only"],["fill","currentColor","viewBox","0 0 24 24","aria-hidden","true",1,"w-6","h-6"],["fill-rule","evenodd","d","M12.315 2c2.43 0 2.784.013 3.808.06 1.064.049 1.791.218 2.427.465a4.902 4.902 0 011.772 1.153 4.902 4.902 0 011.153 1.772c.247.636.416 1.363.465 2.427.048 1.024.06 1.378.06 3.808s-.012 2.784-.06 3.808c-.049 1.064-.218 1.791-.465 2.427a4.902 4.902 0 01-1.153 1.772 4.902 4.902 0 01-1.772 1.153c-.636.247-1.363.416-2.427.465-1.024.048-1.378.06-3.808.06s-2.784-.012-3.808-.06c-1.064-.049-1.791-.218-2.427-.465a4.902 4.902 0 01-1.772-1.153 4.902 4.902 0 01-1.153-1.772c-.247-.636-.416-1.363-.465-2.427-.048-1.024-.06-1.378-.06-3.808s.012-2.784.06-3.808c.049-1.064.218-1.791.465-2.427a4.902 4.902 0 011.153-1.772A4.902 4.902 0 015.45 2.525c.636-.247 1.363-.416 2.427-.465C8.901 2.013 9.256 2 11.685 2h.63zm-.081 1.802h-.468c-2.456 0-2.784.011-3.807.06-1.064.049-1.644.211-2.126.41-1.054.423-1.737 1.1-2.16 2.159-.199.482-.36 1.062-.41 2.126-.048 1.023-.06 1.351-.06 3.807s.011 2.784.06 3.807c.049 1.064.211 1.644.41 2.126.423 1.054 1.106 1.737 2.159 2.16.482.199 1.062.36 2.126.41 1.023.048 1.351.06 3.807.06h.468c2.456 0 2.784-.011 3.807-.06 1.064-.049 1.644-.211 2.126-.41 1.054-.423 1.737-1.1 2.16-2.159.199-.482.36-1.062.41-2.126.048-1.023.06-1.351.06-3.807s-.011-2.784-.06-3.807c-.049-1.064-.211-1.644-.41-2.126-.423-1.054-1.106-1.737-2.159-2.16-.482-.199-1.062-.36-2.126-.41-1.023-.048-1.351-.06-3.807-.06z","clip-rule","evenodd"],["d","M12 6.865a5.135 5.135 0 100 10.27 5.135 5.135 0 000-10.27zm-3.308 5.135a3.308 3.308 0 116.616 0 3.308 3.308 0 01-6.616 0z"],["d","M16.949 6.865a1.285 1.285 0 11-2.57 0 1.285 1.285 0 012.57 0z"],["d","M8.29 20.251c7.547 0 11.675-6.253 11.675-11.675 0-.178 0-.355-.012-.53A8.348 8.348 0 0022 5.92a8.19 8.19 0 01-2.357.646 4.118 4.118 0 001.804-2.27 8.224 8.224 0 01-2.605.996 4.107 4.107 0 00-6.993 3.743 11.65 11.65 0 01-8.457-4.287 4.106 4.106 0 001.27 5.477A4.072 4.072 0 012.8 9.71v.052a4.105 4.105 0 003.292 4.022 4.095 4.095 0 01-1.853.07 4.108 4.108 0 003.834 2.85A8.233 8.233 0 012 18.407a11.616 11.616 0 006.29 1.84"],[1,"space-y-2"],[1,"space-y-2","text-muted-foreground"],["href","#",1,"transition-colors","hover:text-foreground"],[1,"text-muted-foreground","text-sm"],[1,"flex","w-full","items-center","space-x-2","space-x-reverse"],["type","email","placeholder","\u0627\u06CC\u0645\u06CC\u0644 \u0634\u0645\u0627",1,"input",3,"ngModelChange","ngModel"],[1,"btn","btn-primary","btn-md","shrink-0",3,"click"],[1,"mt-8","flex","flex-col","items-center","justify-between","border-t","border-border","pt-6","sm:flex-row"],[1,"text-sm","text-muted-foreground"]],template:function(n,a){n&1&&(o(0,"footer",0)(1,"div",1)(2,"div",2)(3,"div",3)(4,"h3",4),u(5,"\u0641\u0631\u0648\u0634\u06AF\u0627\u0647 \u0644\u0650\u062F\u06A9\u0627"),s(),o(6,"p",5),u(7,"\u062A\u062C\u0631\u0628\u0647 \u062E\u0631\u06CC\u062F \u0622\u0646\u0644\u0627\u06CC\u0646 \u0628\u0647\u062A\u0631\u06CC\u0646 \u0642\u0637\u0639\u0627\u062A \u0648 \u0644\u0648\u0627\u0632\u0645 \u062C\u0627\u0646\u0628\u06CC \u06AF\u0644\u062E\u0627\u0646\u0647 \u0628\u0627 \u0636\u0645\u0627\u0646\u062A \u0627\u0635\u0627\u0644\u062A \u0648 \u0628\u0647\u062A\u0631\u06CC\u0646 \u0642\u06CC\u0645\u062A."),s(),o(8,"div",6)(9,"a",7)(10,"span",8),u(11,"Instagram"),s(),ge(),o(12,"svg",9),w(13,"path",10)(14,"path",11)(15,"path",12),s()(),ve(),o(16,"a",7)(17,"span",8),u(18,"Twitter"),s(),ge(),o(19,"svg",9),w(20,"path",13),s()()()(),ve(),o(21,"div",14)(22,"h3",4),u(23,"\u062E\u062F\u0645\u0627\u062A \u0645\u0634\u062A\u0631\u06CC\u0627\u0646"),s(),o(24,"ul",15)(25,"li")(26,"a",16),u(27,"\u067E\u0627\u0633\u062E \u0628\u0647 \u067E\u0631\u0633\u0634\u200C\u0647\u0627\u06CC \u0645\u062A\u062F\u0627\u0648\u0644"),s()(),o(28,"li")(29,"a",16),u(30,"\u0634\u0631\u0627\u06CC\u0637 \u0627\u0633\u062A\u0641\u0627\u062F\u0647"),s()(),o(31,"li")(32,"a",16),u(33,"\u062D\u0631\u06CC\u0645 \u062E\u0635\u0648\u0635\u06CC"),s()()()(),o(34,"div",14)(35,"h3",4),u(36,"\u0628\u0627 \u0645\u0627"),s(),o(37,"ul",15)(38,"li")(39,"a",16),u(40,"\u062F\u0631\u0628\u0627\u0631\u0647 \u0645\u0627"),s()(),o(41,"li")(42,"a",16),u(43,"\u062A\u0645\u0627\u0633 \u0628\u0627 \u0645\u0627"),s()(),o(44,"li")(45,"a",16),u(46,"\u0641\u0631\u0635\u062A\u200C\u0647\u0627\u06CC \u0634\u063A\u0644\u06CC"),s()()()(),o(47,"div",3)(48,"h3",4),u(49,"\u0639\u0636\u0648\u06CC\u062A \u062F\u0631 \u062E\u0628\u0631\u0646\u0627\u0645\u0647"),s(),o(50,"p",17),u(51,"\u0627\u0632 \u062C\u062F\u06CC\u062F\u062A\u0631\u06CC\u0646 \u062A\u062E\u0641\u06CC\u0641\u200C\u0647\u0627 \u0648 \u0645\u062D\u0635\u0648\u0644\u0627\u062A \u0628\u0627\u062E\u0628\u0631 \u0634\u0648\u06CC\u062F."),s(),o(52,"div",18)(53,"input",19),Ke("ngModelChange",function(m){return Ge(a.newsletterEmail,m)||(a.newsletterEmail=m),m}),s(),o(54,"button",20),f("click",function(){return a.subscribeNewsletter()}),u(55," \u062B\u0628\u062A "),s()()()(),o(56,"div",21)(57,"p",22),u(58),s()()()()),n&2&&(c(53),Xe("ngModel",a.newsletterEmail),c(5),Y("\xA9 ",a.currentYear," \u062A\u0645\u0627\u0645\u06CC \u062D\u0642\u0648\u0642 \u0628\u0631\u0627\u06CC \u0641\u0631\u0648\u0634\u06AF\u0627\u0647 \u0644\u0650\u062F\u06A9\u0627 \u0645\u062D\u0641\u0648\u0638 \u0627\u0633\u062A."))},dependencies:[Q,bt,yt,_t,xt,O],encapsulation:2});let t=e;return t})();function _i(t,e){if(t&1){let r=x();o(0,"div",1)(1,"div",2)(2,"div",3)(3,"span",4),u(4),s(),o(5,"p"),u(6),s()(),o(7,"button",5),f("click",function(){v(r);let n=p();return y(n.close())}),o(8,"span",6),u(9,"close"),s()()()()}if(t&2){let r=p();d("@slideInOut",void 0),c(),d("ngClass",r.notificationClass),c(3),k(r.icon),c(2),k(r.notification.message)}}var Dt=(()=>{let e=class e{constructor(i){this.notificationService=i,this.notification=null}ngOnInit(){this.subscription=this.notificationService.notification$.subscribe(i=>{this.notification=i,this.timer&&clearTimeout(this.timer),i&&(this.timer=setTimeout(()=>{this.close()},5e3))})}ngOnDestroy(){this.subscription.unsubscribe(),this.timer&&clearTimeout(this.timer)}get notificationClass(){if(!this.notification)return"";switch(this.notification.type){case"success":return"bg-success text-success-foreground";case"error":return"bg-destructive text-destructive-foreground";case"info":default:return"bg-blue-500 text-white"}}get icon(){if(!this.notification)return"";switch(this.notification.type){case"success":return"check_circle";case"error":return"error";case"info":return"info";default:return"info"}}close(){this.notificationService.clear()}};e.\u0275fac=function(n){return new(n||e)(h(T))},e.\u0275cmp=I({type:e,selectors:[["app-notification"]],decls:1,vars:1,consts:[["class","fixed top-5 left-1/2 -translate-x-1/2 z-[100] w-full max-w-md px-4",4,"ngIf"],[1,"fixed","top-5","left-1/2","-translate-x-1/2","z-[100]","w-full","max-w-md","px-4"],[1,"flex","items-center","justify-between","p-4","rounded-xl","shadow-lg","text-sm","font-medium",3,"ngClass"],[1,"flex","items-center","gap-3"],[1,"material-icons","text-xl"],[1,"ms-4","-my-2","p-2","rounded-full","hover:bg-black/10","focus:outline-none","focus:ring-2","focus:ring-white",3,"click"],[1,"material-icons","text-lg"]],template:function(n,a){n&1&&g(0,_i,10,4,"div",0),n&2&&d("ngIf",a.notification)},dependencies:[O,qe,B],encapsulation:2,data:{animation:[X("slideInOut",[Ce("in",S({transform:"translate(-50%, 0)",opacity:1})),j("void => *",[S({transform:"translate(-50%, -100%)",opacity:0}),L("300ms ease-out")]),j("* => void",[L("300ms ease-in",S({transform:"translate(-50%, -100%)",opacity:0}))])])]}});let t=e;return t})();var me=(()=>{let e=class e{constructor(i,n,a,l){this.authService=i,this.notificationService=n,this.router=a,this.platformId=l,this.INACTIVITY_TIMEOUT=1800*1e3,this.WARNING_TIME=300*1e3,this.CHECK_INTERVAL=60*1e3,this.lastActivityTime=Date.now(),this.destroy$=new R,this.isMonitoring=!1,this.warningShown=!1}isPaymentPage(){if(!D(this.platformId))return!1;let i=window.location.pathname.toLowerCase(),n=window.location.search.toLowerCase();return i.includes("/payment")||i.includes("/checkout")||i.includes("/callback")||n.includes("authority=")||n.includes("status=")}startSessionMonitoring(){if(!(!D(this.platformId)||this.isMonitoring)){if(this.isPaymentPage()){console.log("[Session] Skipping session monitoring on payment page");return}this.isMonitoring=!0,this.lastActivityTime=Date.now(),this.warningShown=!1,this.setupActivityListeners(),this.resetInactivityTimer(),this.startPeriodicCheck()}}stopSessionMonitoring(){console.log("[Session] Stopping session monitoring"),this.isMonitoring=!1,this.clearTimers(),this.warningShown=!1}setupActivityListeners(){if(!D(this.platformId))return;let i=[H(document,"mousemove"),H(document,"mousedown"),H(document,"keypress"),H(document,"scroll"),H(document,"touchstart"),H(document,"click")];Ee(...i).pipe(Pe(1e4),_(this.destroy$)).subscribe(()=>{this.onUserActivity()}),H(document,"visibilitychange").pipe(_(this.destroy$)).subscribe(()=>{document.hidden||this.onUserActivity()})}onUserActivity(){!this.isMonitoring||this.isPaymentPage()||(this.lastActivityTime=Date.now(),this.warningShown=!1,this.resetInactivityTimer())}resetInactivityTimer(){this.clearTimers(),this.warningTimer=setTimeout(()=>{this.isPaymentPage()||this.showInactivityWarning()},this.INACTIVITY_TIMEOUT-this.WARNING_TIME),this.inactivityTimer=setTimeout(()=>{this.isPaymentPage()||this.handleSessionTimeout()},this.INACTIVITY_TIMEOUT)}startPeriodicCheck(){ie(this.CHECK_INTERVAL,this.CHECK_INTERVAL).pipe(_(this.destroy$)).subscribe(()=>{if(!this.isMonitoring||this.isPaymentPage())return;let i=Date.now()-this.lastActivityTime;i>=this.INACTIVITY_TIMEOUT?this.handleSessionTimeout():i>=this.INACTIVITY_TIMEOUT-this.WARNING_TIME&&!this.warningShown&&this.showInactivityWarning()})}showInactivityWarning(){if(this.warningShown||!this.isMonitoring||this.isPaymentPage())return;this.warningShown=!0;let i=Math.floor(this.WARNING_TIME/6e4);this.notificationService.show(`\u0646\u0634\u0633\u062A \u0634\u0645\u0627 \u0628\u0647 \u062F\u0644\u06CC\u0644 \u0639\u062F\u0645 \u0641\u0639\u0627\u0644\u06CC\u062A ${i} \u062F\u0642\u06CC\u0642\u0647 \u062F\u06CC\u06AF\u0631 \u0645\u0646\u0642\u0636\u06CC \u0645\u06CC\u200C\u0634\u0648\u062F.  \u0628\u0631\u0627\u06CC \u0627\u062F\u0627\u0645\u0647\u060C \u0641\u0639\u0627\u0644\u06CC\u062A\u06CC \u0627\u0646\u062C\u0627\u0645 \u062F\u0647\u06CC\u062F. `,"info")}handleSessionTimeout(){!this.isMonitoring||this.isPaymentPage()||(this.stopSessionMonitoring(),this.notificationService.show("\u0646\u0634\u0633\u062A \u0634\u0645\u0627 \u0628\u0647 \u062F\u0644\u06CC\u0644 \u0639\u062F\u0645 \u0641\u0639\u0627\u0644\u06CC\u062A \u0645\u0646\u0642\u0636\u06CC \u0634\u062F. \u0644\u0637\u0641\u0627 \u0645\u062C\u062F\u062F\u0627 \u0648\u0627\u0631\u062F \u0634\u0648\u06CC\u062F.","info"),this.authService.logout(!0))}clearTimers(){this.inactivityTimer&&(clearTimeout(this.inactivityTimer),this.inactivityTimer=null),this.warningTimer&&(clearTimeout(this.warningTimer),this.warningTimer=null)}getRemainingTime(){let i=Date.now()-this.lastActivityTime;return Math.max(0,this.INACTIVITY_TIMEOUT-i)}getRemainingTimeFormatted(){let i=this.getRemainingTime(),n=Math.floor(i/6e4),a=Math.floor(i%6e4/1e3);return`${n}:${a.toString().padStart(2,"0")}`}extendSession(){this.isMonitoring&&(this.onUserActivity(),this.notificationService.show("\u0646\u0634\u0633\u062A \u0634\u0645\u0627 \u062A\u0645\u062F\u06CC\u062F \u0634\u062F","success"))}isSessionActive(){return this.isMonitoring&&this.authService.isAuthenticated()}ngOnDestroy(){this.destroy$.next(),this.destroy$.complete(),this.stopSessionMonitoring()}};e.\u0275fac=function(n){return new(n||e)(F(M),F(T),F(Z),F(K))},e.\u0275prov=V({token:e,factory:e.\u0275fac,providedIn:"root"});let t=e;return t})();function xi(t,e){t&1&&(o(0,"span"),u(1,"\u062A\u0645\u062F\u06CC\u062F"),s())}function bi(t,e){t&1&&(o(0,"span",9),u(1,"sync"),s())}function Ci(t,e){if(t&1){let r=x();o(0,"div",1)(1,"div",2)(2,"span",3),u(3,"schedule"),s(),o(4,"div")(5,"p",4),u(6,"\u0632\u0645\u0627\u0646 \u0628\u0627\u0642\u06CC\u0645\u0627\u0646\u062F\u0647 \u0646\u0634\u0633\u062A"),s(),o(7,"p",5),u(8),s()(),o(9,"button",6),f("click",function(){v(r);let n=p();return y(n.extendSession())}),g(10,xi,2,0,"span",7)(11,bi,2,0,"span",8),s()()()}if(t&2){let r=p();c(8),k(r.remainingTime),c(),d("disabled",r.isExtending),c(),d("ngIf",!r.isExtending),c(),d("ngIf",r.isExtending)}}var Ut=(()=>{let e=class e{constructor(i){this.sessionService=i,this.remainingTime="",this.showTimer=!1,this.isExtending=!1,this.destroy$=new R,this.SHOW_TIMER_THRESHOLD=300*1e3}ngOnInit(){ke(1e3).pipe(_(this.destroy$),G(()=>this.sessionService.isSessionActive()),A(()=>{let i=this.sessionService.getRemainingTime();this.showTimer=i<this.SHOW_TIMER_THRESHOLD&&i>0,this.showTimer&&(this.remainingTime=this.sessionService.getRemainingTimeFormatted())})).subscribe()}extendSession(){this.isExtending=!0,this.sessionService.extendSession(),setTimeout(()=>{this.isExtending=!1},1e3)}ngOnDestroy(){this.destroy$.next(),this.destroy$.complete()}};e.\u0275fac=function(n){return new(n||e)(h(me))},e.\u0275cmp=I({type:e,selectors:[["app-session-timer"]],decls:1,vars:1,consts:[["class","fixed bottom-4 left-4 bg-card border border-border rounded-lg shadow-lg p-3 z-50 animate-fade-in-up",4,"ngIf"],[1,"fixed","bottom-4","left-4","bg-card","border","border-border","rounded-lg","shadow-lg","p-3","z-50","animate-fade-in-up"],[1,"flex","items-center","gap-3"],[1,"material-icons","text-warning"],[1,"text-xs","font-medium","text-muted-foreground"],[1,"text-lg","font-bold","text-foreground","tabular-nums"],[1,"btn","btn-primary","btn-sm",3,"click","disabled"],[4,"ngIf"],["class","material-icons animate-spin",4,"ngIf"],[1,"material-icons","animate-spin"]],template:function(n,a){n&1&&g(0,Ci,12,4,"div",0),n&2&&d("ngIf",a.showTimer)},dependencies:[O,B],encapsulation:2});let t=e;return t})();var Ht=(()=>{let e=class e{constructor(i,n,a,l,m){this.sessionService=i,this.authService=n,this.cartService=a,this.router=l,this.platformId=m,this.destroy$=new R}isPaymentPage(){if(!D(this.platformId))return!1;let i=window.location.pathname.toLowerCase(),n=window.location.search.toLowerCase();return i.includes("/payment")||i.includes("/callback")||n.includes("authority=")||n.includes("status=")}ngOnInit(){if(this.isPaymentPage()){console.log("[App] Payment page detected, skipping initialization");return}this.router.events.pipe(G(i=>i instanceof ct),_(this.destroy$)).subscribe(i=>{let n=i.urlAfterRedirects.toLowerCase();(n.includes("/payment")||n.includes("/callback"))&&this.sessionService.stopSessionMonitoring()}),this.authService.isLoggedIn$.pipe(_(this.destroy$)).subscribe(i=>{i&&!this.isPaymentPage()?(this.sessionService.startSessionMonitoring(),this.cartService.getMyCart().subscribe()):this.isPaymentPage()||(this.sessionService.stopSessionMonitoring(),this.cartService.clearLocalCart())}),this.authService.isAuthenticated()&&!this.isPaymentPage()&&this.sessionService.startSessionMonitoring()}ngOnDestroy(){this.destroy$.next(),this.destroy$.complete()}};e.\u0275fac=function(n){return new(n||e)(h(me),h(M),h(W),h(Z),h(K))},e.\u0275cmp=I({type:e,selectors:[["app-root"]],decls:7,vars:0,consts:[[1,"flex","flex-col","min-h-screen","bg-background"],[1,"flex-grow"]],template:function(n,a){n&1&&(w(0,"app-notification")(1,"app-session-timer"),o(2,"div",0),w(3,"app-header"),o(4,"main",1),w(5,"router-outlet"),s(),w(6,"app-footer"),s())},dependencies:[lt,Ot,jt,Dt,Ut],encapsulation:2});let t=e;return t})();it(Ht,Mt).catch(t=>console.error(t));
