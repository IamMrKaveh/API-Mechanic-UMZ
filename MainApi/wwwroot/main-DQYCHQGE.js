import{a as Jt}from"./chunk-ZHMJELME.js";import{c as ce,d as B,f as P,g as Xe,h as G}from"./chunk-DUKSTT3K.js";import{a as pi}from"./chunk-JBDIXU3W.js";import{a as Ne}from"./chunk-4ATIAIKP.js";import{a as W}from"./chunk-MX7VZAVK.js";import{a as ei,b as Ve,d as je,e as ti,f as ii,g as ie,i as ni,j as ri,l as oi,m as si,p as ai,q as ci,r as li,s as ui,u as di,y as mi,z as $e}from"./chunk-2WEVJ2Q3.js";import{b as de}from"./chunk-CVBRNWP7.js";import{a as H}from"./chunk-OR3E3ANE.js";import{a as Z}from"./chunk-WNMS36QR.js";import{A as K,B as X,C as Yt,D as Qt,E as Kt,F as Xt,G as Zt,H as U,b as Fe,c as Q,d as j,e as Oe,f as Nt,i as R,j as q,k as Vt,l as jt,n as Me,o as $t,p as Ke,q as ye,r as zt,s as Ut,t as Ht,u as Bt,v as Gt,w as Le,x as qt,y as De,z as Wt}from"./chunk-H5ECWNVP.js";import{$ as C,$a as St,$b as Qe,A as T,Bb as Re,C as ge,Cb as Pe,Db as x,E as st,F as oe,G as ke,Gb as f,Hb as m,Jb as Tt,K as at,Kb as At,Lb as Rt,M as We,Ma as ae,Mb as Pt,Na as Ae,Nb as Ft,Oa as Ee,Ob as $,P as ee,Pb as c,Q as w,Qa as xt,Qb as A,R as M,Ra as ue,Rb as y,S as ct,Sa as l,T as lt,W as N,Wa as yt,Xa as bt,Ya as Ct,Yb as _e,Z as ut,Zb as Ye,_ as z,aa as dt,ab as wt,ac as D,bb as S,bc as Y,cb as It,cc as xe,dc as Ot,ea as g,f as L,fa as v,fc as Lt,g as le,ga as mt,gb as k,ha as pt,ia as ht,ic as te,j as E,ja as ft,jb as kt,k as I,la as gt,lb as h,lc as Dt,na as V,o as pe,oa as vt,pb as Et,tb as Mt,ua as ve,ub as d,v as re,vb as s,w as he,wb as a,x as rt,xb as _,y as ot,ya as se,z as fe,za as _t}from"./chunk-C5CPS5UB.js";import{a as O,b as me}from"./chunk-4CLCTAJ7.js";var hi=(()=>{let n=class n{constructor(){this.requestRecords=new Map,this.penalties=new Map,this.stats={totalRequests:0,allowedRequests:0,deniedRequests:0},typeof window<"u"&&(this.cleanupInterval=window.setInterval(()=>{this.cleanup()},300*1e3))}checkLimit(e,t){this.stats.totalRequests++;let o=Date.now(),u=this.penalties.get(e);if(u&&o<u.until)return this.stats.deniedRequests++,!1;u&&o>=u.until&&this.penalties.delete(e);let b=(this.requestRecords.get(e)||[]).filter(J=>o-J.timestamp<t.timeWindowMs);return b.reduce((J,we)=>J+we.count,0)>=t.maxRequests?(this.stats.deniedRequests++,t.penaltyMs&&this.penalties.set(e,{until:o+t.penaltyMs,reason:`Exceeded ${t.maxRequests} requests in ${t.timeWindowMs}ms`}),!1):(b.push({timestamp:o,count:1}),this.requestRecords.set(e,b),this.stats.allowedRequests++,!0)}getStats(e,t){let o=Date.now(),b=(this.requestRecords.get(e)||[]).filter(Ie=>o-Ie.timestamp<t.timeWindowMs).reduce((Ie,Te)=>Ie+Te.count,0),ne=b>=t.maxRequests,J=this.penalties.get(e),we=J&&o<J.until?J.until:void 0;return{totalRequests:this.stats.totalRequests,allowedRequests:this.stats.allowedRequests,deniedRequests:this.stats.deniedRequests,currentWindowRequests:b,isLimited:ne,penaltyUntil:we}}getTimeUntilReset(e,t){let o=Date.now(),u=this.penalties.get(e);if(u&&o<u.until)return u.until-o;let p=this.requestRecords.get(e)||[];if(p.length===0)return 0;let ne=p[0].timestamp+t.timeWindowMs;return Math.max(0,ne-o)}clear(e){this.requestRecords.delete(e),this.penalties.delete(e)}clearAll(){this.requestRecords.clear(),this.penalties.clear(),this.stats={totalRequests:0,allowedRequests:0,deniedRequests:0}}cleanup(){let e=Date.now(),t=3600*1e3;this.requestRecords.forEach((o,u)=>{let p=o.filter(b=>e-b.timestamp<t);p.length===0?this.requestRecords.delete(u):p.length!==o.length&&this.requestRecords.set(u,p)}),this.penalties.forEach((o,u)=>{e>=o.until&&this.penalties.delete(u)})}resetStats(){this.stats={totalRequests:0,allowedRequests:0,deniedRequests:0}}getGlobalStats(){return O({},this.stats)}destroy(){this.cleanupInterval&&clearInterval(this.cleanupInterval),this.clearAll()}};n.\u0275fac=function(t){return new(t||n)},n.\u0275prov=N({token:n,factory:n.\u0275fac,providedIn:"root"});let i=n;return i})(),Ze={SEARCH:{maxRequests:60,timeWindowMs:60*1e3},API_PUBLIC:{maxRequests:60,timeWindowMs:60*1e3},API_RESTRICTED:{maxRequests:10,timeWindowMs:60*1e3,penaltyMs:300*1e3},LOGIN:{maxRequests:5,timeWindowMs:900*1e3,penaltyMs:1800*1e3},CART_ADD:{maxRequests:30,timeWindowMs:60*1e3},REVIEW_CREATE:{maxRequests:3,timeWindowMs:3600*1e3}};var ze=class{constructor(n){this.cache=new Map,this.stats={hits:0,misses:0,evictions:0,totalMemoryBytes:0},this.config=O({maxSize:100,ttlMs:300*1e3,strategy:"LRU",enableStats:!0,maxMemoryBytes:10*1024*1024},n)}get(n){let r=this.cache.get(n);if(!r)return this.stats.misses++,null;let e=Date.now();return e-r.timestamp>this.config.ttlMs?(this.cache.delete(n),this.stats.misses++,this.updateMemoryUsage(-1*(r.size||0)),null):(r.lastAccess=e,r.accessCount++,this.stats.hits++,r.data)}set(n,r){let e=this.cache.get(n);e&&this.updateMemoryUsage(-1*(e.size||0));let t=this.estimateSize(r);this.config.maxMemoryBytes&&this.stats.totalMemoryBytes+t>this.config.maxMemoryBytes&&this.evictUntilSpace(t),this.cache.size>=this.config.maxSize&&this.evict();let o=Date.now();this.cache.set(n,{data:r,timestamp:o,accessCount:0,lastAccess:o,size:t}),this.updateMemoryUsage(t)}has(n){return this.cache.has(n)&&this.get(n)!==null}delete(n){let r=this.cache.get(n);return r?(this.updateMemoryUsage(-1*(r.size||0)),this.cache.delete(n)):!1}evict(){switch(this.config.strategy){case"LRU":this.evictLRU();break;case"LFU":this.evictLFU();break;case"FIFO":this.evictFIFO();break}this.stats.evictions++}evictLRU(){let n=null,r=1/0;this.cache.forEach((e,t)=>{e.lastAccess<r&&(r=e.lastAccess,n=t)}),n&&this.delete(n)}evictLFU(){let n=null,r=1/0;this.cache.forEach((e,t)=>{e.accessCount<r&&(r=e.accessCount,n=t)}),n&&this.delete(n)}evictFIFO(){let n=null,r=1/0;this.cache.forEach((e,t)=>{e.timestamp<r&&(r=e.timestamp,n=t)}),n&&this.delete(n)}evictUntilSpace(n){let r=this.config.maxMemoryBytes-n;for(;this.stats.totalMemoryBytes>r&&this.cache.size>0;)this.evict()}clear(){this.cache.clear(),this.stats={hits:0,misses:0,evictions:0,totalMemoryBytes:0}}size(){return this.cache.size}keys(){return Array.from(this.cache.keys())}getStats(){let n=this.stats.hits+this.stats.misses,r=n>0?this.stats.hits/n:0,e,t;return this.cache.forEach(o=>{(!e||o.timestamp<e)&&(e=o.timestamp),(!t||o.timestamp>t)&&(t=o.timestamp)}),{hits:this.stats.hits,misses:this.stats.misses,hitRate:r,size:this.cache.size,memoryUsage:this.stats.totalMemoryBytes,oldestEntry:e,newestEntry:t}}cleanup(){let n=Date.now(),r=[];this.cache.forEach((e,t)=>{n-e.timestamp>this.config.ttlMs&&r.push(t)}),r.forEach(e=>this.delete(e))}estimateSize(n){if(n==null)return 0;try{return JSON.stringify(n).length*2}catch{return 1024}}updateMemoryUsage(n){this.stats.totalMemoryBytes=Math.max(0,this.stats.totalMemoryBytes+n)}resetStats(){this.stats.hits=0,this.stats.misses=0,this.stats.evictions=0}updateConfig(n){for(this.config=O(O({},this.config),n);this.cache.size>this.config.maxSize;)this.evict();if(this.config.maxMemoryBytes)for(;this.stats.totalMemoryBytes>this.config.maxMemoryBytes;)this.evict()}forEach(n){this.cache.forEach(n)}};var Ue=(()=>{let n=class n{constructor(){this.http=C(ye),this.rateLimiter=C(hi),this.API_URL=`${Z.API_URL}Search`,this.CACHE_TTL=120*1e3,this.DEBOUNCE_TIME=300,this.cache=new ze({maxSize:100,ttlMs:this.CACHE_TTL,strategy:"LRU",enableStats:!0}),this.searchStateSubject=new le({isSearching:!1,error:null}),this.searchState$=this.searchStateSubject.asObservable()}searchGlobal(e){if(typeof navigator<"u"&&!navigator.onLine)return I(()=>new Error("\u0627\u062A\u0635\u0627\u0644 \u0627\u06CC\u0646\u062A\u0631\u0646\u062A \u0628\u0631\u0642\u0631\u0627\u0631 \u0646\u06CC\u0633\u062A."));if(!e||e.trim().length<2)return E({categories:[],categoryGroups:[],products:[],query:""});if(!this.rateLimiter.checkLimit("search",Ze.SEARCH))return I(()=>new Error("\u062A\u0639\u062F\u0627\u062F \u062F\u0631\u062E\u0648\u0627\u0633\u062A\u200C\u0647\u0627\u06CC \u0634\u0645\u0627 \u0628\u06CC\u0634 \u0627\u0632 \u062D\u062F \u0645\u062C\u0627\u0632 \u0627\u0633\u062A. \u0644\u0637\u0641\u0627\u064B \u06A9\u0645\u06CC \u0635\u0628\u0631 \u06A9\u0646\u06CC\u062F."));let t=this.normalizePersianChars(e.trim()),o=`global:${t}`;if(this.isCacheValid(o)){let p=this.cache.get(o);if(p)return E(p.data)}this.setSearching(!0),this.setError(null);let u=new Me().set("q",t);return this.http.get(`${this.API_URL}/global`,{params:u}).pipe(M(p=>this.setCache(o,p)),T(p=>(this.cache.delete(o),this.setError(this.getErrorMessage(p)),E({categories:[],categoryGroups:[],products:[],query:""}))),ke(()=>this.setSearching(!1)),We(1))}searchProducts(e){if(typeof navigator<"u"&&!navigator.onLine)return I(()=>new Error("\u0627\u062A\u0635\u0627\u0644 \u0627\u06CC\u0646\u062A\u0631\u0646\u062A \u0628\u0631\u0642\u0631\u0627\u0631 \u0646\u06CC\u0633\u062A."));if(!this.rateLimiter.checkLimit("search",Ze.SEARCH))return I(()=>new Error("\u062A\u0639\u062F\u0627\u062F \u062F\u0631\u062E\u0648\u0627\u0633\u062A\u200C\u0647\u0627\u06CC \u0634\u0645\u0627 \u0628\u06CC\u0634 \u0627\u0632 \u062D\u062F \u0645\u062C\u0627\u0632 \u0627\u0633\u062A. \u0644\u0637\u0641\u0627\u064B \u06A9\u0645\u06CC \u0635\u0628\u0631 \u06A9\u0646\u06CC\u062F."));let t=`products:${JSON.stringify(e)}`;if(this.isCacheValid(t)){let u=this.cache.get(t);if(u)return E(u.data)}this.setSearching(!0),this.setError(null);let o=new Me;return e.q&&(o=o.set("q",this.normalizePersianChars(e.q.trim()))),e.categoryId&&(o=o.set("categoryId",e.categoryId.toString())),e.categoryGroupId&&(o=o.set("categoryGroupId",e.categoryGroupId.toString())),e.minPrice!==void 0&&(o=o.set("minPrice",e.minPrice.toString())),e.maxPrice!==void 0&&(o=o.set("maxPrice",e.maxPrice.toString())),e.inStockOnly!==void 0&&(o=o.set("inStockOnly",e.inStockOnly.toString())),e.brand&&(o=o.set("brand",e.brand)),e.page&&(o=o.set("page",e.page.toString())),e.pageSize&&(o=o.set("pageSize",e.pageSize.toString())),e.sortBy&&(o=o.set("sortBy",e.sortBy)),this.http.get(`${this.API_URL}/products`,{params:o}).pipe(at({count:3,delay:(u,p)=>{if(u.status&&u.status>=400&&u.status<500)return I(()=>u);let b=Math.min(1e3*Math.pow(2,p),1e4);return console.log(`Retrying request... Attempt ${p} after ${b}ms`),he(b)}}),M(u=>this.setCache(t,u)),T(u=>(this.cache.delete(t),this.setError(this.getErrorMessage(u)),I(()=>u))),ke(()=>this.setSearching(!1)),We(1))}getSearchSuggestions(e){return e.pipe(ge(this.DEBOUNCE_TIME),oe(),ee(t=>!t||t.trim().length<2?E({categories:[],categoryGroups:[],products:[],query:""}):this.searchGlobal(t).pipe(T(o=>(this.setError(o.message||"\u062E\u0637\u0627 \u062F\u0631 \u062C\u0633\u062A\u062C\u0648"),E({categories:[],categoryGroups:[],products:[],query:""}))))))}clearCache(){this.cache.clear()}clearError(){this.setError(null)}setSearching(e){let t=this.searchStateSubject.value;this.searchStateSubject.next(me(O({},t),{isSearching:e}))}setError(e){let t=this.searchStateSubject.value;this.searchStateSubject.next(me(O({},t),{error:e}))}isCacheValid(e){let t=this.cache.get(e);return t?Date.now()-t.timestamp<this.CACHE_TTL:!1}setCache(e,t){this.cache.set(e,{data:t,timestamp:Date.now()})}normalizePersianChars(e){return e?e.replace(/ي/g,"\u06CC").replace(/ك/g,"\u06A9").replace(/ى/g,"\u06CC").replace(/٤/g,"\u06F4").replace(/٥/g,"\u06F5").replace(/٦/g,"\u06F6"):""}getErrorMessage(e){return e?.error?.message?e.error.message:e?.message?e.message:"\u062E\u0637\u0627\u06CC\u06CC \u062F\u0631 \u062C\u0633\u062A\u062C\u0648 \u0631\u062E \u062F\u0627\u062F. \u0644\u0637\u0641\u0627\u064B \u062F\u0648\u0628\u0627\u0631\u0647 \u062A\u0644\u0627\u0634 \u06A9\u0646\u06CC\u062F."}};n.\u0275fac=function(t){return new(t||n)},n.\u0275prov=N({token:n,factory:n.\u0275fac,providedIn:"root"});let i=n;return i})();var be=(()=>{let n=class n{constructor(e){this.sanitizer=e,this.DEFAULT_CONFIG={maxLength:100,minLength:1,allowedPattern:/^[\u0600-\u06FFa-zA-Z0-9\s\-_.()]+$/,dangerousChars:/<|>|script|javascript|onerror|onclick|onload|eval|expression/gi}}validateSearchQuery(e,t={}){let o=O(O({},this.DEFAULT_CONFIG),t),u=[];if(e==null)return{isValid:!1,sanitizedValue:"",errors:["\u062C\u0633\u062A\u062C\u0648 \u0646\u0645\u06CC\u200C\u062A\u0648\u0627\u0646\u062F \u062E\u0627\u0644\u06CC \u0628\u0627\u0634\u062F"]};let b=this.normalizePersianChars(String(e)).trim();if(b.length===0)return{isValid:!1,sanitizedValue:"",errors:["\u0644\u0637\u0641\u0627 \u0639\u0628\u0627\u0631\u062A\u06CC \u0628\u0631\u0627\u06CC \u062C\u0633\u062A\u062C\u0648 \u0648\u0627\u0631\u062F \u06A9\u0646\u06CC\u062F"]};if(b.length<o.minLength&&u.push(`\u062D\u062F\u0627\u0642\u0644 ${o.minLength} \u06A9\u0627\u0631\u0627\u06A9\u062A\u0631 \u0648\u0627\u0631\u062F \u06A9\u0646\u06CC\u062F`),b.length>o.maxLength&&u.push(`\u062D\u062F\u0627\u06A9\u062B\u0631 ${o.maxLength} \u06A9\u0627\u0631\u0627\u06A9\u062A\u0631 \u0645\u062C\u0627\u0632 \u0627\u0633\u062A`),o.allowedPattern.test(b)||u.push("\u0641\u0642\u0637 \u062D\u0631\u0648\u0641\u060C \u0627\u0639\u062F\u0627\u062F \u0648 \u0628\u0631\u062E\u06CC \u06A9\u0627\u0631\u0627\u06A9\u062A\u0631\u0647\u0627\u06CC \u062E\u0627\u0635 \u0645\u062C\u0627\u0632 \u0647\u0633\u062A\u0646\u062F"),o.dangerousChars.test(b))return u.push("\u06A9\u0627\u0631\u0627\u06A9\u062A\u0631\u0647\u0627\u06CC \u063A\u06CC\u0631\u0645\u062C\u0627\u0632 \u0634\u0646\u0627\u0633\u0627\u06CC\u06CC \u0634\u062F"),{isValid:!1,sanitizedValue:"",errors:u};let ne=this.sanitizer.sanitize(ae.HTML,b)||"";return ne!==b&&b.includes("<")?(u.push("\u0645\u062D\u062A\u0648\u0627\u06CC HTML \u0645\u062C\u0627\u0632 \u0646\u06CC\u0633\u062A"),{isValid:!1,sanitizedValue:"",errors:u}):{isValid:u.length===0,sanitizedValue:ne,errors:u.length>0?u:void 0}}validateNumericParam(e,t,o){let u=Number(e);return isNaN(u)||!isFinite(u)?null:t!==void 0&&u<t?t:o!==void 0&&u>o?o:Math.floor(u)}validateBooleanParam(e){return e==="true"||e===!0||e===1?!0:e==="false"||e===!1||e===0?!1:null}sanitizeUrlParams(e){let t={};for(let[o,u]of Object.entries(e)){if(u==null)continue;let p=this.sanitizer.sanitize(ae.HTML,String(o))||"";if(p)if(typeof u=="string"){let b=this.sanitizer.sanitize(ae.HTML,u);b&&(t[p]=b)}else(typeof u=="number"||typeof u=="boolean")&&(t[p]=u)}return t}escapeRegex(e){return e.replace(/[.*+?^${}()|[\]\\]/g,"\\$&")}normalizePersianChars(e){return e?e.replace(/ي/g,"\u06CC").replace(/ك/g,"\u06A9").replace(/ى/g,"\u06CC").replace(/٤/g,"\u06F4").replace(/٥/g,"\u06F5").replace(/٦/g,"\u06F6"):""}};n.\u0275fac=function(t){return new(t||n)(z(Le))},n.\u0275prov=N({token:n,factory:n.\u0275fac,providedIn:"root"});let i=n;return i})();var $i=()=>[];function zi(i,n){if(i&1){let r=x();s(0,"div",34)(1,"span",35),c(2),a(),s(3,"button",36),f("click",function(){g(r);let t=m();return v(t.retryLastSearch())}),s(4,"span",37),c(5,"refresh"),a(),c(6," \u062A\u0644\u0627\u0634 \u0645\u062C\u062F\u062F "),a()()}if(i&2){let r=m();l(2),A(r.error())}}function Ui(i,n){if(i&1&&(s(0,"span",38),c(1),a()),i&2){let r=m();l(),y(' \u0628\u0631\u0627\u06CC "',r.currentQuery(),'" ')}}function Hi(i,n){if(i&1&&(s(0,"p",39),c(1),a()),i&2){let r=m();l(),y(" ",r.searchResults().total," \u0645\u062D\u0635\u0648\u0644 \u06CC\u0627\u0641\u062A \u0634\u062F ")}}function Bi(i,n){if(i&1&&(s(0,"option",40),c(1),a()),i&2){let r=n.$implicit;d("value",r.value),l(),y(" ",r.label," ")}}function Gi(i,n){i&1&&(s(0,"div",41)(1,"div",42),_(2,"span",43),s(3,"p",44),c(4,"\u062F\u0631 \u062D\u0627\u0644 \u062C\u0633\u062A\u062C\u0648..."),a()()())}function qi(i,n){if(i&1){let r=x();s(0,"div",45)(1,"span",46),c(2,"error_outline"),a(),s(3,"h3",47),c(4,"\u062E\u0637\u0627 \u062F\u0631 \u062C\u0633\u062A\u062C\u0648"),a(),s(5,"p",39),c(6),a(),s(7,"button",48),f("click",function(){g(r);let t=m();return v(t.retryLastSearch())}),c(8," \u062A\u0644\u0627\u0634 \u0645\u062C\u062F\u062F "),a()()}if(i&2){let r=m();l(6),A(r.error())}}function Wi(i,n){if(i&1){let r=x();s(0,"div",45)(1,"span",49),c(2,"search_off"),a(),s(3,"h3",47),c(4,"\u0646\u062A\u06CC\u062C\u0647\u200C\u0627\u06CC \u06CC\u0627\u0641\u062A \u0646\u0634\u062F"),a(),s(5,"p",50),c(6," \u0645\u062A\u0623\u0633\u0641\u0627\u0646\u0647 \u0645\u062D\u0635\u0648\u0644\u06CC \u0628\u0627 \u0627\u06CC\u0646 \u0645\u0634\u062E\u0635\u0627\u062A \u067E\u06CC\u062F\u0627 \u0646\u0634\u062F. "),_(7,"br"),c(8," \u0644\u0637\u0641\u0627\u064B \u06A9\u0644\u0645\u0627\u062A \u06A9\u0644\u06CC\u062F\u06CC \u06CC\u0627 \u0641\u06CC\u0644\u062A\u0631\u0647\u0627\u06CC \u062F\u06CC\u06AF\u0631\u06CC \u0631\u0627 \u0627\u0645\u062A\u062D\u0627\u0646 \u06A9\u0646\u06CC\u062F. "),a(),s(9,"button",51),f("click",function(){g(r);let t=m();return v(t.onClearFilters())}),c(10," \u067E\u0627\u06A9 \u06A9\u0631\u062F\u0646 \u0641\u06CC\u0644\u062A\u0631\u0647\u0627 "),a()()}}function Yi(i,n){if(i&1&&_(0,"img",72),i&2){let r=m().$implicit;d("src",r.imageUrl,Ee)("alt",r.name)}}function Qi(i,n){i&1&&(s(0,"div",73)(1,"span",74),c(2,"image"),a()())}function Ki(i,n){i&1&&(s(0,"span",75),c(1," \u062A\u062E\u0641\u06CC\u0641 "),a())}function Xi(i,n){i&1&&(s(0,"span",76),c(1," \u0646\u0627\u0645\u0648\u062C\u0648\u062F "),a())}function Zi(i,n){if(i&1&&(s(0,"a",57)(1,"figure",58),h(2,Yi,1,2,"img",59)(3,Qi,3,0,"div",60),s(4,"div",61),h(5,Ki,2,0,"span",62)(6,Xi,2,0,"span",63),a()(),s(7,"div",64)(8,"h3",65),c(9),a(),s(10,"div",66)(11,"span",67),c(12,"category"),a(),s(13,"span",68),c(14),a()(),s(15,"div",69)(16,"div",70),c(17),a(),s(18,"span",71),c(19," arrow_back "),a()()()()),i&2){let r=n.$implicit,e=m(3);d("routerLink",e.getProductLink(r)),l(2),d("ngIf",r.imageUrl),l(),d("ngIf",!r.imageUrl),l(2),d("ngIf",(r.discountPercentage||0)>0),l(),d("ngIf",!r.inStock),l(3),y(" ",r.name," "),l(5),A(r.categoryGroupName),l(3),y(" ",e.formatPrice(r.price)," ")}}function Ji(i,n){if(i&1&&(s(0,"div",55),h(1,Zi,20,8,"a",56),a()),i&2){let r=m(2);l(),d("ngForOf",r.searchResults().items)}}function en(i,n){if(i&1&&_(0,"img",72),i&2){let r=m().$implicit;d("src",r.imageUrl,Ee)("alt",r.name)}}function tn(i,n){i&1&&(s(0,"div",73)(1,"span",74),c(2,"image"),a()())}function nn(i,n){if(i&1&&(s(0,"p",92),c(1),a()),i&2){let r=m().$implicit;l(),y(" ",r.description," ")}}function rn(i,n){i&1&&(s(0,"span",93),c(1," \u062A\u062E\u0641\u06CC\u0641 "),a())}function on(i,n){i&1&&(s(0,"span",94),c(1," \u0646\u0627\u0645\u0648\u062C\u0648\u062F "),a())}function sn(i,n){if(i&1&&(s(0,"a",79)(1,"figure",80),h(2,en,1,2,"img",59)(3,tn,3,0,"div",60),a(),s(4,"div",81)(5,"div",82)(6,"div",83)(7,"h3",84),c(8),a(),h(9,nn,2,1,"p",85),s(10,"div",86)(11,"div",87)(12,"span",10),c(13,"category"),a(),s(14,"span"),c(15),a()(),s(16,"div",7),h(17,rn,2,0,"span",88)(18,on,2,0,"span",89),a()()(),s(19,"div",90)(20,"div",91),c(21),a()()()()()),i&2){let r=n.$implicit,e=m(3);d("routerLink",e.getProductLink(r)),l(2),d("ngIf",r.imageUrl),l(),d("ngIf",!r.imageUrl),l(5),y(" ",r.name," "),l(),d("ngIf",r.description),l(6),A(r.categoryGroupName),l(2),d("ngIf",(r.discountPercentage||0)>0),l(),d("ngIf",!r.inStock),l(3),y(" ",e.formatPrice(r.price)," ")}}function an(i,n){if(i&1&&(s(0,"div",77),h(1,sn,22,9,"a",78),a()),i&2){let r=m(2);l(),d("ngForOf",r.searchResults().items)}}function cn(i,n){if(i&1){let r=x();s(0,"button",99),f("click",function(){let t=g(r).index,o=m(3);return v(o.onPageChange(t+1))}),c(1),a()}if(i&2){let r=n.index,e=m(3);$("btn-primary",e.currentPage()===r+1)("btn-outline",e.currentPage()!==r+1),l(),y(" ",r+1," ")}}function ln(i,n){if(i&1){let r=x();s(0,"div",95)(1,"button",96),f("click",function(){g(r);let t=m(2);return v(t.onPageChange(t.currentPage()-1))}),s(2,"span",37),c(3,"chevron_right"),a()(),s(4,"div",97),h(5,cn,2,5,"button",98),a(),s(6,"button",96),f("click",function(){g(r);let t=m(2);return v(t.onPageChange(t.currentPage()+1))}),s(7,"span",37),c(8,"chevron_left"),a()()()}if(i&2){let r=m(2);l(),d("disabled",r.currentPage()===1),l(4),d("ngForOf",_e(3,$i).constructor(r.getMin(r.totalPages(),5))),l(),d("disabled",r.currentPage()===r.totalPages())}}function un(i,n){if(i&1&&(s(0,"div"),h(1,Ji,2,1,"div",52)(2,an,2,1,"div",53)(3,ln,9,4,"div",54),a()),i&2){let r=m();l(),d("ngIf",r.viewMode()==="grid"),l(),d("ngIf",r.viewMode()==="list"),l(),d("ngIf",r.totalPages()>1)}}var fi=(()=>{let n=class n{constructor(){this.route=C(De),this.router=C(K),this.searchService=C(Ue),this.validationService=C(be),this.searchAction$=new L,this.searchControl=new ie("",{nonNullable:!0}),this.filtersForm=new ii({sort:new ie(""),minPrice:new ie(null),maxPrice:new ie(null),inStockOnly:new ie(!1),brand:new ie("")}),this.searchResults=V(null),this.isLoading=V(!1),this.error=V(null),this.currentQuery=V(""),this.currentPage=V(1),this.pageSize=V(20),this.viewMode=V("grid"),this.totalPages=te(()=>{let e=this.searchResults();return!e||e.total===0?0:Math.ceil(e.total/this.pageSize())}),this.hasResults=te(()=>{let e=this.searchResults();return e!==null&&e.items.length>0}),this.isEmpty=te(()=>{let e=this.searchResults();return!this.isLoading()&&e!==null&&e.items.length===0}),this.destroy$=new L,this.sortOptions=[{value:"relevance",label:"\u0645\u0631\u062A\u0628\u0637\u200C\u062A\u0631\u06CC\u0646"},{value:"price_asc",label:"\u0642\u06CC\u0645\u062A \u0635\u0639\u0648\u062F\u06CC"},{value:"price_desc",label:"\u0642\u06CC\u0645\u062A \u0646\u0632\u0648\u0644\u06CC"},{value:"newest",label:"\u062C\u062F\u06CC\u062F\u062A\u0631\u06CC\u0646"},{value:"popular",label:"\u0645\u062D\u0628\u0648\u0628\u200C\u062A\u0631\u06CC\u0646"}]}ngOnInit(){this.searchAction$.pipe(w(this.destroy$),ee(e=>(this.isLoading.set(!0),this.error.set(null),this.searchService.searchProducts(e).pipe(T(t=>(this.error.set(t.message||"\u062E\u0637\u0627 \u062F\u0631 \u062C\u0633\u062A\u062C\u0648"),E(null))),ke(()=>this.isLoading.set(!1)))))).subscribe(e=>{e&&this.searchResults.set(e)}),this.route.queryParams.pipe(w(this.destroy$),oe((e,t)=>e.q===t.q&&e.page===t.page),ge(100)).subscribe(e=>{let t=e.q||"",o=parseInt(e.page,10)||1;t&&t.length>=2?(this.currentQuery.set(t),this.currentPage.set(o),this.searchControl.setValue(t,{emitEvent:!1}),this.triggerSearch(t,o)):(!t||t.length<2)&&this.searchResults.set(null)}),this.filtersForm.valueChanges.pipe(ge(300),oe((e,t)=>JSON.stringify(e)===JSON.stringify(t)),w(this.destroy$)).subscribe(()=>{this.updateUrl(this.currentQuery(),1)}),this.searchControl.valueChanges.pipe(ge(300),oe(),w(this.destroy$)).subscribe(e=>{e&&e.length>=2&&this.updateUrl(e,1)})}triggerSearch(e,t){let o=this.validationService.validateSearchQuery(e);if(!o.isValid){this.error.set(o.errors?.[0]||"\u0648\u0631\u0648\u062F\u06CC \u0646\u0627\u0645\u0639\u062A\u0628\u0631 \u0627\u0633\u062A");return}let u={q:o.sanitizedValue,page:t,pageSize:this.pageSize(),sortBy:this.filtersForm.controls.sort.value||void 0,minPrice:this.filtersForm.controls.minPrice.value??void 0,maxPrice:this.filtersForm.controls.maxPrice.value??void 0,inStockOnly:this.filtersForm.controls.inStockOnly.value??void 0,brand:this.filtersForm.controls.brand.value||void 0};this.searchAction$.next(u)}ngOnDestroy(){this.destroy$.next(),this.destroy$.complete()}performSearch(e,t=1){let o=e??this.currentQuery();this.updateUrl(o,t)}onPageChange(e){e<1||e>this.totalPages()||this.updateUrl(this.currentQuery(),e)}updateUrl(e,t){this.router.navigate([],{relativeTo:this.route,queryParams:{q:e,page:t>1?t:null},queryParamsHandling:"merge"})}onSubmitSearch(){let e=this.searchControl.value?.trim();e&&e.length>=2&&this.updateUrl(e,1)}onClearSearch(){this.searchControl.setValue(""),this.searchResults.set(null),this.currentQuery.set(""),this.router.navigate(["/search"])}onClearFilters(){this.filtersForm.reset({sort:"",minPrice:null,maxPrice:null,inStockOnly:!1,brand:""})}getProductLink(e){return`/products/${e.productId}`}formatPrice(e){return new Intl.NumberFormat("fa-IR").format(e)+" \u062A\u0648\u0645\u0627\u0646"}retryLastSearch(){this.error.set(null),this.triggerSearch(this.currentQuery(),this.currentPage())}getMin(e,t){return Math.min(e,t)}};n.\u0275fac=function(t){return new(t||n)},n.\u0275cmp=k({type:n,selectors:[["app-search-results"]],decls:51,vars:17,consts:[[1,"container","py-8"],["class","error-container",4,"ngIf"],[1,"page-header","mb-6"],[1,"flex","items-center","justify-between","flex-wrap","gap-4"],[1,"text-2xl","font-bold","text-foreground","mb-2"],["class","text-primary",4,"ngIf"],["class","text-sm text-muted-foreground",4,"ngIf"],[1,"flex","items-center","gap-2"],[1,"btn-group"],["type","button","aria-label","\u0646\u0645\u0627\u06CC\u0634 \u0634\u0628\u06A9\u0647\u200C\u0627\u06CC",1,"btn","btn-sm",3,"click"],[1,"material-icons","text-base"],["type","button","aria-label","\u0646\u0645\u0627\u06CC\u0634 \u0644\u06CC\u0633\u062A\u06CC",1,"btn","btn-sm",3,"click"],[1,"grid","grid-cols-1","lg:grid-cols-4","gap-6"],[1,"lg:col-span-1"],[1,"card","p-6","space-y-6","sticky","top-20"],[1,"flex","items-center","justify-between"],[1,"text-lg","font-semibold","text-foreground"],["type","button",1,"btn","btn-ghost","btn-sm","text-destructive",3,"click"],[1,"space-y-4",3,"formGroup"],[1,"label"],[1,"label-text"],["formControlName","sort",1,"select","select-bordered","w-full"],[3,"value",4,"ngFor","ngForOf"],[1,"divider"],[1,"grid","grid-cols-2","gap-2"],["type","number","formControlName","minPrice","placeholder","\u0627\u0632","min","0",1,"input","input-bordered","input-sm"],["type","number","formControlName","maxPrice","placeholder","\u062A\u0627","min","0",1,"input","input-bordered","input-sm"],[1,"form-control"],[1,"label","cursor-pointer","justify-start","gap-3"],["type","checkbox","formControlName","inStockOnly",1,"checkbox","checkbox-primary"],[1,"lg:col-span-3"],["class","flex items-center justify-center py-20",4,"ngIf"],["class","card p-12 text-center",4,"ngIf"],[4,"ngIf"],[1,"error-container"],[1,"error-message"],[1,"btn","btn-secondary",3,"click"],[1,"material-icons"],[1,"text-primary"],[1,"text-sm","text-muted-foreground"],[3,"value"],[1,"flex","items-center","justify-center","py-20"],[1,"text-center"],[1,"loading","loading-spinner","loading-lg","text-primary"],[1,"text-sm","text-muted-foreground","mt-4"],[1,"card","p-12","text-center"],[1,"material-icons","text-6xl","text-destructive","mb-4"],[1,"text-lg","font-semibold","text-foreground","mb-2"],["type","button",1,"btn","btn-primary","mt-4",3,"click"],[1,"material-icons","text-6xl","text-muted-foreground/50","mb-4"],[1,"text-sm","text-muted-foreground","mb-4"],["type","button",1,"btn","btn-outline",3,"click"],["class","grid grid-cols-1 sm:grid-cols-2 xl:grid-cols-3 gap-4",4,"ngIf"],["class","space-y-4",4,"ngIf"],["class","flex items-center justify-center gap-2 mt-8",4,"ngIf"],[1,"grid","grid-cols-1","sm:grid-cols-2","xl:grid-cols-3","gap-4"],["class","card hover:shadow-lg transition-shadow group",3,"routerLink",4,"ngFor","ngForOf"],[1,"card","hover:shadow-lg","transition-shadow","group",3,"routerLink"],[1,"relative","aspect-square","overflow-hidden","bg-muted"],["class","w-full h-full object-cover group-hover:scale-105 transition-transform duration-300","loading","lazy",3,"src","alt",4,"ngIf"],["class","w-full h-full flex items-center justify-center",4,"ngIf"],[1,"absolute","top-2","right-2","flex","flex-col","gap-2"],["class","badge badge-destructive",4,"ngIf"],["class","badge badge-outline bg-background/80 backdrop-blur-sm",4,"ngIf"],[1,"card-body","p-4"],[1,"card-title","text-base","line-clamp-2","group-hover:text-primary","transition-colors"],[1,"flex","items-center","gap-2","text-xs","text-muted-foreground","mt-2"],[1,"material-icons","text-sm"],[1,"truncate"],[1,"flex","items-center","justify-between","mt-4"],[1,"font-bold","text-primary"],[1,"material-icons","text-muted-foreground","group-hover:text-primary","transition-colors"],["loading","lazy",1,"w-full","h-full","object-cover","group-hover:scale-105","transition-transform","duration-300",3,"src","alt"],[1,"w-full","h-full","flex","items-center","justify-center"],[1,"material-icons","text-6xl","text-muted-foreground/30"],[1,"badge","badge-destructive"],[1,"badge","badge-outline","bg-background/80","backdrop-blur-sm"],[1,"space-y-4"],["class","card card-side hover:shadow-lg transition-shadow group",3,"routerLink",4,"ngFor","ngForOf"],[1,"card","card-side","hover:shadow-lg","transition-shadow","group",3,"routerLink"],[1,"w-48","flex-shrink-0","bg-muted"],[1,"card-body"],[1,"flex","items-start","justify-between","gap-4"],[1,"flex-1"],[1,"card-title","text-lg","group-hover:text-primary","transition-colors"],["class","text-sm text-muted-foreground mt-2 line-clamp-2",4,"ngIf"],[1,"flex","items-center","gap-4","mt-4"],[1,"flex","items-center","gap-2","text-sm","text-muted-foreground"],["class","badge badge-destructive badge-sm",4,"ngIf"],["class","badge badge-outline badge-sm",4,"ngIf"],[1,"text-left"],[1,"font-bold","text-xl","text-primary"],[1,"text-sm","text-muted-foreground","mt-2","line-clamp-2"],[1,"badge","badge-destructive","badge-sm"],[1,"badge","badge-outline","badge-sm"],[1,"flex","items-center","justify-center","gap-2","mt-8"],["type","button",1,"btn","btn-outline","btn-sm",3,"click","disabled"],[1,"flex","items-center","gap-1"],["type","button","class","btn btn-sm",3,"btn-primary","btn-outline","click",4,"ngFor","ngForOf"],["type","button",1,"btn","btn-sm",3,"click"]],template:function(t,o){t&1&&(s(0,"div",0),h(1,zi,7,1,"div",1),s(2,"div",2)(3,"div",3)(4,"div")(5,"h1",4),c(6," \u0646\u062A\u0627\u06CC\u062C \u062C\u0633\u062A\u062C\u0648 "),h(7,Ui,2,1,"span",5),a(),h(8,Hi,2,1,"p",6),a(),s(9,"div",7)(10,"div",8)(11,"button",9),f("click",function(){return o.viewMode.set("grid")}),s(12,"span",10),c(13,"grid_view"),a()(),s(14,"button",11),f("click",function(){return o.viewMode.set("list")}),s(15,"span",10),c(16,"view_list"),a()()()()()(),s(17,"div",12)(18,"aside",13)(19,"div",14)(20,"div",15)(21,"h2",16),c(22,"\u0641\u06CC\u0644\u062A\u0631\u0647\u0627"),a(),s(23,"button",17),f("click",function(){return o.onClearFilters()}),c(24," \u067E\u0627\u06A9 \u06A9\u0631\u062F\u0646 "),a()(),s(25,"form",18)(26,"div")(27,"label",19)(28,"span",20),c(29,"\u0645\u0631\u062A\u0628\u200C\u0633\u0627\u0632\u06CC"),a()(),s(30,"select",21),h(31,Bi,2,2,"option",22),a()(),_(32,"div",23),s(33,"div")(34,"label",19)(35,"span",20),c(36,"\u0645\u062D\u062F\u0648\u062F\u0647 \u0642\u06CC\u0645\u062A (\u062A\u0648\u0645\u0627\u0646)"),a()(),s(37,"div",24),_(38,"input",25)(39,"input",26),a()(),_(40,"div",23),s(41,"div",27)(42,"label",28),_(43,"input",29),s(44,"span",20),c(45,"\u0641\u0642\u0637 \u06A9\u0627\u0644\u0627\u0647\u0627\u06CC \u0645\u0648\u062C\u0648\u062F"),a()()()()()(),s(46,"main",30),h(47,Gi,5,0,"div",31)(48,qi,9,1,"div",32)(49,Wi,11,0,"div",32)(50,un,4,3,"div",33),a()()()),t&2&&(l(),d("ngIf",o.error()),l(6),d("ngIf",o.currentQuery()),l(),d("ngIf",o.hasResults()),l(3),$("btn-primary",o.viewMode()==="grid")("btn-outline",o.viewMode()!=="grid"),l(3),$("btn-primary",o.viewMode()==="list")("btn-outline",o.viewMode()!=="list"),l(11),d("formGroup",o.filtersForm),l(6),d("ngForOf",o.sortOptions),l(16),d("ngIf",o.isLoading()),l(),d("ngIf",o.error()&&!o.isLoading()),l(),d("ngIf",o.isEmpty()),l(),d("ngIf",o.hasResults()&&!o.isLoading()))},dependencies:[R,Q,j,U,X,$e,ni,li,ui,Ve,ri,ei,ci,je,ti,di,si,ai],styles:[".page-header[_ngcontent-%COMP%]{animation:_ngcontent-%COMP%_fadeInDown .3s ease-out}.card[_ngcontent-%COMP%]{transition:all .3s ease}.card[_ngcontent-%COMP%]:hover{transform:translateY(-4px)}figure[_ngcontent-%COMP%]{position:relative;overflow:hidden}figure[_ngcontent-%COMP%]   img[_ngcontent-%COMP%]{transition:transform .3s ease}.badge[_ngcontent-%COMP%]{animation:_ngcontent-%COMP%_fadeIn .3s ease-out}.loading-spinner[_ngcontent-%COMP%]{animation:_ngcontent-%COMP%_spin 1s linear infinite}@keyframes _ngcontent-%COMP%_spin{0%{transform:rotate(0)}to{transform:rotate(360deg)}}@keyframes _ngcontent-%COMP%_fadeIn{0%{opacity:0}to{opacity:1}}@keyframes _ngcontent-%COMP%_fadeInDown{0%{opacity:0;transform:translateY(-20px)}to{opacity:1;transform:translateY(0)}}.line-clamp-2[_ngcontent-%COMP%]{display:-webkit-box;-webkit-line-clamp:2;-webkit-box-orient:vertical;overflow:hidden}@media (max-width: 1024px){.grid[_ngcontent-%COMP%]{grid-template-columns:repeat(auto-fill,minmax(250px,1fr))}}@media (max-width: 768px){.page-header[_ngcontent-%COMP%]   h1[_ngcontent-%COMP%]{font-size:1.5rem}.card-side[_ngcontent-%COMP%]{flex-direction:column}.card-side[_ngcontent-%COMP%]   figure[_ngcontent-%COMP%]{width:100%;aspect-ratio:16/9}}  .highlight{background-color:hsl(var(--primary)/.2);font-weight:600;color:hsl(var(--primary));padding:0 2px;border-radius:2px}*[_ngcontent-%COMP%]{transition-property:color,background-color,border-color,transform,box-shadow;transition-duration:.2s;transition-timing-function:cubic-bezier(.4,0,.2,1)}@media (min-width: 1024px){aside[_ngcontent-%COMP%]   .card[_ngcontent-%COMP%]{position:sticky;top:5rem}}.btn-group[_ngcontent-%COMP%]{display:inline-flex;border-radius:.5rem;overflow:hidden}.btn-group[_ngcontent-%COMP%]   .btn[_ngcontent-%COMP%]{border-radius:0}.btn-group[_ngcontent-%COMP%]   .btn[_ngcontent-%COMP%]:first-child{border-top-right-radius:.5rem;border-bottom-right-radius:.5rem}.btn-group[_ngcontent-%COMP%]   .btn[_ngcontent-%COMP%]:last-child{border-top-left-radius:.5rem;border-bottom-left-radius:.5rem}.material-icons.text-6xl[_ngcontent-%COMP%]{animation:_ngcontent-%COMP%_pulse 2s cubic-bezier(.4,0,.6,1) infinite}@keyframes _ngcontent-%COMP%_pulse{0%,to{opacity:1}50%{opacity:.5}}.btn-sm[_ngcontent-%COMP%]{min-width:2.5rem}.btn-sm[_ngcontent-%COMP%]:disabled{opacity:.5;cursor:not-allowed}"]});let i=n;return i})();var gi=[{path:"",loadComponent:()=>import("./chunk-2TJN5MD3.js").then(i=>i.Home)},{path:"auth",loadChildren:()=>import("./chunk-373VPW4S.js").then(i=>i.AUTH_ROUTES)},{path:"cart",loadComponent:()=>import("./chunk-AJOHRF2Z.js").then(i=>i.CartPage),canActivate:[Ne]},{path:"category",loadChildren:()=>import("./chunk-VRYGFFI3.js").then(i=>i.CATEGORY_ROUTES)},{path:"products",loadChildren:()=>import("./chunk-J44VHVCO.js").then(i=>i.PRODUCTS_ROUTES)},{path:"discounts",loadChildren:()=>import("./chunk-DDKQTWZZ.js").then(i=>i.DISCOUNT_ROUTES)},{path:"checkout",loadChildren:()=>import("./chunk-F4FTO76G.js").then(i=>i.CHECKOUT_ROUTES),canActivate:[Ne]},{path:"payment",loadChildren:()=>import("./chunk-OZS76GYR.js").then(i=>i.PAYMENT_ROUTES)},{path:"dashboard",loadChildren:()=>import("./chunk-RICMJ6ZR.js").then(i=>i.DASHBOARD_ROUTES),canActivate:[Ne]},{path:"admin",loadChildren:()=>import("./chunk-EUB3RSKE.js").then(i=>i.ADMIN_ROUTES),canActivate:[Jt]},{path:"search",component:fi,title:"\u0646\u062A\u0627\u06CC\u062C \u062C\u0633\u062A\u062C\u0648"},{path:"**",redirectTo:"",pathMatch:"full"}];var dn="@",mn=(()=>{class i{doc;delegate;zone;animationType;moduleImpl;_rendererFactoryPromise=null;scheduler=null;injector=C(ht);loadingSchedulerFn=C(pn,{optional:!0});_engine;constructor(r,e,t,o,u){this.doc=r,this.delegate=e,this.zone=t,this.animationType=o,this.moduleImpl=u}ngOnDestroy(){this._engine?.flush()}loadImpl(){let r=()=>this.moduleImpl??import("./chunk-JHT4FKBG.js").then(t=>t),e;return this.loadingSchedulerFn?e=this.loadingSchedulerFn(r):e=r(),e.catch(t=>{throw new lt(5300,!1)}).then(({\u0275createEngine:t,\u0275AnimationRendererFactory:o})=>{this._engine=t(this.animationType,this.doc);let u=new o(this.delegate,this._engine,this.zone);return this.delegate=u,u})}createRenderer(r,e){let t=this.delegate.createRenderer(r,e);if(t.\u0275type===0)return t;typeof t.throwOnSyntheticProps=="boolean"&&(t.throwOnSyntheticProps=!1);let o=new Je(t);return e?.data?.animation&&!this._rendererFactoryPromise&&(this._rendererFactoryPromise=this.loadImpl()),this._rendererFactoryPromise?.then(u=>{let p=u.createRenderer(r,e);o.use(p),this.scheduler??=this.injector.get(vt,null,{optional:!0}),this.scheduler?.notify(10)}).catch(u=>{o.use(t)}),o}begin(){this.delegate.begin?.()}end(){this.delegate.end?.()}whenRenderingDone(){return this.delegate.whenRenderingDone?.()??Promise.resolve()}componentReplaced(r){this._engine?.flush(),this.delegate.componentReplaced?.(r)}static \u0275fac=function(e){It()};static \u0275prov=N({token:i,factory:i.\u0275fac})}return i})(),Je=class{delegate;replay=[];\u0275type=1;constructor(n){this.delegate=n}use(n){if(this.delegate=n,this.replay!==null){for(let r of this.replay)r(n);this.replay=null}}get data(){return this.delegate.data}destroy(){this.replay=null,this.delegate.destroy()}createElement(n,r){return this.delegate.createElement(n,r)}createComment(n){return this.delegate.createComment(n)}createText(n){return this.delegate.createText(n)}get destroyNode(){return this.delegate.destroyNode}appendChild(n,r){this.delegate.appendChild(n,r)}insertBefore(n,r,e,t){this.delegate.insertBefore(n,r,e,t)}removeChild(n,r,e,t){this.delegate.removeChild(n,r,e,t)}selectRootElement(n,r){return this.delegate.selectRootElement(n,r)}parentNode(n){return this.delegate.parentNode(n)}nextSibling(n){return this.delegate.nextSibling(n)}setAttribute(n,r,e,t){this.delegate.setAttribute(n,r,e,t)}removeAttribute(n,r,e){this.delegate.removeAttribute(n,r,e)}addClass(n,r){this.delegate.addClass(n,r)}removeClass(n,r){this.delegate.removeClass(n,r)}setStyle(n,r,e,t){this.delegate.setStyle(n,r,e,t)}removeStyle(n,r,e){this.delegate.removeStyle(n,r,e)}setProperty(n,r,e){this.shouldReplay(r)&&this.replay.push(t=>t.setProperty(n,r,e)),this.delegate.setProperty(n,r,e)}setValue(n,r){this.delegate.setValue(n,r)}listen(n,r,e,t){return this.shouldReplay(r)&&this.replay.push(o=>o.listen(n,r,e,t)),this.delegate.listen(n,r,e,t)}shouldReplay(n){return this.replay!==null&&n.startsWith(dn)}},pn=new ut("");function vi(i="animations"){return yt("NgAsyncAnimations"),dt([{provide:St,useFactory:(n,r,e)=>new mn(n,r,e,i),deps:[ft,Vt,Ct]},{provide:_t,useValue:i==="noop"?"NoopAnimations":"BrowserAnimations"}])}var He=!1,et=new le(null),Be=()=>{if(typeof window>"u")return!1;let i=window.location.pathname.toLowerCase(),n=window.location.search.toLowerCase();return i.includes("/payment")||i.includes("/callback")||n.includes("authority=")||n.includes("status=")},hn=i=>{let n=i.toLowerCase();return n.includes("/verify-payment")||n.includes("/orders/verify-payment")||n.includes("payment")},Ge=(i,n)=>{let r=W.getAuthToken();if(r&&!i.url.includes("/refresh"))return i.clone({setHeaders:{Authorization:`Bearer ${r}`}});if(!n.isAuthenticated()){let e=de.getGuestToken();if(e)return i.clone({setHeaders:{"X-Guest-Token":e}})}return i},fn=(i,n,r,e)=>He?et.pipe(fe(t=>t!=null),st(1),ee(()=>n(Ge(i,r)))):(He=!0,et.next(null),r.refreshToken().pipe(ee(t=>(He=!1,t&&t.token?(et.next(t.token),n(Ge(i,r))):(Be()||(r.logout(),e.clearLocalCart()),I(()=>new Error("Session expired."))))),T(t=>(He=!1,Be()||(r.logout(!1),e.clearLocalCart()),I(()=>t))))),_i=(i,n)=>{let r=C(W),e=C(de),t=i.url.startsWith(Z.API_URL),o=i;return Be()||hn(i.url)?(t&&(o=Ge(i,r)),o=o.clone({withCredentials:!0})):t&&(o=Ge(i,r),o=o.clone({withCredentials:!0})),n(o).pipe(T(u=>{let p=i.url.includes("/login")||i.url.includes("/refresh")||i.url.includes("/verify-otp");return u instanceof Ke&&u.status===401&&p?(Be()||r.logout(!1),I(()=>u)):u instanceof Ke&&u.status===401&&t?fn(i,n,r,e):I(()=>u)}))};var gn=i=>{let n=i.url.toLowerCase(),r=i.headers.has("X-Payment-Verification");return n.includes("/verify-payment")||n.includes("/payment")||n.includes("/checkout")||r},vn=()=>{if(typeof window>"u")return!1;let i=window.location.pathname.toLowerCase(),n=window.location.search.toLowerCase();return i.includes("/payment/callback")||i.includes("/payment/success")||i.includes("/payment/failure")||i.includes("/payment")||n.includes("authority=")||n.includes("status=")},xi=(i,n)=>{let r=C(H),e=C(W);return n(i).pipe(T(t=>{let o=i.url.includes("/login")||i.url.includes("/refresh")||i.url.includes("/verify-otp");if(gn(i)||vn())return I(()=>t);if(t.status===401&&o)return e.logout(!1),I(()=>t);if(t.status===401&&!o)return I(()=>t);let p="\u06CC\u06A9 \u062E\u0637\u0627\u06CC \u067E\u06CC\u0634\u200C\u0628\u06CC\u0646\u06CC \u0646\u0634\u062F\u0647 \u0631\u062E \u062F\u0627\u062F.  \u0644\u0637\u0641\u0627 \u062F\u0648\u0628\u0627\u0631\u0647 \u062A\u0644\u0627\u0634 \u06A9\u0646\u06CC\u062F.";return t.status===429?p="\u062A\u0639\u062F\u0627\u062F \u062F\u0631\u062E\u0648\u0627\u0633\u062A\u200C\u0647\u0627\u06CC \u0634\u0645\u0627 \u0628\u06CC\u0634 \u0627\u0632 \u062D\u062F \u0645\u062C\u0627\u0632 \u0627\u0633\u062A. \u0644\u0637\u0641\u0627\u064B \u0686\u0646\u062F \u0644\u062D\u0638\u0647 \u0628\u0639\u062F \u062F\u0648\u0628\u0627\u0631\u0647 \u062A\u0644\u0627\u0634 \u06A9\u0646\u06CC\u062F.":t.status===409?t.error?.message?.includes("modified by another user")||t.error?.message?.includes("Cart was updated")?p="\u0627\u06CC\u0646 \u0631\u06A9\u0648\u0631\u062F \u062A\u0648\u0633\u0637 \u06A9\u0627\u0631\u0628\u0631 \u062F\u06CC\u06AF\u0631\u06CC \u062A\u063A\u06CC\u06CC\u0631 \u06A9\u0631\u062F\u0647 \u0627\u0633\u062A. \u0644\u0637\u0641\u0627\u064B \u0635\u0641\u062D\u0647 \u0631\u0627 \u0631\u0641\u0631\u0634 \u06A9\u0646\u06CC\u062F.":p=t.error?.message||"\u0627\u0637\u0644\u0627\u0639\u0627\u062A \u062A\u0648\u0633\u0637 \u06A9\u0627\u0631\u0628\u0631 \u062F\u06CC\u06AF\u0631\u06CC \u062A\u063A\u06CC\u06CC\u0631 \u06A9\u0631\u062F\u0647 \u0627\u0633\u062A.  \u0644\u0637\u0641\u0627\u064B \u0635\u0641\u062D\u0647 \u0631\u0627 \u0631\u0641\u0631\u0634 \u06A9\u0631\u062F\u0647 \u0648 \u062F\u0648\u0628\u0627\u0631\u0647 \u062A\u0644\u0627\u0634 \u06A9\u0646\u06CC\u062F.":t.error instanceof ErrorEvent?p=`\u062E\u0637\u0627: ${t.error.message}`:t.error&&typeof t.error.message=="string"?p=t.error.message:typeof t.error=="string"&&t.error.length<200?p=t.error:t.statusText&&(p=`\u062E\u0637\u0627: ${t.statusText}`),r.show(p,"error"),I(()=>t)}))};var yi=(i,n)=>{let r=C(H);return n(i).pipe(T(e=>e.status===429?_n(e,i,n,r):I(()=>e)))};function _n(i,n,r,e){let t=i.headers.get("Retry-After"),o=parseInt(t||"60",10),u=o*1e3,p=t?`\u062F\u0631\u062E\u0648\u0627\u0633\u062A\u200C\u0647\u0627\u06CC \u0634\u0645\u0627 \u0628\u06CC\u0634 \u0627\u0632 \u062D\u062F \u0645\u062C\u0627\u0632 \u0627\u0633\u062A. \u0644\u0637\u0641\u0627 ${o} \u062B\u0627\u0646\u06CC\u0647 \u0635\u0628\u0631 \u06A9\u0646\u06CC\u062F.`:"\u062F\u0631\u062E\u0648\u0627\u0633\u062A\u200C\u0647\u0627\u06CC \u0634\u0645\u0627 \u0628\u06CC\u0634 \u0627\u0632 \u062D\u062F \u0645\u062C\u0627\u0632 \u0627\u0633\u062A. \u0644\u0637\u0641\u0627 \u0686\u0646\u062F \u0644\u062D\u0638\u0647 \u0635\u0628\u0631 \u06A9\u0646\u06CC\u062F.";return e.show(p,"error"),typeof window<"u"&&!window.navigator.onLine&&console.warn("[Rate Limit] Network appears to be offline"),console.warn("[Rate Limit] Too many requests. Retrying after:",o,"seconds"),he(u).pipe(M(()=>{console.info("[Rate Limit] Retrying request..."),e.show("\u062F\u0631 \u062D\u0627\u0644 \u062A\u0644\u0627\u0634 \u0645\u062C\u062F\u062F...","info")}),ee(()=>r(n)),T(b=>b.status===429?(e.show("\u062F\u0631\u062E\u0648\u0627\u0633\u062A \u0634\u0645\u0627 \u0647\u0645\u0686\u0646\u0627\u0646 \u0645\u062D\u062F\u0648\u062F \u0627\u0633\u062A. \u0644\u0637\u0641\u0627 \u0628\u0639\u062F\u0627\u064B \u062A\u0644\u0627\u0634 \u06A9\u0646\u06CC\u062F.","error"),I(()=>b)):I(()=>b)))}function xn(i){let n=i&&(i.hasOwnProperty("items")||i.hasOwnProperty("Items")),r=i&&(i.hasOwnProperty("totalItems")||i.hasOwnProperty("TotalItems")||i.hasOwnProperty("totalCount")||i.hasOwnProperty("TotalCount"));return n&&r}var bi=(i,n)=>n(i).pipe(pe(r=>{if(r instanceof $t&&r.body&&xn(r.body)){let e=r.body,t={items:e.items??e.Items??[],totalItems:e.totalItems??e.TotalItems??e.totalCount??e.TotalCount??0,page:e.page??e.Page??e.pageNumber??e.PageNumber??1,pageSize:e.pageSize??e.PageSize??10,totalPages:e.totalPages??e.TotalPages??1};return r.clone({body:t})}return r}));var Ci=(i,n)=>{let r=C(zt);if(!(yn(i.method)&&bn(i.url)&&!Cn(i.url)))return n(i);let t=r.getToken();if(t){let o=i.clone({headers:i.headers.set("X-XSRF-TOKEN",t)});return n(o)}return n(i)};function yn(i){return["POST","PUT","PATCH","DELETE"].includes(i.toUpperCase())}function bn(i){return i.startsWith(Z.API_URL)||i.startsWith("/api")}function Cn(i){return["/api/Users/login","/api/Users/verify-otp","/api/Users/refresh"].some(r=>i.includes(r))}var Si=(()=>{let n=class n{constructor(e,t){this.http=e,this.platformId=t,this.apiUrl=`${Z.API_URL}Security/csrf-token`,this.tokenFetched=!1}isPaymentPage(){if(!q(this.platformId))return!1;let e=window.location.pathname.toLowerCase(),t=window.location.search.toLowerCase();return e.includes("/payment")||e.includes("/callback")||t.includes("authority=")||t.includes("status=")}initializeCsrfToken(){return q(this.platformId)?this.tokenFetched?E(void 0):this.isPaymentPage()?(console.log("[CSRF] Skipping token fetch on payment page"),E(void 0)):this.http.get(this.apiUrl).pipe(M(e=>{e&&e.token&&(this.tokenFetched=!0,console.log("[CSRF] Token initialized successfully"))}),T(e=>(console.warn("[CSRF] Token fetch failed:",e),E(void 0))),pe(()=>{})):E(void 0)}refreshCsrfToken(){return this.isPaymentPage()?E(void 0):(this.tokenFetched=!1,this.initializeCsrfToken())}};n.\u0275fac=function(t){return new(t||n)(z(ye),z(se))},n.\u0275prov=N({token:n,factory:n.\u0275fac,providedIn:"root"});let i=n;return i})();function wn(i){return()=>{if(typeof window<"u"){let n=window.location.pathname.toLowerCase(),r=window.location.search.toLowerCase();if(n.includes("/payment")||r.includes("authority=")||r.includes("status="))return E(void 0)}return i.initializeCsrfToken()}}var tt=class{constructor(){this.notificationService=C(H)}isPaymentPage(){if(typeof window>"u")return!1;let n=window.location.pathname.toLowerCase(),r=window.location.search.toLowerCase();return n.includes("/payment")||n.includes("/checkout")||r.includes("authority=")||r.includes("status=")}handleError(n){if(n?.message?.includes("Loading chunk")||n?.message?.includes("ChunkLoadError")||n?.message?.includes("Failed to fetch dynamically imported module")){console.warn("Chunk loading error detected:",n.message),typeof window<"u"&&(sessionStorage.getItem("chunk_reload_attempted")?(sessionStorage.removeItem("chunk_reload_attempted"),this.notificationService.show("\u062E\u0637\u0627 \u062F\u0631 \u0628\u0627\u0631\u06AF\u0630\u0627\u0631\u06CC \u0635\u0641\u062D\u0647. \u0644\u0637\u0641\u0627\u064B \u0635\u0641\u062D\u0647 \u0631\u0627 \u0631\u0641\u0631\u0634 \u06A9\u0646\u06CC\u062F.","error")):(sessionStorage.setItem("chunk_reload_attempted","true"),window.location.reload()));return}console.error("Unhandled error:",n),!n.rejection&&n.status!==401&&!this.isPaymentPage()&&this.notificationService.show("\u06CC\u06A9 \u062E\u0637\u0627\u06CC \u063A\u06CC\u0631\u0645\u0646\u062A\u0638\u0631\u0647 \u0631\u062E \u062F\u0627\u062F. \u0644\u0637\u0641\u0627\u064B \u062F\u0648\u0628\u0627\u0631\u0647 \u062A\u0644\u0627\u0634 \u06A9\u0646\u06CC\u062F.","error")}},wi={providers:[Lt({eventCoalescing:!0}),Kt(gi,Zt(),Xt(Qt)),Ut(Gt(),Ht([_i,yi,xi,bi,Ci]),Bt({headerName:"X-XSRF-TOKEN",cookieName:"XSRF-TOKEN"})),vi(),{provide:gt,useClass:tt},{provide:Et,useFactory:wn,deps:[Si],multi:!0},be]};var Ii=(()=>{let n=class n{constructor(e){this.http=e,this.apiUrl=`${Z.API_URL}Notifications`,this.notificationsSubject=new le([]),this.notifications$=this.notificationsSubject.asObservable(),this.unreadCountSubject=new le(0),this.unreadCount$=this.unreadCountSubject.asObservable()}getNotifications(e=!1,t=1,o=20){let u=new Me().set("unreadOnly",e.toString()).set("page",t.toString()).set("pageSize",o.toString());return this.http.get(this.apiUrl,{params:u}).pipe(M(p=>{this.notificationsSubject.next(p)}))}getUnreadCount(){return this.http.get(`${this.apiUrl}/count`).pipe(M(e=>{this.unreadCountSubject.next(e.count)}))}markAsRead(e){return this.http.patch(`${this.apiUrl}/${e}/read`,{}).pipe(M(()=>{this.getUnreadCount().subscribe();let t=this.notificationsSubject.value.map(o=>o.id===e?me(O({},o),{isRead:!0}):o);this.notificationsSubject.next(t)}))}markAllAsRead(){return this.http.patch(`${this.apiUrl}/read-all`,{}).pipe(M(()=>{this.unreadCountSubject.next(0);let e=this.notificationsSubject.value.map(t=>me(O({},t),{isRead:!0}));this.notificationsSubject.next(e)}))}deleteNotification(e){return this.http.delete(`${this.apiUrl}/${e}`).pipe(M(()=>{let t=this.notificationsSubject.value.filter(o=>o.id!==e);this.notificationsSubject.next(t),this.getUnreadCount().subscribe()}))}};n.\u0275fac=function(t){return new(t||n)(z(ye))},n.\u0275prov=N({token:n,factory:n.\u0275fac,providedIn:"root"});let i=n;return i})();var kn=()=>[1,2,3];function En(i,n){if(i&1&&(s(0,"span",5),c(1),a()),i&2){let r=n.ngIf;$("hidden",r===0),l(),y(" ",r>9?"9+":r," ")}}function Mn(i,n){i&1&&(s(0,"div",18),_(1,"div",19),s(2,"div",20),_(3,"div",21)(4,"div",22),a()())}function Tn(i,n){i&1&&(s(0,"div",16),h(1,Mn,5,0,"div",17),a()),i&2&&(l(),d("ngForOf",_e(1,kn)))}function An(i,n){i&1&&(s(0,"div",23)(1,"span",24),c(2,"notifications_off"),a(),s(3,"p",25),c(4,"\u0647\u06CC\u0686 \u0627\u0639\u0644\u0627\u0646 \u062C\u062F\u06CC\u062F\u06CC \u0646\u062F\u0627\u0631\u06CC\u062F."),a()())}function Rn(i,n){i&1&&_(0,"div",34)}function Pn(i,n){if(i&1){let r=x();s(0,"div",26)(1,"a",27),f("click",function(){let t=g(r).$implicit,o=m(2);return v(o.handleNotificationClick(t))}),s(2,"div",28),h(3,Rn,1,0,"div",29),a(),s(4,"div",30)(5,"p",31),c(6),a(),s(7,"p",32),c(8),a(),s(9,"span",33),c(10),D(11,"date"),a()()()()}if(i&2){let r=n.$implicit;l(3),d("ngIf",!r.isRead),l(2),$("text-foreground",!r.isRead)("text-muted-foreground",r.isRead),l(),y(" ",r.title," "),l(2),y(" ",r.message," "),l(2),y(" ",xe(11,8,r.createdAt,"short")," ")}}function Fn(i,n){if(i&1){let r=x();s(0,"div",6)(1,"div",7)(2,"h3",8),c(3,"\u0627\u0639\u0644\u0627\u0646\u200C\u0647\u0627"),a(),s(4,"button",9),D(5,"async"),f("click",function(){g(r);let t=m();return v(t.markAllAsRead())}),c(6," \u062E\u0648\u0627\u0646\u062F\u0645 \u0647\u0645\u0647 "),a()(),s(7,"div",10),h(8,Tn,2,2,"div",11)(9,An,5,0,"div",12),D(10,"async"),h(11,Pn,12,11,"div",13),D(12,"async"),a(),s(13,"div",14)(14,"a",15),c(15," \u0645\u0634\u0627\u0647\u062F\u0647 \u0647\u0645\u0647 \u0627\u0639\u0644\u0627\u0646\u200C\u0647\u0627 "),a()()()}if(i&2){let r,e=m();d("@slideFade",void 0),l(4),d("disabled",Y(5,5,e.unreadCount$)===0),l(4),d("ngIf",e.isLoading),l(),d("ngIf",!e.isLoading&&((r=Y(10,7,e.notifications$))==null?null:r.length)===0),l(2),d("ngForOf",Y(12,9,e.notifications$))}}var ki=(()=>{let n=class n{constructor(e,t,o){this.notificationService=e,this.elementRef=t,this.router=o,this.isMenuOpen=!1,this.isLoading=!1,this.destroy$=new L,this.notifications$=this.notificationService.notifications$,this.unreadCount$=this.notificationService.unreadCount$}ngOnInit(){this.notificationService.getUnreadCount().pipe(w(this.destroy$)).subscribe()}toggleMenu(){this.isMenuOpen=!this.isMenuOpen,this.isMenuOpen&&this.loadNotifications()}loadNotifications(){this.isLoading=!0,this.notificationService.getNotifications().pipe(w(this.destroy$)).subscribe(()=>{this.isLoading=!1})}markAllAsRead(){this.notificationService.markAllAsRead().pipe(w(this.destroy$)).subscribe()}handleNotificationClick(e){e.isRead||this.notificationService.markAsRead(e.id).pipe(w(this.destroy$)).subscribe(),e.actionUrl&&this.router.navigateByUrl(e.actionUrl),this.isMenuOpen=!1}onDocumentClick(e){this.elementRef.nativeElement.contains(e.target)||(this.isMenuOpen=!1)}ngOnDestroy(){this.destroy$.next(),this.destroy$.complete()}};n.\u0275fac=function(t){return new(t||n)(S(Ii),S(ve),S(K))},n.\u0275cmp=k({type:n,selectors:[["app-notification-bell"]],hostBindings:function(t,o){t&1&&f("click",function(p){return o.onDocumentClick(p)},ue)},decls:7,vars:4,consts:[[1,"relative",3,"click"],["aria-label","Notifications",1,"btn","btn-ghost","btn-icon","relative","rounded-full","hover:bg-accent","group",3,"click"],[1,"material-icons-outlined","text-xl","text-foreground/80","group-hover:icon-pulse"],["class","absolute top-1.5 right-1.5 flex h-4 w-4 items-center justify-center rounded-full badge-destructive text-[10px] font-bold text-white ring-2 ring-background animate-in zoom-in",3,"hidden",4,"ngIf"],["class","dropdown-content end-0 sm:end-auto sm:start-1/2 sm:-translate-x-1/2 mt-2 w-80 md:w-96 origin-top-right",4,"ngIf"],[1,"absolute","top-1.5","right-1.5","flex","h-4","w-4","items-center","justify-center","rounded-full","badge-destructive","text-[10px]","font-bold","text-white","ring-2","ring-background","animate-in","zoom-in"],[1,"dropdown-content","end-0","sm:end-auto","sm:start-1/2","sm:-translate-x-1/2","mt-2","w-80","md:w-96","origin-top-right"],[1,"flex","items-center","justify-between","p-4","border-b","border-border","bg-muted/30"],[1,"font-semibold","text-sm"],[1,"btn","btn-link","btn-xs","disabled:opacity-50","disabled:no-underline",3,"click","disabled"],[1,"max-h-[400px]","overflow-y-auto","scrollbar-thin"],["class","p-4 space-y-4",4,"ngIf"],["class","p-8 text-center empty-state",4,"ngIf"],["class","divide-y divide-border",4,"ngFor","ngForOf"],[1,"p-2","bg-muted/30","border-t","border-border","text-center"],["routerLink","/dashboard/notifications",1,"btn","btn-ghost","btn-sm","w-full"],[1,"p-4","space-y-4"],["class","flex gap-3",4,"ngFor","ngForOf"],[1,"flex","gap-3"],[1,"skeleton","skeleton-avatar","w-8","h-8","rounded-full","shrink-0"],[1,"flex-1","space-y-2"],[1,"skeleton","skeleton-text","w-3/4"],[1,"skeleton","skeleton-text","w-1/2"],[1,"p-8","text-center","empty-state"],[1,"material-icons-outlined","icon-4xl","text-muted-foreground/50","mb-2","empty-state-icon"],[1,"text-sm","text-muted-foreground","empty-state-description"],[1,"divide-y","divide-border"],[1,"flex","items-start","gap-3","p-4","hover:bg-accent/50","transition-colors","cursor-pointer","relative","group",3,"click"],[1,"flex-shrink-0","mt-1"],["class","w-2.5 h-2.5 rounded-full bg-primary group-hover:scale-110 transition-transform badge-dot",4,"ngIf"],[1,"flex-1","space-y-1"],[1,"text-sm","font-medium","leading-none"],[1,"text-xs","text-muted-foreground","leading-relaxed","line-clamp-2"],[1,"text-[10px]","text-muted-foreground/70","block","pt-1"],[1,"w-2.5","h-2.5","rounded-full","bg-primary","group-hover:scale-110","transition-transform","badge-dot"]],template:function(t,o){t&1&&(s(0,"div",0),f("click",function(p){return o.onDocumentClick(p)},ue),s(1,"button",1),f("click",function(){return o.toggleMenu()}),s(2,"span",2),c(3,"notifications"),a(),h(4,En,2,3,"span",3),D(5,"async"),a(),h(6,Fn,16,11,"div",4),a()),t&2&&(l(4),d("ngIf",Y(5,2,o.unreadCount$)),l(2),d("ngIf",o.isMenuOpen))},dependencies:[R,Q,j,U,X,Oe,Nt],encapsulation:2,data:{animation:[ce("slideFade",[G(":enter",[P({opacity:0,transform:"translateY(-10px)"}),B("150ms ease-out",P({opacity:1,transform:"translateY(0)"}))]),G(":leave",[B("150ms ease-in",P({opacity:0,transform:"translateY(-10px)"}))])])]}});let i=n;return i})();var On=i=>["/category",i],Ln=i=>["/products/category-group",i];function Dn(i,n){if(i&1){let r=x();s(0,"li")(1,"button",5),f("mouseenter",function(){let t=g(r).$implicit,o=m();return v(o.setActiveCategory(t.id))}),s(2,"span",6),c(3),a(),s(4,"span",7),c(5," chevron_left "),a()()()}if(i&2){let r=n.$implicit,e=m();l(),d("ngClass",e.activeCategoryId===r.id?"bg-background text-primary font-bold shadow-sm":"text-muted-foreground hover:bg-background/50 hover:text-foreground"),l(2),A(r.title),l(),d("ngClass",e.activeCategoryId===r.id?"text-primary":"opacity-0 -translate-x-2 group-hover:opacity-100 group-hover:translate-x-0")}}function Nn(i,n){if(i&1){let r=x();s(0,"a",17),f("click",function(){g(r);let t=m(3);return v(t.onItemClick())}),_(1,"span",18),c(2),a()}if(i&2){let r=n.$implicit;d("routerLink",Ye(2,Ln,r.id)),l(2),y(" ",r.title," ")}}function Vn(i,n){if(i&1){let r=x();s(0,"div",9)(1,"div",10)(2,"h3",11),_(3,"span",12),c(4),a(),s(5,"a",13),f("click",function(){g(r);let t=m(2);return v(t.onItemClick())}),c(6," \u0645\u0634\u0627\u0647\u062F\u0647 \u0647\u0645\u0647 "),s(7,"span",14),c(8,"arrow_back"),a()()(),s(9,"div",15),h(10,Nn,3,4,"a",16),a()()}if(i&2){let r=m().$implicit;l(4),y(" ",r.title," "),l(),d("routerLink",Ye(3,On,r.id)),l(5),d("ngForOf",r.groups)}}function jn(i,n){if(i&1&&(Re(0),h(1,Vn,11,5,"div",8),Pe()),i&2){let r=n.$implicit,e=m();l(),d("ngIf",e.activeCategoryId===r.id)}}var Ei=(()=>{let n=class n{constructor(e){this.categoryService=e,this.categories=[],this.activeCategoryId=null,this.itemClicked=new bt}ngOnInit(){this.categoryService.getCategoryHierarchy().subscribe({next:e=>{this.categories=e,this.categories.length>0&&(this.activeCategoryId=this.categories[0].id)}})}setActiveCategory(e){this.activeCategoryId=e}onItemClick(){this.itemClicked.emit()}};n.\u0275fac=function(t){return new(t||n)(S(pi))},n.\u0275cmp=k({type:n,selectors:[["app-category-group-menu"]],outputs:{itemClicked:"itemClicked"},decls:6,vars:2,consts:[[1,"flex","w-full","min-h-[400px]","bg-popover","text-popover-foreground","rounded-xl","overflow-hidden","shadow-inner","border","border-border",3,"click"],[1,"w-1/4","border-l","border-border","bg-muted/30","py-4","overflow-y-auto"],[1,"space-y-1","px-2"],[4,"ngFor","ngForOf"],[1,"w-3/4","p-8","bg-background","overflow-y-auto"],[1,"w-full","text-right","px-4","py-3","text-sm","rounded-lg","transition-all","duration-200","flex","items-center","justify-between","group",3,"mouseenter","ngClass"],[1,"truncate"],[1,"material-icons","text-base","transition-transform","duration-200",3,"ngClass"],["class","animate-fade-in space-y-6",4,"ngIf"],[1,"animate-fade-in","space-y-6"],[1,"flex","items-center","justify-between","pb-4","border-b","border-border"],[1,"font-bold","text-xl","text-foreground","flex","items-center","gap-2"],[1,"w-1.5","h-6","bg-primary","rounded-full"],[1,"text-xs","font-medium","text-primary","hover:text-primary/80","flex","items-center","gap-1","transition-colors",3,"click","routerLink"],[1,"material-icons","text-sm"],[1,"grid","grid-cols-3","gap-x-6","gap-y-3"],["class","text-sm text-muted-foreground hover:text-primary hover:translate-x-1 transition-all duration-200 flex items-center gap-2 py-1.5",3,"routerLink","click",4,"ngFor","ngForOf"],[1,"text-sm","text-muted-foreground","hover:text-primary","hover:translate-x-1","transition-all","duration-200","flex","items-center","gap-2","py-1.5",3,"click","routerLink"],[1,"w-1","h-1","rounded-full","bg-border","group-hover:bg-primary","transition-colors"]],template:function(t,o){t&1&&(s(0,"div",0),f("click",function(p){return p.stopPropagation()}),s(1,"div",1)(2,"ul",2),h(3,Dn,6,3,"li",3),a()(),s(4,"div",4),h(5,jn,2,1,"ng-container",3),a()()),t&2&&(l(3),d("ngForOf",o.categories),l(2),d("ngForOf",o.categories))},dependencies:[R,Fe,Q,j,U,X],encapsulation:2});let i=n;return i})();var Mi=(()=>{let n=class n{constructor(e){this.sanitizer=e,this.cache=new Map,this.MAX_CACHE_SIZE=100}transform(e,t){if(!e||!t)return e||"";if(t.length>100)return console.warn("Search query too long for highlighting"),e;let o=`${e}_${t}`;if(this.cache.has(o))return this.cache.get(o);try{let u=this.sanitizer.sanitize(ae.HTML,e),p=this.sanitizer.sanitize(ae.HTML,t);if(!u||!p)return u||e||"";let b=this.normalizePersianChars(p),J=this.escapeRegex(b).replace(/ی/g,"[\u06CC\u064A\u0649]").replace(/ک/g,"[\u06A9\u0643]").replace(/۴/g,"[\u06F4\u0664]").replace(/۵/g,"[\u06F5\u0665]").replace(/۶/g,"[\u06F6\u0666]"),we=new RegExp(J,"gi"),Ie=u.replace(we,it=>{let nt=this.sanitizer.sanitize(ae.HTML,it);return nt?`<mark class="search-highlight">${nt}</mark>`:it}),Te=this.sanitizer.bypassSecurityTrustHtml(Ie);return this.addToCache(o,Te),Te}catch(u){return console.error("Highlight pipe error:",u),e}}escapeRegex(e){return e.replace(/[.*+?^${}()|[\]\\]/g,"\\$&")}normalizePersianChars(e){return e?e.replace(/ي/g,"\u06CC").replace(/ك/g,"\u06A9").replace(/ى/g,"\u06CC").replace(/٤/g,"\u06F4").replace(/٥/g,"\u06F5").replace(/٦/g,"\u06F6"):""}addToCache(e,t){if(this.cache.size>=this.MAX_CACHE_SIZE){let o=this.cache.keys().next().value;o!==void 0&&this.cache.delete(o)}this.cache.set(e,t)}clearCache(){this.cache.clear()}};n.\u0275fac=function(t){return new(t||n)(S(Le,16))},n.\u0275pipe=kt({name:"highlight",type:n,pure:!0});let i=n;return i})();var $n=["searchInput"];function zn(i,n){i&1&&(s(0,"div",8),_(1,"span",9),a())}function Un(i,n){if(i&1){let r=x();s(0,"button",10),f("click",function(){g(r);let t=m();return v(t.onClearSearch())}),s(1,"span",11),c(2,"close"),a()()}}function Hn(i,n){i&1&&(s(0,"div",15),_(1,"span",16),s(2,"p",17),c(3,"\u062F\u0631 \u062D\u0627\u0644 \u062C\u0633\u062A\u062C\u0648..."),a()())}function Bn(i,n){if(i&1&&(s(0,"div",15)(1,"span",18),c(2,"error_outline"),a(),s(3,"p",19),c(4),a()()),i&2){let r=m(2);l(4),A(r.error())}}function Gn(i,n){i&1&&(s(0,"div",15)(1,"span",20),c(2,"search_off"),a(),s(3,"p",21),c(4,"\u0646\u062A\u06CC\u062C\u0647\u200C\u0627\u06CC \u06CC\u0627\u0641\u062A \u0646\u0634\u062F"),a(),s(5,"p",22),c(6,"\u0644\u0637\u0641\u0627\u064B \u06A9\u0644\u0645\u0627\u062A \u06A9\u0644\u06CC\u062F\u06CC \u062F\u06CC\u06AF\u0631\u06CC \u0631\u0627 \u0627\u0645\u062A\u062D\u0627\u0646 \u06A9\u0646\u06CC\u062F"),a()())}function qn(i,n){if(i&1){let r=x();s(0,"button",32),f("click",function(){let t=g(r).$implicit,o=m(4);return v(o.onSelectItem({type:"category",data:t}))}),s(1,"span",33),c(2," category "),a(),s(3,"div",34),_(4,"span",35),D(5,"highlight"),s(6,"span",36),c(7),a()()()}if(i&2){let r=n.$implicit,e=n.index,t=m(4);$("active",t.activeIndex()===e),l(4),d("innerHTML",xe(5,4,r.name,t.searchControl.value),Ae),l(3),y("(",r.productCount," \u0645\u062D\u0635\u0648\u0644)")}}function Wn(i,n){if(i&1&&(s(0,"div",27)(1,"div",28)(2,"span",29)(3,"span",26),c(4,"category"),a(),c(5," \u062F\u0633\u062A\u0647\u200C\u0628\u0646\u062F\u06CC\u200C\u0647\u0627 "),a()(),s(6,"div",30),h(7,qn,8,7,"button",31),a()()),i&2){let r=m(3);l(7),d("ngForOf",r.searchResults().categories)}}function Yn(i,n){if(i&1){let r=x();s(0,"button",32),f("click",function(){let t=g(r).$implicit,o=m(4);return v(o.onSelectItem({type:"group",data:t}))}),s(1,"span",33),c(2," label "),a(),s(3,"div",34),_(4,"div",37),D(5,"highlight"),s(6,"div",38),c(7),s(8,"span",39),c(9),a()()()()}if(i&2){let r=n.$implicit,e=n.index,t=m(4);$("active",t.activeIndex()===(t.searchResults().categories.length||0)+e),l(4),d("innerHTML",xe(5,5,r.name,t.searchControl.value),Ae),l(3),y(" ",r.categoryName," "),l(2),y("(",r.productCount," \u0645\u062D\u0635\u0648\u0644)")}}function Qn(i,n){if(i&1&&(s(0,"div",27)(1,"div",28)(2,"span",29)(3,"span",26),c(4,"label"),a(),c(5," \u06AF\u0631\u0648\u0647\u200C\u0647\u0627 "),a()(),s(6,"div",30),h(7,Yn,10,8,"button",31),a()()),i&2){let r=m(3);l(7),d("ngForOf",r.searchResults().categoryGroups)}}function Kn(i,n){if(i&1&&_(0,"img",45),i&2){let r=m().$implicit;d("src",r.imageUrl,Ee)("alt",r.name)}}function Xn(i,n){i&1&&(s(0,"div",46)(1,"span",47),c(2,"image"),a()())}function Zn(i,n){i&1&&(s(0,"div",48)(1,"span",49),c(2,"\u062A\u062E\u0641\u06CC\u0641"),a()())}function Jn(i,n){i&1&&(s(0,"div",48)(1,"span",50),c(2,"\u0646\u0627\u0645\u0648\u062C\u0648\u062F"),a()())}function er(i,n){if(i&1){let r=x();s(0,"button",32),f("click",function(){let t=g(r).$implicit,o=m(4);return v(o.onSelectItem({type:"product",data:t}))}),s(1,"div",40),h(2,Kn,1,2,"img",41)(3,Xn,3,0,"div",42),a(),s(4,"div",34),_(5,"div",37),D(6,"highlight"),s(7,"div",38),c(8),a(),s(9,"div",43),c(10),a()(),h(11,Zn,3,0,"div",44)(12,Jn,3,0,"div",44),a()}if(i&2){let r=n.$implicit,e=n.index,t=m(4);$("active",t.activeIndex()===(t.searchResults().categories.length||0)+(t.searchResults().categoryGroups.length||0)+e),l(2),d("ngIf",r.imageUrl),l(),d("ngIf",!r.imageUrl),l(2),d("innerHTML",xe(6,9,r.name,t.searchControl.value),Ae),l(3),y(" ",r.categoryGroupName," "),l(2),y(" ",t.formatPrice(r.price)," "),l(),d("ngIf",(r.discountPercentage||0)>0),l(),d("ngIf",!r.inStock)}}function tr(i,n){if(i&1&&(s(0,"div")(1,"div",28)(2,"span",29)(3,"span",26),c(4,"inventory_2"),a(),c(5," \u0645\u062D\u0635\u0648\u0644\u0627\u062A "),a()(),s(6,"div",30),h(7,er,13,12,"button",31),a()()),i&2){let r=m(3);l(7),d("ngForOf",r.searchResults().products)}}function ir(i,n){if(i&1){let r=x();s(0,"div"),h(1,Wn,8,1,"div",23)(2,Qn,8,1,"div",23)(3,tr,8,1,"div",14),s(4,"div",24)(5,"button",25),f("click",function(){g(r);let t=m(2);return v(t.onSubmitSearch())}),s(6,"span",26),c(7,"arrow_back"),a(),c(8),a()()()}if(i&2){let r,e,t,o=m(2);l(),d("ngIf",((r=o.searchResults())==null?null:r.categories)&&o.searchResults().categories.length>0),l(),d("ngIf",((e=o.searchResults())==null?null:e.categoryGroups)&&o.searchResults().categoryGroups.length>0),l(),d("ngIf",((t=o.searchResults())==null?null:t.products)&&o.searchResults().products.length>0),l(5),y(" \u0645\u0634\u0627\u0647\u062F\u0647 \u0647\u0645\u0647 \u0646\u062A\u0627\u06CC\u062C (",o.totalResults(),") ")}}function nr(i,n){if(i&1&&(s(0,"div",12),h(1,Hn,4,0,"div",13)(2,Bn,5,1,"div",13)(3,Gn,7,0,"div",13)(4,ir,9,4,"div",14),a()),i&2){let r=m();l(),d("ngIf",r.isSearching()),l(),d("ngIf",r.error()&&!r.isSearching()),l(),d("ngIf",r.isEmpty()),l(),d("ngIf",r.hasResults()&&!r.isSearching())}}var Ti=(()=>{let n=class n{constructor(){this.searchService=C(Ue),this.validationService=C(be),this.router=C(K),this.route=C(De),this.el=C(ve),this.cdr=C(Dt),this.searchControl=new ie("",{nonNullable:!0}),this.searchResults=V(null),this.isSearching=V(!1),this.isOpen=V(!1),this.error=V(null),this.activeIndex=V(-1),this.destroy$=new L,this.flatResults=te(()=>{let e=this.searchResults();return e?[...(e.categories??[]).map(t=>({type:"category",data:t})),...(e.categoryGroups??[]).map(t=>({type:"group",data:t})),...(e.products??[]).map(t=>({type:"product",data:t}))]:[]}),this.totalResults=te(()=>this.flatResults().length),this.hasResults=te(()=>this.totalResults()>0),this.isEmpty=te(()=>!this.isSearching()&&this.searchControl.value.length>=2&&this.totalResults()===0)}ngOnInit(){this.bindAutocomplete(),this.bindSearchState(),this.syncFromUrl()}ngOnDestroy(){this.destroy$.next(),this.destroy$.complete(),this.scrollTimer&&clearTimeout(this.scrollTimer)}bindAutocomplete(){this.searchService.getSearchSuggestions(this.searchControl.valueChanges).pipe(M(()=>{this.error.set(null),this.isOpen.set(!0)}),w(this.destroy$)).subscribe(e=>{this.searchResults.set(e),this.activeIndex.set(-1),this.cdr.markForCheck()})}bindSearchState(){this.searchService.searchState$.pipe(w(this.destroy$)).subscribe(e=>{this.isSearching.set(e.isSearching),e.error&&this.error.set(e.error),this.cdr.markForCheck()})}syncFromUrl(){this.route.queryParams.pipe(w(this.destroy$)).subscribe(e=>{let t=e.q;t&&t!==this.searchControl.value&&this.searchControl.setValue(t,{emitEvent:!1})})}onInputFocus(){this.searchControl.value.length>=2&&this.isOpen.set(!0)}onClearSearch(){this.searchControl.setValue(""),this.searchResults.set(null),this.error.set(null),this.isOpen.set(!1),this.activeIndex.set(-1),this.searchInput.nativeElement.focus()}onSubmitSearch(){let e=this.searchControl.value.trim();if(e.length<2)return;let t=this.validationService.validateSearchQuery(e);if(!t.isValid){this.error.set(t.errors?.[0]??null);return}this.isOpen.set(!1),this.router.navigate(["/search"],{queryParams:{q:t.sanitizedValue}})}onSelectItem(e){this.isOpen.set(!1),e.type==="category"&&this.router.navigate(["/category",e.data.categoryId]),e.type==="group"&&this.router.navigate(["/products/category-group",e.data.categoryGroupId]),e.type==="product"&&this.router.navigate(["/products",e.data.productId])}onOutsideClick(e){this.el.nativeElement.contains(e.target)||(this.isOpen.set(!1),this.activeIndex.set(-1))}onKey(e){let t=this.flatResults();if(!(!this.isOpen()||t.length===0)){if(e.key==="ArrowDown"&&(e.preventDefault(),this.activeIndex.set((this.activeIndex()+1)%t.length),this.scrollToActive()),e.key==="ArrowUp"&&(e.preventDefault(),this.activeIndex.set((this.activeIndex()-1+t.length)%t.length),this.scrollToActive()),e.key==="Enter"){e.preventDefault();let o=this.activeIndex();o>=0?this.onSelectItem(t[o]):this.onSubmitSearch()}e.key==="Escape"&&(this.isOpen.set(!1),this.activeIndex.set(-1))}}scrollToActive(){this.scrollTimer&&clearTimeout(this.scrollTimer),this.scrollTimer=setTimeout(()=>{this.el.nativeElement.querySelector(".search-item.active")?.scrollIntoView({block:"nearest"})})}formatPrice(e){return new Intl.NumberFormat("fa-IR").format(e)+" \u062A\u0648\u0645\u0627\u0646"}};n.\u0275fac=function(t){return new(t||n)},n.\u0275cmp=k({type:n,selectors:[["app-search"]],viewQuery:function(t,o){if(t&1&&Tt($n,5),t&2){let u;At(u=Rt())&&(o.searchInput=u.first)}},hostBindings:function(t,o){t&1&&f("click",function(p){return o.onOutsideClick(p)},ue)("keydown",function(p){return o.onKey(p)})},decls:9,vars:4,consts:[["searchInput",""],[1,"relative","w-full","search-container"],[1,"relative"],["type","text","placeholder","\u062C\u0633\u062A\u062C\u0648 \u062F\u0631 \u0645\u062D\u0635\u0648\u0644\u0627\u062A...","aria-label","\u062C\u0633\u062A\u062C\u0648","autocomplete","off",1,"input","input-md","w-full","pr-10","pl-10","bg-muted/50","border-border","focus:bg-background","focus:border-primary","transition-all",3,"focus","keydown.enter","formControl"],[1,"material-icons","absolute","right-3","top-1/2","-translate-y-1/2","text-muted-foreground","pointer-events-none"],["class","absolute left-3 top-1/2 -translate-y-1/2",4,"ngIf"],["type","button","class","absolute left-3 top-1/2 -translate-y-1/2 btn btn-ghost btn-icon btn-sm hover:bg-accent","aria-label","\u067E\u0627\u06A9 \u06A9\u0631\u062F\u0646 \u062C\u0633\u062A\u062C\u0648",3,"click",4,"ngIf"],["class","search-dropdown absolute top-full left-0 right-0 mt-2 bg-popover border border-border rounded-xl shadow-dropdown overflow-hidden z-50 animate-fade-in-down max-h-[500px] overflow-y-auto",4,"ngIf"],[1,"absolute","left-3","top-1/2","-translate-y-1/2"],[1,"loading","loading-spinner","loading-sm","text-primary"],["type","button","aria-label","\u067E\u0627\u06A9 \u06A9\u0631\u062F\u0646 \u062C\u0633\u062A\u062C\u0648",1,"absolute","left-3","top-1/2","-translate-y-1/2","btn","btn-ghost","btn-icon","btn-sm","hover:bg-accent",3,"click"],[1,"material-icons","text-lg"],[1,"search-dropdown","absolute","top-full","left-0","right-0","mt-2","bg-popover","border","border-border","rounded-xl","shadow-dropdown","overflow-hidden","z-50","animate-fade-in-down","max-h-[500px]","overflow-y-auto"],["class","p-8 text-center",4,"ngIf"],[4,"ngIf"],[1,"p-8","text-center"],[1,"loading","loading-spinner","loading-lg","text-primary"],[1,"text-sm","text-muted-foreground","mt-3"],[1,"material-icons","text-4xl","text-destructive","mb-2"],[1,"text-sm","text-destructive"],[1,"material-icons","text-4xl","text-muted-foreground","mb-2"],[1,"text-sm","text-muted-foreground"],[1,"text-xs","text-muted-foreground","mt-2"],["class","border-b border-border",4,"ngIf"],[1,"p-3","border-t","border-border","bg-muted/20"],["type","button",1,"w-full","btn","btn-outline","btn-sm","hover:bg-primary","hover:text-primary-foreground","hover:border-primary","transition-colors",3,"click"],[1,"material-icons","text-base"],[1,"border-b","border-border"],[1,"px-4","py-2","bg-muted/30","sticky","top-0","backdrop-blur-sm","z-10"],[1,"text-xs","font-semibold","text-muted-foreground","flex","items-center","gap-2"],[1,"p-2"],["type","button","class","search-item w-full text-right px-3 py-2.5 hover:bg-accent rounded-lg transition-colors flex items-center gap-3 group",3,"active","click",4,"ngFor","ngForOf"],["type","button",1,"search-item","w-full","text-right","px-3","py-2.5","hover:bg-accent","rounded-lg","transition-colors","flex","items-center","gap-3","group",3,"click"],[1,"material-icons-outlined","text-muted-foreground","group-hover:text-accent-foreground"],[1,"flex-1","min-w-0"],[1,"text-sm","font-medium","text-foreground","group-hover:text-accent-foreground",3,"innerHTML"],[1,"text-xs","text-muted-foreground","mr-2"],[1,"text-sm","font-medium","text-foreground","group-hover:text-accent-foreground","truncate",3,"innerHTML"],[1,"text-xs","text-muted-foreground","truncate"],[1,"mr-1"],[1,"w-12","h-12","rounded-lg","overflow-hidden","flex-shrink-0","bg-muted","border","border-border"],["class","w-full h-full object-cover",3,"src","alt",4,"ngIf"],["class","w-full h-full flex items-center justify-center",4,"ngIf"],[1,"text-xs","font-semibold","text-primary","mt-1"],["class","flex-shrink-0",4,"ngIf"],[1,"w-full","h-full","object-cover",3,"src","alt"],[1,"w-full","h-full","flex","items-center","justify-center"],[1,"material-icons","text-muted-foreground"],[1,"flex-shrink-0"],[1,"badge","badge-sm","badge-destructive"],[1,"badge","badge-sm","badge-outline"]],template:function(t,o){if(t&1){let u=x();s(0,"div",1)(1,"div",2)(2,"input",3,0),f("focus",function(){return g(u),v(o.onInputFocus())})("keydown.enter",function(){return g(u),v(o.onSubmitSearch())}),a(),s(4,"span",4),c(5," search "),a(),h(6,zn,2,0,"div",5)(7,Un,3,0,"button",6),a(),h(8,nr,5,4,"div",7),a()}t&2&&(l(2),d("formControl",o.searchControl),l(4),d("ngIf",o.isSearching()),l(),d("ngIf",o.searchControl.value&&!o.isSearching()),l(),d("ngIf",o.isOpen()&&o.searchControl.value&&o.searchControl.value.length>=2))},dependencies:[R,Q,j,$e,Ve,je,oi,U,Mi],styles:['.search-container[_ngcontent-%COMP%]{position:relative;z-index:100}.search-dropdown[_ngcontent-%COMP%]{animation:_ngcontent-%COMP%_fadeInDown .2s ease-out;box-shadow:0 10px 25px -5px #0000001a,0 10px 10px -5px #0000000a}.search-dropdown[_ngcontent-%COMP%]::-webkit-scrollbar{width:8px}.search-dropdown[_ngcontent-%COMP%]::-webkit-scrollbar-track{background:transparent}.search-dropdown[_ngcontent-%COMP%]::-webkit-scrollbar-thumb{background:hsl(var(--border));border-radius:4px}.search-dropdown[_ngcontent-%COMP%]::-webkit-scrollbar-thumb:hover{background:hsl(var(--muted-foreground)/.3)}.search-item.active[_ngcontent-%COMP%]{background-color:hsl(var(--accent));color:hsl(var(--accent-foreground))}.search-item.active[_ngcontent-%COMP%]   .material-icons[_ngcontent-%COMP%], .search-item.active[_ngcontent-%COMP%]   .material-icons-outlined[_ngcontent-%COMP%]{color:hsl(var(--accent-foreground))}.search-item[_ngcontent-%COMP%]:focus-visible{outline:2px solid hsl(var(--primary));outline-offset:-2px}@keyframes _ngcontent-%COMP%_fadeInDown{0%{opacity:0;transform:translateY(-10px)}to{opacity:1;transform:translateY(0)}}@keyframes _ngcontent-%COMP%_spin-slow{0%{transform:rotate(0)}to{transform:rotate(360deg)}}.animate-fade-in-down[_ngcontent-%COMP%]{animation:_ngcontent-%COMP%_fadeInDown .2s ease-out}.loading-spinner[_ngcontent-%COMP%]{animation:_ngcontent-%COMP%_spin-slow 1s linear infinite}@media (max-width: 768px){.search-dropdown[_ngcontent-%COMP%]{max-height:400px}}  .highlight{background-color:hsl(var(--primary)/.2);font-weight:600;color:hsl(var(--primary));padding:0 2px;border-radius:2px}.search-container[_ngcontent-%COMP%]   *[_ngcontent-%COMP%]{transition-property:color,background-color,border-color;transition-duration:.15s;transition-timing-function:cubic-bezier(.4,0,.2,1)}img[src=""][_ngcontent-%COMP%], img[_ngcontent-%COMP%]:not([src]){background:hsl(var(--muted))}'],changeDetection:0});let i=n;return i})();var or=()=>({exact:!0});function sr(i,n){if(i&1){let r=x();s(0,"div",34)(1,"div",35)(2,"app-category-group-menu",36),f("itemClicked",function(){g(r);let t=m();return v(t.closeCategoryMenu())}),a()()()}i&2&&d("@dropdownAnimation",void 0)}function ar(i,n){if(i&1){let r=x();s(0,"a",48),f("click",function(){g(r);let t=m(3);return v(t.closeMenu())}),s(1,"span",45),c(2,"admin_panel_settings"),a(),c(3," \u067E\u0646\u0644 \u0627\u062F\u0645\u06CC\u0646 "),a()}}function cr(i,n){if(i&1){let r=x();s(0,"div",41)(1,"div",42),c(2),D(3,"async"),a(),s(4,"div",43)(5,"a",44),f("click",function(){g(r);let t=m(2);return v(t.closeMenu())}),s(6,"span",45),c(7,"dashboard"),a(),c(8," \u062F\u0627\u0634\u0628\u0648\u0631\u062F "),a(),h(9,ar,4,0,"a",46),D(10,"async"),s(11,"button",47),f("click",function(){g(r);let t=m(2);return v(t.logout())}),s(12,"span",45),c(13,"logout"),a(),c(14," \u062E\u0631\u0648\u062C "),a()()()}if(i&2){let r,e=m(2);d("@slideFade",void 0),l(2),y(" ",((r=Y(3,3,e.userProfile$))==null?null:r.firstName)||"\u06A9\u0627\u0631\u0628\u0631"," \u0639\u0632\u06CC\u0632\u060C \u062E\u0648\u0634 \u0622\u0645\u062F\u06CC\u062F "),l(7),d("ngIf",Y(10,5,e.isAdmin$))}}function lr(i,n){if(i&1){let r=x();Re(0),_(1,"app-notification-bell"),s(2,"div",37)(3,"button",38),f("click",function(t){g(r);let o=m();return v(o.toggleMenu(t))}),s(4,"span",39),c(5,"person"),a()(),h(6,cr,15,7,"div",40),a(),Pe()}if(i&2){let r=m();l(6),d("ngIf",r.isMenuOpen)}}function ur(i,n){i&1&&(s(0,"a",49),c(1," \u0648\u0631\u0648\u062F | \u062B\u0628\u062A\u200C\u0646\u0627\u0645 "),a(),s(2,"a",50)(3,"span",51),c(4,"login"),a()())}function dr(i,n){if(i&1&&(s(0,"span",52),c(1),a()),i&2){let r=n.ngIf;l(),y(" ",r>9?"9+":r," ")}}function mr(i,n){if(i&1){let r=x();s(0,"div",53),f("click",function(){g(r);let t=m();return v(t.toggleSearchMobile())}),a()}}function pr(i,n){i&1&&(s(0,"div",54),_(1,"app-search"),a())}function hr(i,n){if(i&1){let r=x();s(0,"div",55),f("click",function(){g(r);let t=m();return v(t.isMobileMenuOpen=!1)}),a()}}function fr(i,n){if(i&1){let r=x();s(0,"a",62),f("click",function(){g(r);let t=m(2);return v(t.isMobileMenuOpen=!1)}),s(1,"span",63),c(2),a(),c(3),a()}if(i&2){let r=n.$implicit;d("routerLink",r.link),l(2),A(r.icon),l(),y(" ",r.title," ")}}function gr(i,n){if(i&1){let r=x();s(0,"div",56)(1,"div",57)(2,"span",58),c(3,"\u0641\u0647\u0631\u0633\u062A"),a(),s(4,"button",59),f("click",function(){g(r);let t=m();return v(t.isMobileMenuOpen=!1)}),s(5,"span",51),c(6,"close"),a()()(),s(7,"nav",60),h(8,fr,4,3,"a",61),a()()}if(i&2){let r=m();l(8),d("ngForOf",r.mobileMenuItems)}}var Ri=(()=>{let n=class n{constructor(e,t,o,u,p){this.authService=e,this.cartService=t,this.elementRef=o,this.renderer=u,this.platformId=p,this.isMenuOpen=!1,this.isMobileMenuOpen=!1,this.isMobileSearchOpen=!1,this.isCategoryMenuOpen=!1,this.isScrolled=!1,this.isDarkMode=!1,this.destroy$=new L,this.mobileMenuItems=[{title:"\u062E\u0627\u0646\u0647",link:"/",icon:"home"},{title:"\u0645\u062D\u0635\u0648\u0644\u0627\u062A",link:"/products",icon:"storefront"},{title:"\u062A\u062E\u0641\u06CC\u0641\u200C\u0647\u0627",link:"/discounts",icon:"local_offer"}]}onWindowScroll(){this.isScrolled=window.scrollY>20}onDocumentClick(e){let t=this.elementRef.nativeElement.querySelector(".user-menu-container");t&&!t.contains(e.target)&&(this.isMenuOpen=!1)}ngOnInit(){this.isLoggedIn$=this.authService.isLoggedIn$,this.userProfile$=this.authService.userProfile$,this.cartItemCount$=this.cartService.cartItemCount$,this.isAdmin$=this.userProfile$.pipe(pe(e=>e?.isAdmin??!1)),this.isLoggedIn$.pipe(oe(),w(this.destroy$)).subscribe(e=>{e?this.cartService.getCartItemsCount().subscribe():this.cartService.clearLocalCart()}),this.authService.isAuthenticated()&&this.cartService.getMyCart().subscribe(),this.initTheme()}ngOnDestroy(){this.destroy$.next(),this.destroy$.complete()}toggleMenu(e){e.stopPropagation(),this.isMenuOpen=!this.isMenuOpen}closeMenu(){this.isMenuOpen=!1}toggleSearchMobile(){this.isMobileSearchOpen=!this.isMobileSearchOpen}showCategoryMenu(){clearTimeout(this.hoverTimeout),this.isCategoryMenuOpen=!0}hideCategoryMenu(){this.hoverTimeout=setTimeout(()=>{this.isCategoryMenuOpen=!1},150)}closeCategoryMenu(){this.isCategoryMenuOpen=!1}logout(){this.closeMenu(),this.authService.logout()}initTheme(){if(q(this.platformId)){let e=localStorage.getItem("theme"),t=window.matchMedia("(prefers-color-scheme: dark)").matches;e==="dark"||!e&&t?(this.isDarkMode=!0,this.renderer.addClass(document.documentElement,"dark")):(this.isDarkMode=!1,this.renderer.removeClass(document.documentElement,"dark"))}}toggleTheme(){document.documentElement.classList.add("theme-transitioning"),this.isDarkMode=!this.isDarkMode,this.isDarkMode?(this.renderer.addClass(document.documentElement,"dark"),localStorage.setItem("theme","dark")):(this.renderer.removeClass(document.documentElement,"dark"),localStorage.setItem("theme","light")),setTimeout(()=>{document.documentElement.classList.remove("theme-transitioning")},300)}};n.\u0275fac=function(t){return new(t||n)(S(W),S(de),S(ve),S(wt),S(se))},n.\u0275cmp=k({type:n,selectors:[["app-header"]],hostBindings:function(t,o){t&1&&f("scroll",function(){return o.onWindowScroll()},xt)("click",function(p){return o.onDocumentClick(p)},ue)},decls:49,vars:20,consts:[["loggedOut",""],[1,"sticky","top-0","z-50","w-full","border-b","border-border","bg-background/95","backdrop-blur","supports-[backdrop-filter]:bg-background/60","transition-all","duration-300","ease-in-out","h-16","flex","items-center"],[1,"container","flex","items-center","h-full","gap-4"],[1,"flex","items-center","lg:hidden"],["aria-label","\u0645\u0646\u0648",1,"btn","btn-ghost","btn-icon","active:scale-95","transition-transform",3,"click"],[1,"material-icons","text-2xl"],[1,"flex","items-center","gap-2","mr-auto","lg:mr-0"],["routerLink","/","aria-label","\u0628\u0627\u0632\u06AF\u0634\u062A \u0628\u0647 \u0635\u0641\u062D\u0647 \u0627\u0635\u0644\u06CC",1,"flex","items-center","gap-2","transition-transform","hover:scale-105","active:scale-95"],["src","/assets/icons/ledka-icon.jpg","alt","\u0644\u0648\u06AF\u0648 \u0641\u0631\u0648\u0634\u06AF\u0627\u0647","width","36","height","36",1,"h-9","w-auto","rounded-md","shadow-sm"],[1,"hidden","sm:inline-block","text-xl","font-bold","bg-gradient-to-r","from-primary","to-primary-600","bg-clip-text","text-transparent"],[1,"hidden","lg:flex","items-center","gap-1","text-sm","font-medium","mx-4"],["routerLink","/","routerLinkActive","bg-primary/10 text-primary",1,"nav-item",3,"routerLinkActiveOptions"],[1,"relative","h-full","flex","items-center","group",3,"mouseenter","mouseleave"],[1,"nav-item","group-hover:bg-accent","group-hover:text-accent-foreground"],[1,"material-icons","text-lg","group-hover:icon-bounce"],["class","absolute top-full right-0 w-[800px] pt-4",4,"ngIf"],["routerLink","/products","routerLinkActive","bg-primary/10 text-primary",1,"nav-item","group"],["routerLink","/discounts","routerLinkActive","bg-primary/10 text-primary",1,"nav-item","text-destructive","group"],[1,"material-icons","text-lg","group-hover:icon-shake"],[1,"hidden","lg:flex","flex-1","max-w-md","mx-4"],[1,"flex","items-center","justify-end","gap-1","sm:gap-2"],["aria-label","\u062C\u0633\u062A\u062C\u0648",1,"btn","btn-ghost","btn-icon","lg:hidden","hover:bg-accent","hover:text-accent-foreground","group",3,"click"],[1,"material-icons","group-hover:icon-spin-slow"],[1,"btn","btn-ghost","btn-icon","hover:bg-accent","hover:text-accent-foreground","group",3,"click"],[1,"material-icons","group-hover:icon-spin-fast"],[1,"h-6","w-px","bg-border","mx-2","hidden","sm:block"],[4,"ngIf","ngIfElse"],["routerLink","/cart","aria-label","\u0633\u0628\u062F \u062E\u0631\u06CC\u062F",1,"relative","icon-wrapper","icon-wrapper-md","hover:bg-accent","rounded-full","border","border-transparent","hover:border-border","transition-all","group","ml-1","cursor-pointer"],[1,"material-icons-outlined","group-hover:icon-bounce","text-foreground"],["class","absolute -top-1 -right-1 flex h-4 w-4 items-center justify-center rounded-full badge-destructive text-[10px] font-bold text-white ring-2 ring-background animate-in zoom-in",4,"ngIf"],["class","mobile-search-overlay",3,"click",4,"ngIf"],["class","absolute top-full left-0 right-0 bg-background border-b border-border p-4 shadow-lg z-50 animate-fade-in-down lg:hidden",4,"ngIf"],["class","mobile-menu-overlay",3,"click",4,"ngIf"],["class","drawer drawer-left w-3/4 max-w-sm p-6 mobile-menu-sidebar",4,"ngIf"],[1,"absolute","top-full","right-0","w-[800px]","pt-4"],[1,"bg-popover","rounded-xl","overflow-hidden","shadow-dropdown","border","border-border"],[3,"itemClicked"],[1,"relative","user-menu-container","ml-1"],["aria-label","\u0645\u0646\u0648\u06CC \u06A9\u0627\u0631\u0628\u0631",1,"icon-wrapper","icon-wrapper-md","hover:bg-accent","rounded-full","border","border-transparent","hover:border-border","transition-all","cursor-pointer",3,"click"],[1,"material-icons","text-foreground"],["class","dropdown-content left-0 mt-2 w-56 origin-top-left",4,"ngIf"],[1,"dropdown-content","left-0","mt-2","w-56","origin-top-left"],[1,"dropdown-header","border-b","border-border"],[1,"p-1"],["routerLink","/dashboard",1,"dropdown-item","rounded-md",3,"click"],[1,"material-icons-outlined","text-lg"],["routerLink","/admin","class","dropdown-item rounded-md text-secondary hover:bg-secondary/10 hover:text-secondary",3,"click",4,"ngIf"],[1,"dropdown-item","rounded-md","text-destructive","hover:bg-destructive/10","hover:text-destructive",3,"click"],["routerLink","/admin",1,"dropdown-item","rounded-md","text-secondary","hover:bg-secondary/10","hover:text-secondary",3,"click"],["routerLink","/auth",1,"btn","btn-primary","btn-sm","rounded-full","px-6","shadow-sm","hidden","md:inline-flex"],["routerLink","/auth","aria-label","\u0648\u0631\u0648\u062F",1,"btn","btn-ghost","btn-icon","md:hidden","text-primary"],[1,"material-icons"],[1,"absolute","-top-1","-right-1","flex","h-4","w-4","items-center","justify-center","rounded-full","badge-destructive","text-[10px]","font-bold","text-white","ring-2","ring-background","animate-in","zoom-in"],[1,"mobile-search-overlay",3,"click"],[1,"absolute","top-full","left-0","right-0","bg-background","border-b","border-border","p-4","shadow-lg","z-50","animate-fade-in-down","lg:hidden"],[1,"mobile-menu-overlay",3,"click"],[1,"drawer","drawer-left","w-3/4","max-w-sm","p-6","mobile-menu-sidebar"],[1,"flex","items-center","justify-between","mb-8"],[1,"text-lg","font-bold","text-foreground"],[1,"btn","btn-ghost","btn-icon","-mr-2",3,"click"],[1,"flex","flex-col","gap-2"],["class","flex items-center gap-4 rounded-lg px-4 py-3 text-sm font-medium hover:bg-accent hover:text-accent-foreground transition-colors","routerLinkActive","bg-primary/10 text-primary",3,"routerLink","click",4,"ngFor","ngForOf"],["routerLinkActive","bg-primary/10 text-primary",1,"flex","items-center","gap-4","rounded-lg","px-4","py-3","text-sm","font-medium","hover:bg-accent","hover:text-accent-foreground","transition-colors",3,"click","routerLink"],[1,"material-icons-outlined","text-xl"]],template:function(t,o){if(t&1){let u=x();s(0,"header",1)(1,"div",2)(2,"div",3)(3,"button",4),f("click",function(){return g(u),v(o.isMobileMenuOpen=!o.isMobileMenuOpen)}),s(4,"span",5),c(5,"menu"),a()()(),s(6,"div",6)(7,"a",7),_(8,"img",8),s(9,"span",9),c(10,"\u0641\u0631\u0648\u0634\u06AF\u0627\u0647 \u0644\u0650\u062F\u06A9\u0627"),a()()(),s(11,"nav",10)(12,"a",11),c(13,"\u062E\u0627\u0646\u0647"),a(),s(14,"div",12),f("mouseenter",function(){return g(u),v(o.showCategoryMenu())})("mouseleave",function(){return g(u),v(o.hideCategoryMenu())}),s(15,"button",13)(16,"span",14),c(17,"category"),a(),c(18," \u062F\u0633\u062A\u0647 \u0628\u0646\u062F\u06CC \u0645\u062D\u0635\u0648\u0644\u0627\u062A "),a(),h(19,sr,3,1,"div",15),a(),s(20,"a",16),c(21," \u0645\u062D\u0635\u0648\u0644\u0627\u062A "),a(),s(22,"a",17)(23,"span",18),c(24,"local_offer"),a(),c(25," \u062A\u062E\u0641\u06CC\u0641\u200C\u0647\u0627 "),a()(),s(26,"div",19),_(27,"app-search"),a(),s(28,"div",20)(29,"button",21),f("click",function(){return g(u),v(o.toggleSearchMobile())}),s(30,"span",22),c(31,"search"),a()(),s(32,"button",23),f("click",function(){return g(u),v(o.toggleTheme())}),s(33,"span",24),c(34),a()(),_(35,"div",25),h(36,lr,7,1,"ng-container",26),D(37,"async"),h(38,ur,5,0,"ng-template",null,0,Ot),s(40,"a",27)(41,"span",28),c(42,"shopping_cart"),a(),h(43,dr,2,1,"span",29),D(44,"async"),a()()(),h(45,mr,1,0,"div",30)(46,pr,2,0,"div",31)(47,hr,1,0,"div",32)(48,gr,9,1,"div",33),a()}if(t&2){let u=Pt(39);$("shadow-md",o.isScrolled)("bg-background/80",o.isScrolled),l(12),d("routerLinkActiveOptions",_e(19,or)),l(7),d("ngIf",o.isCategoryMenuOpen),l(13),Mt("aria-label",o.isDarkMode?"\u062A\u063A\u06CC\u06CC\u0631 \u0628\u0647 \u062D\u0627\u0644\u062A \u0631\u0648\u0634\u0646":"\u062A\u063A\u06CC\u06CC\u0631 \u0628\u0647 \u062D\u0627\u0644\u062A \u062A\u0627\u0631\u06CC\u06A9"),l(2),y(" ",o.isDarkMode?"light_mode":"dark_mode"," "),l(2),d("ngIf",Y(37,15,o.isLoggedIn$))("ngIfElse",u),l(7),d("ngIf",Y(44,17,o.cartItemCount$)),l(2),d("ngIf",o.isMobileSearchOpen),l(),d("ngIf",o.isMobileSearchOpen),l(),d("ngIf",o.isMobileMenuOpen),l(),d("ngIf",o.isMobileMenuOpen)}},dependencies:[R,Q,j,U,X,Yt,ki,Ei,Ti,Oe],encapsulation:2,data:{animation:[ce("slideFade",[G(":enter",[P({opacity:0,transform:"translateY(-10px)"}),B("150ms ease-out",P({opacity:1,transform:"translateY(0)"}))]),G(":leave",[B("150ms ease-in",P({opacity:0,transform:"translateY(-10px)"}))])]),ce("dropdownAnimation",[G(":enter",[P({opacity:0,transform:"translateY(10px)"}),B("200ms ease-out",P({opacity:1,transform:"translateY(0)"}))]),G(":leave",[B("150ms ease-in",P({opacity:0,transform:"translateY(10px)"}))])])]}});let i=n;return i})();var Fi=(()=>{let n=class n{constructor(e){this.notificationService=e,this.newsletterEmail="",this.currentYear=new Date().getFullYear()}subscribeNewsletter(){if(this.newsletterEmail){if(!/^[a-zA-Z0-9._-]+@[a-zA-Z0-9.-]+\.[a-zA-Z]{2,6}$/.test(this.newsletterEmail)){this.notificationService.show("\u0644\u0637\u0641\u0627 \u06CC\u06A9 \u0627\u06CC\u0645\u06CC\u0644 \u0645\u0639\u062A\u0628\u0631 \u0648\u0627\u0631\u062F \u06A9\u0646\u06CC\u062F","error");return}this.notificationService.show("\u0628\u0627 \u0645\u0648\u0641\u0642\u06CC\u062A \u062F\u0631 \u062E\u0628\u0631\u0646\u0627\u0645\u0647 \u0639\u0636\u0648 \u0634\u062F\u06CC\u062F","success"),this.newsletterEmail=""}else this.notificationService.show("\u0644\u0637\u0641\u0627 \u0627\u06CC\u0645\u06CC\u0644 \u062E\u0648\u062F \u0631\u0627 \u0648\u0627\u0631\u062F \u06A9\u0646\u06CC\u062F","error")}scrollToTop(){window.scrollTo({top:0,behavior:"smooth"})}};n.\u0275fac=function(t){return new(t||n)(S(H))},n.\u0275cmp=k({type:n,selectors:[["app-footer"]],decls:71,vars:1,consts:[[1,"relative","mt-24"],[1,"wave-divider","text-muted/30","dark:text-muted/10","absolute","top-0","left-0","right-0","-translate-y-[99%]","z-10","w-full"],["viewBox","0 0 1200 120","preserveAspectRatio","none"],["d","M321.39,56.44c58-10.79,114.16-30.13,172-41.86,82.39-16.72,168.19-17.73,250.45-.39C823.78,31,906.67,72,985.66,92.83c70.05,18.48,146.53,26.09,214.34,3V0H0V27.35A600.21,600.21,0,0,0,321.39,56.44Z"],[1,"bg-muted/30","dark:bg-muted/10","pt-16","pb-8","border-t","border-border"],[1,"container"],[1,"grid","grid-cols-1","md:grid-cols-2","lg:grid-cols-4","gap-12","mb-12"],[1,"space-y-6"],["routerLink","/",1,"flex","items-center","gap-3","group"],["src","/assets/icons/ledka-icon.jpg","alt","Ledka Logo",1,"w-12","h-12","rounded-xl","shadow-sm","transition-transform","group-hover:scale-105"],[1,"text-2xl","font-black","text-foreground","tracking-tight"],[1,"text-sm","text-muted-foreground","leading-7","text-justify"],[1,"flex","gap-3"],["href","#","aria-label","Instagram",1,"icon-wrapper","icon-wrapper-md","icon-wrapper-circle","icon-wrapper-primary","bg-background","shadow-sm","hover-lift","group"],[1,"material-icons","group-hover:icon-pulse"],["href","#","aria-label","Twitter",1,"icon-wrapper","icon-wrapper-md","icon-wrapper-circle","icon-wrapper-info","bg-background","shadow-sm","hover-lift","group"],[1,"material-icons","group-hover:icon-shake"],["href","#","aria-label","Whatsapp",1,"icon-wrapper","icon-wrapper-md","icon-wrapper-circle","icon-wrapper-success","bg-background","shadow-sm","hover-lift","group"],[1,"material-icons","group-hover:icon-beat"],[1,"space-y-4"],[1,"font-bold","text-foreground"],[1,"space-y-2","text-sm","text-muted-foreground"],["routerLink","/products",1,"hover:text-primary","transition-colors","block","py-1"],["routerLink","/discounts",1,"hover:text-primary","transition-colors","block","py-1"],["routerLink","/blog",1,"hover:text-primary","transition-colors","block","py-1"],["routerLink","/about",1,"hover:text-primary","transition-colors","block","py-1"],["href","#",1,"hover:text-primary","transition-colors","block","py-1"],[1,"grid","grid-cols-2","gap-4"],[1,"card","bg-background","p-2","flex","items-center","justify-center","aspect-square","hover:shadow-md","transition-shadow"],[1,"text-xs","text-muted-foreground/50"],[1,"border-t","border-border/50","pt-8","flex","flex-col","md:flex-row","justify-between","items-center","gap-4","text-xs","text-muted-foreground"],[1,"font-mono","dir-ltr","opacity-50","hover:opacity-100","transition-opacity"]],template:function(t,o){t&1&&(s(0,"div",0)(1,"div",1),mt(),s(2,"svg",2),_(3,"path",3),a()(),pt(),s(4,"footer",4)(5,"div",5)(6,"div",6)(7,"div",7)(8,"a",8),_(9,"img",9),s(10,"span",10),c(11,"\u0644\u0650\u062F\u06A9\u0627"),a()(),s(12,"p",11),c(13," \u062A\u062C\u0631\u0628\u0647 \u062E\u0631\u06CC\u062F \u0622\u0646\u0644\u0627\u06CC\u0646 \u0645\u0637\u0645\u0626\u0646 \u0628\u0627 \u06AF\u0627\u0631\u0627\u0646\u062A\u06CC \u0627\u0635\u0627\u0644\u062A \u06A9\u0627\u0644\u0627. \u0645\u0627 \u062F\u0631 \u0644\u0650\u062F\u06A9\u0627 \u0645\u062A\u0639\u0647\u062F \u0628\u0647 \u0627\u0631\u0627\u0626\u0647 \u0628\u0647\u062A\u0631\u06CC\u0646 \u062E\u062F\u0645\u0627\u062A \u0648 \u0645\u062D\u0635\u0648\u0644\u0627\u062A \u0628\u0647 \u0634\u0645\u0627 \u0647\u0633\u062A\u06CC\u0645. "),a(),s(14,"div",12)(15,"a",13)(16,"span",14),c(17,"photo_camera"),a()(),s(18,"a",15)(19,"span",16),c(20,"public"),a()(),s(21,"a",17)(22,"span",18),c(23,"chat"),a()()()(),s(24,"div",19)(25,"h3",20),c(26,"\u062F\u0633\u062A\u0631\u0633\u06CC \u0633\u0631\u06CC\u0639"),a(),s(27,"ul",21)(28,"li")(29,"a",22),c(30,"\u0645\u062D\u0635\u0648\u0644\u0627\u062A"),a()(),s(31,"li")(32,"a",23),c(33,"\u062A\u062E\u0641\u06CC\u0641\u200C\u0647\u0627"),a()(),s(34,"li")(35,"a",24),c(36,"\u0628\u0644\u0627\u06AF"),a()(),s(37,"li")(38,"a",25),c(39,"\u062F\u0631\u0628\u0627\u0631\u0647 \u0645\u0627"),a()()()(),s(40,"div",19)(41,"h3",20),c(42,"\u062E\u062F\u0645\u0627\u062A \u0645\u0634\u062A\u0631\u06CC\u0627\u0646"),a(),s(43,"ul",21)(44,"li")(45,"a",26),c(46,"\u067E\u0631\u0633\u0634\u200C\u0647\u0627\u06CC \u0645\u062A\u062F\u0627\u0648\u0644"),a()(),s(47,"li")(48,"a",26),c(49,"\u0634\u0631\u0627\u06CC\u0637 \u0648 \u0642\u0648\u0627\u0646\u06CC\u0646"),a()(),s(50,"li")(51,"a",26),c(52,"\u062D\u0631\u06CC\u0645 \u062E\u0635\u0648\u0635\u06CC"),a()(),s(53,"li")(54,"a",26),c(55,"\u0631\u0648\u06CC\u0647 \u0628\u0627\u0632\u06AF\u0631\u062F\u0627\u0646\u062F\u0646 \u06A9\u0627\u0644\u0627"),a()()()(),s(56,"div",19)(57,"h3",20),c(58,"\u0646\u0645\u0627\u062F \u0627\u0639\u062A\u0645\u0627\u062F"),a(),s(59,"div",27)(60,"div",28)(61,"span",29),c(62,"ENAMAD"),a()(),s(63,"div",28)(64,"span",29),c(65,"SAMANDEHI"),a()()()()(),s(66,"div",30)(67,"p"),c(68),a(),s(69,"p",31),c(70," Designed & Developed by Ledka Team "),a()()()()()),t&2&&(l(68),y("\u062A\u0645\u0627\u0645\u06CC \u062D\u0642\u0648\u0642 \u0628\u0631\u0627\u06CC \u0641\u0631\u0648\u0634\u06AF\u0627\u0647 \u0644\u0650\u062F\u06A9\u0627 \u0645\u062D\u0641\u0648\u0638 \u0627\u0633\u062A \xA9 ",o.currentYear))},dependencies:[U,X,mi,R],encapsulation:2});let i=n;return i})();var vr=(i,n,r)=>({"toast-success":i,"toast-error":n,"toast-info":r}),_r=(i,n,r)=>({"text-success":i,"text-destructive":n,"text-info":r});function xr(i,n){if(i&1){let r=x();s(0,"div",1)(1,"div",2)(2,"span",3),c(3),a(),s(4,"p",4),c(5),a(),s(6,"button",5),f("click",function(){g(r);let t=m();return v(t.close())}),s(7,"span",6),c(8,"close"),a()()()()}if(i&2){let r=m();d("@slideInOut",void 0),l(),d("ngClass",Qe(5,vr,r.notification.type==="success",r.notification.type==="error",r.notification.type==="info")),l(),d("ngClass",Qe(9,_r,r.notification.type==="success",r.notification.type==="error",r.notification.type==="info")),l(),A(r.icon),l(2),A(r.notification.message)}}var Oi=(()=>{let n=class n{constructor(e){this.notificationService=e,this.notification=null}ngOnInit(){this.subscription=this.notificationService.notification$.subscribe(e=>{this.notification=e,this.timer&&clearTimeout(this.timer),e&&(this.timer=setTimeout(()=>{this.close()},5e3))})}ngOnDestroy(){this.subscription.unsubscribe(),this.timer&&clearTimeout(this.timer)}get notificationClass(){if(!this.notification)return"";switch(this.notification.type){case"success":return"bg-success text-success-foreground";case"error":return"bg-destructive text-destructive-foreground";case"info":default:return"bg-blue-500 text-white"}}get icon(){if(!this.notification)return"";switch(this.notification.type){case"success":return"check_circle";case"error":return"error";case"info":return"info";default:return"info"}}close(){this.notificationService.clear()}};n.\u0275fac=function(t){return new(t||n)(S(H))},n.\u0275cmp=k({type:n,selectors:[["app-notification"]],decls:1,vars:1,consts:[["class","fixed top-5 left-1/2 -translate-x-1/2 z-toast w-full max-w-md px-4",4,"ngIf"],[1,"fixed","top-5","left-1/2","-translate-x-1/2","z-toast","w-full","max-w-md","px-4"],[1,"toast","shadow-lg",3,"ngClass"],[1,"material-icons","text-xl",3,"ngClass"],[1,"text-sm","font-medium"],[1,"btn","btn-ghost","btn-icon","btn-sm","-my-2","ms-auto","rounded-full","hover:bg-black/5",3,"click"],[1,"material-icons","text-lg"]],template:function(t,o){t&1&&h(0,xr,9,13,"div",0),t&2&&d("ngIf",o.notification)},dependencies:[R,Fe,j],encapsulation:2,data:{animation:[ce("slideInOut",[Xe("in",P({transform:"translate(-50%, 0)",opacity:1})),G("void => *",[P({transform:"translate(-50%, -100%)",opacity:0}),B("300ms ease-out")]),G("* => void",[B("300ms ease-in",P({transform:"translate(-50%, -100%)",opacity:0}))])])]}});let i=n;return i})();var qe=(()=>{let n=class n{constructor(e,t,o,u){this.authService=e,this.notificationService=t,this.router=o,this.platformId=u,this.INACTIVITY_TIMEOUT=1800*1e3,this.WARNING_TIME=300*1e3,this.CHECK_INTERVAL=60*1e3,this.lastActivityTime=Date.now(),this.destroy$=new L,this.isMonitoring=!1,this.warningShown=!1}isPaymentPage(){if(!q(this.platformId))return!1;let e=window.location.pathname.toLowerCase(),t=window.location.search.toLowerCase();return e.includes("/payment")||e.includes("/checkout")||e.includes("/callback")||t.includes("authority=")||t.includes("status=")}startSessionMonitoring(){if(!(!q(this.platformId)||this.isMonitoring)){if(this.isPaymentPage()){console.log("[Session] Skipping session monitoring on payment page");return}this.isMonitoring=!0,this.lastActivityTime=Date.now(),this.warningShown=!1,this.setupActivityListeners(),this.resetInactivityTimer(),this.startPeriodicCheck()}}stopSessionMonitoring(){console.log("[Session] Stopping session monitoring"),this.isMonitoring=!1,this.clearTimers(),this.warningShown=!1}setupActivityListeners(){if(!q(this.platformId))return;let e=[re(document,"mousemove"),re(document,"mousedown"),re(document,"keypress"),re(document,"scroll"),re(document,"touchstart"),re(document,"click")];ot(...e).pipe(ct(1e4),w(this.destroy$)).subscribe(()=>{this.onUserActivity()}),re(document,"visibilitychange").pipe(w(this.destroy$)).subscribe(()=>{document.hidden||this.onUserActivity()})}onUserActivity(){!this.isMonitoring||this.isPaymentPage()||(this.lastActivityTime=Date.now(),this.warningShown=!1,this.resetInactivityTimer())}resetInactivityTimer(){this.clearTimers(),this.warningTimer=setTimeout(()=>{this.isPaymentPage()||this.showInactivityWarning()},this.INACTIVITY_TIMEOUT-this.WARNING_TIME),this.inactivityTimer=setTimeout(()=>{this.isPaymentPage()||this.handleSessionTimeout()},this.INACTIVITY_TIMEOUT)}startPeriodicCheck(){he(this.CHECK_INTERVAL,this.CHECK_INTERVAL).pipe(w(this.destroy$)).subscribe(()=>{if(!this.isMonitoring||this.isPaymentPage())return;let e=Date.now()-this.lastActivityTime;e>=this.INACTIVITY_TIMEOUT?this.handleSessionTimeout():e>=this.INACTIVITY_TIMEOUT-this.WARNING_TIME&&!this.warningShown&&this.showInactivityWarning()})}showInactivityWarning(){if(this.warningShown||!this.isMonitoring||this.isPaymentPage())return;this.warningShown=!0;let e=Math.floor(this.WARNING_TIME/6e4);this.notificationService.show(`\u0646\u0634\u0633\u062A \u0634\u0645\u0627 \u0628\u0647 \u062F\u0644\u06CC\u0644 \u0639\u062F\u0645 \u0641\u0639\u0627\u0644\u06CC\u062A ${e} \u062F\u0642\u06CC\u0642\u0647 \u062F\u06CC\u06AF\u0631 \u0645\u0646\u0642\u0636\u06CC \u0645\u06CC\u200C\u0634\u0648\u062F.  \u0628\u0631\u0627\u06CC \u0627\u062F\u0627\u0645\u0647\u060C \u0641\u0639\u0627\u0644\u06CC\u062A\u06CC \u0627\u0646\u062C\u0627\u0645 \u062F\u0647\u06CC\u062F. `,"info")}handleSessionTimeout(){!this.isMonitoring||this.isPaymentPage()||(this.stopSessionMonitoring(),this.notificationService.show("\u0646\u0634\u0633\u062A \u0634\u0645\u0627 \u0628\u0647 \u062F\u0644\u06CC\u0644 \u0639\u062F\u0645 \u0641\u0639\u0627\u0644\u06CC\u062A \u0645\u0646\u0642\u0636\u06CC \u0634\u062F. \u0644\u0637\u0641\u0627 \u0645\u062C\u062F\u062F\u0627 \u0648\u0627\u0631\u062F \u0634\u0648\u06CC\u062F.","info"),this.authService.logout(!0))}clearTimers(){this.inactivityTimer&&(clearTimeout(this.inactivityTimer),this.inactivityTimer=null),this.warningTimer&&(clearTimeout(this.warningTimer),this.warningTimer=null)}getRemainingTime(){let e=Date.now()-this.lastActivityTime;return Math.max(0,this.INACTIVITY_TIMEOUT-e)}getRemainingTimeFormatted(){let e=this.getRemainingTime(),t=Math.floor(e/6e4),o=Math.floor(e%6e4/1e3);return`${t}:${o.toString().padStart(2,"0")}`}extendSession(){this.isMonitoring&&(this.onUserActivity(),this.notificationService.show("\u0646\u0634\u0633\u062A \u0634\u0645\u0627 \u062A\u0645\u062F\u06CC\u062F \u0634\u062F","success"))}isSessionActive(){return this.isMonitoring&&this.authService.isAuthenticated()}ngOnDestroy(){this.destroy$.next(),this.destroy$.complete(),this.stopSessionMonitoring()}};n.\u0275fac=function(t){return new(t||n)(z(W),z(H),z(K),z(se))},n.\u0275prov=N({token:n,factory:n.\u0275fac,providedIn:"root"});let i=n;return i})();function yr(i,n){i&1&&(s(0,"span",15),c(1," \u062A\u0645\u062F\u06CC\u062F \u0646\u0634\u0633\u062A "),s(2,"span",16),c(3,"refresh"),a()())}function br(i,n){i&1&&(s(0,"span",17)(1,"span",18),c(2,"refresh"),a(),c(3," \u062F\u0631 \u062D\u0627\u0644 \u062A\u0645\u062F\u06CC\u062F... "),a())}function Cr(i,n){if(i&1){let r=x();s(0,"div",1)(1,"div",2)(2,"div",3)(3,"div",4)(4,"div",5)(5,"span",6),c(6,"schedule"),a()(),s(7,"p",7),c(8,"\u0632\u0645\u0627\u0646 \u0628\u0627\u0642\u06CC\u0645\u0627\u0646\u062F\u0647 \u0646\u0634\u0633\u062A"),a()(),s(9,"p",8),c(10),a()(),s(11,"div",9),_(12,"div",10),a(),s(13,"div",11)(14,"button",12),f("click",function(){g(r);let t=m();return v(t.extendSession())}),h(15,yr,4,0,"span",13)(16,br,4,0,"span",14),a()()()()}if(i&2){let r=m();l(10),A(r.remainingTime),l(2),Ft("width",r.percent,"%"),l(2),d("disabled",r.isExtending),l(),d("ngIf",!r.isExtending),l(),d("ngIf",r.isExtending)}}var Di=(()=>{let n=class n{constructor(e){this.sessionService=e,this.remainingTime="",this.showTimer=!1,this.isExtending=!1,this.percent=100,this.destroy$=new L,this.SHOW_TIMER_THRESHOLD=120*1e3}ngOnInit(){rt(1e3).pipe(w(this.destroy$),fe(()=>this.sessionService.isSessionActive()),M(()=>{let e=this.sessionService.getRemainingTime();this.showTimer=e<this.SHOW_TIMER_THRESHOLD&&e>0,this.showTimer&&(this.remainingTime=this.sessionService.getRemainingTimeFormatted(),this.percent=Math.min(100,Math.max(0,e/this.SHOW_TIMER_THRESHOLD*100)))})).subscribe()}extendSession(){this.isExtending=!0,this.sessionService.extendSession(),setTimeout(()=>{this.isExtending=!1},1e3)}ngOnDestroy(){this.destroy$.next(),this.destroy$.complete()}};n.\u0275fac=function(t){return new(t||n)(S(qe))},n.\u0275cmp=k({type:n,selectors:[["app-session-timer"]],decls:1,vars:1,consts:[["class","fixed bottom-4 left-4 z-toast animate-fade-in-up",4,"ngIf"],[1,"fixed","bottom-4","left-4","z-toast","animate-fade-in-up"],[1,"toast","toast-warning","shadow-lg","border-warning/50","flex-col","items-stretch","min-w-[280px]"],[1,"flex","items-center","justify-between","mb-2"],[1,"flex","items-center","gap-2"],[1,"icon-wrapper","icon-wrapper-sm","icon-wrapper-warning","rounded-full"],[1,"material-icons","text-lg","icon-pulse"],[1,"text-xs","font-medium","text-foreground"],[1,"text-lg","font-bold","tabular-nums"],[1,"progress","h-1.5","w-full","bg-warning/20"],[1,"progress-bar","bg-warning"],[1,"mt-3","flex","justify-end"],[1,"btn","btn-sm","btn-warning","w-full","group",3,"click","disabled"],["class","flex items-center justify-center gap-1",4,"ngIf"],["class","flex items-center justify-center gap-2",4,"ngIf"],[1,"flex","items-center","justify-center","gap-1"],[1,"material-icons","icon-xs","group-hover:icon-spin"],[1,"flex","items-center","justify-center","gap-2"],[1,"material-icons","icon-spin"]],template:function(t,o){t&1&&h(0,Cr,17,6,"div",0),t&2&&d("ngIf",o.showTimer)},dependencies:[R,j],encapsulation:2});let i=n;return i})();var Ni=(()=>{let n=class n{constructor(e,t,o,u,p){this.sessionService=e,this.authService=t,this.cartService=o,this.router=u,this.platformId=p,this.destroy$=new L}isPaymentPage(){if(!q(this.platformId))return!1;let e=window.location.pathname.toLowerCase(),t=window.location.search.toLowerCase();return e.includes("/payment")||e.includes("/callback")||t.includes("authority=")||t.includes("status=")}ngOnInit(){if(this.isPaymentPage()){console.log("[App] Payment page detected, skipping initialization");return}this.router.events.pipe(fe(e=>e instanceof qt),w(this.destroy$)).subscribe(e=>{let t=e.urlAfterRedirects.toLowerCase();(t.includes("/payment")||t.includes("/callback"))&&this.sessionService.stopSessionMonitoring()}),this.authService.isLoggedIn$.pipe(w(this.destroy$)).subscribe(e=>{e&&!this.isPaymentPage()?(this.sessionService.startSessionMonitoring(),this.cartService.getMyCart().subscribe()):this.isPaymentPage()||(this.sessionService.stopSessionMonitoring(),this.cartService.clearLocalCart())}),this.authService.isAuthenticated()&&!this.isPaymentPage()&&this.sessionService.startSessionMonitoring()}ngOnDestroy(){this.destroy$.next(),this.destroy$.complete()}};n.\u0275fac=function(t){return new(t||n)(S(qe),S(W),S(de),S(K),S(se))},n.\u0275cmp=k({type:n,selectors:[["app-root"]],decls:9,vars:0,consts:[["href","#main-content",1,"skip-link"],[1,"flex","flex-col","min-h-screen","bg-background","font-sans","antialiased","selection:bg-primary","selection:text-primary-foreground"],["id","main-content",1,"flex-grow","animate-fade-in","scroll-mt-24"]],template:function(t,o){t&1&&(s(0,"a",0),c(1,"\u0628\u0631\u06AF\u0634\u062A \u0628\u0647 \u0645\u062D\u062A\u0648\u0627\u06CC \u0627\u0635\u0644\u06CC"),a(),_(2,"app-notification")(3,"app-session-timer"),s(4,"div",1),_(5,"app-header"),s(6,"main",2),_(7,"router-outlet"),a(),_(8,"app-footer"),a())},dependencies:[Wt,Ri,Fi,Oi,Di],encapsulation:2});let i=n;return i})();jt(Ni,wi).catch(i=>console.error(i));
