import{a as U}from"./chunk-RFRMSZ5W.js";import{a as D}from"./chunk-GAYMAGXT.js";import{a as z}from"./chunk-VFDSUV63.js";import{F as E,f as W,g as F,z as T}from"./chunk-PMZJQWMM.js";import{Db as w,Hb as P,Jb as p,Oa as y,Sa as e,Sb as v,Ub as a,Vb as I,Wb as l,_a as h,ba as C,ca as _,cc as x,db as S,gc as g,hc as b,ic as k,qb as u,sb as d,wb as c,xb as r,yb as o,zb as f}from"./chunk-OU7FPMWK.js";var V=i=>["/products",i];function M(i,m){if(i&1&&(r(0,"div",6)(1,"div",23),a(2),g(3,"number"),o()()),i&2){let t=p(2);e(2),l(" ",k(3,1,t.discountPercentage,"1.0-0"),"% ")}}function j(i,m){i&1&&(r(0,"div",7),f(1,"span",24),o())}function L(i,m){i&1&&(r(0,"div",8)(1,"span",25),a(2,"\u0646\u0627\u0645\u0648\u062C\u0648\u062F"),o()())}function B(i,m){if(i&1&&(r(0,"span",19),a(1),g(2,"number"),o()),i&2){let t=p(2);e(),l(" ",b(2,1,t.originalPrice)," ")}}function R(i,m){if(i&1){let t=w();r(0,"div",0)(1,"a",1)(2,"span",2),a(3),o()(),r(4,"div",3),f(5,"div",4)(6,"img",5),u(7,M,4,4,"div",6),u(8,j,2,0,"div",7),u(9,L,3,0,"div",8),r(10,"div",9)(11,"button",10)(12,"span",11),a(13,"visibility"),o()(),r(14,"button",12),P("click",function(s){C(t);let A=p();return _(A.toggleWishlist(s))}),r(15,"span",11),a(16),o()(),r(17,"button",13)(18,"span",11),a(19,"add_shopping_cart"),o()()()(),r(20,"div",14)(21,"h3",15),a(22),o(),r(23,"div",16)(24,"div",17)(25,"div",18),u(26,B,3,3,"span",19),r(27,"div",20)(28,"span",21),a(29),g(30,"number"),o(),r(31,"span",22),a(32,"\u062A\u0648\u0645\u0627\u0646"),o()()()()()()()}if(i&2){let t=p();e(),c("routerLink",x(24,V,t.product.id))("title",t.product.name),e(2),l("\u0645\u0634\u0627\u0647\u062F\u0647 ",t.product.name),e(3),c("src",t.productIconUrl,y)("alt",t.product.name),e(),d(t.hasDiscount?7:-1),e(),d(t.isInStock()?8:-1),e(),d(t.isInStock()?-1:9),e(2),c("routerLink",x(26,V,t.product.id)),e(3),v("text-destructive",t.isWishlisted)("icon-wrapper-primary",!t.isWishlisted),c("disabled",t.isTogglingWishlist)("title",t.isWishlisted?"\u062D\u0630\u0641 \u0627\u0632 \u0639\u0644\u0627\u0642\u0647\u200C\u0645\u0646\u062F\u06CC\u200C\u0647\u0627":"\u0627\u0641\u0632\u0648\u062F\u0646 \u0628\u0647 \u0639\u0644\u0627\u0642\u0647\u200C\u0645\u0646\u062F\u06CC\u200C\u0647\u0627"),e(2),I(t.isWishlisted?"favorite":"favorite_border"),e(),c("disabled",!t.isInStock()),e(5),l(" ",t.product.name," "),e(4),d(t.hasDiscount?26:-1),e(2),v("text-destructive",t.hasDiscount),e(),l(" ",b(30,22,t.displayPrice)," ")}}var Q=(()=>{class i{constructor(t,n,s){this.mediaService=t,this.wishlistService=n,this.authService=s,this.isWishlisted=!1,this.isTogglingWishlist=!1}ngOnInit(){this.authService.isAuthenticated()&&this.product&&(this.isWishlisted=this.wishlistService.isInWishlist(this.product.id),this.wishlistService.wishlistIds$.subscribe(t=>{this.isWishlisted=t.has(this.product.id)}))}toggleWishlist(t){t.preventDefault(),t.stopPropagation(),this.authService.isAuthenticated()&&(this.isTogglingWishlist=!0,this.wishlistService.toggle(this.product.id).subscribe({next:()=>this.isTogglingWishlist=!1,error:()=>this.isTogglingWishlist=!1}))}isInStock(){return this.product?this.product.variants.some(n=>n.isUnlimited)?!0:this.product.totalStock>0:!1}get productIconUrl(){let n=this.product?.images?.find(s=>s.isPrimary)?.url||this.product?.images?.[0]?.url;return n?this.mediaService.getMediaUrl(n):"https://via.placeholder.com/300"}get displayVariant(){if(!(!this.product||!this.product.variants||this.product.variants.length===0))return this.product.variants.reduce((t,n)=>n.sellingPrice<t.sellingPrice?n:t)}get hasDiscount(){let t=this.displayVariant;return t?t.originalPrice>t.sellingPrice:!1}get discountPercentage(){let t=this.displayVariant;return!t||!this.hasDiscount?0:t.discountPercentage}get displayPrice(){return this.displayVariant?.sellingPrice||0}get originalPrice(){return this.displayVariant?.originalPrice||0}static{this.\u0275fac=function(n){return new(n||i)(h(z),h(U),h(D))}}static{this.\u0275cmp=S({type:i,selectors:[["app-product-card"]],inputs:{product:"product"},decls:1,vars:1,consts:[[1,"product-card","card-interactive","group","h-full"],[1,"absolute","inset-0","z-10",3,"routerLink","title"],[1,"sr-only"],[1,"product-image"],[1,"absolute","inset-0","bg-gradient-to-t","from-black/5","to-transparent","opacity-0","group-hover:opacity-100","transition-opacity","duration-300"],["loading","lazy","decoding","async",3,"src","alt"],[1,"product-badge","top-3","left-3"],[1,"absolute","top-3","right-3","z-20"],[1,"absolute","inset-0","z-20","flex","items-center","justify-center","bg-background/60","backdrop-blur-[2px]"],[1,"product-actions"],["title","\u0645\u0634\u0627\u0647\u062F\u0647 \u062C\u0632\u0626\u06CC\u0627\u062A",1,"icon-wrapper","icon-wrapper-lg","icon-wrapper-primary","bg-background","rounded-full","shadow-lg","mx-1","hover:scale-110","transition-transform","z-20",3,"routerLink"],[1,"material-icons","text-xl"],[1,"icon-wrapper","icon-wrapper-lg","bg-background","rounded-full","shadow-lg","mx-1","hover:scale-110","transition-transform","z-20",3,"click","disabled","title"],["title","\u0627\u0641\u0632\u0648\u062F\u0646 \u0628\u0647 \u0633\u0628\u062F",1,"icon-wrapper","icon-wrapper-lg","icon-wrapper-primary","bg-background","rounded-full","shadow-lg","mx-1","hover:scale-110","transition-transform","z-20",3,"disabled"],[1,"product-info","flex-1","flex","flex-col"],[1,"product-title","group-hover:text-primary","transition-colors"],[1,"mt-auto","pt-3","border-t","border-border/50"],[1,"product-price","justify-end"],[1,"flex","flex-col","items-end"],[1,"text-sm","text-muted-foreground","line-through"],[1,"flex","items-baseline","gap-1"],[1,"text-xl","font-bold","tabular-nums"],[1,"text-sm","font-medium","text-muted-foreground"],[1,"badge","badge-lg","bg-destructive","text-white","shadow-sm","animate-fade-in"],["title","\u0645\u0648\u062C\u0648\u062F \u062F\u0631 \u0627\u0646\u0628\u0627\u0631",1,"inline-block","w-2","h-2","rounded-full","bg-success","shadow-sm"],[1,"badge","bg-muted","text-muted-foreground","shadow-lg"]],template:function(n,s){n&1&&u(0,R,33,28,"div",0),n&2&&d(s.product?0:-1)},dependencies:[F,E,T,W],encapsulation:2})}}return i})();export{Q as a};
