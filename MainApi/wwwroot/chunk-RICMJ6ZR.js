import { a as Fe } from "./chunk-CCDKSRRZ.js"; import { a as V, b as Ae } from "./chunk-OWZBN5HE.js"; import { a as we } from "./chunk-X53S5UY7.js"; import { a as he } from "./chunk-4ATIAIKP.js"; import { a as q } from "./chunk-MX7VZAVK.js"; import { a as be, b as G, c as m, d as H, e as U, f as ee, g as S, i as z, m as J, p as K, q as Se, r as _e, s as ye, v as Ce, x as Ee, z as Q } from "./chunk-2WEVJ2Q3.js"; import "./chunk-CVBRNWP7.js"; import { a as O } from "./chunk-OR3E3ANE.js"; import "./chunk-WNMS36QR.js"; import { A as D, B as T, C as ve, H as M, b as ce, c as L, d as w, e as $, f as pe, h as fe, i as A, y as xe, z as ge } from "./chunk-H5ECWNVP.js"; import { A as oe, Bb as B, Cb as R, Db as P, G as C, Gb as h, Hb as v, Ob as ae, Pb as i, Qb as b, R as se, Rb as x, Sa as d, Sb as ue, Tb as de, Yb as le, Zb as me, ac as _, bb as c, bc as F, cc as Z, ea as N, fa as k, g as re, gb as E, j as ne, lb as f, ub as l, vb as t, wb as e, xb as p } from "./chunk-C5CPS5UB.js"; import { a as y, b as I } from "./chunk-4CLCTAJ7.js"; var Pe = () => ({ exact: !0 }); function Te(r, s) { if (r & 1 && (B(0), t(1, "h2", 20), i(2), e(), t(3, "p", 21), i(4), e(), R()), r & 2) { let n = s.ngIf; d(2), ue(" ", n.firstName, " ", n.lastName, " "), d(2), x(" ", n.phoneNumber, " ") } } function Me(r, s) { if (r & 1 && (t(0, "li")(1, "a", 22)(2, "span", 17), i(3), e(), t(4, "span"), i(5), e()()()), r & 2) { let n = s.$implicit; d(), l("routerLink", n.link)("routerLinkActiveOptions", le(4, Pe)), d(2), b(n.icon), d(2), b(n.title) } } var Ie = (() => { let s = class s { constructor(o, a) { this.authService = o, this.router = a, this.menuItems = [{ title: "\u067E\u0631\u0648\u0641\u0627\u06CC\u0644", link: "/dashboard/profile", icon: "account_circle" }, { title: "\u062A\u0627\u0631\u06CC\u062E\u0686\u0647 \u0633\u0641\u0627\u0631\u0634\u0627\u062A", link: "/dashboard/order-history", icon: "history" }, { title: "\u0622\u062F\u0631\u0633\u200C\u0647\u0627\u06CC \u0645\u0646", icon: "home", link: "/dashboard/addresses" }], this.user$ = this.authService.userProfile$ } ngOnInit() { } logout() { this.authService.logout(), this.router.navigate(["/"]) } }; s.\u0275fac = function (a) { return new (a || s)(c(q), c(D)) }, s.\u0275cmp = E({ type: s, selectors: [["app-dashboard-page"]], decls: 27, vars: 4, consts: [[1, "min-h-screen", "bg-background", "pb-12"], [1, "container", "py-8", "md:py-10"], [1, "md:hidden", "mb-6", "flex", "justify-between", "items-center"], [1, "text-xl", "font-bold", "text-foreground"], [1, "grid", "grid-cols-1", "md:grid-cols-12", "gap-6", "lg:gap-8"], [1, "md:col-span-4", "lg:col-span-3"], [1, "sticky", "top-24", "space-y-6"], [1, "card", "p-6", "flex", "flex-col", "items-center", "text-center"], [1, "relative", "w-20", "h-20", "mb-4"], [1, "w-full", "h-full", "rounded-full", "bg-muted", "flex", "items-center", "justify-center", "text-muted-foreground", "border", "border-border"], [1, "material-icons", "text-4xl"], [4, "ngIf"], [1, "card", "overflow-hidden", "p-2"], [1, "space-y-1"], [4, "ngFor", "ngForOf"], [1, "pt-2", "mt-2", "border-t", "border-border"], [1, "w-full", "flex", "items-center", "gap-3", "px-4", "py-3", "rounded-lg", "text-sm", "text-destructive", "hover:bg-destructive/10", "transition-colors", 3, "click"], [1, "material-icons-outlined", "text-lg"], [1, "md:col-span-8", "lg:col-span-9"], [1, "card", "min-h-[500px]", "overflow-hidden"], [1, "font-bold", "text-lg", "text-foreground", "mb-1"], [1, "text-sm", "text-muted-foreground", "font-mono"], ["routerLinkActive", "bg-primary/10 text-primary font-semibold", 1, "flex", "items-center", "gap-3", "px-4", "py-3", "rounded-lg", "text-sm", "text-muted-foreground", "hover:bg-muted/50", "hover:text-foreground", "transition-colors", 3, "routerLink", "routerLinkActiveOptions"]], template: function (a, u) { a & 1 && (t(0, "div", 0)(1, "div", 1)(2, "div", 2)(3, "h1", 3), i(4, "\u062D\u0633\u0627\u0628 \u06A9\u0627\u0631\u0628\u0631\u06CC"), e()(), t(5, "div", 4)(6, "aside", 5)(7, "div", 6)(8, "div", 7)(9, "div", 8)(10, "div", 9)(11, "span", 10), i(12, "person"), e()()(), f(13, Te, 5, 3, "ng-container", 11), _(14, "async"), e(), t(15, "nav", 12)(16, "ul", 13), f(17, Me, 6, 5, "li", 14), t(18, "li", 15)(19, "button", 16), h("click", function () { return u.logout() }), t(20, "span", 17), i(21, "logout"), e(), t(22, "span"), i(23, "\u062E\u0631\u0648\u062C"), e()()()()()()(), t(24, "main", 18)(25, "div", 19), p(26, "router-outlet"), e()()()()()), a & 2 && (d(13), l("ngIf", F(14, 2, u.user$)), d(4), l("ngForOf", u.menuItems)) }, dependencies: [A, L, w, M, ge, T, ve, $], encapsulation: 2 }); let r = s; return r })(); function Be(r, s) { r & 1 && (t(0, "div", 8), p(1, "span", 9), e()) } function Re(r, s) { if (r & 1 && (t(0, "div", 10), i(1), e()), r & 2) { let n = v().ngIf; d(), x(" ", n.error, " ") } } function $e(r, s) { r & 1 && p(0, "span", 26) } function qe(r, s) { if (r & 1) { let n = P(); t(0, "form", 11), h("ngSubmit", function () { N(n); let a = v(2); return k(a.updateProfile()) }), t(1, "div", 12)(2, "div", 13)(3, "span", 14), i(4, "person"), e()()(), t(5, "div", 15)(6, "div", 16)(7, "label", 17), i(8, "\u0646\u0627\u0645"), e(), p(9, "input", 18), e(), t(10, "div", 16)(11, "label", 17), i(12, "\u0646\u0627\u0645 \u062E\u0627\u0646\u0648\u0627\u062F\u06AF\u06CC"), e(), p(13, "input", 19), e(), t(14, "div", 16)(15, "label", 17), i(16, "\u0634\u0645\u0627\u0631\u0647 \u0645\u0648\u0628\u0627\u06CC\u0644"), e(), p(17, "input", 20), e(), t(18, "div", 16)(19, "label", 17), i(20, "\u062A\u0627\u0631\u06CC\u062E \u0639\u0636\u0648\u06CC\u062A"), e(), p(21, "input", 21), e()(), t(22, "div", 22)(23, "button", 23), h("click", function () { N(n); let a = v(2); return k(a.deleteAccount()) }), i(24, " \u062D\u0630\u0641 \u062D\u0633\u0627\u0628 \u06A9\u0627\u0631\u0628\u0631\u06CC "), e(), t(25, "button", 24), f(26, $e, 1, 0, "span", 25), t(27, "span"), i(28), e()()()() } if (r & 2) { let n = v().ngIf, o = v(); l("formGroup", o.profileForm), d(25), l("disabled", o.profileForm.pristine || n.isSubmitting), d(), l("ngIf", n.isSubmitting), d(2), b(n.isSubmitting ? "\u062F\u0631 \u062D\u0627\u0644 \u0630\u062E\u06CC\u0631\u0647..." : "\u062B\u0628\u062A \u062A\u063A\u06CC\u06CC\u0631\u0627\u062A") } } function Ge(r, s) { if (r & 1 && (B(0), f(1, Be, 2, 0, "div", 5)(2, Re, 2, 1, "div", 6)(3, qe, 29, 4, "form", 7), R()), r & 2) { let n = s.ngIf, o = v(); d(), l("ngIf", n.isLoading), d(), l("ngIf", n.error), d(), l("ngIf", !n.isLoading && o.profileForm) } } var ke = (() => { let s = class s { constructor(o, a, u, g) { this.profileService = o, this.authService = a, this.notificationService = u, this.router = g, this.showAddressModal = !1, this.editingAddress = null, this.store = new re({ profile: null, isLoading: !0, isSubmitting: !1, error: null }), this.vm$ = this.store.asObservable() } ngOnInit() { this.profileForm = new ee({ phoneNumber: new S({ value: "", disabled: !0 }), createdAt: new S({ value: "", disabled: !0 }), firstName: new S("", [m.maxLength(100)]), lastName: new S("", [m.maxLength(100)]), isAdmin: new S({ value: !1, disabled: !0 }) }), this.addressForm = new ee({ title: new S("", m.required), receiverName: new S("", m.required), phoneNumber: new S("", m.required), province: new S("", m.required), city: new S("", m.required), address: new S("", m.required), postalCode: new S("", m.required) }), this.loadProfile() } loadProfile() { this.store.next(I(y({}, this.store.value), { isLoading: !0 })), this.profileService.getProfile().pipe(se(o => { this.profileForm.patchValue({ phoneNumber: o.phoneNumber, createdAt: o.createdAt ? new Date(o.createdAt).toLocaleDateString("fa-IR") : "", firstName: o.firstName, lastName: o.lastName, isAdmin: o.isAdmin }), this.authService.updateUserProfile(o), this.store.next(I(y({}, this.store.value), { profile: o, isLoading: !1, error: null })), this.profileForm.markAsPristine() }), oe(o => { let a = o?.error?.message || "\u062E\u0637\u0627 \u062F\u0631 \u062F\u0631\u06CC\u0627\u0641\u062A \u0627\u0637\u0644\u0627\u0639\u0627\u062A \u067E\u0631\u0648\u0641\u0627\u06CC\u0644"; return this.store.next(I(y({}, this.store.value), { isLoading: !1, error: a })), ne(null) })).subscribe() } updateProfile() { if (this.profileForm.invalid || this.profileForm.pristine) return; this.store.next(I(y({}, this.store.value), { isSubmitting: !0 })); let o = { firstName: this.profileForm.value.firstName?.trim() || void 0, lastName: this.profileForm.value.lastName?.trim() || void 0 }; this.profileService.updateProfile(o).pipe(C(() => this.store.next(I(y({}, this.store.value), { isSubmitting: !1 })))).subscribe({ next: () => { this.notificationService.show("\u067E\u0631\u0648\u0641\u0627\u06CC\u0644 \u0628\u0627 \u0645\u0648\u0641\u0642\u06CC\u062A \u0628\u0647\u200C\u0631\u0648\u0632\u0631\u0633\u0627\u0646\u06CC \u0634\u062F", "success"), this.loadProfile() }, error: a => { let u = a?.error?.message || "\u062E\u0637\u0627 \u062F\u0631 \u0628\u0647\u200C\u0631\u0648\u0632\u0631\u0633\u0627\u0646\u06CC \u067E\u0631\u0648\u0641\u0627\u06CC\u0644"; this.notificationService.show(u, "error") } }) } deleteAccount() { confirm("\u0622\u06CC\u0627 \u0627\u0632 \u062D\u0630\u0641 \u062D\u0633\u0627\u0628 \u06A9\u0627\u0631\u0628\u0631\u06CC \u062E\u0648\u062F \u0627\u0637\u0645\u06CC\u0646\u0627\u0646 \u062F\u0627\u0631\u06CC\u062F\u061F \u0627\u06CC\u0646 \u0639\u0645\u0644 \u063A\u06CC\u0631\u0642\u0627\u0628\u0644 \u0628\u0627\u0632\u06AF\u0634\u062A \u0627\u0633\u062A.") && (this.store.next(I(y({}, this.store.value), { isSubmitting: !0 })), this.profileService.deleteAccount().pipe(C(() => this.store.next(I(y({}, this.store.value), { isSubmitting: !1 })))).subscribe({ next: () => { this.notificationService.show("\u062D\u0633\u0627\u0628 \u06A9\u0627\u0631\u0628\u0631\u06CC \u0634\u0645\u0627 \u0628\u0627 \u0645\u0648\u0641\u0642\u06CC\u062A \u062D\u0630\u0641 \u0634\u062F.", "success"), this.authService.logout(), this.router.navigate(["/"]) }, error: o => { let a = o?.error?.message || "\u062E\u0637\u0627 \u062F\u0631 \u062D\u0630\u0641 \u062D\u0633\u0627\u0628 \u06A9\u0627\u0631\u0628\u0631\u06CC."; this.notificationService.show(a, "error") } })) } }; s.\u0275fac = function (a) { return new (a || s)(c(V), c(q), c(O), c(D)) }, s.\u0275cmp = E({ type: s, selectors: [["app-profile"]], decls: 7, vars: 3, consts: [[1, "flex", "flex-col", "h-full"], [1, "p-6", "border-b", "border-border", "flex", "items-center", "justify-between"], [1, "text-lg", "font-bold", "text-foreground"], [1, "p-6", "max-w-2xl", "mx-auto", "w-full", "flex-1"], [4, "ngIf"], ["class", "flex justify-center py-12", 4, "ngIf"], ["class", "alert alert-destructive mb-6", 4, "ngIf"], ["class", "space-y-8", 3, "formGroup", "ngSubmit", 4, "ngIf"], [1, "flex", "justify-center", "py-12"], [1, "spinner", "spinner-lg", "text-primary"], [1, "alert", "alert-destructive", "mb-6"], [1, "space-y-8", 3, "ngSubmit", "formGroup"], [1, "flex", "flex-col", "items-center", "mb-8"], [1, "w-24", "h-24", "rounded-full", "bg-muted", "flex", "items-center", "justify-center", "text-muted-foreground", "border", "border-border", "mb-2"], [1, "material-icons", "text-4xl"], [1, "grid", "grid-cols-1", "sm:grid-cols-2", "gap-6"], [1, "space-y-2"], [1, "text-sm", "font-medium", "text-foreground"], ["type", "text", "formControlName", "firstName", 1, "input", "w-full"], ["type", "text", "formControlName", "lastName", 1, "input", "w-full"], ["type", "text", "formControlName", "phoneNumber", "readonly", "", 1, "input", "w-full", "bg-muted/30", "text-muted-foreground", "dir-ltr"], ["type", "text", "formControlName", "createdAt", "readonly", "", 1, "input", "w-full", "bg-muted/30", "text-muted-foreground", "text-center"], [1, "pt-6", "border-t", "border-border", "flex", "flex-col-reverse", "sm:flex-row", "justify-between", "gap-4"], ["type", "button", 1, "btn", "btn-outline", "text-destructive", "border-destructive/30", "hover:bg-destructive/10", "w-full", "sm:w-auto", 3, "click"], ["type", "submit", 1, "btn", "btn-primary", "w-full", "sm:w-auto", "min-w-[120px]", 3, "disabled"], ["class", "spinner spinner-sm me-2", 4, "ngIf"], [1, "spinner", "spinner-sm", "me-2"]], template: function (a, u) { a & 1 && (t(0, "div", 0)(1, "div", 1)(2, "h2", 2), i(3, "\u0648\u06CC\u0631\u0627\u06CC\u0634 \u067E\u0631\u0648\u0641\u0627\u06CC\u0644"), e()(), t(4, "div", 3), f(5, Ge, 4, 3, "ng-container", 4), _(6, "async"), e()()), a & 2 && (d(5), l("ngIf", F(6, 1, u.vm$))) }, dependencies: [A, w, Q, z, G, H, U, J, K, $], encapsulation: 2 }); let r = s; return r })(); function He(r, s) { r & 1 && (t(0, "div", 7), p(1, "span", 8), t(2, "span", 9), i(3, "\u062F\u0631 \u062D\u0627\u0644 \u0628\u0627\u0631\u06AF\u0630\u0627\u0631\u06CC..."), e()()) } function Ue(r, s) { r & 1 && (t(0, "div", 10)(1, "span", 11), i(2, "receipt_long"), e(), t(3, "p", 9), i(4, "\u0647\u0646\u0648\u0632 \u0633\u0641\u0627\u0631\u0634\u06CC \u062B\u0628\u062A \u0646\u06A9\u0631\u062F\u0647\u200C\u0627\u06CC\u062F"), e(), t(5, "a", 12), i(6, "\u0634\u0631\u0648\u0639 \u062E\u0631\u06CC\u062F"), e()()) } function ze(r, s) { if (r & 1) { let n = P(); t(0, "tr", 23)(1, "td", 24), i(2), e(), t(3, "td", 25), i(4), _(5, "date"), e(), t(6, "td", 26), i(7), _(8, "number"), e(), t(9, "td", 27)(10, "span", 28), _(11, "statusClass"), i(12), e()(), t(13, "td", 29)(14, "button", 30), h("click", function () { let a = N(n).$implicit, u = v(2); return k(u.viewOrderDetails(a.id)) }), i(15, " \u062C\u0632\u0626\u06CC\u0627\u062A "), e()()() } if (r & 2) { let n = s.$implicit; d(2), x("#", n.id), d(2), b(Z(5, 5, n.createdAt, "yyyy/MM/dd")), d(3), b(F(8, 8, n.totalAmount)), d(3), l("ngClass", F(11, 10, n.orderStatus == null ? null : n.orderStatus.name)), d(2), x(" ", (n.orderStatus == null ? null : n.orderStatus.name) || "\u0646\u0627\u0645\u0634\u062E\u0635", " ") } } function Je(r, s) { if (r & 1) { let n = P(); t(0, "div", 31), h("click", function () { let a = N(n).$implicit, u = v(2); return k(u.viewOrderDetails(a.id)) }), t(1, "div", 32)(2, "div")(3, "span", 33), i(4, "\u0634\u0645\u0627\u0631\u0647 \u0633\u0641\u0627\u0631\u0634"), e(), t(5, "span", 34), i(6), e()(), t(7, "span", 28), _(8, "statusClass"), i(9), e()(), t(10, "div", 35)(11, "span", 36), i(12), _(13, "date"), e(), t(14, "div", 37), i(15), _(16, "number"), t(17, "span", 38), i(18, "\u062A\u0648\u0645\u0627\u0646"), e()()()() } if (r & 2) { let n = s.$implicit; d(6), x("#", n.id), d(), l("ngClass", F(8, 5, n.orderStatus == null ? null : n.orderStatus.name)), d(2), x(" ", n.orderStatus == null ? null : n.orderStatus.name, " "), d(3), b(Z(13, 7, n.createdAt, "yyyy/MM/dd")), d(3), x(" ", F(16, 10, n.totalAmount), " ") } } function Ke(r, s) { if (r & 1 && (t(0, "div", 13)(1, "div", 14)(2, "table", 15)(3, "thead", 16)(4, "tr")(5, "th", 17), i(6, "\u0634\u0645\u0627\u0631\u0647 \u0633\u0641\u0627\u0631\u0634"), e(), t(7, "th", 17), i(8, "\u062A\u0627\u0631\u06CC\u062E"), e(), t(9, "th", 17), i(10, "\u0645\u0628\u0644\u063A (\u062A\u0648\u0645\u0627\u0646)"), e(), t(11, "th", 17), i(12, "\u0648\u0636\u0639\u06CC\u062A"), e(), t(13, "th", 18), i(14, "\u0639\u0645\u0644\u06CC\u0627\u062A"), e()()(), t(15, "tbody", 19), f(16, ze, 16, 12, "tr", 20), e()()(), t(17, "div", 21), f(18, Je, 19, 12, "div", 22), e()()), r & 2) { let n = v(); d(16), l("ngForOf", n.orders), d(2), l("ngForOf", n.orders) } } var Le = (() => { let s = class s { constructor(o, a, u) { this.orderService = o, this.notificationService = a, this.router = u, this.orders = [], this.isLoading = !0, this.paginationInfo = null } ngOnInit() { this.loadOrders() } loadOrders(o = 1, a = 10) { this.isLoading = !0, this.orderService.getOrders(o, a).pipe(C(() => this.isLoading = !1)).subscribe({ next: u => { this.orders = u.items ?? [], this.paginationInfo = u }, error: () => { this.notificationService.show("\u062E\u0637\u0627 \u062F\u0631 \u062F\u0631\u06CC\u0627\u0641\u062A \u062A\u0627\u0631\u06CC\u062E\u0686\u0647 \u0633\u0641\u0627\u0631\u0634\u0627\u062A", "error") } }) } viewOrderDetails(o) { this.router.navigate(["/dashboard/order", o]) } }; s.\u0275fac = function (a) { return new (a || s)(c(we), c(O), c(D)) }, s.\u0275cmp = E({ type: s, selectors: [["app-order-history"]], decls: 8, vars: 3, consts: [[1, "flex", "flex-col", "h-full"], [1, "p-6", "border-b", "border-border", "flex", "justify-between", "items-center"], [1, "text-lg", "font-bold", "text-foreground"], [1, "p-6", "flex-1"], ["class", "flex flex-col items-center justify-center h-64 space-y-4", 4, "ngIf"], ["class", "empty-state border-2 border-dashed border-border rounded-xl", 4, "ngIf"], ["class", "space-y-4", 4, "ngIf"], [1, "flex", "flex-col", "items-center", "justify-center", "h-64", "space-y-4"], [1, "spinner", "spinner-lg", "text-primary"], [1, "text-muted-foreground", "text-sm"], [1, "empty-state", "border-2", "border-dashed", "border-border", "rounded-xl"], [1, "material-icons", "text-4xl", "text-muted-foreground/40", "mb-4"], ["routerLink", "/products", 1, "btn", "btn-link", "mt-2"], [1, "space-y-4"], [1, "hidden", "md:block", "overflow-hidden", "rounded-xl", "border", "border-border"], [1, "w-full", "text-sm"], [1, "bg-muted/30", "border-b", "border-border"], [1, "px-6", "py-4", "font-semibold", "text-muted-foreground", "text-right"], [1, "px-6", "py-4", "font-semibold", "text-muted-foreground", "text-left"], [1, "divide-y", "divide-border"], ["class", "hover:bg-muted/10 transition-colors", 4, "ngFor", "ngForOf"], [1, "md:hidden", "grid", "gap-4"], ["class", "card-hover p-4 active:scale-[0.99] cursor-pointer border border-border", 3, "click", 4, "ngFor", "ngForOf"], [1, "hover:bg-muted/10", "transition-colors"], [1, "px-6", "py-4", "font-mono", "text-foreground"], [1, "px-6", "py-4", "text-muted-foreground"], [1, "px-6", "py-4", "font-medium", "text-foreground"], [1, "px-6", "py-4"], [1, "badge", 3, "ngClass"], [1, "px-6", "py-4", "text-left"], [1, "btn", "btn-ghost", "btn-sm", 3, "click"], [1, "card-hover", "p-4", "active:scale-[0.99]", "cursor-pointer", "border", "border-border", 3, "click"], [1, "flex", "justify-between", "items-start", "mb-3"], [1, "text-xs", "text-muted-foreground", "block", "mb-1"], [1, "font-mono", "font-bold", "text-foreground"], [1, "flex", "justify-between", "items-end", "border-t", "border-border", "pt-3"], [1, "text-xs", "text-muted-foreground"], [1, "font-bold", "text-primary"], [1, "text-xs", "font-normal", "text-muted-foreground"]], template: function (a, u) { a & 1 && (t(0, "div", 0)(1, "div", 1)(2, "h2", 2), i(3, "\u062A\u0627\u0631\u06CC\u062E\u0686\u0647 \u0633\u0641\u0627\u0631\u0634\u0627\u062A"), e()(), t(4, "div", 3), f(5, He, 4, 0, "div", 4)(6, Ue, 7, 0, "div", 5)(7, Ke, 19, 2, "div", 6), e()()), a & 2 && (d(5), l("ngIf", u.isLoading), d(), l("ngIf", !u.isLoading && (!u.orders || u.orders.length === 0)), d(), l("ngIf", !u.isLoading && u.orders && u.orders.length > 0)) }, dependencies: [A, ce, L, w, fe, pe, Fe], encapsulation: 2 }); let r = s; return r })(); function Qe(r, s) { if (r & 1 && (t(0, "option", 28), i(1), e()), r & 2) { let n = s.$implicit; l("value", n.name), d(), b(n.name) } } function We(r, s) { if (r & 1 && (t(0, "option", 28), i(1), e()), r & 2) { let n = s.$implicit; l("value", n.name), d(), b(n.name) } } function Xe(r, s) { if (r & 1 && (t(0, "span"), i(1), e()), r & 2) { let n = v(); d(), b(n.isEditMode ? "\u0648\u06CC\u0631\u0627\u06CC\u0634 \u0622\u062F\u0631\u0633" : "\u062B\u0628\u062A \u0622\u062F\u0631\u0633") } } function Ye(r, s) { r & 1 && (t(0, "span", 29), i(1, "\u062F\u0631 \u062D\u0627\u0644 \u067E\u0631\u062F\u0627\u0632\u0634"), e()) } var ie = (() => { let s = class s { constructor(o, a, u, g, j, Oe) { this.fb = o, this.route = a, this.router = u, this.profileService = g, this.locationService = j, this.notificationService = Oe, this.isEditMode = !1, this.addressId = null, this.isSubmitting = !1, this.states = [], this.cities = [], this.citiesLoading = !1, this.addressForm = this.fb.group({ title: ["", [m.required, m.maxLength(100)]], receiverName: ["", [m.required, m.maxLength(100)]], phoneNumber: ["", [m.required, m.pattern(/^\+?\d{10,15}$/)]], postalCode: ["", [m.required, m.pattern(/^\d{10}$/), m.minLength(10), m.maxLength(10)]], province: [null, m.required], city: [{ value: null, disabled: !0 }, m.required], address: ["", [m.required, m.maxLength(500)]], isDefault: [!1] }) } ngOnInit() { this.loadStates(); let o = this.route.snapshot.paramMap.get("id"); o && (this.addressId = +o, this.isEditMode = !0, this.loadAddressData()) } loadStates() { this.locationService.getStates().subscribe(o => this.states = o) } onProvinceChange(o) { let u = o.target.value, g = this.states.find(j => j.name === u); this.cities = [], this.addressForm.get("city")?.reset(), this.addressForm.get("city")?.disable(), g && (this.citiesLoading = !0, this.addressForm.get("city")?.enable(), this.locationService.getCitiesByState(g.id).pipe(C(() => this.citiesLoading = !1)).subscribe(j => this.cities = j)) } loadAddressData() { this.addressId && this.profileService.getProfile().subscribe(o => { let a = o.userAddresses?.find(u => u.id === this.addressId); if (a) { this.addressForm.patchValue(a); let u = this.states.find(g => g.name === a.province); u && (this.addressForm.get("city")?.enable(), this.locationService.getCitiesByState(u.id).subscribe(g => { this.cities = g, this.addressForm.get("city")?.patchValue(a.city) })) } else this.notificationService.show("\u0622\u062F\u0631\u0633 \u0645\u0648\u0631\u062F \u0646\u0638\u0631 \u06CC\u0627\u0641\u062A \u0646\u0634\u062F", "error"), this.router.navigate(["/dashboard/addresses"]) }) } onSubmit() { if (this.addressForm.invalid) { this.addressForm.markAllAsTouched(); return } this.isSubmitting = !0; let o = this.addressForm.getRawValue(); (this.isEditMode && this.addressId ? this.profileService.updateAddress(this.addressId, y({ id: this.addressId }, o)) : this.profileService.addAddress(o)).pipe(C(() => this.isSubmitting = !1)).subscribe({ next: () => { this.notificationService.show(`\u0622\u062F\u0631\u0633 \u0628\u0627 \u0645\u0648\u0641\u0642\u06CC\u062A ${this.isEditMode ? "\u0648\u06CC\u0631\u0627\u06CC\u0634" : "\u0627\u0641\u0632\u0648\u062F\u0647"} \u0634\u062F`, "success"), this.router.navigate(["/dashboard/addresses"]) }, error: u => this.notificationService.show(u?.error?.message || "\u062E\u0637\u0627 \u062F\u0631 \u062B\u0628\u062A \u0622\u062F\u0631\u0633", "error") }) } }; s.\u0275fac = function (a) { return new (a || s)(c(Ee), c(xe), c(D), c(V), c(Ae), c(O)) }, s.\u0275cmp = E({ type: s, selectors: [["app-address-form"]], decls: 55, vars: 12, consts: [[1, "flex", "flex-col", "h-full", "bg-background"], [1, "p-6", "border-b", "border-border", "flex", "items-center", "justify-between"], [1, "text-lg", "font-bold", "text-foreground"], ["routerLink", "/dashboard/addresses", 1, "btn", "btn-ghost", "btn-sm", "text-muted-foreground", "hover:text-foreground"], [1, "material-icons", "icon-sm", "me-1"], [1, "p-6", "max-w-2xl", "mx-auto", "w-full", "flex-1"], [1, "space-y-6", 3, "ngSubmit", "formGroup"], [1, "form-group"], [1, "form-label", "text-sm", "font-medium", "text-foreground"], ["type", "text", "formControlName", "title", "placeholder", "\u0645\u062B\u0627\u0644: \u0645\u0646\u0632\u0644\u060C \u0645\u062D\u0644 \u06A9\u0627\u0631", 1, "input", "w-full"], [1, "form-row", "grid", "grid-cols-1", "sm:grid-cols-2", "gap-6"], ["type", "text", "formControlName", "receiverName", 1, "input", "w-full"], ["type", "tel", "formControlName", "phoneNumber", "placeholder", "09xxxxxxxxx", "maxlength", "11", 1, "input", "w-full", "ltr-input"], ["formControlName", "province", 1, "input", "w-full", 3, "change"], ["disabled", "", 3, "ngValue"], [3, "value", 4, "ngFor", "ngForOf"], ["formControlName", "city", 1, "input", "w-full", 3, "disabled"], [1, "form-row", "grid", "grid-cols-1", "sm:grid-cols-3", "gap-6"], [1, "form-group", "sm:col-span-2"], ["formControlName", "address", "rows", "2", 1, "input", "w-full", "min-h-[50px]"], ["type", "text", "formControlName", "postalCode", "maxlength", "10", 1, "input", "w-full", "ltr-input"], [1, "flex", "items-center", "gap-2"], ["type", "checkbox", "id", "isDefault", "formControlName", "isDefault", 1, "checkbox"], ["for", "isDefault", 1, "form-label", "text-sm", "text-foreground", "cursor-pointer", "mb-0"], [1, "form-actions", "pt-6", "border-t", "border-border", "flex", "justify-end"], ["type", "submit", 1, "btn", "btn-success", "w-full", "sm:w-auto", "min-w-[140px]", 3, "disabled"], [4, "ngIf"], ["class", "opacity-0", 4, "ngIf"], [3, "value"], [1, "opacity-0"]], template: function (a, u) { if (a & 1 && (t(0, "div", 0)(1, "div", 1)(2, "h2", 2), i(3), e(), t(4, "a", 3)(5, "span", 4), i(6, "arrow_forward"), e(), i(7, " \u0628\u0627\u0632\u06AF\u0634\u062A "), e()(), t(8, "div", 5)(9, "form", 6), h("ngSubmit", function () { return u.onSubmit() }), t(10, "div", 7)(11, "label", 8), i(12, "\u0639\u0646\u0648\u0627\u0646 \u0622\u062F\u0631\u0633"), e(), p(13, "input", 9), e(), t(14, "div", 10)(15, "div", 7)(16, "label", 8), i(17, "\u0646\u0627\u0645 \u06AF\u06CC\u0631\u0646\u062F\u0647"), e(), p(18, "input", 11), e(), t(19, "div", 7)(20, "label", 8), i(21, "\u0634\u0645\u0627\u0631\u0647 \u062A\u0645\u0627\u0633"), e(), p(22, "input", 12), e()(), t(23, "div", 10)(24, "div", 7)(25, "label", 8), i(26, "\u0627\u0633\u062A\u0627\u0646"), e(), t(27, "select", 13), h("change", function (j) { return u.onProvinceChange(j) }), t(28, "option", 14), i(29, "\u0627\u0646\u062A\u062E\u0627\u0628 \u0627\u0633\u062A\u0627\u0646"), e(), f(30, Qe, 2, 2, "option", 15), e()(), t(31, "div", 7)(32, "label", 8), i(33, "\u0634\u0647\u0631"), e(), t(34, "select", 16)(35, "option", 14), i(36, "\u0627\u0646\u062A\u062E\u0627\u0628 \u0634\u0647\u0631"), e(), f(37, We, 2, 2, "option", 15), e()()(), t(38, "div", 17)(39, "div", 18)(40, "label", 8), i(41, "\u0622\u062F\u0631\u0633 \u067E\u0633\u062A\u06CC"), e(), p(42, "textarea", 19), e(), t(43, "div", 7)(44, "label", 8), i(45, "\u06A9\u062F \u067E\u0633\u062A\u06CC"), e(), p(46, "input", 20), e()(), t(47, "div", 21), p(48, "input", 22), t(49, "label", 23), i(50, "\u0627\u06CC\u0646 \u0622\u062F\u0631\u0633 \u0628\u0647 \u0639\u0646\u0648\u0627\u0646 \u067E\u06CC\u0634\u200C\u0641\u0631\u0636 \u062A\u0646\u0638\u06CC\u0645 \u0634\u0648\u062F"), e()(), t(51, "div", 24)(52, "button", 25), f(53, Xe, 2, 1, "span", 26)(54, Ye, 2, 0, "span", 27), e()()()()()), a & 2) { let g; d(3), x(" ", u.isEditMode ? "\u0648\u06CC\u0631\u0627\u06CC\u0634 \u0622\u062F\u0631\u0633" : "\u0622\u062F\u0631\u0633 \u062C\u062F\u06CC\u062F", " "), d(6), l("formGroup", u.addressForm), d(19), l("ngValue", null), d(2), l("ngForOf", u.states), d(4), l("disabled", u.citiesLoading || !((g = u.addressForm.get("province")) != null && g.value)), d(), l("ngValue", null), d(2), l("ngForOf", u.cities), d(15), ae("btn-loading", u.isSubmitting), l("disabled", u.addressForm.invalid || u.isSubmitting), d(), l("ngIf", !u.isSubmitting), d(), l("ngIf", u.isSubmitting) } }, dependencies: [A, L, w, Q, z, _e, ye, G, be, Se, H, U, Ce, J, K, M, T], encapsulation: 2 }); let r = s; return r })(); var Ze = r => ["/dashboard/addresses/edit", r]; function et(r, s) { r & 1 && (t(0, "div", 9), p(1, "span", 10), e()) } function tt(r, s) { r & 1 && (t(0, "div", 11)(1, "span", 12), i(2, "location_off"), e(), t(3, "p", 13), i(4, "\u0647\u0646\u0648\u0632 \u0622\u062F\u0631\u0633\u06CC \u062B\u0628\u062A \u0646\u06A9\u0631\u062F\u0647\u200C\u0627\u06CC\u062F"), e(), t(5, "a", 14), i(6, "\u062B\u0628\u062A \u0627\u0648\u0644\u06CC\u0646 \u0622\u062F\u0631\u0633"), e()()) } function it(r, s) { r & 1 && (t(0, "span", 29), i(1, "\u067E\u06CC\u0634\u200C\u0641\u0631\u0636"), e()) } function rt(r, s) { if (r & 1) { let n = P(); t(0, "div", 17)(1, "div")(2, "div", 18)(3, "h3", 19)(4, "span", 20), i(5, "place"), e(), i(6), e(), f(7, it, 2, 0, "span", 21), e(), t(8, "p", 22), i(9), e(), t(10, "div", 23)(11, "span", 24)(12, "span", 25), i(13, "person"), e(), i(14), e(), t(15, "span", 24)(16, "span", 25), i(17, "phone"), e(), i(18), e(), t(19, "span", 24)(20, "span", 25), i(21, "markunread_mailbox"), e(), i(22), e()()(), t(23, "div", 26)(24, "a", 27)(25, "span", 4), i(26, "edit"), e(), i(27, " \u0648\u06CC\u0631\u0627\u06CC\u0634 "), e(), t(28, "button", 28), h("click", function () { let a = N(n).$implicit, u = v(2); return k(u.deleteAddress(a.id)) }), t(29, "span", 4), i(30, "delete"), e(), i(31, " \u062D\u0630\u0641 "), e()()() } if (r & 2) { let n = s.$implicit; d(6), x(" ", n.title, " "), d(), l("ngIf", n.isDefault), d(2), de(" ", n.province, "\u060C ", n.city, "\u060C ", n.address, " "), d(5), x(" ", n.receiverName), d(4), x(" ", n.phoneNumber), d(4), x(" ", n.postalCode), d(2), l("routerLink", me(9, Ze, n.id)) } } function nt(r, s) { if (r & 1 && (t(0, "div", 15), f(1, rt, 32, 11, "div", 16), e()), r & 2) { let n = v(); d(), l("ngForOf", n.addresses) } } var De = (() => { let s = class s { constructor(o, a) { this.profileService = o, this.notificationService = a, this.addresses = [], this.isLoading = !0 } ngOnInit() { this.loadAddresses() } loadAddresses() { this.isLoading = !0, this.profileService.getProfile().pipe(C(() => this.isLoading = !1)).subscribe({ next: o => { this.addresses = o.userAddresses || [] }, error: () => this.notificationService.show("\u062E\u0637\u0627 \u062F\u0631 \u0628\u0627\u0631\u06AF\u0630\u0627\u0631\u06CC \u0622\u062F\u0631\u0633\u200C\u0647\u0627", "error") }) } deleteAddress(o) { confirm("\u0622\u06CC\u0627 \u0627\u0632 \u062D\u0630\u0641 \u0627\u06CC\u0646 \u0622\u062F\u0631\u0633 \u0627\u0637\u0645\u06CC\u0646\u0627\u0646 \u062F\u0627\u0631\u06CC\u062F\u061F") && this.profileService.deleteAddress(o).subscribe({ next: () => { this.notificationService.show("\u0622\u062F\u0631\u0633 \u0628\u0627 \u0645\u0648\u0641\u0642\u06CC\u062A \u062D\u0630\u0641 \u0634\u062F", "success"), this.loadAddresses() }, error: a => this.notificationService.show(a?.error?.message || "\u062E\u0637\u0627 \u062F\u0631 \u062D\u0630\u0641 \u0622\u062F\u0631\u0633", "error") }) } }; s.\u0275fac = function (a) { return new (a || s)(c(V), c(O)) }, s.\u0275cmp = E({ type: s, selectors: [["app-user-addresses"]], decls: 12, vars: 3, consts: [[1, "flex", "flex-col", "h-full"], [1, "p-6", "border-b", "border-border", "flex", "items-center", "justify-between"], [1, "text-lg", "font-bold", "text-foreground"], ["routerLink", "/dashboard/addresses/new", 1, "btn", "btn-primary", "btn-sm"], [1, "material-icons", "text-sm", "me-1"], [1, "p-6", "flex-1"], ["class", "flex justify-center py-12", 4, "ngIf"], ["class", "empty-state border-2 border-dashed border-border rounded-xl", 4, "ngIf"], ["class", "grid grid-cols-1 lg:grid-cols-2 gap-6", 4, "ngIf"], [1, "flex", "justify-center", "py-12"], [1, "spinner", "spinner-lg", "text-primary"], [1, "empty-state", "border-2", "border-dashed", "border-border", "rounded-xl"], [1, "material-icons", "text-4xl", "text-muted-foreground/40", "mb-4"], [1, "text-foreground", "font-medium"], ["routerLink", "/dashboard/addresses/new", 1, "btn", "btn-link", "mt-2"], [1, "grid", "grid-cols-1", "lg:grid-cols-2", "gap-6"], ["class", "card-hover p-5 flex flex-col justify-between", 4, "ngFor", "ngForOf"], [1, "card-hover", "p-5", "flex", "flex-col", "justify-between"], [1, "flex", "items-center", "justify-between", "mb-3"], [1, "font-bold", "text-foreground", "flex", "items-center", "gap-2"], [1, "material-icons", "text-primary", "text-lg"], ["class", "badge badge-primary", 4, "ngIf"], [1, "text-sm", "text-muted-foreground", "leading-relaxed", "mb-4"], [1, "flex", "flex-wrap", "gap-4", "text-xs", "text-muted-foreground"], [1, "flex", "items-center", "gap-1"], [1, "material-icons", "text-sm"], [1, "border-t", "border-border", "mt-4", "pt-3", "flex", "justify-end", "gap-2"], [1, "btn", "btn-ghost", "btn-sm", "text-muted-foreground", "hover:text-primary", 3, "routerLink"], [1, "btn", "btn-ghost", "btn-sm", "text-muted-foreground", "hover:text-destructive", 3, "click"], [1, "badge", "badge-primary"]], template: function (a, u) { a & 1 && (t(0, "div", 0)(1, "div", 1)(2, "h2", 2), i(3, "\u0622\u062F\u0631\u0633\u200C\u0647\u0627\u06CC \u0645\u0646"), e(), t(4, "a", 3)(5, "span", 4), i(6, "add"), e(), i(7, " \u0627\u0641\u0632\u0648\u062F\u0646 \u0622\u062F\u0631\u0633 "), e()(), t(8, "div", 5), f(9, et, 2, 0, "div", 6)(10, tt, 7, 0, "div", 7)(11, nt, 2, 1, "div", 8), e()()), a & 2 && (d(9), l("ngIf", u.isLoading), d(), l("ngIf", !u.isLoading && (!u.addresses || u.addresses.length === 0)), d(), l("ngIf", !u.isLoading && u.addresses.length > 0)) }, dependencies: [A, L, w, M, T], encapsulation: 2 }); let r = s; return r })(); var Mt = [{ path: "", component: Ie, canActivate: [he], children: [{ path: "", redirectTo: "profile", pathMatch: "full" }, { path: "profile", component: ke }, { path: "order-history", component: Le }, { path: "order/:id", loadComponent: () => import("./chunk-WJC2SBBJ.js").then(r => r.OrderDetailPage) }, { path: "addresses", component: De }, { path: "addresses/new", component: ie }, { path: "addresses/edit/:id", component: ie }] }]; export { Mt as DASHBOARD_ROUTES };