import{a as N}from"./chunk-YV2TEDS4.js";import{a as V}from"./chunk-LJELM4NS.js";import{a as k}from"./chunk-NKWORGOE.js";import"./chunk-WNMS36QR.js";import{F as M,b as B,d as F,f as T,g as j,w as L}from"./chunk-PMZJQWMM.js";import{Db as A,Hb as I,Jb as x,Oa as b,Sa as r,Ub as i,Vb as w,Wb as a,Xb as O,Yb as D,_a as v,ba as h,ca as C,db as S,gc as u,hc as s,ic as P,qb as p,sb as m,tb as _,ub as E,vb as y,wb as f,xb as n,yb as t,zb as g}from"./chunk-OU7FPMWK.js";import"./chunk-4CLCTAJ7.js";function R(d,c){d&1&&(n(0,"div",1)(1,"span",4),i(2,"sync"),t()())}function q(d,c){d&1&&(n(0,"div",2)(1,"p",5),i(2,"\u0633\u0641\u0627\u0631\u0634 \u0645\u0648\u0631\u062F \u0646\u0638\u0631 \u06CC\u0627\u0641\u062A \u0646\u0634\u062F."),t()())}function z(d,c){d&1&&g(0,"span",27)}function U(d,c){if(d&1){let e=A();n(0,"button",26),I("click",function(){h(e);let l=x(2);return C(l.cancelOrder())}),p(1,z,1,0,"span",27),i(2," \u0644\u063A\u0648 \u0633\u0641\u0627\u0631\u0634 "),t()}if(d&2){let e=x(2);f("disabled",e.isCancelling),r(),m(e.isCancelling?1:-1)}}function $(d,c){if(d&1&&(n(0,"div",17)(1,"div",28),g(2,"img",29),t(),n(3,"div",30)(4,"h4",31),i(5),t(),n(6,"div",8),i(7),u(8,"number"),u(9,"number"),t()(),n(10,"div",32),i(11),u(12,"number"),t()()),d&2){let e=c.$implicit;r(2),f("src",(e.product==null?null:e.product.icon)||"https://via.placeholder.com/80",b),r(3),w(e.product==null?null:e.product.name),r(2),O(" ",s(8,5,e.quantity)," \u0639\u062F\u062F \xD7 ",s(9,7,e.sellingPrice)," \u062A\u0648\u0645\u0627\u0646 "),r(4),a(" ",s(12,9,e.amount)," \u062A\u0648\u0645\u0627\u0646 ")}}function G(d,c){if(d&1&&(n(0,"div",24)(1,"span"),i(2,"\u062A\u062E\u0641\u06CC\u0641"),t(),n(3,"span"),i(4),u(5,"number"),t()()),d&2){let e=x(2);r(4),a("-",s(5,1,e.order.discountAmount)," \u062A\u0648\u0645\u0627\u0646")}}function H(d,c){if(d&1&&(n(0,"div",3)(1,"div",6)(2,"div")(3,"h1",7),i(4),t(),n(5,"p",8),i(6),u(7,"date"),t()(),n(8,"div",9)(9,"span",10),u(10,"statusClass"),i(11),t(),p(12,U,3,2,"button",11),t()(),n(13,"div",12)(14,"div",13)(15,"div",14)(16,"div",15),i(17,"\u0627\u0642\u0644\u0627\u0645 \u0633\u0641\u0627\u0631\u0634"),t(),n(18,"div",16),E(19,$,13,11,"div",17,_),t()()(),n(21,"div",3)(22,"div",18)(23,"h3",19),i(24,"\u0627\u0637\u0644\u0627\u0639\u0627\u062A \u0627\u0631\u0633\u0627\u0644"),t(),n(25,"div",20)(26,"p")(27,"span",21),i(28,"\u06AF\u06CC\u0631\u0646\u062F\u0647:"),t(),i(29),t(),n(30,"p")(31,"span",21),i(32,"\u0622\u062F\u0631\u0633:"),t(),i(33),t(),n(34,"p")(35,"span",21),i(36,"\u06A9\u062F \u067E\u0633\u062A\u06CC:"),t(),i(37),t(),n(38,"p")(39,"span",21),i(40,"\u0634\u0645\u0627\u0631\u0647 \u062A\u0645\u0627\u0633:"),t(),i(41),t()()(),n(42,"div",18)(43,"h3",19),i(44,"\u0641\u0627\u06A9\u062A\u0648\u0631 \u0646\u0647\u0627\u06CC\u06CC"),t(),n(45,"div",22)(46,"div",23)(47,"span"),i(48,"\u062C\u0645\u0639 \u0627\u0642\u0644\u0627\u0645"),t(),n(49,"span"),i(50),u(51,"number"),t()(),n(52,"div",23)(53,"span"),i(54,"\u0647\u0632\u06CC\u0646\u0647 \u0627\u0631\u0633\u0627\u0644"),t(),n(55,"span"),i(56),u(57,"number"),t()(),p(58,G,6,3,"div",24),n(59,"div",25)(60,"span"),i(61,"\u0645\u0628\u0644\u063A \u06A9\u0644"),t(),n(62,"span"),i(63),u(64,"number"),t()()()()()()()),d&2){let e=x();r(4),a("\u0633\u0641\u0627\u0631\u0634 #",e.order.id),r(2),a("\u062B\u0628\u062A \u0634\u062F\u0647 \u062F\u0631 ",P(7,15,e.order.createdAt,"yyyy/MM/dd")),r(3),f("ngClass",s(10,18,e.order.orderStatus==null?null:e.order.orderStatus.name)),r(2),a(" ",(e.order.orderStatus==null?null:e.order.orderStatus.name)||"\u0646\u0627\u0645\u0634\u062E\u0635"," "),r(),m(e.canCancelOrder(e.order.orderStatus==null?null:e.order.orderStatus.name)?12:-1),r(7),y(e.order.orderItems),r(10),a(" ",e.order.addressSnapshot==null?null:e.order.addressSnapshot.receiverName),r(4),D(" ",e.order.addressSnapshot==null?null:e.order.addressSnapshot.province,"\u060C ",e.order.addressSnapshot==null?null:e.order.addressSnapshot.city,"\u060C ",e.order.addressSnapshot==null?null:e.order.addressSnapshot.address),r(4),a(" ",e.order.addressSnapshot==null?null:e.order.addressSnapshot.postalCode),r(4),a(" ",e.order.addressSnapshot==null?null:e.order.addressSnapshot.phoneNumber),r(9),a("",s(51,20,e.order.totalAmount)," \u062A\u0648\u0645\u0627\u0646"),r(6),a("",s(57,22,e.order.shippingCost)," \u062A\u0648\u0645\u0627\u0646"),r(2),m(e.order.discountAmount>0?58:-1),r(5),a("",s(64,24,e.order.finalAmount)," \u062A\u0648\u0645\u0627\u0646")}}var te=(()=>{class d{constructor(e,o,l){this.route=e,this.orderService=o,this.notificationService=l,this.order=null,this.isLoading=!0,this.isCancelling=!1}ngOnInit(){let e=this.route.snapshot.paramMap.get("id");e?(this.orderId=Number(e),this.loadOrder()):(this.isLoading=!1,this.notificationService.show("\u0634\u0646\u0627\u0633\u0647 \u0633\u0641\u0627\u0631\u0634 \u0646\u0627\u0645\u0639\u062A\u0628\u0631 \u0627\u0633\u062A","error"))}loadOrder(){this.isLoading=!0,this.orderService.getOrderById(this.orderId).subscribe({next:e=>{this.order=e,this.isLoading=!1},error:()=>{this.notificationService.show("\u062E\u0637\u0627 \u062F\u0631 \u0628\u0627\u0631\u06AF\u0630\u0627\u0631\u06CC \u062C\u0632\u0626\u06CC\u0627\u062A \u0633\u0641\u0627\u0631\u0634","error"),this.isLoading=!1}})}canCancelOrder(e){if(!e)return!1;let o=e.toLowerCase();return o.includes("pending")||o.includes("waiting")||o.includes("\u062F\u0631 \u0627\u0646\u062A\u0638\u0627\u0631")||o.includes("\u062A\u0627\u06CC\u06CC\u062F \u0634\u062F\u0647")}cancelOrder(){confirm("\u0622\u06CC\u0627 \u0645\u0637\u0645\u0626\u0646 \u0647\u0633\u062A\u06CC\u062F \u06A9\u0647 \u0645\u06CC\u200C\u062E\u0648\u0627\u0647\u06CC\u062F \u0627\u06CC\u0646 \u0633\u0641\u0627\u0631\u0634 \u0631\u0627 \u0644\u063A\u0648 \u06A9\u0646\u06CC\u062F\u061F")&&(this.isCancelling=!0,this.orderService.cancelOrder(this.orderId).subscribe({next:()=>{this.notificationService.show("\u0633\u0641\u0627\u0631\u0634 \u0628\u0627 \u0645\u0648\u0641\u0642\u06CC\u062A \u0644\u063A\u0648 \u0634\u062F","success"),this.isCancelling=!1,this.loadOrder()},error:e=>{this.isCancelling=!1,this.notificationService.show(e.error?.message||"\u062E\u0637\u0627 \u062F\u0631 \u0644\u063A\u0648 \u0633\u0641\u0627\u0631\u0634","error")}}))}static{this.\u0275fac=function(o){return new(o||d)(v(L),v(N),v(k))}}static{this.\u0275cmp=S({type:d,selectors:[["app-order-detail-page"]],decls:4,vars:3,consts:[[1,"container","py-8","max-w-5xl"],[1,"flex","justify-center","py-12"],[1,"text-center","py-12","card","border-dashed"],[1,"space-y-6"],[1,"material-icons","animate-spin","text-primary","text-3xl"],[1,"text-muted-foreground"],[1,"flex","flex-col","sm:flex-row","justify-between","items-start","sm:items-center","gap-4"],[1,"text-2xl","font-bold","text-foreground"],[1,"text-sm","text-muted-foreground","mt-1"],[1,"flex","items-center","gap-3"],[1,"px-3","py-1","text-sm","font-medium","rounded","border",3,"ngClass"],[1,"btn","btn-outline","btn-sm","text-destructive","hover:bg-destructive/10","border-destructive/30",3,"disabled"],[1,"grid","grid-cols-1","lg:grid-cols-3","gap-6"],[1,"lg:col-span-2","space-y-6"],[1,"card","overflow-hidden"],[1,"p-4","border-b","border-border","font-bold"],[1,"divide-y","divide-border"],[1,"p-4","flex","gap-4"],[1,"card","p-5"],[1,"font-bold","border-b","border-border","pb-3","mb-3"],[1,"text-sm","space-y-2","text-muted-foreground"],[1,"text-foreground","font-medium"],[1,"space-y-3","text-sm"],[1,"flex","justify-between","text-muted-foreground"],[1,"flex","justify-between","text-success"],[1,"flex","justify-between","font-bold","text-base","text-foreground","pt-3","border-t","border-border"],[1,"btn","btn-outline","btn-sm","text-destructive","hover:bg-destructive/10","border-destructive/30",3,"click","disabled"],[1,"spinner","spinner-xs","me-1"],[1,"w-16","h-16","rounded","bg-muted","flex-shrink-0","overflow-hidden","border","border-border"],[1,"w-full","h-full","object-cover",3,"src"],[1,"flex-1","min-w-0"],[1,"font-medium","text-foreground","truncate"],[1,"font-bold","text-foreground","self-center"]],template:function(o,l){o&1&&(n(0,"div",0),p(1,R,3,0,"div",1),p(2,q,3,0,"div",2),p(3,H,65,26,"div",3),t()),o&2&&(r(),m(l.isLoading?1:-1),r(),m(!l.isLoading&&!l.order?2:-1),r(),m(!l.isLoading&&l.order?3:-1))},dependencies:[j,B,M,T,F,V],encapsulation:2})}}return d})();export{te as OrderDetailPage};
