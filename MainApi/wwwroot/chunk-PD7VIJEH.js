import{a as Rt}from"./chunk-YWOBP6Z3.js";import{a as Ze}from"./chunk-LJELM4NS.js";import{a as Mt}from"./chunk-C4USK2LC.js";import{a as Bt}from"./chunk-AI7IIPS3.js";import{a as _e,b as Z,c as I,d as $,e as ae,f as Ie,g as H,h as Ce,i as se,j as ee,k as Vt,l as Ut,n as $e,o as Be,p as de,q as le,r as te,s as ie,t as ne,u as Nt,v as Ee,w as jt,x as we,y as ge,z as me}from"./chunk-BAR23WDL.js";import{b as $t}from"./chunk-EB3EXIZ5.js";import{a as Pt}from"./chunk-GAYMAGXT.js";import"./chunk-KL5Q5BU5.js";import{a as D}from"./chunk-NKWORGOE.js";import{a as Fe}from"./chunk-VFDSUV63.js";import{a as R}from"./chunk-WNMS36QR.js";import{A as Dt,F as j,b as q,d as fe,e as Xe,f as be,g as M,k as dt,l as z,o as G,w as ue,x as Lt,y as he,z as N}from"./chunk-PMZJQWMM.js";import{$b as X,Ab as w,Bb as y,Cb as Je,D as L,Db as S,Eb as Me,Hb as C,Ib as Le,Jb as l,N as He,Oa as Se,Qb as wt,Rb as Qe,Sa as a,Sb as B,T as O,Ub as n,Vb as v,Wb as x,X as W,Xb as ce,Zb as Q,_a as h,_b as Y,ba as b,bc as Ye,ca as _,cc as J,d as Te,db as k,dc as Ft,ec as kt,fc as It,gb as Et,gc as F,h as ke,hc as U,i as yt,ic as oe,ja as st,l as qe,m as Ne,pb as Ke,pc as Tt,qb as m,ra as At,s as je,sb as c,tb as T,ub as A,vb as E,wb as f,xb as i,y as Ae,yb as t,zb as g}from"./chunk-OU7FPMWK.js";import{a as Ve,b as Ue}from"./chunk-4CLCTAJ7.js";var Ot=r=>({exact:r});function Mi(r,d){if(r&1&&(i(0,"span",28),n(1),t()),r&2){let e=l().$implicit;a(),x(" ",e.badge," ")}}function Vi(r,d){if(r&1&&(i(0,"a",10,0)(2,"span",27),n(3),t(),n(4),m(5,Mi,2,1,"span",28),t()),r&2){let e=d.$implicit,o=wt(1);f("routerLink",e.link)("routerLinkActiveOptions",J(7,Ot,e.exact)),a(2),B("text-primary",o.isActive),a(),x(" ",e.icon," "),a(),x(" ",e.title," "),a(),c(e.badge?5:-1)}}function Ui(r,d){if(r&1){let e=S();i(0,"div",29),C("click",function(){b(e);let u=l();return _(u.isMobileMenuOpen=!1)}),t()}}function Ni(r,d){if(r&1){let e=S();i(0,"a",36),C("click",function(){b(e);let u=l(2);return _(u.isMobileMenuOpen=!1)}),i(1,"span",37),n(2),t(),n(3),t()}if(r&2){let e=d.$implicit;f("routerLink",e.link)("routerLinkActiveOptions",J(4,Ot,e.exact)),a(2),v(e.icon),a(),x(" ",e.title," ")}}function ji(r,d){if(r&1){let e=S();i(0,"div",26)(1,"div",30)(2,"span",31)(3,"span",32),n(4,"admin_panel_settings"),t(),n(5," \u0645\u0646\u0648\u06CC \u0645\u062F\u06CC\u0631\u06CC\u062A "),t(),i(6,"button",33),C("click",function(){b(e);let u=l();return _(u.isMobileMenuOpen=!1)}),i(7,"span",21),n(8,"close"),t()()(),i(9,"div",34)(10,"nav",9),A(11,Ni,4,6,"a",35,T),t()()()}if(r&2){let e=l();a(11),E(e.menuItems)}}var Wt=(()=>{class r{constructor(){this.isMobileMenuOpen=!1,this.menuItems=[{title:"\u062F\u0627\u0634\u0628\u0648\u0631\u062F",link:"/admin/dashboard",icon:"dashboard",exact:!0},{title:"\u0645\u062D\u0635\u0648\u0644\u0627\u062A",link:"/admin/products",icon:"inventory_2",exact:!1},{title:"\u0648\u06CC\u0698\u06AF\u06CC\u200C\u0647\u0627\u06CC \u0645\u062D\u0635\u0648\u0644",link:"/admin/attributes",icon:"tune",exact:!1},{title:"\u062F\u0633\u062A\u0647\u200C\u0628\u0646\u062F\u06CC\u200C\u0647\u0627",link:"/admin/categories",icon:"category",exact:!1},{title:"\u06AF\u0631\u0648\u0647\u200C\u0647\u0627\u06CC \u062F\u0633\u062A\u0647\u200C\u0628\u0646\u062F\u06CC",link:"/admin/category-groups",icon:"folder",exact:!1},{title:"\u0633\u0641\u0627\u0631\u0634\u0627\u062A",link:"/admin/orders",icon:"receipt_long",exact:!1},{title:"\u062A\u0631\u0627\u06A9\u0646\u0634\u200C\u0647\u0627\u06CC \u0627\u0646\u0628\u0627\u0631",link:"/admin/inventory/transactions",icon:"history",exact:!1},{title:"\u06A9\u062F\u0647\u0627\u06CC \u062A\u062E\u0641\u06CC\u0641",link:"/admin/discounts",icon:"percent",exact:!1},{title:"\u0646\u0638\u0631\u0627\u062A \u06A9\u0627\u0631\u0628\u0631\u0627\u0646",link:"/admin/reviews",icon:"reviews",exact:!1},{title:"\u06A9\u0627\u0631\u0628\u0631\u0627\u0646",link:"/admin/users",icon:"group",exact:!1},{title:"\u0648\u0636\u0639\u06CC\u062A\u200C\u0647\u0627\u06CC \u0633\u0641\u0627\u0631\u0634",link:"/admin/order-statuses",icon:"fact_check",exact:!1},{title:"\u0631\u0648\u0634\u200C\u0647\u0627\u06CC \u0627\u0631\u0633\u0627\u0644",link:"/admin/shipping-methods",icon:"local_shipping",exact:!1},{title:"\u06AF\u0632\u0627\u0631\u0634\u0627\u062A \u0633\u06CC\u0633\u062A\u0645\u06CC",link:"/admin/audit-logs",icon:"policy",exact:!1},{title:"\u062A\u06CC\u06A9\u062A\u200C\u0647\u0627\u06CC \u067E\u0634\u062A\u06CC\u0628\u0627\u0646\u06CC",link:"/admin/support/tickets",icon:"support_agent",exact:!1},{title:"\u0645\u062F\u06CC\u0631\u06CC\u062A \u062C\u0633\u062A\u062C\u0648",link:"/admin/search-management",icon:"search",exact:!1}]}static{this.\u0275fac=function(o){return new(o||r)}}static{this.\u0275cmp=k({type:r,selectors:[["app-admin-layout"]],decls:36,vars:2,consts:[["rla","routerLinkActive"],[1,"grid","min-h-screen","w-full","lg:grid-cols-[280px_1fr]","bg-muted/10"],[1,"hidden","border-l","border-border","bg-sidebar","lg:flex","lg:flex-col","sticky","top-0","h-screen","z-20","shadow-sm","transition-all","duration-300"],[1,"flex","h-header","items-center","px-6","border-b","border-border","bg-sidebar/50","backdrop-blur-sm"],["routerLink","/",1,"flex","items-center","gap-3","transition-transform","hover:scale-105","group"],[1,"w-8","h-8","rounded-lg","bg-gradient-to-br","from-primary","to-primary-600","flex","items-center","justify-center","text-primary-foreground","shadow-lg","shadow-primary/20","group-hover:shadow-primary/40","transition-shadow"],[1,"font-black","text-lg"],[1,"font-bold","text-lg","tracking-tight","text-sidebar-foreground"],[1,"flex-1","overflow-y-auto","py-6","px-4","scrollbar-thin"],[1,"space-y-1"],["routerLinkActive","bg-sidebar-active text-primary font-semibold shadow-sm",1,"flex","items-center","gap-3","rounded-lg","px-3","py-2.5","text-sm","font-medium","text-sidebar-foreground/70","transition-all","duration-200","hover:bg-sidebar-hover","hover:text-sidebar-foreground","group",3,"routerLink","routerLinkActiveOptions"],[1,"p-4","border-t","border-border","bg-sidebar/50"],[1,"flex","items-center","gap-3","rounded-xl","bg-card/50","border","border-border","p-3","shadow-sm","hover:shadow-md","transition-shadow","cursor-pointer"],[1,"avatar","avatar-md","ring-2","ring-background"],[1,"avatar-fallback","bg-primary/10","text-primary","font-bold"],[1,"avatar-status","online"],[1,"flex","flex-col","min-w-0"],[1,"text-sm","font-bold","text-foreground","truncate"],[1,"text-xs","text-muted-foreground","truncate","font-mono"],[1,"sticky","top-0","z-30","flex","h-16","items-center","gap-4","border-b","border-border","bg-background/80","px-4","backdrop-blur-md","lg:hidden"],["aria-label","Open menu",1,"btn","btn-ghost","btn-icon","-mr-2",3,"click"],[1,"material-icons"],[1,"flex","items-center","gap-2","font-bold","text-lg","text-foreground"],[1,"w-2","h-2","rounded-full","bg-primary","animate-pulse"],[1,"flex-1","p-4","sm:p-6","md:p-8","max-w-[1600px]","w-full","mx-auto","animate-fade-in"],[1,"mobile-menu-overlay"],[1,"fixed","inset-y-0","right-0","z-50","w-3/4","max-w-xs","bg-sidebar","shadow-2xl","flex","flex-col","mobile-menu-sidebar","border-l","border-border"],[1,"material-icons-outlined","text-[20px]","w-6","text-center","transition-transform","duration-200","group-hover:scale-110"],[1,"mr-auto","badge","badge-primary","text-[10px]","h-5","px-1.5","animate-pulse"],[1,"mobile-menu-overlay",3,"click"],[1,"flex","h-16","items-center","justify-between","border-b","border-border","px-6","bg-sidebar/50"],[1,"font-bold","text-lg","flex","items-center","gap-2","text-sidebar-foreground"],[1,"material-icons","text-primary"],[1,"btn","btn-ghost","btn-icon","-ml-2","text-muted-foreground","hover:text-destructive","transition-colors",3,"click"],[1,"flex-1","overflow-y-auto","py-4","px-4","scrollbar-thin"],["routerLinkActive","bg-sidebar-active text-primary font-bold shadow-sm",1,"flex","items-center","gap-3","rounded-lg","px-3","py-3","text-sm","font-medium","text-sidebar-foreground/70","transition-colors","hover:bg-sidebar-hover","hover:text-sidebar-foreground",3,"routerLink","routerLinkActiveOptions"],["routerLinkActive","bg-sidebar-active text-primary font-bold shadow-sm",1,"flex","items-center","gap-3","rounded-lg","px-3","py-3","text-sm","font-medium","text-sidebar-foreground/70","transition-colors","hover:bg-sidebar-hover","hover:text-sidebar-foreground",3,"click","routerLink","routerLinkActiveOptions"],[1,"material-icons-outlined","text-[22px]","w-6","text-center"]],template:function(o,u){o&1&&(i(0,"div",1)(1,"aside",2)(2,"div",3)(3,"a",4)(4,"div",5)(5,"span",6),n(6,"L"),t()(),i(7,"span",7),n(8,"\u067E\u0646\u0644 \u0645\u062F\u06CC\u0631\u06CC\u062A"),t()()(),i(9,"div",8)(10,"nav",9),A(11,Vi,6,9,"a",10,T),t()(),i(13,"div",11)(14,"div",12)(15,"div",13)(16,"div",14),n(17,"A"),t(),g(18,"div",15),t(),i(19,"div",16)(20,"span",17),n(21,"\u0645\u062F\u06CC\u0631 \u0633\u06CC\u0633\u062A\u0645"),t(),i(22,"span",18),n(23,"admin@ledka.ir"),t()()()()(),i(24,"div",16)(25,"header",19)(26,"button",20),C("click",function(){return u.isMobileMenuOpen=!0}),i(27,"span",21),n(28,"menu"),t()(),i(29,"div",22),g(30,"span",23),n(31," \u067E\u0646\u0644 \u0645\u062F\u06CC\u0631\u06CC\u062A "),t()(),i(32,"main",24),g(33,"router-outlet"),t()()(),m(34,Ui,1,0,"div",25),m(35,ji,13,0,"div",26)),o&2&&(a(11),E(u.menuItems),a(23),c(u.isMobileMenuOpen?34:-1),a(),c(u.isMobileMenuOpen?35:-1))},dependencies:[j,Lt,N,Dt],encapsulation:2})}}return r})();var Gt=(()=>{class r{constructor(e){this.http=e,this.apiUrl=`${R.API_URL}admin/analytics`}getDashboardStatistics(e,o){let u=new z;return e&&(u=u.set("fromDate",e.toISOString())),o&&(u=u.set("toDate",o.toISOString())),this.http.get(`${this.apiUrl}/dashboard`,{params:u})}getSalesChartData(e,o,u="day"){let s=new z().set("fromDate",e.toISOString()).set("toDate",o.toISOString()).set("groupBy",u);return this.http.get(`${this.apiUrl}/sales-chart`,{params:s})}getTopSellingProducts(e=10,o,u){let s=new z().set("count",e.toString());return o&&(s=s.set("fromDate",o.toISOString())),u&&(s=s.set("toDate",u.toISOString())),this.http.get(`${this.apiUrl}/top-products`,{params:s})}getCategoryPerformance(e,o){let u=new z;return e&&(u=u.set("fromDate",e.toISOString())),o&&(u=u.set("toDate",o.toISOString())),this.http.get(`${this.apiUrl}/category-performance`,{params:u})}getRevenueReport(e,o){let u=new z().set("fromDate",e.toISOString()).set("toDate",o.toISOString());return this.http.get(`${this.apiUrl}/revenue`,{params:u})}getInventoryReport(){return this.http.get(`${this.apiUrl}/inventory`)}static{this.\u0275fac=function(o){return new(o||r)(W(G))}}static{this.\u0275prov=O({token:r,factory:r.\u0275fac,providedIn:"root"})}}return r})();function Bi(r,d){r&1&&(i(0,"div",11)(1,"div",15),g(2,"span",16),i(3,"p",17),n(4,"\u062F\u0631 \u062D\u0627\u0644 \u062A\u062D\u0644\u06CC\u0644 \u062F\u0627\u062F\u0647\u200C\u0647\u0627..."),t()()())}function Ri(r,d){if(r&1&&(i(0,"div",36)(1,"span",37),n(2,"arrow_upward"),t(),n(3),t()),r&2){let e=l(2);a(3),x(" ",e.stats.users.newUsers," \u06A9\u0627\u0631\u0628\u0631 \u062C\u062F\u06CC\u062F ")}}function Oi(r,d){if(r&1&&(i(0,"div",12)(1,"div",18)(2,"div",19)(3,"p",20),n(4,"\u062F\u0631\u0622\u0645\u062F \u06A9\u0644"),t(),i(5,"div",21)(6,"span",22),n(7,"payments"),t()()(),i(8,"div",23)(9,"p",24),n(10),F(11,"number"),i(12,"span",25),n(13,"\u062A\u0648\u0645\u0627\u0646"),t()()()(),i(14,"div",26)(15,"div",19)(16,"p",20),n(17,"\u0633\u0648\u062F \u062E\u0627\u0644\u0635"),t(),i(18,"div",27)(19,"span",22),n(20,"trending_up"),t()()(),i(21,"div",23)(22,"p",28),n(23),F(24,"number"),i(25,"span",25),n(26,"\u062A\u0648\u0645\u0627\u0646"),t()()()(),i(27,"div",29)(28,"div",19)(29,"p",20),n(30,"\u062A\u0639\u062F\u0627\u062F \u0633\u0641\u0627\u0631\u0634\u0627\u062A"),t(),i(31,"div",30)(32,"span",22),n(33,"shopping_bag"),t()()(),i(34,"div",23)(35,"p",31),n(36),F(37,"number"),t(),i(38,"p",32)(39,"span",33),n(40,"analytics"),t(),n(41),F(42,"number"),t()()(),i(43,"div",34)(44,"div",19)(45,"p",20),n(46,"\u06A9\u0627\u0631\u0628\u0631\u0627\u0646"),t(),i(47,"div",35)(48,"span",22),n(49,"group"),t()()(),i(50,"div",23)(51,"p",31),n(52),F(53,"number"),t(),m(54,Ri,4,1,"div",36),t()()()),r&2){let e=l();a(10),x(" ",U(11,6,e.stats.orders.totalRevenue)," "),a(13),x(" ",U(24,8,e.stats.orders.totalProfit)," "),a(13),v(U(37,10,e.stats.orders.totalOrders)),a(5),x(" \u0645\u06CC\u0627\u0646\u06AF\u06CC\u0646: ",U(42,12,e.stats.orders.averageOrderValue)," "),a(11),v(U(53,14,e.stats.users.totalUsers)),a(2),c(e.stats.users.newUsers>0?54:-1)}}function Wi(r,d){if(r&1&&(i(0,"div",55)(1,"div",56)(2,"div",57)(3,"div",58),n(4),t(),i(5,"div"),n(6),F(7,"number"),t()()()()),r&2){let e=d.$implicit,o=l(2);Qe("height",o.maxRevenue>0?e.revenue/o.maxRevenue*100:0,"%"),a(4),v(e.period),a(2),v(U(7,4,e.revenue))}}function Gi(r,d){if(r&1&&(i(0,"tr",54)(1,"td",59)(2,"div",60)(3,"span",61),n(4),t()()(),i(5,"td",62)(6,"span",63),n(7),t()(),i(8,"td",64),n(9),F(10,"number"),t()()),r&2){let e=d.$implicit;a(3),f("title",e.productName),a(),x(" ",e.productName," "),a(3),v(e.totalQuantity),a(2),x(" ",U(10,4,e.totalRevenue)," ")}}function zi(r,d){r&1&&(i(0,"tr")(1,"td",65),n(2," \u062F\u0627\u062F\u0647\u200C\u0627\u06CC \u0628\u0631\u0627\u06CC \u0646\u0645\u0627\u06CC\u0634 \u0648\u062C\u0648\u062F \u0646\u062F\u0627\u0631\u062F "),t()())}function qi(r,d){if(r&1&&(i(0,"div",13)(1,"div",38)(2,"div",39)(3,"h3",40),n(4,"\u0631\u0648\u0646\u062F \u0641\u0631\u0648\u0634"),t(),i(5,"span",41),n(6,"\u062F\u0631\u0622\u0645\u062F"),t()(),i(7,"div",42),A(8,Wi,8,6,"div",43,T),t(),i(10,"div",44)(11,"span"),n(12),t(),i(13,"span"),n(14),t()()(),i(15,"div",45)(16,"div",46)(17,"h3",40),n(18,"\u0645\u062D\u0635\u0648\u0644\u0627\u062A \u067E\u0631\u0641\u0631\u0648\u0634"),t()(),i(19,"div",47)(20,"table",48)(21,"thead",49)(22,"tr",50)(23,"th",51),n(24,"\u0645\u062D\u0635\u0648\u0644"),t(),i(25,"th",52),n(26,"\u062A\u0639\u062F\u0627\u062F"),t(),i(27,"th",51),n(28,"\u062F\u0631\u0622\u0645\u062F"),t()()(),i(29,"tbody",53),A(30,Gi,11,6,"tr",54,T),m(32,zi,3,0,"tr"),t()()()()()),r&2){let e=l();a(8),E(e.salesData),a(4),v(e.salesData[0]==null?null:e.salesData[0].period),a(2),v(e.salesData[e.salesData.length-1]==null?null:e.salesData[e.salesData.length-1].period),a(16),E(e.topProducts),a(2),c(e.topProducts.length===0?32:-1)}}function Hi(r,d){if(r&1&&(i(0,"div",68),g(1,"div",69),i(2,"div",70)(3,"span",71),n(4),t(),i(5,"span",72),n(6),t()(),i(7,"div",73)(8,"div",74),n(9),F(10,"number"),i(11,"span",75),n(12,"\u062A\u0648\u0645\u0627\u0646"),t()(),i(13,"div",76)(14,"span",77),n(15,"inventory_2"),t(),n(16),t()()()),r&2){let e=d.$implicit;a(3),f("title",e.categoryName),a(),v(e.categoryName),a(2),x("",e.orderCount," \u0633\u0641\u0627\u0631\u0634"),a(3),x(" ",U(10,5,e.totalRevenue)," "),a(7),x(" ",e.totalQuantity," \u0639\u062F\u062F \u0641\u0631\u0648\u062E\u062A\u0647 \u0634\u062F\u0647 ")}}function Ki(r,d){if(r&1&&(i(0,"div",14)(1,"h3",66),n(2,"\u0639\u0645\u0644\u06A9\u0631\u062F \u062F\u0633\u062A\u0647\u200C\u0628\u0646\u062F\u06CC\u200C\u0647\u0627"),t(),i(3,"div",67),A(4,Hi,17,7,"div",68,T),t()()),r&2){let e=l();a(4),E(e.categoryPerformance)}}var zt=(()=>{class r{constructor(e){this.analyticsService=e,this.stats=null,this.salesData=[],this.topProducts=[],this.categoryPerformance=[],this.isLoading=!1,this.dateRange="month",this.maxRevenue=0}ngOnInit(){this.loadData()}loadData(){this.isLoading=!0;let{from:e,to:o}=this.getDateRange();je({stats:this.analyticsService.getDashboardStatistics(e,o).pipe(Ae(()=>ke(null))),sales:this.analyticsService.getSalesChartData(e,o,this.dateRange==="year"?"month":"day").pipe(Ae(()=>ke([]))),top:this.analyticsService.getTopSellingProducts(10,e,o).pipe(Ae(()=>ke([]))),cat:this.analyticsService.getCategoryPerformance(e,o).pipe(Ae(()=>ke([])))}).pipe(L(()=>this.isLoading=!1)).subscribe({next:u=>{this.stats=u.stats,this.salesData=u.sales||[],this.topProducts=u.top||[],this.categoryPerformance=u.cat||[],this.salesData.length>0?this.maxRevenue=Math.max(...this.salesData.map(s=>s.revenue),1):this.maxRevenue=0}})}getDateRange(){let e=new Date,o=new Date;return this.dateRange==="week"&&o.setDate(e.getDate()-7),this.dateRange==="month"&&o.setDate(e.getDate()-30),this.dateRange==="year"&&o.setFullYear(e.getFullYear()-1),{from:o,to:e}}static{this.\u0275fac=function(o){return new(o||r)(h(Gt))}}static{this.\u0275cmp=k({type:r,selectors:[["app-admin-dashboard"]],decls:20,vars:5,consts:[[1,"space-y-8","animate-fade-in"],[1,"flex","flex-col","sm:flex-row","items-center","justify-between","gap-4"],[1,"text-3xl","font-black","tracking-tight","text-heading-foreground"],[1,"flex","items-center","gap-2","bg-card","p-1","rounded-lg","border","border-border","shadow-sm"],[1,"h-9","rounded-md","border-0","bg-transparent","py-0","pl-8","pr-3","text-sm","focus:ring-0","focus:outline-none","cursor-pointer","hover:bg-muted/50","transition-colors","text-foreground",3,"ngModelChange","change","ngModel"],["value","week"],["value","month"],["value","year"],[1,"w-px","h-5","bg-border"],["title","\u0628\u0631\u0648\u0632\u0631\u0633\u0627\u0646\u06CC",1,"btn","btn-ghost","btn-sm","btn-icon","rounded-md","text-muted-foreground","hover:text-foreground",3,"click"],[1,"material-icons","text-[18px]"],[1,"flex","justify-center","items-center","min-h-[300px]"],[1,"grid","gap-6","md:grid-cols-2","lg:grid-cols-4","animate-fade-in-up"],[1,"grid","gap-6","lg:grid-cols-2","animate-fade-in-up","delay-100"],[1,"card","p-6","animate-fade-in-up","delay-200"],[1,"flex","flex-col","items-center","gap-3"],[1,"spinner","spinner-xl","text-primary"],[1,"text-sm","text-muted-foreground","animate-pulse"],[1,"stat-card","border-r-4","border-r-primary","hover-lift"],[1,"flex","items-center","justify-between"],[1,"stat-label"],[1,"icon-wrapper","icon-wrapper-sm","icon-wrapper-primary"],[1,"material-icons","text-lg"],[1,"mt-4"],[1,"stat-value","text-gradient"],[1,"text-xs","font-normal","text-muted-foreground"],[1,"stat-card","border-r-4","border-r-success","hover-lift"],[1,"icon-wrapper","icon-wrapper-sm","icon-wrapper-success"],[1,"stat-value","text-success"],[1,"stat-card","border-r-4","border-r-info","hover-lift"],[1,"icon-wrapper","icon-wrapper-sm","icon-wrapper-info"],[1,"stat-value"],[1,"text-xs","text-muted-foreground","mt-1","flex","items-center","gap-1"],[1,"material-icons","text-[14px]"],[1,"stat-card","border-r-4","border-r-warning","hover-lift"],[1,"icon-wrapper","icon-wrapper-sm","icon-wrapper-warning"],[1,"stat-change","positive","mt-1"],[1,"material-icons","text-[16px]"],[1,"card","p-6","h-full","flex","flex-col"],[1,"flex","items-center","justify-between","mb-6"],[1,"font-bold","text-lg","text-heading-foreground"],[1,"badge","badge-outline"],[1,"flex-1","min-h-[250px]","flex","items-end","gap-2","border-b","border-l","border-border/50","p-2","relative","bg-muted/5","rounded-lg"],[1,"flex-1","bg-gradient-to-t","from-primary/60","to-primary","hover:from-primary","hover:to-primary-400","transition-all","duration-300","rounded-t-sm","relative","group","cursor-pointer",3,"height"],[1,"flex","justify-between","text-xs","text-muted-foreground","mt-3","px-2","font-mono"],[1,"card","p-0","overflow-hidden","h-full","flex","flex-col"],[1,"p-6","border-b","border-border"],[1,"overflow-auto","scrollbar-thin","flex-1","max-h-[350px]"],[1,"w-full","text-sm"],[1,"bg-muted/30","sticky","top-0","z-10","backdrop-blur-sm"],[1,"text-right","text-muted-foreground","text-xs"],[1,"px-6","py-3","font-medium"],[1,"px-6","py-3","font-medium","text-center"],[1,"divide-y","divide-border/50"],[1,"group","hover:bg-muted/20","transition-colors"],[1,"flex-1","bg-gradient-to-t","from-primary/60","to-primary","hover:from-primary","hover:to-primary-400","transition-all","duration-300","rounded-t-sm","relative","group","cursor-pointer"],[1,"tooltip-content","bottom-full","left-1/2","-translate-x-1/2","mb-2","opacity-0","group-hover:opacity-100","pointer-events-none","transition-opacity"],[1,"text-center"],[1,"text-muted-foreground","text-[10px]","mb-0.5"],[1,"px-6","py-3"],[1,"flex","flex-col"],[1,"font-medium","text-foreground","truncate","max-w-[200px]",3,"title"],[1,"px-6","py-3","text-center"],[1,"badge","badge-secondary","font-mono"],[1,"px-6","py-3","font-medium","tabular-nums","text-foreground"],["colspan","3",1,"p-8","text-center","text-muted-foreground"],[1,"font-bold","text-lg","text-heading-foreground","mb-6"],[1,"grid","gap-4","sm:grid-cols-2","lg:grid-cols-3","xl:grid-cols-4"],[1,"group","p-4","rounded-xl","bg-card","border","border-border","hover:border-primary/30","hover:shadow-card-hover","transition-all","duration-300","relative","overflow-hidden"],[1,"absolute","top-0","right-0","w-16","h-16","bg-primary/5","rounded-bl-full","-mr-8","-mt-8","transition-transform","group-hover:scale-150"],[1,"flex","justify-between","items-start","mb-3","relative","z-10"],[1,"font-bold","text-foreground","truncate",3,"title"],[1,"badge","badge-outline","text-[10px]"],[1,"space-y-1","relative","z-10"],[1,"text-xl","font-black","text-primary","tabular-nums"],[1,"text-xs","text-muted-foreground","font-normal"],[1,"flex","items-center","text-xs","text-muted-foreground"],[1,"material-icons","text-[14px]","me-1"]],template:function(o,u){o&1&&(i(0,"div",0)(1,"div",1)(2,"h1",2),n(3," \u062F\u0627\u0634\u0628\u0648\u0631\u062F \u062A\u062D\u0644\u06CC\u0644\u06CC "),t(),i(4,"div",3)(5,"select",4),X("ngModelChange",function(p){return Y(u.dateRange,p)||(u.dateRange=p),p}),C("change",function(){return u.loadData()}),i(6,"option",5),n(7,"\u06F7 \u0631\u0648\u0632 \u06AF\u0630\u0634\u062A\u0647"),t(),i(8,"option",6),n(9,"\u06F3\u06F0 \u0631\u0648\u0632 \u06AF\u0630\u0634\u062A\u0647"),t(),i(10,"option",7),n(11,"\u06CC\u06A9 \u0633\u0627\u0644 \u06AF\u0630\u0634\u062A\u0647"),t()(),g(12,"div",8),i(13,"button",9),C("click",function(){return u.loadData()}),i(14,"span",10),n(15,"refresh"),t()()()(),m(16,Bi,5,0,"div",11),m(17,Oi,55,16,"div",12),m(18,qi,33,3,"div",13),m(19,Ki,6,0,"div",14),t()),o&2&&(a(5),Q("ngModel",u.dateRange),a(11),c(u.isLoading?16:-1),a(),c(!u.isLoading&&u.stats?17:-1),a(),c(u.isLoading?-1:18),a(),c(u.isLoading?-1:19))},dependencies:[M,ge,ie,ne,te,$,Ce,be],encapsulation:2})}}return r})();var Re=(()=>{class r{constructor(e){this.http=e,this.apiUrl=`${R.API_URL}admin/attributes`}getAllAttributeTypes(){return this.http.get(this.apiUrl)}getAttributeTypeById(e){return this.http.get(`${this.apiUrl}/${e}`)}createAttributeType(e){return this.http.post(this.apiUrl,e)}updateAttributeType(e,o){return this.http.put(`${this.apiUrl}/${e}`,o)}deleteAttributeType(e){return this.http.delete(`${this.apiUrl}/${e}`)}createAttributeValue(e,o){return this.http.post(`${this.apiUrl}/${e}/values`,o)}updateAttributeValue(e,o){return this.http.put(`${this.apiUrl}/values/${e}`,o)}deleteAttributeValue(e){return this.http.delete(`${this.apiUrl}/values/${e}`)}static{this.\u0275fac=function(o){return new(o||r)(W(G))}}static{this.\u0275prov=O({token:r,factory:r.\u0275fac,providedIn:"root"})}}return r})();var qt=r=>({"is-invalid":r});function Ji(r,d){r&1&&g(0,"span",26)}var mt=(()=>{class r{constructor(e,o,u,s,p){this.fb=e,this.route=o,this.router=u,this.attributeService=s,this.notificationService=p,this.isEditMode=!1,this.id=null,this.isSubmitting=!1,this.form=this.fb.group({name:["",[I.required]],displayName:["",[I.required]],sortOrder:[0],isActive:[!0]})}ngOnInit(){let e=this.route.snapshot.paramMap.get("id");e&&(this.id=+e,this.isEditMode=!0,this.loadData())}loadData(){this.id&&this.attributeService.getAttributeTypeById(this.id).subscribe({next:e=>this.form.patchValue(e),error:()=>this.router.navigate(["/admin/attributes"])})}onSubmit(){if(this.form.invalid)return;this.isSubmitting=!0,(this.isEditMode&&this.id?this.attributeService.updateAttributeType(this.id,this.form.value):this.attributeService.createAttributeType(this.form.value)).pipe(L(()=>this.isSubmitting=!1)).subscribe({next:()=>{this.notificationService.show("\u0639\u0645\u0644\u06CC\u0627\u062A \u0628\u0627 \u0645\u0648\u0641\u0642\u06CC\u062A \u0627\u0646\u062C\u0627\u0645 \u0634\u062F","success"),this.router.navigate(["/admin/attributes"])},error:o=>this.notificationService.show(o.error?.message||"\u062E\u0637\u0627","error")})}static{this.\u0275fac=function(o){return new(o||r)(h(we),h(ue),h(he),h(Re),h(D))}}static{this.\u0275cmp=k({type:r,selectors:[["app-admin-attribute-type-form"]],decls:54,vars:11,consts:[[1,"max-w-2xl","mx-auto","animate-fade-in-up"],[1,"flex","items-center","justify-between","mb-6"],[1,"text-2xl","font-bold","text-heading-foreground"],[1,"text-sm","text-muted-foreground","mt-1"],["routerLink","/admin/attributes",1,"btn","btn-outline","btn-sm","gap-2"],[1,"material-icons","text-sm"],[1,"card","p-6","space-y-6","shadow-md","border-border",3,"ngSubmit","formGroup"],[1,"grid","gap-6","md:grid-cols-2"],[1,"space-y-2","form-group"],[1,"form-label"],[1,"text-destructive"],[1,"input-group"],[1,"input-addon"],["type","text","formControlName","name","placeholder","e.g. Color",1,"input","ltr-input",3,"ngClass"],[1,"form-hint"],["type","text","formControlName","displayName","placeholder","\u0645\u062B\u0644\u0627: \u0631\u0646\u06AF",1,"input",3,"ngClass"],["type","number","formControlName","sortOrder","placeholder","0",1,"input"],[1,"flex","items-center","gap-3","p-4","bg-muted/20","rounded-lg","border","border-border/50"],[1,"flex","items-center"],["type","checkbox","id","isActive","formControlName","isActive",1,"switch"],["for","isActive",1,"switch-thumb"],["for","isActive",1,"text-sm","font-medium","cursor-pointer","select-none","text-foreground"],[1,"block","text-xs","text-muted-foreground","font-normal","mt-0.5"],[1,"flex","justify-end","gap-3","border-t","border-border","pt-6","mt-2"],["routerLink","/admin/attributes",1,"btn","btn-ghost","text-muted-foreground","hover:text-foreground"],["type","submit",1,"btn","btn-primary","min-w-[120px]","shadow-button",3,"disabled"],[1,"spinner","spinner-sm","mr-2","border-white"]],template:function(o,u){if(o&1&&(i(0,"div",0)(1,"div",1)(2,"div")(3,"h1",2),n(4),t(),i(5,"p",3),n(6," \u0627\u0637\u0644\u0627\u0639\u0627\u062A \u0648\u06CC\u0698\u06AF\u06CC \u0631\u0627 \u0648\u0627\u0631\u062F \u06A9\u0646\u06CC\u062F "),t()(),i(7,"a",4)(8,"span",5),n(9,"arrow_forward"),t(),n(10," \u0628\u0627\u0632\u06AF\u0634\u062A "),t()(),i(11,"form",6),C("ngSubmit",function(){return u.onSubmit()}),i(12,"div",7)(13,"div",8)(14,"label",9),n(15," \u0646\u0627\u0645 \u0633\u06CC\u0633\u062A\u0645\u06CC (\u0627\u0646\u06AF\u0644\u06CC\u0633\u06CC) "),i(16,"span",10),n(17,"*"),t()(),i(18,"div",11)(19,"span",12)(20,"span",5),n(21,"code"),t()(),g(22,"input",13),t(),i(23,"div",14),n(24,"\u0628\u0631\u0627\u06CC \u0627\u0633\u062A\u0641\u0627\u062F\u0647 \u062F\u0631 \u06A9\u062F\u0646\u0648\u06CC\u0633\u06CC \u0648 API"),t()(),i(25,"div",8)(26,"label",9),n(27," \u0646\u0627\u0645 \u0646\u0645\u0627\u06CC\u0634\u06CC (\u0641\u0627\u0631\u0633\u06CC) "),i(28,"span",10),n(29,"*"),t()(),i(30,"div",11)(31,"span",12)(32,"span",5),n(33,"label"),t()(),g(34,"input",15),t()()(),i(35,"div",7)(36,"div",8)(37,"label",9),n(38,"\u062A\u0631\u062A\u06CC\u0628 \u0646\u0645\u0627\u06CC\u0634"),t(),g(39,"input",16),t()(),i(40,"div",17)(41,"div",18),g(42,"input",19)(43,"label",20),t(),i(44,"label",21),n(45," \u0641\u0639\u0627\u0644 \u0633\u0627\u0632\u06CC \u0648\u06CC\u0698\u06AF\u06CC "),i(46,"span",22),n(47," \u062F\u0631 \u0635\u0648\u0631\u062A \u063A\u06CC\u0631\u0641\u0639\u0627\u0644 \u0628\u0648\u062F\u0646\u060C \u062F\u0631 \u0645\u062D\u0635\u0648\u0644\u0627\u062A \u0646\u0645\u0627\u06CC\u0634 \u062F\u0627\u062F\u0647 \u0646\u0645\u06CC\u200C\u0634\u0648\u062F "),t()()(),i(48,"div",23)(49,"a",24),n(50,"\u0627\u0646\u0635\u0631\u0627\u0641"),t(),i(51,"button",25),m(52,Ji,1,0,"span",26),n(53),t()()()()),o&2){let s,p;a(4),x(" ",u.isEditMode?"\u0648\u06CC\u0631\u0627\u06CC\u0634":"\u0627\u06CC\u062C\u0627\u062F"," \u0648\u06CC\u0698\u06AF\u06CC "),a(7),f("formGroup",u.form),a(11),f("ngClass",J(7,qt,((s=u.form.get("name"))==null?null:s.invalid)&&((s=u.form.get("name"))==null?null:s.touched))),a(12),f("ngClass",J(9,qt,((p=u.form.get("displayName"))==null?null:p.invalid)&&((p=u.form.get("displayName"))==null?null:p.touched))),a(17),f("disabled",u.form.invalid||u.isSubmitting),a(),c(u.isSubmitting?52:-1),a(),x(" ",u.isEditMode?"\u0628\u0631\u0648\u0632\u0631\u0633\u0627\u0646\u06CC":"\u0630\u062E\u06CC\u0631\u0647"," ")}},dependencies:[M,q,me,se,Z,ee,_e,$,ae,le,de,j,N],encapsulation:2})}}return r})();var Qi=r=>["/admin/attributes",r,"values"],Yi=r=>["/admin/attributes/edit",r];function Xi(r,d){if(r&1){let e=S();i(0,"tr",16)(1,"td",17),n(2),t(),i(3,"td",18),n(4),t(),i(5,"td",19),n(6),t(),i(7,"td",20)(8,"span",21),n(9),t()(),i(10,"td",20)(11,"span",22),n(12),t()(),i(13,"td",23)(14,"div",24)(15,"a",25)(16,"span",26),n(17,"list"),t()(),i(18,"a",27)(19,"span",26),n(20,"edit"),t()(),i(21,"button",28),C("click",function(){let u=b(e).$implicit,s=l();return _(s.deleteType(u.id))}),i(22,"span",26),n(23,"delete"),t()()()()()}if(r&2){let e=d.$implicit;a(2),v(e.id),a(2),v(e.displayName),a(2),v(e.name),a(3),v(e.sortOrder||0),a(2),f("ngClass",e.isActive?"badge-success":"badge-destructive"),a(),x(" ",e.isActive?"\u0641\u0639\u0627\u0644":"\u063A\u06CC\u0631\u0641\u0639\u0627\u0644"," "),a(3),f("routerLink",J(8,Qi,e.id)),a(3),f("routerLink",J(10,Yi,e.id))}}function Zi(r,d){r&1&&(i(0,"tr")(1,"td",29)(2,"div",30)(3,"div",31)(4,"span",32),n(5,"tune"),t()(),i(6,"p"),n(7,"\u0647\u06CC\u0686 \u0648\u06CC\u0698\u06AF\u06CC \u062A\u0639\u0631\u06CC\u0641 \u0646\u0634\u062F\u0647 \u0627\u0633\u062A"),t()()()())}function en(r,d){r&1&&(i(0,"tr")(1,"td",33),g(2,"span",34),t()())}var Ht=(()=>{class r{constructor(e,o){this.attributeService=e,this.notificationService=o,this.types=[],this.isLoading=!0}ngOnInit(){this.loadTypes()}loadTypes(){this.isLoading=!0,this.attributeService.getAllAttributeTypes().subscribe({next:e=>{this.types=e,this.isLoading=!1},error:()=>{this.isLoading=!1,this.notificationService.show("\u062E\u0637\u0627 \u062F\u0631 \u0628\u0627\u0631\u06AF\u0630\u0627\u0631\u06CC","error")}})}deleteType(e){confirm("\u0622\u06CC\u0627 \u0627\u0632 \u062D\u0630\u0641 \u0627\u06CC\u0646 \u0648\u06CC\u0698\u06AF\u06CC \u0627\u0637\u0645\u06CC\u0646\u0627\u0646 \u062F\u0627\u0631\u06CC\u062F\u061F")&&this.attributeService.deleteAttributeType(e).subscribe({next:()=>{this.notificationService.show("\u062D\u0630\u0641 \u0634\u062F","success"),this.loadTypes()},error:o=>this.notificationService.show(o.error?.message||"\u062E\u0637\u0627 \u062F\u0631 \u062D\u0630\u0641","error")})}static{this.\u0275fac=function(o){return new(o||r)(h(Re),h(D))}}static{this.\u0275cmp=k({type:r,selectors:[["app-admin-attribute-type-list"]],decls:35,vars:2,consts:[[1,"space-y-6","animate-fade-in"],[1,"flex","flex-col","sm:flex-row","sm:items-center","justify-between","gap-4"],[1,"text-2xl","font-bold","tracking-tight","text-heading-foreground","flex","items-center","gap-2"],[1,"material-icons","text-primary"],[1,"text-sm","text-muted-foreground","mt-1"],["routerLink","/admin/attributes/new",1,"btn","btn-primary","shadow-lg","shadow-primary/20","hover:shadow-primary/40","transition-all"],[1,"material-icons","text-sm"],[1,"card","overflow-hidden","border","border-border","shadow-sm"],[1,"overflow-x-auto"],[1,"w-full","text-sm","text-right"],[1,"bg-muted/50","border-b","border-border","text-muted-foreground"],[1,"px-6","py-4","font-medium","w-16"],[1,"px-6","py-4","font-medium"],[1,"px-6","py-4","font-medium","text-center","w-24"],[1,"px-6","py-4","font-medium","w-48","text-left"],[1,"divide-y","divide-border/50","bg-card"],[1,"group","hover:bg-muted/30","transition-colors"],[1,"px-6","py-4","font-mono","text-muted-foreground"],[1,"px-6","py-4","font-medium","text-foreground"],[1,"px-6","py-4","font-mono","text-muted-foreground","dir-ltr","text-right"],[1,"px-6","py-4","text-center"],[1,"badge","badge-outline","bg-background"],[1,"badge",3,"ngClass"],[1,"px-6","py-4"],[1,"flex","items-center","justify-end","gap-2","opacity-0","group-hover:opacity-100","transition-opacity"],["title","\u0645\u0642\u0627\u062F\u06CC\u0631",1,"btn","btn-icon","btn-ghost","btn-sm","text-info","hover:text-info-foreground","hover:bg-info",3,"routerLink"],[1,"material-icons","text-lg"],["title","\u0648\u06CC\u0631\u0627\u06CC\u0634",1,"btn","btn-icon","btn-ghost","btn-sm","text-primary","hover:text-primary-foreground","hover:bg-primary",3,"routerLink"],["title","\u062D\u0630\u0641",1,"btn","btn-icon","btn-ghost","btn-sm","text-muted-foreground","hover:text-destructive-foreground","hover:bg-destructive",3,"click"],["colspan","6",1,"px-6","py-12","text-center","text-muted-foreground"],[1,"flex","flex-col","items-center","gap-3"],[1,"w-12","h-12","rounded-full","bg-muted","flex","items-center","justify-center"],[1,"material-icons","text-2xl","text-muted-foreground/50"],["colspan","6",1,"p-12","text-center"],[1,"spinner","spinner-lg","text-primary"]],template:function(o,u){o&1&&(i(0,"div",0)(1,"div",1)(2,"div")(3,"h1",2)(4,"span",3),n(5,"tune"),t(),n(6," \u0645\u062F\u06CC\u0631\u06CC\u062A \u0648\u06CC\u0698\u06AF\u06CC\u200C\u0647\u0627 "),t(),i(7,"p",4),n(8,"\u062A\u0639\u0631\u06CC\u0641 \u0648\u06CC\u0698\u06AF\u06CC\u200C\u0647\u0627\u06CC \u0645\u062E\u062A\u0644\u0641 \u0628\u0631\u0627\u06CC \u0645\u062D\u0635\u0648\u0644\u0627\u062A (\u0631\u0646\u06AF\u060C \u0633\u0627\u06CC\u0632 \u0648...)"),t()(),i(9,"a",5)(10,"span",6),n(11,"add"),t(),n(12," \u0648\u06CC\u0698\u06AF\u06CC \u062C\u062F\u06CC\u062F "),t()(),i(13,"div",7)(14,"div",8)(15,"table",9)(16,"thead",10)(17,"tr")(18,"th",11),n(19,"#"),t(),i(20,"th",12),n(21,"\u0646\u0627\u0645 \u0646\u0645\u0627\u06CC\u0634\u06CC"),t(),i(22,"th",12),n(23,"\u0646\u0627\u0645 \u0633\u06CC\u0633\u062A\u0645\u06CC"),t(),i(24,"th",13),n(25,"\u062A\u0631\u062A\u06CC\u0628"),t(),i(26,"th",13),n(27,"\u0648\u0636\u0639\u06CC\u062A"),t(),i(28,"th",14),n(29,"\u0639\u0645\u0644\u06CC\u0627\u062A"),t()()(),i(30,"tbody",15),A(31,Xi,24,12,"tr",16,T),m(33,Zi,8,0,"tr"),m(34,en,3,0,"tr"),t()()()()()),o&2&&(a(31),E(u.types),a(2),c(!u.isLoading&&u.types.length===0?33:-1),a(),c(u.isLoading?34:-1))},dependencies:[M,q,j,N],encapsulation:2})}}return r})();function tn(r,d){if(r&1&&g(0,"div",34),r&2){let e=l().$implicit;Qe("background-color",e.hexCode),f("title",e.hexCode)}}function nn(r,d){r&1&&(i(0,"span",27),n(1,"-"),t())}function rn(r,d){if(r&1){let e=S();i(0,"tr",21)(1,"td",22),n(2),t(),i(3,"td",23),n(4),t(),i(5,"td",24),n(6),t(),i(7,"td",25),m(8,tn,1,3,"div",26),m(9,nn,2,0,"span",27),t(),i(10,"td",25)(11,"span",28),n(12),t()(),i(13,"td",29)(14,"div",30)(15,"button",31),C("click",function(){let u=b(e).$implicit,s=l(2);return _(s.openEditModal(u))}),i(16,"span",32),n(17,"edit"),t()(),i(18,"button",33),C("click",function(){let u=b(e).$implicit,s=l(2);return _(s.deleteValue(u.id))}),i(19,"span",32),n(20,"delete"),t()()()()()}if(r&2){let e=d.$implicit;a(2),v(e.id),a(2),v(e.displayValue),a(2),v(e.value),a(2),c(e.hexCode?8:-1),a(),c(e.hexCode?-1:9),a(3),v(e.sortOrder||0)}}function on(r,d){r&1&&(i(0,"tr")(1,"td",35)(2,"p"),n(3,"\u0647\u06CC\u0686 \u0645\u0642\u062F\u0627\u0631\u06CC \u0628\u0631\u0627\u06CC \u0627\u06CC\u0646 \u0648\u06CC\u0698\u06AF\u06CC \u062B\u0628\u062A \u0646\u0634\u062F\u0647 \u0627\u0633\u062A"),t()()())}function un(r,d){if(r&1){let e=S();i(0,"div",0)(1,"div",2)(2,"div")(3,"div",3)(4,"a",4),n(5,"\u0648\u06CC\u0698\u06AF\u06CC\u200C\u0647\u0627"),t(),i(6,"span",5),n(7,"chevron_left"),t(),i(8,"span"),n(9),t()(),i(10,"h1",6),n(11," \u0645\u0642\u0627\u062F\u06CC\u0631 \u0648\u06CC\u0698\u06AF\u06CC: "),i(12,"span",7),n(13),t()()(),i(14,"div",8)(15,"a",9),n(16,"\u0628\u0627\u0632\u06AF\u0634\u062A"),t(),i(17,"button",10),C("click",function(){b(e);let u=l();return _(u.openAddModal())}),i(18,"span",11),n(19,"add"),t(),n(20," \u0645\u0642\u062F\u0627\u0631 \u062C\u062F\u06CC\u062F "),t()()(),i(21,"div",12)(22,"div",13)(23,"table",14)(24,"thead",15)(25,"tr")(26,"th",16),n(27,"#"),t(),i(28,"th",17),n(29,"\u0645\u0642\u062F\u0627\u0631 \u0646\u0645\u0627\u06CC\u0634\u06CC"),t(),i(30,"th",17),n(31,"\u06A9\u062F/\u0645\u0642\u062F\u0627\u0631"),t(),i(32,"th",18),n(33,"\u0631\u0646\u06AF (\u0627\u062E\u062A\u06CC\u0627\u0631\u06CC)"),t(),i(34,"th",18),n(35,"\u062A\u0631\u062A\u06CC\u0628"),t(),i(36,"th",19),n(37,"\u0639\u0645\u0644\u06CC\u0627\u062A"),t()()(),i(38,"tbody",20),A(39,rn,21,6,"tr",21,T),m(41,on,4,0,"tr"),t()()()()()}if(r&2){let e=l();a(9),v(e.attributeType.displayName),a(4),v(e.attributeType.displayName),a(26),E(e.attributeValues),a(2),c(e.attributeValues.length===0?41:-1)}}function an(r,d){r&1&&g(0,"span",54)}function sn(r,d){if(r&1){let e=S();i(0,"div",1)(1,"div",36)(2,"div",37)(3,"h3",38),n(4),t(),i(5,"button",39),C("click",function(){b(e);let u=l();return _(u.closeModal())}),i(6,"span",40),n(7,"close"),t()()(),i(8,"div",41)(9,"form",42),C("ngSubmit",function(){b(e);let u=l();return _(u.onSubmit())}),i(10,"div",43)(11,"label",44),n(12,"\u0645\u0642\u062F\u0627\u0631 \u0646\u0645\u0627\u06CC\u0634\u06CC "),i(13,"span",45),n(14,"*"),t()(),g(15,"input",46),t(),i(16,"div",43)(17,"label",44),n(18,"\u0645\u0642\u062F\u0627\u0631 \u0633\u06CC\u0633\u062A\u0645\u06CC/\u06A9\u062F "),i(19,"span",45),n(20,"*"),t()(),g(21,"input",47),t(),i(22,"div",43)(23,"label",44),n(24,"\u06A9\u062F \u0631\u0646\u06AF (\u0627\u062E\u062A\u06CC\u0627\u0631\u06CC)"),t(),i(25,"div",8),g(26,"input",48)(27,"input",49),t()(),i(28,"div",43)(29,"label",44),n(30,"\u062A\u0631\u062A\u06CC\u0628 \u0646\u0645\u0627\u06CC\u0634"),t(),g(31,"input",50),t()()(),i(32,"div",51)(33,"button",52),C("click",function(){b(e);let u=l();return _(u.closeModal())}),n(34,"\u0627\u0646\u0635\u0631\u0627\u0641"),t(),i(35,"button",53),C("click",function(){b(e);let u=l();return _(u.onSubmit())}),m(36,an,1,0,"span",54),n(37," \u0630\u062E\u06CC\u0631\u0647 "),t()()()()}if(r&2){let e=l();a(4),x("",e.isEditMode?"\u0648\u06CC\u0631\u0627\u06CC\u0634":"\u0627\u0641\u0632\u0648\u062F\u0646"," \u0645\u0642\u062F\u0627\u0631"),a(5),f("formGroup",e.form),a(26),f("disabled",e.form.invalid||e.isSubmitting),a(),c(e.isSubmitting?36:-1)}}var Kt=(()=>{class r{constructor(e,o,u,s){this.route=e,this.attributeService=o,this.notificationService=u,this.fb=s,this.attributeType=null,this.attributeValues=[],this.isModalOpen=!1,this.isEditMode=!1,this.isSubmitting=!1,this.editingId=null,this.typeId=0,this.form=this.fb.group({value:["",I.required],displayValue:["",I.required],hexCode:[""],sortOrder:[0]})}ngOnInit(){let e=this.route.snapshot.paramMap.get("id");e&&(this.typeId=+e,this.loadData())}loadData(){this.attributeService.getAttributeTypeById(this.typeId).subscribe({next:e=>{this.attributeType=e,this.attributeValues=e.values||[]},error:()=>this.notificationService.show("\u062E\u0637\u0627 \u062F\u0631 \u062F\u0631\u06CC\u0627\u0641\u062A \u0627\u0637\u0644\u0627\u0639\u0627\u062A","error")})}openAddModal(){this.isEditMode=!1,this.editingId=null,this.form.reset({sortOrder:0}),this.isModalOpen=!0}openEditModal(e){this.isEditMode=!0,this.editingId=e.id,this.form.patchValue(e),this.isModalOpen=!0}closeModal(){this.isModalOpen=!1}onSubmit(){if(this.form.invalid)return;this.isSubmitting=!0;let e=Ue(Ve({},this.form.value),{attributeTypeId:this.typeId});(this.isEditMode&&this.editingId?this.attributeService.updateAttributeValue(this.editingId,e):this.attributeService.createAttributeValue(this.typeId,e)).pipe(L(()=>this.isSubmitting=!1)).subscribe({next:()=>{this.notificationService.show("\u0639\u0645\u0644\u06CC\u0627\u062A \u0628\u0627 \u0645\u0648\u0641\u0642\u06CC\u062A \u0627\u0646\u062C\u0627\u0645 \u0634\u062F","success"),this.closeModal(),this.loadData()},error:u=>this.notificationService.show(u.error?.message||"\u062E\u0637\u0627 \u062F\u0631 \u0630\u062E\u06CC\u0631\u0647 \u0633\u0627\u0632\u06CC","error")})}deleteValue(e){confirm("\u0622\u06CC\u0627 \u0627\u0632 \u062D\u0630\u0641 \u0627\u06CC\u0646 \u0645\u0642\u062F\u0627\u0631 \u0627\u0637\u0645\u06CC\u0646\u0627\u0646 \u062F\u0627\u0631\u06CC\u062F\u061F")&&this.attributeService.deleteAttributeValue(e).subscribe({next:()=>{this.notificationService.show("\u062D\u0630\u0641 \u0628\u0627 \u0645\u0648\u0641\u0642\u06CC\u062A \u0627\u0646\u062C\u0627\u0645 \u0634\u062F","success"),this.loadData()},error:()=>this.notificationService.show("\u062E\u0637\u0627 \u062F\u0631 \u062D\u0630\u0641","error")})}static{this.\u0275fac=function(o){return new(o||r)(h(ue),h(Re),h(D),h(we))}}static{this.\u0275cmp=k({type:r,selectors:[["app-admin-attribute-values"]],decls:2,vars:2,consts:[[1,"space-y-6","animate-fade-in"],[1,"modal-overlay"],[1,"flex","flex-col","sm:flex-row","sm:items-center","justify-between","gap-4"],[1,"flex","items-center","gap-2","text-muted-foreground","text-sm","mb-1"],["routerLink","/admin/attributes",1,"hover:text-primary","transition-colors"],[1,"material-icons","text-[10px]","rtl:rotate-180"],[1,"text-2xl","font-bold","tracking-tight","text-heading-foreground","flex","items-center","gap-2"],[1,"text-primary"],[1,"flex","gap-2"],["routerLink","/admin/attributes",1,"btn","btn-outline","btn-sm"],[1,"btn","btn-primary","btn-sm","shadow-lg","shadow-primary/20",3,"click"],[1,"material-icons","text-sm","mr-1"],[1,"card","overflow-hidden","border","border-border","shadow-sm"],[1,"overflow-x-auto"],[1,"w-full","text-sm","text-right"],[1,"bg-muted/50","border-b","border-border","text-muted-foreground"],[1,"px-6","py-4","font-medium","w-16"],[1,"px-6","py-4","font-medium"],[1,"px-6","py-4","font-medium","w-32","text-center"],[1,"px-6","py-4","font-medium","w-32","text-left"],[1,"divide-y","divide-border/50","bg-card"],[1,"group","hover:bg-muted/30","transition-colors"],[1,"px-6","py-4","font-mono","text-muted-foreground"],[1,"px-6","py-4","font-medium","text-foreground"],[1,"px-6","py-4","text-muted-foreground","dir-ltr","text-right","font-mono"],[1,"px-6","py-4","text-center"],[1,"w-6","h-6","rounded-full","border","border-border","shadow-sm","mx-auto",3,"background-color","title"],[1,"text-muted-foreground","text-xs"],[1,"text-muted-foreground"],[1,"px-6","py-4"],[1,"flex","items-center","justify-end","gap-2","opacity-0","group-hover:opacity-100","transition-opacity"],[1,"btn","btn-icon","btn-ghost","btn-sm","text-primary","hover:text-primary-foreground","hover:bg-primary",3,"click"],[1,"material-icons","text-lg"],[1,"btn","btn-icon","btn-ghost","btn-sm","text-muted-foreground","hover:text-destructive-foreground","hover:bg-destructive",3,"click"],[1,"w-6","h-6","rounded-full","border","border-border","shadow-sm","mx-auto",3,"title"],["colspan","6",1,"px-6","py-12","text-center","text-muted-foreground"],[1,"modal","animate-scale-in"],[1,"modal-header"],[1,"font-bold","text-lg","text-heading-foreground"],[1,"btn","btn-ghost","btn-icon","btn-sm","rounded-full",3,"click"],[1,"material-icons"],[1,"modal-body"],[1,"space-y-4",3,"ngSubmit","formGroup"],[1,"space-y-2"],[1,"text-sm","font-medium","text-foreground"],[1,"text-destructive"],["type","text","formControlName","displayValue","placeholder","\u0645\u062B\u0644\u0627: \u0642\u0631\u0645\u0632","autofocus","",1,"input","w-full"],["type","text","formControlName","value","placeholder","e.g. #FF0000 or red",1,"input","w-full","ltr-input"],["type","color","formControlName","hexCode",1,"h-10","w-12","p-1","rounded","border","border-input","cursor-pointer","bg-background"],["type","text","formControlName","hexCode","placeholder","#000000",1,"input","flex-1","ltr-input","uppercase"],["type","number","formControlName","sortOrder","placeholder","0",1,"input","w-full"],[1,"modal-footer","bg-muted/10"],[1,"btn","btn-ghost","btn-sm",3,"click"],[1,"btn","btn-primary","btn-sm","min-w-[80px]",3,"click","disabled"],[1,"spinner","spinner-sm","mr-2","border-white"]],template:function(o,u){o&1&&(m(0,un,42,3,"div",0),m(1,sn,38,4,"div",1)),o&2&&(c(u.attributeType?0:-1),a(),c(u.isModalOpen?1:-1))},dependencies:[me,se,Z,ee,$,ae,le,de,j,N],encapsulation:2})}}return r})();var Jt=(()=>{class r{constructor(e){this.http=e,this.auditUrl=`${R.API_URL}admin/audit-logs`}getAuditLogs(e){let o=new z;return Object.keys(e).forEach(u=>{let s=e[u];s!=null&&s!==""&&(o=o.set(u,s.toString()))}),this.http.get(this.auditUrl,{params:o})}exportCsv(e){let o=new z;return e.userId!=null&&(o=o.set("userId",e.userId.toString())),e.eventType&&(o=o.set("eventType",e.eventType)),e.from&&(o=o.set("from",e.from)),e.to&&(o=o.set("to",e.to)),e.maxRows&&(o=o.set("maxRows",e.maxRows.toString())),this.http.get(`${this.auditUrl}/export/csv`,{params:o,responseType:"blob"})}getStatistics(e,o){let u=new z;return e&&(u=u.set("from",e)),o&&(u=u.set("to",o)),this.http.get(`${this.auditUrl}/statistics`,{params:u})}exportJson(e){let o=new z;return e.userId!=null&&(o=o.set("userId",e.userId.toString())),e.eventType&&(o=o.set("eventType",e.eventType)),e.from&&(o=o.set("from",e.from)),e.to&&(o=o.set("to",e.to)),e.maxRows&&(o=o.set("maxRows",e.maxRows.toString())),this.http.get(`${this.auditUrl}/export/json`,{params:o,responseType:"blob"})}getEventTypes(){return this.http.get(`${this.auditUrl}/event-types`)}static{this.\u0275fac=function(o){return new(o||r)(W(G))}}static{this.\u0275prov=O({token:r,factory:r.\u0275fac,providedIn:"root"})}}return r})();function ln(r,d){r&1&&g(0,"span",7)}function mn(r,d){r&1&&(i(0,"span",8),n(1,"download"),t())}function cn(r,d){r&1&&(i(0,"tr")(1,"td",36)(2,"div",37),g(3,"span",38),t()()())}function pn(r,d){if(r&1&&(i(0,"tr",34)(1,"td",39),n(2),F(3,"date"),t(),i(4,"td",40)(5,"div",41)(6,"span",42),n(7),t(),i(8,"span",43),n(9),t()()(),i(10,"td",40)(11,"span",44),n(12),t()(),i(13,"td",45),n(14),t(),i(15,"td",46),n(16),t(),i(17,"td",47),n(18),t()()),r&2){let e=d.$implicit;a(2),x(" ",oe(3,9,e.timestamp,"yyyy/MM/dd HH:mm:ss")," "),a(5),x(" ",(e.userName||"?").charAt(0)," "),a(),f("title",e.userName),a(),v(e.userName||"System"),a(3),v(e.eventType),a(2),v(e.action),a(),f("title",e.details),a(),x(" ",e.details," "),a(2),x(" ",e.ipAddress," ")}}function fn(r,d){r&1&&(i(0,"tr")(1,"td",48)(2,"div",49)(3,"span",50),n(4,"history_toggle_off"),t(),i(5,"p"),n(6,"\u0647\u06CC\u0686 \u06AF\u0632\u0627\u0631\u0634\u06CC \u06CC\u0627\u0641\u062A \u0646\u0634\u062F"),t()()()())}function gn(r,d){if(r&1){let e=S();i(0,"div",35)(1,"button",51),C("click",function(){b(e);let u=l();return _(u.changePage(u.logs.page-1))}),n(2," \u0642\u0628\u0644\u06CC "),t(),i(3,"span",52),n(4),t(),i(5,"button",51),C("click",function(){b(e);let u=l();return _(u.changePage(u.logs.page+1))}),n(6," \u0628\u0639\u062F\u06CC "),t()()}if(r&2){let e=l();a(),f("disabled",e.logs.page===1),a(3),ce("\u0635\u0641\u062D\u0647 ",e.logs.page," \u0627\u0632 ",e.logs.totalPages),a(),f("disabled",e.logs.page===e.logs.totalPages)}}var Qt=(()=>{class r{constructor(e){this.auditService=e,this.logs=null,this.isLoading=!1,this.filters={page:1,pageSize:20},this.isExporting=!1}ngOnInit(){this.loadLogs()}loadLogs(){this.isLoading=!0,this.auditService.getAuditLogs(this.filters).pipe(L(()=>this.isLoading=!1)).subscribe({next:e=>this.logs=e,error:e=>console.error(e)})}applyFilters(){this.filters.page=1,this.loadLogs()}changePage(e){this.filters.page=e,this.loadLogs()}exportCsv(){this.isExporting=!0,this.auditService.exportCsv({userId:this.filters.userId,eventType:this.filters.eventType,from:this.filters.fromDate,to:this.filters.toDate}).pipe(L(()=>this.isExporting=!1)).subscribe({next:e=>{let o=URL.createObjectURL(e),u=document.createElement("a");u.href=o,u.download=`audit_logs_${new Date().toISOString().slice(0,10)}.csv`,u.click(),URL.revokeObjectURL(o)},error:()=>console.error("\u062E\u0637\u0627 \u062F\u0631 \u062F\u0631\u06CC\u0627\u0641\u062A \u0641\u0627\u06CC\u0644 CSV")})}static{this.\u0275fac=function(o){return new(o||r)(h(Jt))}}static{this.\u0275cmp=k({type:r,selectors:[["app-admin-audit-logs"]],decls:70,vars:10,consts:[[1,"space-y-6","animate-fade-in"],[1,"flex","items-center","justify-between"],[1,"text-2xl","font-bold","tracking-tight","text-heading-foreground","flex","items-center","gap-2"],[1,"material-icons","text-primary"],[1,"text-sm","text-muted-foreground","mt-1"],[1,"flex","gap-2"],[1,"btn","btn-outline","btn-sm","gap-2",3,"click","disabled"],[1,"spinner","spinner-xs"],[1,"material-icons","text-sm"],[1,"btn","btn-outline","btn-sm","gap-2",3,"click"],[1,"card","p-4","border","border-border","shadow-sm","bg-muted/10"],[1,"grid","grid-cols-1","md:grid-cols-4","gap-4"],[1,"space-y-1.5"],[1,"text-xs","font-medium","text-muted-foreground"],["type","number","placeholder","User ID",1,"input","input-sm","w-full","bg-background",3,"ngModelChange","ngModel"],[1,"input","input-sm","w-full","bg-background",3,"ngModelChange","ngModel"],[3,"ngValue"],["value","Authentication"],["value","Order"],["value","Product"],["value","Security"],["type","date",1,"input","input-sm","w-full","bg-background","ltr-input",3,"ngModelChange","ngModel"],[1,"flex","items-end"],[1,"btn","btn-primary","btn-sm","w-full","shadow-sm",3,"click"],[1,"material-icons","text-sm","mr-1"],[1,"card","overflow-hidden","border","border-border","shadow-sm"],[1,"overflow-x-auto"],[1,"w-full","text-sm","text-right"],[1,"bg-muted/50","border-b","border-border","text-muted-foreground"],[1,"px-6","py-4","font-medium","w-48"],[1,"px-6","py-4","font-medium","w-32"],[1,"px-6","py-4","font-medium"],[1,"px-6","py-4","font-medium","w-32","text-center"],[1,"divide-y","divide-border/50","bg-card"],[1,"group","hover:bg-muted/30","transition-colors","text-xs","sm:text-sm"],[1,"p-4","border-t","border-border","flex","items-center","justify-between","bg-muted/10"],["colspan","6",1,"p-8","text-center"],[1,"flex","justify-center"],[1,"spinner","spinner-md","text-primary"],[1,"px-6","py-4","whitespace-nowrap","text-muted-foreground","dir-ltr","text-right"],[1,"px-6","py-4"],[1,"flex","items-center","gap-2"],[1,"w-6","h-6","rounded-full","bg-muted","flex","items-center","justify-center","text-xs","font-bold","text-muted-foreground"],[1,"truncate","max-w-[100px]","text-foreground",3,"title"],[1,"badge","badge-outline","text-[10px]","font-mono"],[1,"px-6","py-4","font-medium","text-foreground"],[1,"px-6","py-4","text-muted-foreground","truncate","max-w-[200px]",3,"title"],[1,"px-6","py-4","text-center","font-mono","text-muted-foreground","text-xs"],["colspan","6",1,"p-12","text-center","text-muted-foreground"],[1,"flex","flex-col","items-center","gap-3","opacity-50"],[1,"material-icons","text-4xl"],[1,"btn","btn-outline","btn-sm",3,"click","disabled"],[1,"text-xs","text-muted-foreground"]],template:function(o,u){o&1&&(i(0,"div",0)(1,"div",1)(2,"div")(3,"h1",2)(4,"span",3),n(5,"policy"),t(),n(6," \u06AF\u0632\u0627\u0631\u0634\u0627\u062A \u0633\u06CC\u0633\u062A\u0645\u06CC "),t(),i(7,"p",4),n(8,"\u0631\u0647\u06AF\u06CC\u0631\u06CC \u0641\u0639\u0627\u0644\u06CC\u062A \u06A9\u0627\u0631\u0628\u0631\u0627\u0646 \u0648 \u062A\u063A\u06CC\u06CC\u0631\u0627\u062A \u0633\u06CC\u0633\u062A\u0645"),t()(),i(9,"div",5)(10,"button",6),C("click",function(){return u.exportCsv()}),m(11,ln,1,0,"span",7),m(12,mn,2,0,"span",8),n(13," \u062E\u0631\u0648\u062C\u06CC CSV "),t(),i(14,"button",9),C("click",function(){return u.loadLogs()}),i(15,"span",8),n(16,"refresh"),t(),n(17," \u0628\u0631\u0648\u0632\u0631\u0633\u0627\u0646\u06CC "),t()()(),i(18,"div",10)(19,"div",11)(20,"div",12)(21,"label",13),n(22,"\u0634\u0646\u0627\u0633\u0647 \u06A9\u0627\u0631\u0628\u0631"),t(),i(23,"input",14),X("ngModelChange",function(p){return Y(u.filters.userId,p)||(u.filters.userId=p),p}),t()(),i(24,"div",12)(25,"label",13),n(26,"\u0646\u0648\u0639 \u0631\u0648\u06CC\u062F\u0627\u062F"),t(),i(27,"select",15),X("ngModelChange",function(p){return Y(u.filters.eventType,p)||(u.filters.eventType=p),p}),i(28,"option",16),n(29,"\u0647\u0645\u0647"),t(),i(30,"option",17),n(31,"\u0627\u062D\u0631\u0627\u0632 \u0647\u0648\u06CC\u062A"),t(),i(32,"option",18),n(33,"\u0633\u0641\u0627\u0631\u0634\u0627\u062A"),t(),i(34,"option",19),n(35,"\u0645\u062D\u0635\u0648\u0644\u0627\u062A"),t(),i(36,"option",20),n(37,"\u0627\u0645\u0646\u06CC\u062A"),t()()(),i(38,"div",12)(39,"label",13),n(40,"\u0627\u0632 \u062A\u0627\u0631\u06CC\u062E"),t(),i(41,"input",21),X("ngModelChange",function(p){return Y(u.filters.fromDate,p)||(u.filters.fromDate=p),p}),t()(),i(42,"div",22)(43,"button",23),C("click",function(){return u.applyFilters()}),i(44,"span",24),n(45,"filter_list"),t(),n(46," \u0627\u0639\u0645\u0627\u0644 \u0641\u06CC\u0644\u062A\u0631 "),t()()()(),i(47,"div",25)(48,"div",26)(49,"table",27)(50,"thead",28)(51,"tr")(52,"th",29),n(53,"\u0632\u0645\u0627\u0646"),t(),i(54,"th",30),n(55,"\u06A9\u0627\u0631\u0628\u0631"),t(),i(56,"th",30),n(57,"\u0631\u0648\u06CC\u062F\u0627\u062F"),t(),i(58,"th",29),n(59,"\u0639\u0645\u0644\u06CC\u0627\u062A"),t(),i(60,"th",31),n(61,"\u062C\u0632\u0626\u06CC\u0627\u062A"),t(),i(62,"th",32),n(63,"IP"),t()()(),i(64,"tbody",33),m(65,cn,4,0,"tr"),A(66,pn,19,12,"tr",34,T),m(68,fn,7,0,"tr"),t()()(),m(69,gn,7,4,"div",35),t()()),o&2&&(a(10),f("disabled",u.isExporting),a(),c(u.isExporting?11:-1),a(),c(u.isExporting?-1:12),a(11),Q("ngModel",u.filters.userId),a(4),Q("ngModel",u.filters.eventType),a(),f("ngValue",null),a(13),Q("ngModel",u.filters.fromDate),a(24),c(u.isLoading?65:-1),a(),E(u.logs==null?null:u.logs.items),a(2),c(!u.isLoading&&(!(u.logs!=null&&u.logs.items)||(u.logs==null||u.logs.items==null?null:u.logs.items.length)===0)?68:-1),a(),c(u.logs&&u.logs.totalPages>1?69:-1))},dependencies:[M,ge,ie,ne,Z,ee,te,$,Ce,fe],encapsulation:2})}}return r})();var et=(()=>{class r{constructor(e){this.http=e,this.BrandsUrl=`${R.API_URL}admin/brand`}getBrands(e,o,u,s=!1,p=1,V=10){let K=new z().set("page",p.toString()).set("pageSize",V.toString()).set("includeDeleted",s.toString());return e!==void 0&&(K=K.set("categoryId",e.toString())),o&&(K=K.set("search",o)),u!==void 0&&(K=K.set("isActive",u.toString())),this.http.get(this.BrandsUrl,{params:K})}getBrandById(e){return this.http.get(`${this.BrandsUrl}/${e}`)}createBrand(e){return this.http.post(this.BrandsUrl,e)}updateBrand(e,o){return this.http.put(`${this.BrandsUrl}/${e}`,o)}deleteBrand(e,o){let u=new z().set("categoryId",o.toString());return this.http.delete(`${this.BrandsUrl}/${e}`,{params:u})}moveBrand(e,o,u){return this.http.post(`${this.BrandsUrl}/move`,{sourceCategoryId:e,targetCategoryId:o,brandId:u})}static{this.\u0275fac=function(o){return new(o||r)(W(G))}}static{this.\u0275prov=O({token:r,factory:r.\u0275fac,providedIn:"root"})}}return r})();var Oe=(()=>{class r{constructor(e){this.http=e,this.categoriesUrl=`${R.API_URL}admin/categories`}getCategories(e,o,u=!1,s=1,p=10){let V=new z().set("page",s.toString()).set("pageSize",p.toString()).set("includeDeleted",u.toString());return e&&(V=V.set("search",e)),o!==void 0&&(V=V.set("isActive",o.toString())),this.http.get(this.categoriesUrl,{params:V})}getCategoryById(e){return this.http.get(`${this.categoriesUrl}/${e}`)}createCategory(e){return this.http.post(this.categoriesUrl,e)}updateCategory(e,o){return this.http.put(`${this.categoriesUrl}/${e}`,o)}deleteCategory(e){return this.http.delete(`${this.categoriesUrl}/${e}`)}reorderCategories(e){return this.http.post(`${this.categoriesUrl}/reorder`,{orderedCategoryIds:e})}static{this.\u0275fac=function(o){return new(o||r)(W(G))}}static{this.\u0275prov=O({token:r,factory:r.\u0275fac,providedIn:"root"})}}return r})();var Xt=r=>({"is-invalid":r});function xn(r,d){if(r&1&&(i(0,"option",12),n(1),t()),r&2){let e=d.$implicit;f("value",e.id),a(),v(e.name)}}function hn(r,d){r&1&&(i(0,"div",13),n(1," \u0627\u0646\u062A\u062E\u0627\u0628 \u062F\u0633\u062A\u0647\u200C\u0628\u0646\u062F\u06CC \u0648\u0627\u0644\u062F \u0627\u0644\u0632\u0627\u0645\u06CC \u0627\u0633\u062A "),t())}function Cn(r,d){r&1&&(i(0,"div",13),n(1,"\u0646\u0627\u0645 \u06AF\u0631\u0648\u0647 \u0627\u0644\u0632\u0627\u0645\u06CC \u0627\u0633\u062A"),t())}function vn(r,d){if(r&1&&(i(0,"div",19),g(1,"img",32),t()),r&2){let e=l();a(),f("src",e.iconPreview,Se)}}function bn(r,d){r&1&&g(0,"span",31)}var pt=(()=>{class r{constructor(e,o,u,s,p,V){this.route=e,this.router=o,this.notificationService=u,this.adminBrandService=s,this.adminCategoryService=p,this.mediaService=V,this.destroy$=new Te,this.isEditMode=!1,this.BrandId=null,this.isSubmitting=!1,this.categories=[],this.selectedFile=null,this.iconPreview=null,this.BrandForm=new Ie({name:new H("",[I.required,I.maxLength(100)]),categoryId:new H(null,[I.required]),description:new H(""),isActive:new H(!0),rowVersion:new H(null)})}ngOnInit(){this.loadCategories();let e=this.route.snapshot.paramMap.get("id");e&&(this.BrandId=Number(e),this.isEditMode=!0,this.loadBrandData())}ngOnDestroy(){this.destroy$.next(),this.destroy$.complete()}loadCategories(){this.adminCategoryService.getCategories(void 0,void 0,!1,1,100).subscribe({next:e=>{this.categories=e.items??[]},error:()=>{this.notificationService.show("\u062E\u0637\u0627 \u062F\u0631 \u0628\u0627\u0631\u06AF\u0630\u0627\u0631\u06CC \u062F\u0633\u062A\u0647\u200C\u0628\u0646\u062F\u06CC\u200C\u0647\u0627","error")}})}loadBrandData(){this.BrandId&&this.adminBrandService.getBrandById(this.BrandId).subscribe({next:e=>{this.BrandForm.patchValue({name:e.name,categoryId:e.categoryId,description:e.description??"",isActive:e.isActive,rowVersion:e.rowVersion}),this.iconPreview=e.iconUrl?this.mediaService.getMediaUrl(e.iconUrl):null},error:e=>this.notificationService.show(e?.error?.message||"\u062E\u0637\u0627 \u062F\u0631 \u0628\u0627\u0631\u06AF\u0630\u0627\u0631\u06CC \u0627\u0637\u0644\u0627\u0639\u0627\u062A \u06AF\u0631\u0648\u0647 \u062F\u0633\u062A\u0647\u200C\u0628\u0646\u062F\u06CC","error")})}onFileChange(e){let o=e.target;if(o.files&&o.files.length>0){this.selectedFile=o.files[0];let u=new FileReader;u.onload=s=>this.iconPreview=s.target.result,u.readAsDataURL(this.selectedFile)}}onSubmit(){if(this.BrandForm.invalid||this.isSubmitting)return;this.isSubmitting=!0;let e=new FormData;e.append("Name",this.BrandForm.get("name")?.value),e.append("CategoryId",this.BrandForm.get("categoryId")?.value);let o=this.BrandForm.get("description")?.value;if(o&&e.append("Description",o),this.selectedFile&&e.append("IconFile",this.selectedFile),this.isEditMode&&this.BrandId){e.append("BrandId",this.BrandId.toString());let s=this.BrandForm.get("rowVersion")?.value;s&&e.append("RowVersion",s)}(this.isEditMode&&this.BrandId?this.adminBrandService.updateBrand(this.BrandId,e):this.adminBrandService.createBrand(e).pipe(Ne(()=>{}))).pipe(L(()=>{this.isSubmitting=!1})).subscribe({next:()=>{this.notificationService.show(`\u06AF\u0631\u0648\u0647 \u062F\u0633\u062A\u0647\u200C\u0628\u0646\u062F\u06CC \u0628\u0627 \u0645\u0648\u0641\u0642\u06CC\u062A ${this.isEditMode?"\u0648\u06CC\u0631\u0627\u06CC\u0634":"\u0627\u06CC\u062C\u0627\u062F"} \u0634\u062F`,"success"),this.router.navigate(["/admin/category-groups"])},error:s=>{s.status===409?(this.notificationService.show("\u0627\u06CC\u0646 \u0631\u06A9\u0648\u0631\u062F \u062A\u0648\u0633\u0637 \u06A9\u0627\u0631\u0628\u0631 \u062F\u06CC\u06AF\u0631\u06CC \u062A\u063A\u06CC\u06CC\u0631 \u06A9\u0631\u062F\u0647 \u0627\u0633\u062A.","error"),this.loadBrandData()):this.notificationService.show(s?.error?.message||"\u062E\u0637\u0627 \u062F\u0631 \u062B\u0628\u062A \u062A\u063A\u06CC\u06CC\u0631\u0627\u062A","error")}})}static{this.\u0275fac=function(o){return new(o||r)(h(ue),h(he),h(D),h(et),h(Oe),h(Fe))}}static{this.\u0275cmp=k({type:r,selectors:[["app-admin-brand-form"]],decls:59,vars:15,consts:[[1,"max-w-2xl","mx-auto","animate-fade-in-up"],[1,"flex","items-center","justify-between","mb-6"],[1,"text-2xl","font-bold","text-heading-foreground"],["routerLink","/admin/category-groups",1,"btn","btn-outline","btn-sm","gap-2"],[1,"material-icons","text-sm"],[1,"card","p-6","space-y-6","shadow-md","border-border",3,"ngSubmit","formGroup"],[1,"space-y-4"],[1,"form-group"],[1,"form-label"],[1,"text-destructive"],["formControlName","categoryId",1,"select","w-full",3,"ngClass"],["disabled","",3,"ngValue"],[3,"value"],[1,"form-error"],[1,"input-group"],[1,"input-addon"],["type","text","formControlName","name","placeholder","\u0646\u0627\u0645 \u06AF\u0631\u0648\u0647 \u0631\u0627 \u0648\u0627\u0631\u062F \u06A9\u0646\u06CC\u062F",1,"input",3,"ngClass"],["formControlName","description","placeholder","\u062A\u0648\u0636\u06CC\u062D\u0627\u062A (\u0627\u062E\u062A\u06CC\u0627\u0631\u06CC)",1,"input","min-h-[80px]"],[1,"flex","items-center","gap-4"],[1,"w-20","h-20","rounded-lg","border","border-border","p-1","bg-muted/20"],[1,"btn","btn-outline","btn-sm","cursor-pointer"],[1,"material-icons","text-sm","mr-2"],["type","file","accept","image/*",1,"hidden",3,"change"],[1,"flex","items-center","gap-3","p-4","bg-muted/20","rounded-lg","border","border-border/50"],[1,"flex","items-center"],["type","checkbox","id","isActive","formControlName","isActive",1,"switch"],["for","isActive",1,"switch-thumb"],["for","isActive",1,"text-sm","font-medium","cursor-pointer","select-none","text-foreground"],[1,"flex","justify-end","gap-3","border-t","border-border","pt-6","mt-4"],["routerLink","/admin/category-groups",1,"btn","btn-ghost","text-muted-foreground","hover:text-foreground"],["type","submit",1,"btn","btn-primary","min-w-[120px]","shadow-button",3,"disabled"],[1,"spinner","spinner-sm","mr-2","border-white"],["alt","Icon Preview",1,"w-full","h-full","object-contain",3,"src"]],template:function(o,u){if(o&1&&(i(0,"div",0)(1,"div",1)(2,"div")(3,"h1",2),n(4),t()(),i(5,"a",3)(6,"span",4),n(7,"arrow_forward"),t(),n(8," \u0628\u0627\u0632\u06AF\u0634\u062A "),t()(),i(9,"form",5),C("ngSubmit",function(){return u.onSubmit()}),i(10,"div",6)(11,"div",7)(12,"label",8),n(13,"\u062F\u0633\u062A\u0647\u200C\u0628\u0646\u062F\u06CC \u0648\u0627\u0644\u062F "),i(14,"span",9),n(15,"*"),t()(),i(16,"select",10)(17,"option",11),n(18,"\u0627\u0646\u062A\u062E\u0627\u0628 \u06A9\u0646\u06CC\u062F..."),t(),A(19,xn,2,2,"option",12,T),t(),m(21,hn,2,0,"div",13),t(),i(22,"div",7)(23,"label",8),n(24,"\u0646\u0627\u0645 \u06AF\u0631\u0648\u0647 "),i(25,"span",9),n(26,"*"),t()(),i(27,"div",14)(28,"span",15)(29,"span",4),n(30,"folder"),t()(),g(31,"input",16),t(),m(32,Cn,2,0,"div",13),t(),i(33,"div",7)(34,"label",8),n(35,"\u062A\u0648\u0636\u06CC\u062D\u0627\u062A"),t(),g(36,"textarea",17),t(),i(37,"div",7)(38,"label",8),n(39,"\u0622\u06CC\u06A9\u0648\u0646"),t(),i(40,"div",18),m(41,vn,2,1,"div",19),i(42,"label",20)(43,"span",21),n(44,"upload"),t(),n(45," \u0627\u0646\u062A\u062E\u0627\u0628 \u062A\u0635\u0648\u06CC\u0631 "),i(46,"input",22),C("change",function(p){return u.onFileChange(p)}),t()()()(),i(47,"div",23)(48,"div",24),g(49,"input",25)(50,"label",26),t(),i(51,"label",27),n(52," \u0641\u0639\u0627\u0644 "),t()()(),i(53,"div",28)(54,"a",29),n(55,"\u0627\u0646\u0635\u0631\u0627\u0641"),t(),i(56,"button",30),m(57,bn,1,0,"span",31),n(58),t()()()()),o&2){let s,p,V,K;a(4),x(" ",u.isEditMode?"\u0648\u06CC\u0631\u0627\u06CC\u0634":"\u0627\u06CC\u062C\u0627\u062F"," \u06AF\u0631\u0648\u0647 \u062F\u0633\u062A\u0647\u200C\u0628\u0646\u062F\u06CC "),a(5),f("formGroup",u.BrandForm),a(7),f("ngClass",J(11,Xt,((s=u.BrandForm.get("categoryId"))==null?null:s.invalid)&&((s=u.BrandForm.get("categoryId"))==null?null:s.touched))),a(),f("ngValue",null),a(2),E(u.categories),a(2),c((p=u.BrandForm.get("categoryId"))!=null&&p.invalid&&((p=u.BrandForm.get("categoryId"))!=null&&p.touched)?21:-1),a(10),f("ngClass",J(13,Xt,((V=u.BrandForm.get("name"))==null?null:V.invalid)&&((V=u.BrandForm.get("name"))==null?null:V.touched))),a(),c((K=u.BrandForm.get("name"))!=null&&K.invalid&&((K=u.BrandForm.get("name"))!=null&&K.touched)?32:-1),a(9),c(u.iconPreview?41:-1),a(15),f("disabled",u.BrandForm.invalid||u.isSubmitting),a(),c(u.isSubmitting?57:-1),a(),x(" ",u.isEditMode?"\u0628\u0631\u0648\u0632\u0631\u0633\u0627\u0646\u06CC":"\u0630\u062E\u06CC\u0631\u0647"," ")}},dependencies:[M,q,me,se,ie,ne,Z,_e,te,$,ae,le,de,j,N],encapsulation:2})}}return r})();var _n=r=>["/admin/category-groups/edit",r];function Sn(r,d){if(r&1&&g(0,"img",20),r&2){let e=l().$implicit,o=l();f("src",o.getIconUrl(e),Se)}}function yn(r,d){r&1&&(i(0,"div",21)(1,"span",6),n(2,"image"),t()())}function An(r,d){if(r&1){let e=S();i(0,"tr",16)(1,"td",18)(2,"div",19),m(3,Sn,1,1,"img",20),m(4,yn,3,0,"div",21),t()(),i(5,"td",22),n(6),t(),i(7,"td",23)(8,"span",24),n(9),t()(),i(10,"td",25)(11,"span",26),n(12),t()(),i(13,"td",25)(14,"span",27),n(15),t()(),i(16,"td",18)(17,"div",28)(18,"a",29)(19,"span",30),n(20,"edit"),t()(),i(21,"button",31),C("click",function(){let u=b(e).$implicit,s=l();return _(s.deleteBrand(u.id,u.categoryId))}),i(22,"span",30),n(23,"delete"),t()()()()()}if(r&2){let e=d.$implicit;a(3),c(e.iconUrl?3:-1),a(),c(e.iconUrl?-1:4),a(2),v(e.name),a(3),v(e.categoryName),a(3),v(e.productCount),a(2),f("ngClass",e.isActive?"badge-success":"badge-destructive"),a(),x(" ",e.isActive?"\u0641\u0639\u0627\u0644":"\u063A\u06CC\u0631\u0641\u0639\u0627\u0644"," "),a(3),f("routerLink",J(8,_n,e.id))}}function En(r,d){r&1&&(i(0,"tr")(1,"td",32)(2,"p"),n(3,"\u0647\u06CC\u0686 \u06AF\u0631\u0648\u0647 \u062F\u0633\u062A\u0647\u200C\u0628\u0646\u062F\u06CC \u06CC\u0627\u0641\u062A \u0646\u0634\u062F."),t()()())}function wn(r,d){r&1&&(i(0,"div",17),g(1,"span",33),t())}var Zt=(()=>{class r{constructor(e,o,u,s){this.route=e,this.adminBrandService=o,this.notificationService=u,this.mediaService=s,this.Brands=[],this.isLoading=!0,this.categoryId=null}ngOnInit(){this.route.queryParams.subscribe(e=>{this.categoryId=e.categoryId?Number(e.categoryId):null,this.loadBrands()})}loadBrands(){this.isLoading=!0,this.adminBrandService.getBrands(this.categoryId??void 0,void 0,void 0,!1,1,100).subscribe({next:e=>{this.Brands=e.items??[],this.isLoading=!1},error:()=>{this.notificationService.show("\u062E\u0637\u0627 \u062F\u0631 \u0628\u0627\u0631\u06AF\u0630\u0627\u0631\u06CC \u06AF\u0631\u0648\u0647\u200C\u0647\u0627\u06CC \u062F\u0633\u062A\u0647\u200C\u0628\u0646\u062F\u06CC","error"),this.isLoading=!1}})}getIconUrl(e){return this.mediaService.getMediaUrl(e.iconUrl)}deleteBrand(e,o){confirm("\u0622\u06CC\u0627 \u0627\u0632 \u062D\u0630\u0641 \u0627\u06CC\u0646 \u06AF\u0631\u0648\u0647 \u062F\u0633\u062A\u0647\u200C\u0628\u0646\u062F\u06CC \u0627\u0637\u0645\u06CC\u0646\u0627\u0646 \u062F\u0627\u0631\u06CC\u062F\u061F")&&this.adminBrandService.deleteBrand(e,o).subscribe({next:()=>{this.notificationService.show("\u06AF\u0631\u0648\u0647 \u062F\u0633\u062A\u0647\u200C\u0628\u0646\u062F\u06CC \u0628\u0627 \u0645\u0648\u0641\u0642\u06CC\u062A \u062D\u0630\u0641 \u0634\u062F","success"),this.loadBrands()},error:u=>this.notificationService.show(u?.error?.message||"\u062E\u0637\u0627 \u062F\u0631 \u062D\u0630\u0641 \u06AF\u0631\u0648\u0647 \u062F\u0633\u062A\u0647\u200C\u0628\u0646\u062F\u06CC","error")})}static{this.\u0275fac=function(o){return new(o||r)(h(ue),h(et),h(D),h(Fe))}}static{this.\u0275cmp=k({type:r,selectors:[["app-admin-brand-list"]],decls:35,vars:2,consts:[[1,"space-y-6","animate-fade-in"],[1,"flex","flex-col","sm:flex-row","sm:items-center","justify-between","gap-4"],[1,"text-2xl","font-bold","tracking-tight","text-heading-foreground","flex","items-center","gap-2"],[1,"material-icons","text-primary"],[1,"text-sm","text-muted-foreground","mt-1"],["routerLink","/admin/category-groups/new",1,"btn","btn-primary","shadow-lg","shadow-primary/20","hover:shadow-primary/40","transition-all"],[1,"material-icons","text-sm"],[1,"card","overflow-hidden","border","border-border","shadow-sm"],[1,"overflow-x-auto"],[1,"w-full","text-sm","text-right"],[1,"bg-muted/50","border-b","border-border","text-muted-foreground"],[1,"px-6","py-4","font-medium","w-20"],[1,"px-6","py-4","font-medium"],[1,"px-6","py-4","font-medium","text-center","w-32"],[1,"px-6","py-4","font-medium","w-40","text-left"],[1,"divide-y","divide-border/50","bg-card"],[1,"group","hover:bg-muted/30","transition-colors"],[1,"p-12","text-center"],[1,"px-6","py-4"],[1,"w-10","h-10","rounded-lg","bg-muted/50","border","border-border","p-1","overflow-hidden"],["alt","",1,"w-full","h-full","object-contain",3,"src"],[1,"w-full","h-full","flex","items-center","justify-center","text-muted-foreground"],[1,"px-6","py-4","font-medium","text-foreground","text-base"],[1,"px-6","py-4","text-muted-foreground"],[1,"badge","badge-outline"],[1,"px-6","py-4","text-center"],[1,"font-mono","text-muted-foreground"],[1,"badge",3,"ngClass"],[1,"flex","items-center","justify-end","gap-2","opacity-0","group-hover:opacity-100","transition-opacity"],["title","\u0648\u06CC\u0631\u0627\u06CC\u0634",1,"btn","btn-icon","btn-ghost","btn-sm","text-primary","hover:text-primary-foreground","hover:bg-primary",3,"routerLink"],[1,"material-icons","text-lg"],["title","\u062D\u0630\u0641",1,"btn","btn-icon","btn-ghost","btn-sm","text-muted-foreground","hover:text-destructive-foreground","hover:bg-destructive",3,"click"],["colspan","6",1,"px-6","py-12","text-center","text-muted-foreground"],[1,"spinner","spinner-lg","text-primary"]],template:function(o,u){o&1&&(i(0,"div",0)(1,"div",1)(2,"div")(3,"h1",2)(4,"span",3),n(5,"folder"),t(),n(6," \u06AF\u0631\u0648\u0647\u200C\u0647\u0627\u06CC \u062F\u0633\u062A\u0647\u200C\u0628\u0646\u062F\u06CC "),t(),i(7,"p",4),n(8,"\u0632\u06CC\u0631\u0645\u062C\u0645\u0648\u0639\u0647\u200C\u0647\u0627\u06CC \u062F\u0633\u062A\u0647\u200C\u0628\u0646\u062F\u06CC\u200C\u0647\u0627\u06CC \u0627\u0635\u0644\u06CC"),t()(),i(9,"a",5)(10,"span",6),n(11,"add"),t(),n(12," \u06AF\u0631\u0648\u0647 \u062C\u062F\u06CC\u062F "),t()(),i(13,"div",7)(14,"div",8)(15,"table",9)(16,"thead",10)(17,"tr")(18,"th",11),n(19,"\u0622\u06CC\u06A9\u0648\u0646"),t(),i(20,"th",12),n(21,"\u0646\u0627\u0645 \u06AF\u0631\u0648\u0647"),t(),i(22,"th",12),n(23,"\u062F\u0633\u062A\u0647\u200C\u0628\u0646\u062F\u06CC \u0648\u0627\u0644\u062F"),t(),i(24,"th",13),n(25,"\u062A\u0639\u062F\u0627\u062F \u0645\u062D\u0635\u0648\u0644"),t(),i(26,"th",13),n(27,"\u0648\u0636\u0639\u06CC\u062A"),t(),i(28,"th",14),n(29,"\u0639\u0645\u0644\u06CC\u0627\u062A"),t()()(),i(30,"tbody",15),A(31,An,24,10,"tr",16,T),m(33,En,4,0,"tr"),t()()(),m(34,wn,2,0,"div",17),t()()),o&2&&(a(31),E(u.Brands),a(2),c(!u.isLoading&&u.Brands.length===0?33:-1),a(),c(u.isLoading?34:-1))},dependencies:[M,q,j,N],encapsulation:2})}}return r})();var Fn=r=>({"is-invalid":r});function kn(r,d){r&1&&(i(0,"div",13),n(1," \u0646\u0627\u0645 \u062F\u0633\u062A\u0647\u200C\u0628\u0646\u062F\u06CC \u0627\u0644\u0632\u0627\u0645\u06CC \u0627\u0633\u062A "),t())}function In(r,d){if(r&1&&(i(0,"div",17),g(1,"img",30),t()),r&2){let e=l();a(),f("src",e.getIconUrl(),Se)}}function Tn(r,d){r&1&&g(0,"span",29)}var ft=(()=>{class r{constructor(e,o,u,s,p){this.route=e,this.router=o,this.notificationService=u,this.adminCategoryService=s,this.mediaService=p,this.destroy$=new Te,this.isEditMode=!1,this.categoryId=null,this.isSubmitting=!1,this.iconPreview=null,this.selectedFile=null,this.categoryForm=new Ie({Name:new H("",[I.required,I.maxLength(100)]),Description:new H(""),SortOrder:new H(0),IsActive:new H(!0),RowVersion:new H(null)})}ngOnInit(){let e=this.route.snapshot.paramMap.get("id");e&&(this.categoryId=Number(e),this.isEditMode=!0,this.loadCategoryData())}ngOnDestroy(){this.destroy$.next(),this.destroy$.complete()}loadCategoryData(){this.categoryId&&this.adminCategoryService.getCategoryById(this.categoryId).subscribe({next:e=>{this.categoryForm.patchValue({Name:e.name,Description:e.description??"",SortOrder:e.sortOrder,IsActive:e.isActive,RowVersion:e.rowVersion}),this.iconPreview=e.iconUrl||null},error:e=>this.notificationService.show(e?.error?.message||"\u062E\u0637\u0627 \u062F\u0631 \u0628\u0627\u0631\u06AF\u0630\u0627\u0631\u06CC \u0627\u0637\u0644\u0627\u0639\u0627\u062A \u062F\u0633\u062A\u0647\u200C\u0628\u0646\u062F\u06CC","error")})}onFileChange(e){let o=e.target;if(o.files&&o.files.length>0){this.selectedFile=o.files[0];let u=new FileReader;u.onload=s=>this.iconPreview=s.target.result,u.readAsDataURL(this.selectedFile)}}onSubmit(){if(this.categoryForm.invalid||this.isSubmitting)return;this.isSubmitting=!0;let e=new FormData;e.append("Name",this.categoryForm.get("Name")?.value);let o=this.categoryForm.get("Description")?.value;o&&e.append("Description",o);let u=this.categoryForm.get("SortOrder")?.value;if(u!=null&&e.append("SortOrder",u.toString()),this.selectedFile&&e.append("IconFile",this.selectedFile),this.isEditMode&&this.categoryId){e.append("Id",this.categoryId.toString());let p=this.categoryForm.get("RowVersion")?.value;p&&e.append("RowVersion",p)}(this.isEditMode&&this.categoryId?this.adminCategoryService.updateCategory(this.categoryId,e):this.adminCategoryService.createCategory(e).pipe(Ne(()=>{}))).pipe(L(()=>{this.isSubmitting=!1})).subscribe({next:()=>{let p=`\u062F\u0633\u062A\u0647\u200C\u0628\u0646\u062F\u06CC \u0628\u0627 \u0645\u0648\u0641\u0642\u06CC\u062A ${this.isEditMode?"\u0648\u06CC\u0631\u0627\u06CC\u0634":"\u0627\u06CC\u062C\u0627\u062F"} \u0634\u062F`;this.notificationService.show(p,"success"),this.router.navigate(["/admin/categories"])},error:p=>{p.status===409?(this.notificationService.show("\u0627\u06CC\u0646 \u0631\u06A9\u0648\u0631\u062F \u062A\u0648\u0633\u0637 \u06A9\u0627\u0631\u0628\u0631 \u062F\u06CC\u06AF\u0631\u06CC \u062A\u063A\u06CC\u06CC\u0631 \u06A9\u0631\u062F\u0647 \u0627\u0633\u062A. \u0644\u0637\u0641\u0627 \u0635\u0641\u062D\u0647 \u0631\u0627 \u0631\u0641\u0631\u0634 \u06A9\u0646\u06CC\u062F.","error"),this.loadCategoryData()):this.notificationService.show(p?.error?.message||"\u062E\u0637\u0627 \u062F\u0631 \u062B\u0628\u062A \u062A\u063A\u06CC\u06CC\u0631\u0627\u062A","error")}})}getIconUrl(){return this.iconPreview?this.iconPreview.startsWith("data:")?this.iconPreview:this.mediaService.getMediaUrl(this.iconPreview):""}static{this.\u0275fac=function(o){return new(o||r)(h(ue),h(he),h(D),h(Oe),h(Fe))}}static{this.\u0275cmp=k({type:r,selectors:[["app-admin-category-form"]],decls:56,vars:10,consts:[[1,"max-w-2xl","mx-auto","animate-fade-in-up"],[1,"flex","items-center","justify-between","mb-6"],[1,"text-2xl","font-bold","text-heading-foreground"],["routerLink","/admin/categories",1,"btn","btn-outline","btn-sm","gap-2"],[1,"material-icons","text-sm"],[1,"card","p-6","space-y-6","shadow-md","border-border",3,"ngSubmit","formGroup"],[1,"space-y-4"],[1,"form-group"],[1,"form-label"],[1,"text-destructive"],[1,"input-group"],[1,"input-addon"],["type","text","formControlName","Name","placeholder","\u0646\u0627\u0645 \u062F\u0633\u062A\u0647\u200C\u0628\u0646\u062F\u06CC \u0631\u0627 \u0648\u0627\u0631\u062F \u06A9\u0646\u06CC\u062F",1,"input",3,"ngClass"],[1,"form-error"],["formControlName","Description","placeholder","\u062A\u0648\u0636\u06CC\u062D\u0627\u062A (\u0627\u062E\u062A\u06CC\u0627\u0631\u06CC)",1,"input","min-h-[80px]"],["type","number","formControlName","SortOrder","placeholder","0","min","0",1,"input"],[1,"flex","items-center","gap-4"],[1,"w-20","h-20","rounded-lg","border","border-border","p-1","bg-muted/20"],[1,"btn","btn-outline","btn-sm","cursor-pointer"],[1,"material-icons","text-sm","mr-2"],["type","file","accept","image/*",1,"hidden",3,"change"],[1,"flex","items-center","gap-3","p-4","bg-muted/20","rounded-lg","border","border-border/50"],[1,"flex","items-center"],["type","checkbox","id","isActive","formControlName","IsActive",1,"switch"],["for","isActive",1,"switch-thumb"],["for","isActive",1,"text-sm","font-medium","cursor-pointer","select-none","text-foreground"],[1,"flex","justify-end","gap-3","border-t","border-border","pt-6","mt-4"],["routerLink","/admin/categories",1,"btn","btn-ghost","text-muted-foreground","hover:text-foreground"],["type","submit",1,"btn","btn-primary","min-w-[120px]","shadow-button",3,"disabled"],[1,"spinner","spinner-sm","mr-2","border-white"],["alt","Icon Preview",1,"w-full","h-full","object-contain",3,"src"]],template:function(o,u){if(o&1&&(i(0,"div",0)(1,"div",1)(2,"div")(3,"h1",2),n(4),t()(),i(5,"a",3)(6,"span",4),n(7,"arrow_forward"),t(),n(8," \u0628\u0627\u0632\u06AF\u0634\u062A "),t()(),i(9,"form",5),C("ngSubmit",function(){return u.onSubmit()}),i(10,"div",6)(11,"div",7)(12,"label",8),n(13,"\u0646\u0627\u0645 \u062F\u0633\u062A\u0647\u200C\u0628\u0646\u062F\u06CC "),i(14,"span",9),n(15,"*"),t()(),i(16,"div",10)(17,"span",11)(18,"span",4),n(19,"category"),t()(),g(20,"input",12),t(),m(21,kn,2,0,"div",13),t(),i(22,"div",7)(23,"label",8),n(24,"\u062A\u0648\u0636\u06CC\u062D\u0627\u062A"),t(),g(25,"textarea",14),t(),i(26,"div",7)(27,"label",8),n(28,"\u062A\u0631\u062A\u06CC\u0628 \u0646\u0645\u0627\u06CC\u0634"),t(),i(29,"div",10)(30,"span",11)(31,"span",4),n(32,"sort"),t()(),g(33,"input",15),t()(),i(34,"div",7)(35,"label",8),n(36,"\u0622\u06CC\u06A9\u0648\u0646"),t(),i(37,"div",16),m(38,In,2,1,"div",17),i(39,"label",18)(40,"span",19),n(41,"upload"),t(),n(42," \u0627\u0646\u062A\u062E\u0627\u0628 \u062A\u0635\u0648\u06CC\u0631 "),i(43,"input",20),C("change",function(p){return u.onFileChange(p)}),t()()()(),i(44,"div",21)(45,"div",22),g(46,"input",23)(47,"label",24),t(),i(48,"label",25),n(49," \u0641\u0639\u0627\u0644 "),t()()(),i(50,"div",26)(51,"a",27),n(52,"\u0627\u0646\u0635\u0631\u0627\u0641"),t(),i(53,"button",28),m(54,Tn,1,0,"span",29),n(55),t()()()()),o&2){let s,p;a(4),x(" ",u.isEditMode?"\u0648\u06CC\u0631\u0627\u06CC\u0634":"\u0627\u06CC\u062C\u0627\u062F"," \u062F\u0633\u062A\u0647\u200C\u0628\u0646\u062F\u06CC "),a(5),f("formGroup",u.categoryForm),a(11),f("ngClass",J(8,Fn,((s=u.categoryForm.get("Name"))==null?null:s.invalid)&&((s=u.categoryForm.get("Name"))==null?null:s.touched))),a(),c((p=u.categoryForm.get("Name"))!=null&&p.invalid&&((p=u.categoryForm.get("Name"))!=null&&p.touched)?21:-1),a(17),c(u.iconPreview?38:-1),a(15),f("disabled",u.categoryForm.invalid||u.isSubmitting),a(),c(u.isSubmitting?54:-1),a(),x(" ",u.isEditMode?"\u0628\u0631\u0648\u0632\u0631\u0633\u0627\u0646\u06CC":"\u0630\u062E\u06CC\u0631\u0647"," ")}},dependencies:[M,q,me,se,Z,ee,_e,$,ae,Ee,le,de,j,N],encapsulation:2})}}return r})();var Ln=r=>["/admin/categories/edit",r];function Dn(r,d){if(r&1&&g(0,"img",20),r&2){let e=l().$implicit,o=l();f("src",o.getCategoryIconUrl(e),Se)}}function Pn(r,d){r&1&&(i(0,"div",21)(1,"span",6),n(2,"image"),t()())}function Mn(r,d){if(r&1){let e=S();i(0,"tr",16)(1,"td",18)(2,"div",19),m(3,Dn,1,1,"img",20),m(4,Pn,3,0,"div",21),t()(),i(5,"td",22),n(6),t(),i(7,"td",23)(8,"span",24),n(9),t()(),i(10,"td",23)(11,"span",25),n(12),t()(),i(13,"td",23)(14,"span",26),n(15),t()(),i(16,"td",18)(17,"div",27)(18,"a",28)(19,"span",29),n(20,"edit"),t()(),i(21,"button",30),C("click",function(){let u=b(e).$implicit,s=l();return _(s.deleteCategory(u.id))}),i(22,"span",29),n(23,"delete"),t()()()()()}if(r&2){let e=d.$implicit;a(3),c(e.iconUrl?3:-1),a(),c(e.iconUrl?-1:4),a(2),v(e.name),a(3),v(e.groupCount),a(3),v(e.totalProductCount),a(2),f("ngClass",e.isActive?"badge-success":"badge-destructive"),a(),x(" ",e.isActive?"\u0641\u0639\u0627\u0644":"\u063A\u06CC\u0631\u0641\u0639\u0627\u0644"," "),a(3),f("routerLink",J(8,Ln,e.id))}}function Vn(r,d){r&1&&(i(0,"tr")(1,"td",31)(2,"p"),n(3,"\u0647\u06CC\u0686 \u062F\u0633\u062A\u0647\u200C\u0628\u0646\u062F\u06CC \u06CC\u0627\u0641\u062A \u0646\u0634\u062F."),t()()())}function Un(r,d){r&1&&(i(0,"div",17),g(1,"span",32),t())}var ei=(()=>{class r{constructor(e,o,u){this.adminCategoryService=e,this.notificationService=o,this.mediaService=u,this.categories=[],this.isLoading=!0}ngOnInit(){this.loadCategories()}loadCategories(){this.isLoading=!0,this.adminCategoryService.getCategories(void 0,void 0,!1,1,100).subscribe({next:e=>{this.categories=e.items??[],this.isLoading=!1},error:()=>{this.notificationService.show("\u062E\u0637\u0627 \u062F\u0631 \u0628\u0627\u0631\u06AF\u0630\u0627\u0631\u06CC \u062F\u0633\u062A\u0647\u200C\u0628\u0646\u062F\u06CC\u200C\u0647\u0627","error"),this.isLoading=!1}})}getCategoryIconUrl(e){return this.mediaService.getMediaUrl(e.iconUrl)}deleteCategory(e){confirm("\u0622\u06CC\u0627 \u0627\u0632 \u062D\u0630\u0641 \u0627\u06CC\u0646 \u062F\u0633\u062A\u0647\u200C\u0628\u0646\u062F\u06CC \u0627\u0637\u0645\u06CC\u0646\u0627\u0646 \u062F\u0627\u0631\u06CC\u062F\u061F")&&this.adminCategoryService.deleteCategory(e).subscribe({next:()=>{this.notificationService.show("\u062F\u0633\u062A\u0647\u200C\u0628\u0646\u062F\u06CC \u0628\u0627 \u0645\u0648\u0641\u0642\u06CC\u062A \u062D\u0630\u0641 \u0634\u062F","success"),this.loadCategories()},error:o=>this.notificationService.show(o?.error?.message||o?.error?.ErrorMessage||"\u062E\u0637\u0627 \u062F\u0631 \u062D\u0630\u0641 \u062F\u0633\u062A\u0647\u200C\u0628\u0646\u062F\u06CC","error")})}static{this.\u0275fac=function(o){return new(o||r)(h(Oe),h(D),h(Fe))}}static{this.\u0275cmp=k({type:r,selectors:[["app-admin-category-list"]],decls:35,vars:2,consts:[[1,"space-y-6","animate-fade-in"],[1,"flex","flex-col","sm:flex-row","sm:items-center","justify-between","gap-4"],[1,"text-2xl","font-bold","tracking-tight","text-heading-foreground","flex","items-center","gap-2"],[1,"material-icons","text-primary"],[1,"text-sm","text-muted-foreground","mt-1"],["routerLink","/admin/categories/new",1,"btn","btn-primary","shadow-lg","shadow-primary/20","hover:shadow-primary/40","transition-all"],[1,"material-icons","text-sm"],[1,"card","overflow-hidden","border","border-border","shadow-sm"],[1,"overflow-x-auto"],[1,"w-full","text-sm","text-right"],[1,"bg-muted/50","border-b","border-border","text-muted-foreground"],[1,"px-6","py-4","font-medium","w-20"],[1,"px-6","py-4","font-medium"],[1,"px-6","py-4","font-medium","text-center","w-32"],[1,"px-6","py-4","font-medium","w-40","text-left"],[1,"divide-y","divide-border/50","bg-card"],[1,"group","hover:bg-muted/30","transition-colors"],[1,"p-12","text-center"],[1,"px-6","py-4"],[1,"w-10","h-10","rounded-lg","bg-muted/50","border","border-border","p-1","overflow-hidden"],["alt","",1,"w-full","h-full","object-contain",3,"src"],[1,"w-full","h-full","flex","items-center","justify-center","text-muted-foreground"],[1,"px-6","py-4","font-medium","text-foreground","text-base"],[1,"px-6","py-4","text-center"],[1,"badge","badge-secondary"],[1,"font-mono","text-muted-foreground"],[1,"badge",3,"ngClass"],[1,"flex","items-center","justify-end","gap-2","opacity-0","group-hover:opacity-100","transition-opacity"],["title","\u0648\u06CC\u0631\u0627\u06CC\u0634",1,"btn","btn-icon","btn-ghost","btn-sm","text-primary","hover:text-primary-foreground","hover:bg-primary",3,"routerLink"],[1,"material-icons","text-lg"],["title","\u062D\u0630\u0641",1,"btn","btn-icon","btn-ghost","btn-sm","text-muted-foreground","hover:text-destructive-foreground","hover:bg-destructive",3,"click"],["colspan","6",1,"px-6","py-12","text-center","text-muted-foreground"],[1,"spinner","spinner-lg","text-primary"]],template:function(o,u){o&1&&(i(0,"div",0)(1,"div",1)(2,"div")(3,"h1",2)(4,"span",3),n(5,"category"),t(),n(6," \u062F\u0633\u062A\u0647\u200C\u0628\u0646\u062F\u06CC\u200C\u0647\u0627 "),t(),i(7,"p",4),n(8,"\u0645\u062F\u06CC\u0631\u06CC\u062A \u062F\u0633\u062A\u0647\u200C\u0628\u0646\u062F\u06CC\u200C\u0647\u0627\u06CC \u0627\u0635\u0644\u06CC \u0645\u062D\u0635\u0648\u0644\u0627\u062A"),t()(),i(9,"a",5)(10,"span",6),n(11,"add"),t(),n(12," \u062F\u0633\u062A\u0647\u200C\u0628\u0646\u062F\u06CC \u062C\u062F\u06CC\u062F "),t()(),i(13,"div",7)(14,"div",8)(15,"table",9)(16,"thead",10)(17,"tr")(18,"th",11),n(19,"\u0622\u06CC\u06A9\u0648\u0646"),t(),i(20,"th",12),n(21,"\u0646\u0627\u0645 \u062F\u0633\u062A\u0647\u200C\u0628\u0646\u062F\u06CC"),t(),i(22,"th",13),n(23,"\u06AF\u0631\u0648\u0647\u200C\u0647\u0627\u06CC \u0632\u06CC\u0631\u0645\u062C\u0645\u0648\u0639\u0647"),t(),i(24,"th",13),n(25,"\u062A\u0639\u062F\u0627\u062F \u0645\u062D\u0635\u0648\u0644"),t(),i(26,"th",13),n(27,"\u0648\u0636\u0639\u06CC\u062A"),t(),i(28,"th",14),n(29,"\u0639\u0645\u0644\u06CC\u0627\u062A"),t()()(),i(30,"tbody",15),A(31,Mn,24,10,"tr",16,T),m(33,Vn,4,0,"tr"),t()()(),m(34,Un,2,0,"div",17),t()()),o&2&&(a(31),E(u.categories),a(2),c(!u.isLoading&&u.categories.length===0?33:-1),a(),c(u.isLoading?34:-1))},dependencies:[M,q,j,N],encapsulation:2})}}return r})();var tt=(()=>{class r{constructor(e){this.http=e,this.apiUrl=`${R.API_URL}admin/discounts`}getDiscounts(e=!1,o=!1,u=1,s=20){let p=new z().set("includeExpired",e.toString()).set("includeDeleted",o.toString()).set("page",u.toString()).set("pageSize",s.toString());return this.http.get(this.apiUrl,{params:p})}getDiscountById(e){return this.http.get(`${this.apiUrl}/${e}`)}getUsageReport(e){return this.http.get(`${this.apiUrl}/${e}/usage-report`)}getDiscountInfo(e){return this.http.get(`${this.apiUrl}/info/${e}`)}createDiscount(e){return this.http.post(this.apiUrl,e)}updateDiscount(e,o){return this.http.put(`${this.apiUrl}/${e}`,Ue(Ve({},o),{id:e}))}deleteDiscount(e){return this.http.delete(`${this.apiUrl}/${e}`)}cancelDiscountUsage(e,o){return this.http.post(`${this.apiUrl}/${e}/cancel-usage`,{orderId:o})}static{this.\u0275fac=function(o){return new(o||r)(W(G))}}static{this.\u0275prov=O({token:r,factory:r.\u0275fac,providedIn:"root"})}}return r})();function Nn(r,d){if(r&1){let e=S();i(0,"div",35)(1,"select",37)(2,"option",38),n(3,"\u062F\u0633\u062A\u0647\u200C\u0628\u0646\u062F\u06CC"),t(),i(4,"option",39),n(5,"\u0645\u062D\u0635\u0648\u0644"),t(),i(6,"option",40),n(7,"\u0628\u0631\u0646\u062F"),t(),i(8,"option",41),n(9,"\u06A9\u0627\u0631\u0628\u0631"),t()(),g(10,"input",42),i(11,"button",43),C("click",function(){let u=b(e).$index,s=l(2);return _(s.removeRestriction(u))}),i(12,"span",4),n(13,"remove_circle_outline"),t()()()}if(r&2){let e=d.$index;f("formGroupName",e)}}function jn(r,d){if(r&1){let e=S();i(0,"div",6)(1,"h3",7),n(2,"\u0645\u062D\u062F\u0648\u062F\u06CC\u062A\u200C\u0647\u0627\u06CC \u0627\u0639\u0645\u0627\u0644"),t(),i(3,"p",33),n(4,"\u06A9\u062F \u062A\u062E\u0641\u06CC\u0641 \u0631\u0627 \u0645\u062D\u062F\u0648\u062F \u0628\u0647 \u062F\u0633\u062A\u0647\u200C\u0628\u0646\u062F\u06CC\u060C \u0645\u062D\u0635\u0648\u0644\u060C \u0628\u0631\u0646\u062F \u06CC\u0627 \u06A9\u0627\u0631\u0628\u0631 \u062E\u0627\u0635 \u06A9\u0646\u06CC\u062F"),t(),i(5,"div",34),A(6,Nn,14,1,"div",35,T),t(),i(8,"button",36),C("click",function(){b(e);let u=l();return _(u.addRestriction())}),i(9,"span",4),n(10,"add"),t(),n(11," \u0627\u0641\u0632\u0648\u062F\u0646 \u0645\u062D\u062F\u0648\u062F\u06CC\u062A "),t()()}if(r&2){let e=l();a(6),E(e.restrictionsArray.controls)}}function $n(r,d){r&1&&g(0,"span",32)}var gt=(()=>{class r{constructor(e,o,u,s,p){this.fb=e,this.route=o,this.router=u,this.discountService=s,this.notificationService=p,this.isEditMode=!1,this.id=null,this.isSubmitting=!1,this.concurrencyToken=null,this.form=this.fb.group({code:["",[I.required]],percentage:[0,[I.required,I.min(.01),I.max(100)]],maxDiscountAmount:[null],minOrderAmount:[null],usageLimit:[null],maxUsagePerUser:[null],startsAt:[null],expiresAt:[null],isActive:[!0],restrictions:this.fb.array([])})}get restrictionsArray(){return this.form.get("restrictions")}addRestriction(){this.restrictionsArray.push(this.fb.group({restrictionType:["Category"],entityId:[null]}))}removeRestriction(e){this.restrictionsArray.removeAt(e)}ngOnInit(){let e=this.route.snapshot.paramMap.get("id");e&&(this.id=+e,this.isEditMode=!0,this.loadDiscount())}loadDiscount(){this.id&&this.discountService.getDiscountById(this.id).subscribe(e=>{this.concurrencyToken=e.concurrencyToken??null,this.form.patchValue({code:e.code,percentage:e.percentage,maxDiscountAmount:e.maxDiscountAmount,minOrderAmount:e.minOrderAmount,usageLimit:e.usageLimit,maxUsagePerUser:e.maxUsagePerUser,startsAt:e.startsAt?this.toDateInputValue(e.startsAt):null,expiresAt:e.expiresAt?this.toDateInputValue(e.expiresAt):null,isActive:e.isActive}),this.restrictionsArray.clear(),e.restrictions&&e.restrictions.forEach(o=>{this.restrictionsArray.push(this.fb.group({restrictionType:[o.restrictionType],entityId:[o.entityId]}))})})}toDateInputValue(e){return new Date(e).toISOString().split("T")[0]}onSubmit(){if(this.form.invalid)return;this.isSubmitting=!0;let e=this.form.value,o;if(this.isEditMode&&this.id){let u={id:this.id,percentage:e.percentage,maxDiscountAmount:e.maxDiscountAmount,minOrderAmount:e.minOrderAmount,usageLimit:e.usageLimit,maxUsagePerUser:e.maxUsagePerUser,isActive:e.isActive,startsAt:e.startsAt||void 0,expiresAt:e.expiresAt||void 0,concurrencyToken:this.concurrencyToken??""};o=this.discountService.updateDiscount(this.id,u)}else{let u={code:e.code,percentage:e.percentage,maxDiscountAmount:e.maxDiscountAmount,minOrderAmount:e.minOrderAmount,usageLimit:e.usageLimit,maxUsagePerUser:e.maxUsagePerUser,startsAt:e.startsAt||void 0,expiresAt:e.expiresAt||void 0,restrictions:e.restrictions};o=this.discountService.createDiscount(u)}o.pipe(L(()=>this.isSubmitting=!1)).subscribe({next:()=>{this.notificationService.show("\u06A9\u062F \u062A\u062E\u0641\u06CC\u0641 \u0630\u062E\u06CC\u0631\u0647 \u0634\u062F","success"),this.router.navigate(["/admin/discounts"])},error:u=>this.notificationService.show(u.error?.message||"\u062E\u0637\u0627","error")})}static{this.\u0275fac=function(o){return new(o||r)(h(we),h(ue),h(he),h(tt),h(D))}}static{this.\u0275cmp=k({type:r,selectors:[["app-admin-discount-form"]],decls:81,vars:7,consts:[[1,"max-w-3xl","mx-auto","animate-fade-in-up"],[1,"flex","items-center","justify-between","mb-6"],[1,"text-2xl","font-bold","text-heading-foreground"],["routerLink","/admin/discounts",1,"btn","btn-outline","btn-sm","gap-2"],[1,"material-icons","text-sm"],[1,"card","p-6","space-y-8","shadow-md","border-border",3,"ngSubmit","formGroup"],[1,"space-y-4"],[1,"text-lg","font-semibold","border-b","border-border","pb-2","text-foreground"],[1,"grid","gap-6","md:grid-cols-2"],[1,"form-group"],[1,"form-label"],[1,"text-destructive"],[1,"input-group"],[1,"input-addon","font-mono","text-muted-foreground"],["type","text","formControlName","code","placeholder","OFF2024",1,"input","ltr-input","uppercase","tracking-wider","font-bold"],["type","number","formControlName","percentage","placeholder","0-100","min","0.01","max","100",1,"input"],[1,"input-addon"],["type","number","formControlName","maxDiscountAmount","placeholder","\u062A\u0648\u0645\u0627\u0646",1,"input"],[1,"form-hint"],["type","number","formControlName","minOrderAmount","placeholder","\u062A\u0648\u0645\u0627\u0646",1,"input"],["type","number","formControlName","usageLimit","placeholder","\u0646\u0627\u0645\u062D\u062F\u0648\u062F",1,"input"],["type","number","formControlName","maxUsagePerUser","placeholder","\u0646\u0627\u0645\u062D\u062F\u0648\u062F",1,"input"],["type","date","formControlName","startsAt",1,"input","ltr-input"],["type","date","formControlName","expiresAt",1,"input","ltr-input"],[1,"flex","items-center","gap-3","p-4","bg-muted/20","rounded-lg","border","border-border/50"],[1,"flex","items-center"],["type","checkbox","id","isActive","formControlName","isActive",1,"switch"],["for","isActive",1,"switch-thumb"],["for","isActive",1,"text-sm","font-medium","cursor-pointer","select-none","text-foreground"],[1,"flex","justify-end","gap-3","border-t","border-border","pt-6"],["routerLink","/admin/discounts",1,"btn","btn-ghost","text-muted-foreground","hover:text-foreground"],["type","submit",1,"btn","btn-primary","min-w-[120px]","shadow-button",3,"disabled"],[1,"spinner","spinner-sm","mr-2","border-white"],[1,"text-sm","text-muted-foreground"],["formArrayName","restrictions",1,"space-y-3"],[1,"flex","items-center","gap-3","p-3","rounded-lg","bg-muted/20","border","border-border/50",3,"formGroupName"],["type","button",1,"btn","btn-outline","btn-sm","gap-2","border-dashed",3,"click"],["formControlName","restrictionType",1,"input","input-sm","flex-1"],["value","Category"],["value","Product"],["value","Brand"],["value","User"],["type","number","formControlName","entityId","placeholder","\u0634\u0646\u0627\u0633\u0647 (ID)",1,"input","input-sm","flex-1"],["type","button",1,"icon-wrapper","icon-wrapper-sm","text-destructive","hover:bg-destructive/10","rounded-md","flex-shrink-0",3,"click"]],template:function(o,u){o&1&&(i(0,"div",0)(1,"div",1)(2,"div")(3,"h1",2),n(4),t()(),i(5,"a",3)(6,"span",4),n(7,"arrow_forward"),t(),n(8," \u0628\u0627\u0632\u06AF\u0634\u062A "),t()(),i(9,"form",5),C("ngSubmit",function(){return u.onSubmit()}),i(10,"div",6)(11,"h3",7),n(12,"\u0627\u0637\u0644\u0627\u0639\u0627\u062A \u067E\u0627\u06CC\u0647"),t(),i(13,"div",8)(14,"div",9)(15,"label",10),n(16,"\u06A9\u062F \u062A\u062E\u0641\u06CC\u0641 "),i(17,"span",11),n(18,"*"),t()(),i(19,"div",12)(20,"span",13),n(21,"#"),t(),g(22,"input",14),t()(),i(23,"div",9)(24,"label",10),n(25,"\u062F\u0631\u0635\u062F \u062A\u062E\u0641\u06CC\u0641 "),i(26,"span",11),n(27,"*"),t()(),i(28,"div",12),g(29,"input",15),i(30,"span",16),n(31,"%"),t()()()()(),i(32,"div",6)(33,"h3",7),n(34,"\u0645\u062D\u062F\u0648\u062F\u06CC\u062A\u200C\u0647\u0627"),t(),i(35,"div",8)(36,"div",9)(37,"label",10),n(38,"\u062D\u062F\u0627\u06A9\u062B\u0631 \u0645\u0628\u0644\u063A \u062A\u062E\u0641\u06CC\u0641"),t(),g(39,"input",17),i(40,"p",18),n(41,"\u062D\u062F\u0627\u06A9\u062B\u0631 \u0645\u0628\u0644\u063A\u06CC \u06A9\u0647 \u0627\u0632 \u0641\u0627\u06A9\u062A\u0648\u0631 \u06A9\u0633\u0631 \u0645\u06CC\u200C\u0634\u0648\u062F"),t()(),i(42,"div",9)(43,"label",10),n(44,"\u062D\u062F\u0627\u0642\u0644 \u0645\u0628\u0644\u063A \u0633\u0641\u0627\u0631\u0634"),t(),g(45,"input",19),i(46,"p",18),n(47,"\u06A9\u062F \u062A\u062E\u0641\u06CC\u0641 \u0628\u0631\u0627\u06CC \u0633\u0641\u0627\u0631\u0634\u200C\u0647\u0627\u06CC \u06A9\u0645\u062A\u0631 \u0627\u0632 \u0627\u06CC\u0646 \u0645\u0628\u0644\u063A \u0627\u0639\u0645\u0627\u0644 \u0646\u0645\u06CC\u200C\u0634\u0648\u062F"),t()(),i(48,"div",9)(49,"label",10),n(50,"\u062A\u0639\u062F\u0627\u062F \u0645\u062C\u0627\u0632 \u0627\u0633\u062A\u0641\u0627\u062F\u0647 \u06A9\u0644"),t(),g(51,"input",20),t(),i(52,"div",9)(53,"label",10),n(54,"\u062D\u062F\u0627\u06A9\u062B\u0631 \u0627\u0633\u062A\u0641\u0627\u062F\u0647 \u0647\u0631 \u06A9\u0627\u0631\u0628\u0631"),t(),g(55,"input",21),i(56,"p",18),n(57,"\u062A\u0639\u062F\u0627\u062F \u062F\u0641\u0639\u0627\u062A\u06CC \u06A9\u0647 \u0647\u0631 \u06A9\u0627\u0631\u0628\u0631 \u0645\u06CC\u200C\u062A\u0648\u0627\u0646\u062F \u0627\u0632 \u0627\u06CC\u0646 \u06A9\u062F \u0627\u0633\u062A\u0641\u0627\u062F\u0647 \u06A9\u0646\u062F"),t()(),i(58,"div",9)(59,"label",10),n(60,"\u062A\u0627\u0631\u06CC\u062E \u0634\u0631\u0648\u0639"),t(),g(61,"input",22),i(62,"p",18),n(63,"\u0627\u06AF\u0631 \u062E\u0627\u0644\u06CC \u0628\u0627\u0634\u062F\u060C \u06A9\u062F \u0627\u0632 \u0647\u0645\u200C\u0627\u06A9\u0646\u0648\u0646 \u0641\u0639\u0627\u0644 \u0627\u0633\u062A"),t()(),i(64,"div",9)(65,"label",10),n(66,"\u062A\u0627\u0631\u06CC\u062E \u0627\u0646\u0642\u0636\u0627"),t(),g(67,"input",23),t()()(),m(68,jn,12,0,"div",6),i(69,"div",24)(70,"div",25),g(71,"input",26)(72,"label",27),t(),i(73,"label",28),n(74," \u0641\u0639\u0627\u0644 \u0633\u0627\u0632\u06CC \u06A9\u062F \u062A\u062E\u0641\u06CC\u0641 "),t()(),i(75,"div",29)(76,"a",30),n(77,"\u0627\u0646\u0635\u0631\u0627\u0641"),t(),i(78,"button",31),m(79,$n,1,0,"span",32),n(80),t()()()()),o&2&&(a(4),x(" ",u.isEditMode?"\u0648\u06CC\u0631\u0627\u06CC\u0634":"\u0627\u06CC\u062C\u0627\u062F"," \u06A9\u062F \u062A\u062E\u0641\u06CC\u0641 "),a(5),f("formGroup",u.form),a(13),Ke("disabled",u.isEditMode?"":null),a(46),c(u.isEditMode?-1:68),a(10),f("disabled",u.form.invalid||u.isSubmitting),a(),c(u.isSubmitting?79:-1),a(),x(" ",u.isEditMode?"\u0628\u0631\u0648\u0632\u0631\u0633\u0627\u0646\u06CC":"\u0627\u06CC\u062C\u0627\u062F \u06A9\u062F"," "))},dependencies:[me,se,ie,ne,Z,ee,_e,te,$,ae,Ee,Nt,le,de,$e,Be,j,N],encapsulation:2})}}return r})();var Bn=r=>["/admin/discounts/edit",r],Rn=(r,d)=>d.id;function On(r,d){if(r&1){let e=S();i(0,"tr",15)(1,"td",18),n(2),t(),i(3,"td",19)(4,"span",20),n(5),t()(),i(6,"td",21),n(7),t(),i(8,"td",22),n(9),t(),i(10,"td",22),n(11),t(),i(12,"td",23),n(13),F(14,"date"),t(),i(15,"td",23),n(16),F(17,"date"),t(),i(18,"td",24)(19,"span",25),n(20),t()(),i(21,"td",19)(22,"div",26)(23,"button",27),C("click",function(){let u=b(e).$implicit,s=l();return _(s.viewUsage(u.id))}),i(24,"span",28),n(25,"bar_chart"),t()(),i(26,"a",29)(27,"span",28),n(28,"edit"),t()(),i(29,"button",30),C("click",function(){let u=b(e).$implicit,s=l();return _(s.deleteDiscount(u.id))}),i(30,"span",28),n(31,"delete"),t()()()()()}if(r&2){let e=d.$implicit;a(2),v(e.code),a(3),x("%",e.percentage),a(2),v(e.usedCount),a(2),x(" ",e.usageLimit?e.usageLimit:"\u221E"," "),a(2),x(" ",e.maxUsagePerUser?e.maxUsagePerUser:"\u221E"," "),a(2),x(" ",e.startsAt?oe(14,10,e.startsAt,"shortDate"):"-"," "),a(3),x(" ",e.expiresAt?oe(17,13,e.expiresAt,"shortDate"):"\u0646\u0627\u0645\u062D\u062F\u0648\u062F"," "),a(3),f("ngClass",e.isActive?"badge-success":"badge-destructive"),a(),x(" ",e.isActive?"\u0641\u0639\u0627\u0644":"\u063A\u06CC\u0631\u0641\u0639\u0627\u0644"," "),a(6),f("routerLink",J(16,Bn,e.id))}}function Wn(r,d){r&1&&(i(0,"tr")(1,"td",31)(2,"p"),n(3,"\u0647\u06CC\u0686 \u06A9\u062F \u062A\u062E\u0641\u06CC\u0641\u06CC \u06CC\u0627\u0641\u062A \u0646\u0634\u062F."),t()()())}function Gn(r,d){r&1&&(i(0,"div",16),g(1,"span",32),t())}function zn(r,d){r&1&&(i(0,"span",57),n(1,"\u0644\u063A\u0648 \u0634\u062F\u0647"),t())}function qn(r,d){r&1&&(i(0,"span",58),n(1,"\u062A\u0623\u06CC\u06CC\u062F \u0634\u062F\u0647"),t())}function Hn(r,d){r&1&&(i(0,"span",59),n(1,"\u062F\u0631 \u0627\u0646\u062A\u0638\u0627\u0631"),t())}function Kn(r,d){if(r&1&&(i(0,"tr",51)(1,"td",52),n(2),t(),i(3,"td",53),n(4),t(),i(5,"td",54),n(6),F(7,"number"),t(),i(8,"td",55),n(9),F(10,"date"),t(),i(11,"td",56),m(12,zn,2,0,"span",57)(13,qn,2,0,"span",58)(14,Hn,2,0,"span",59),t()()),r&2){let e=d.$implicit;a(2),v(e.userName??e.userId),a(2),x("#",e.orderId),a(2),x("",U(7,5,e.discountAmount)," \u062A\u0648\u0645\u0627\u0646"),a(3),v(oe(10,7,e.usedAt,"short")),a(3),c(e.isCancelled?12:e.isConfirmed?13:14)}}function Jn(r,d){if(r&1&&(i(0,"table",9)(1,"thead",47)(2,"tr")(3,"th",48),n(4,"\u06A9\u0627\u0631\u0628\u0631"),t(),i(5,"th",48),n(6,"\u0634\u0646\u0627\u0633\u0647 \u0633\u0641\u0627\u0631\u0634"),t(),i(7,"th",48),n(8,"\u0645\u0628\u0644\u063A \u062A\u062E\u0641\u06CC\u0641"),t(),i(9,"th",48),n(10,"\u062A\u0627\u0631\u06CC\u062E"),t(),i(11,"th",49),n(12,"\u0648\u0636\u0639\u06CC\u062A"),t()()(),i(13,"tbody",50),A(14,Kn,15,10,"tr",51,Rn),t()()),r&2){let e=l(2);a(14),E(e.usageReport.usages)}}function Qn(r,d){r&1&&(i(0,"div",46)(1,"p"),n(2,"\u0647\u0646\u0648\u0632 \u0627\u0633\u062A\u0641\u0627\u062F\u0647\u200C\u0627\u06CC \u062B\u0628\u062A \u0646\u0634\u062F\u0647 \u0627\u0633\u062A."),t()())}function Yn(r,d){if(r&1){let e=S();i(0,"div",33),C("click",function(){b(e);let u=l();return _(u.closeUsageModal())}),i(1,"div",34),C("click",function(u){return b(e),_(u.stopPropagation())}),i(2,"div",35)(3,"div")(4,"h2",36),n(5,"\u06AF\u0632\u0627\u0631\u0634 \u0627\u0633\u062A\u0641\u0627\u062F\u0647"),t(),i(6,"p",37),n(7),t()(),i(8,"button",38),C("click",function(){b(e);let u=l();return _(u.closeUsageModal())}),i(9,"span",39),n(10,"close"),t()()(),i(11,"div",40)(12,"div",41)(13,"p",42),n(14),t(),i(15,"p",43),n(16,"\u062A\u0639\u062F\u0627\u062F \u0627\u0633\u062A\u0641\u0627\u062F\u0647"),t()(),i(17,"div",41)(18,"p",42),n(19),t(),i(20,"p",43),n(21,"\u0645\u062D\u062F\u0648\u062F\u06CC\u062A \u06A9\u0644"),t()(),i(22,"div",41)(23,"p",42),n(24),t(),i(25,"p",43),n(26,"\u0638\u0631\u0641\u06CC\u062A \u0628\u0627\u0642\u06CC\u200C\u0645\u0627\u0646\u062F\u0647"),t()(),i(27,"div",41)(28,"span",44),n(29),t(),i(30,"p",43),n(31,"\u0648\u0636\u0639\u06CC\u062A"),t()()(),i(32,"div",45),m(33,Jn,16,0,"table",9)(34,Qn,3,0,"div",46),t()()()}if(r&2){let e=l();a(7),v(e.usageReport.code),a(7),v(e.usageReport.totalUsageCount),a(5),v(e.usageReport.usageLimit??"\u221E"),a(5),v(e.usageReport.remainingUsage),a(4),f("ngClass",e.usageReport.isCurrentlyValid?"badge-success":"badge-destructive"),a(),x(" ",e.usageReport.isCurrentlyValid?"\u0641\u0639\u0627\u0644":"\u063A\u06CC\u0631\u0641\u0639\u0627\u0644"," "),a(4),c(e.usageReport.usages.length>0?33:34)}}var ii=(()=>{class r{constructor(e,o){this.discountService=e,this.notificationService=o,this.discounts=[],this.usageReport=null,this.showUsageModal=!1,this.isLoading=!1}ngOnInit(){this.loadDiscounts()}loadDiscounts(){this.isLoading=!0,this.discountService.getDiscounts(!0,!1).pipe(L(()=>this.isLoading=!1)).subscribe(e=>{this.discounts=e.items})}deleteDiscount(e){confirm("\u062D\u0630\u0641 \u0634\u0648\u062F\u061F")&&this.discountService.deleteDiscount(e).subscribe({next:()=>this.loadDiscounts(),error:o=>this.notificationService.show(o.error?.message||"\u062E\u0637\u0627","error")})}viewUsage(e){this.discountService.getUsageReport(e).subscribe({next:o=>{this.usageReport=o,this.showUsageModal=!0},error:o=>this.notificationService.show(o.error?.message||"\u062E\u0637\u0627 \u062F\u0631 \u0628\u0627\u0631\u06AF\u0630\u0627\u0631\u06CC \u06AF\u0632\u0627\u0631\u0634","error")})}closeUsageModal(){this.showUsageModal=!1,this.usageReport=null}static{this.\u0275fac=function(o){return new(o||r)(h(tt),h(D))}}static{this.\u0275cmp=k({type:r,selectors:[["app-admin-discount-list"]],decls:42,vars:3,consts:[[1,"space-y-6","animate-fade-in"],[1,"flex","flex-col","sm:flex-row","sm:items-center","justify-between","gap-4"],[1,"text-2xl","font-bold","tracking-tight","text-heading-foreground","flex","items-center","gap-2"],[1,"material-icons","text-primary"],[1,"text-sm","text-muted-foreground","mt-1"],["routerLink","/admin/discounts/new",1,"btn","btn-primary","shadow-lg","shadow-primary/20","hover:shadow-primary/40","transition-all"],[1,"material-icons","text-sm"],[1,"card","overflow-hidden","border","border-border","shadow-sm"],[1,"overflow-x-auto"],[1,"w-full","text-sm","text-right"],[1,"bg-muted/50","border-b","border-border","text-muted-foreground"],[1,"px-6","py-4","font-medium"],[1,"px-6","py-4","font-medium","text-center"],[1,"px-6","py-4","font-medium","w-40","text-left"],[1,"divide-y","divide-border/50","bg-card"],[1,"group","hover:bg-muted/30","transition-colors"],[1,"p-12","text-center"],[1,"fixed","inset-0","z-50","flex","items-center","justify-center","bg-black/50","backdrop-blur-sm","p-4"],[1,"px-6","py-4","font-mono","font-bold","text-lg","text-primary","tracking-wider","dir-ltr","text-right"],[1,"px-6","py-4"],[1,"badge","badge-secondary","text-sm"],[1,"px-6","py-4","text-center","font-mono","text-foreground"],[1,"px-6","py-4","text-center","font-mono","text-muted-foreground"],[1,"px-6","py-4","text-muted-foreground","text-xs","font-mono"],[1,"px-6","py-4","text-center"],[1,"badge",3,"ngClass"],[1,"flex","items-center","justify-end","gap-2","opacity-0","group-hover:opacity-100","transition-opacity"],["title","\u06AF\u0632\u0627\u0631\u0634 \u0627\u0633\u062A\u0641\u0627\u062F\u0647",1,"btn","btn-icon","btn-ghost","btn-sm","text-muted-foreground","hover:text-primary","hover:bg-primary/10",3,"click"],[1,"material-icons","text-lg"],[1,"btn","btn-icon","btn-ghost","btn-sm","text-primary","hover:text-primary-foreground","hover:bg-primary",3,"routerLink"],[1,"btn","btn-icon","btn-ghost","btn-sm","text-muted-foreground","hover:text-destructive-foreground","hover:bg-destructive",3,"click"],["colspan","9",1,"px-6","py-12","text-center","text-muted-foreground"],[1,"spinner","spinner-lg","text-primary"],[1,"fixed","inset-0","z-50","flex","items-center","justify-center","bg-black/50","backdrop-blur-sm","p-4",3,"click"],[1,"card","w-full","max-w-2xl","max-h-[80vh]","flex","flex-col","shadow-2xl","border-border",3,"click"],[1,"flex","items-center","justify-between","p-6","border-b","border-border"],[1,"text-lg","font-bold","text-heading-foreground"],[1,"text-sm","text-muted-foreground","mt-1","font-mono"],[1,"btn","btn-icon","btn-ghost","btn-sm",3,"click"],[1,"material-icons"],[1,"p-6","border-b","border-border","grid","grid-cols-2","md:grid-cols-4","gap-4"],[1,"text-center"],[1,"text-2xl","font-bold","text-foreground"],[1,"text-xs","text-muted-foreground","mt-1"],[1,"badge","text-sm",3,"ngClass"],[1,"flex-1","overflow-y-auto"],[1,"p-12","text-center","text-muted-foreground"],[1,"bg-muted/50","border-b","border-border","text-muted-foreground","sticky","top-0"],[1,"px-4","py-3","font-medium"],[1,"px-4","py-3","font-medium","text-center"],[1,"divide-y","divide-border/50"],[1,"hover:bg-muted/20"],[1,"px-4","py-3","text-foreground"],[1,"px-4","py-3","font-mono","text-muted-foreground"],[1,"px-4","py-3","font-mono","text-foreground"],[1,"px-4","py-3","text-muted-foreground","text-xs","font-mono"],[1,"px-4","py-3","text-center"],[1,"badge","badge-destructive"],[1,"badge","badge-success"],[1,"badge","badge-warning"]],template:function(o,u){o&1&&(i(0,"div",0)(1,"div",1)(2,"div")(3,"h1",2)(4,"span",3),n(5,"percent"),t(),n(6," \u06A9\u062F\u0647\u0627\u06CC \u062A\u062E\u0641\u06CC\u0641 "),t(),i(7,"p",4),n(8,"\u0645\u062F\u06CC\u0631\u06CC\u062A \u06A9\u0645\u067E\u06CC\u0646\u200C\u0647\u0627 \u0648 \u06A9\u062F\u0647\u0627\u06CC \u062A\u062E\u0641\u06CC\u0641"),t()(),i(9,"a",5)(10,"span",6),n(11,"add"),t(),n(12," \u06A9\u062F \u062A\u062E\u0641\u06CC\u0641 \u062C\u062F\u06CC\u062F "),t()(),i(13,"div",7)(14,"div",8)(15,"table",9)(16,"thead",10)(17,"tr")(18,"th",11),n(19,"\u06A9\u062F \u062A\u062E\u0641\u06CC\u0641"),t(),i(20,"th",11),n(21,"\u062F\u0631\u0635\u062F"),t(),i(22,"th",12),n(23,"\u0627\u0633\u062A\u0641\u0627\u062F\u0647 \u0634\u062F\u0647"),t(),i(24,"th",12),n(25,"\u0645\u062D\u062F\u0648\u062F\u06CC\u062A \u06A9\u0644"),t(),i(26,"th",12),n(27,"\u0645\u062D\u062F\u0648\u062F\u06CC\u062A \u0647\u0631 \u06A9\u0627\u0631\u0628\u0631"),t(),i(28,"th",11),n(29,"\u062A\u0627\u0631\u06CC\u062E \u0634\u0631\u0648\u0639"),t(),i(30,"th",11),n(31,"\u0627\u0646\u0642\u0636\u0627"),t(),i(32,"th",12),n(33,"\u0648\u0636\u0639\u06CC\u062A"),t(),i(34,"th",13),n(35,"\u0639\u0645\u0644\u06CC\u0627\u062A"),t()()(),i(36,"tbody",14),A(37,On,32,18,"tr",15,T),m(39,Wn,4,0,"tr"),t()()(),m(40,Gn,2,0,"div",16),t()(),m(41,Yn,35,7,"div",17)),o&2&&(a(37),E(u.discounts),a(2),c(!u.isLoading&&u.discounts.length===0?39:-1),a(),c(u.isLoading?40:-1),a(),c(u.showUsageModal&&u.usageReport?41:-1))},dependencies:[M,q,j,N,be,fe],encapsulation:2})}}return r})();var it=(()=>{class r{constructor(e){this.http=e,this.apiUrl=`${R.API_URL}admin/inventory`}getTransactions(e,o,u,s,p=1,V=20){let K=new z().set("page",p.toString()).set("pageSize",V.toString());return e&&(K=K.set("variantId",e.toString())),o&&(K=K.set("transactionType",o)),u&&(K=K.set("fromDate",u.toISOString())),s&&(K=K.set("toDate",s.toISOString())),this.http.get(`${this.apiUrl}/transactions`,{params:K})}getLowStockItems(e=5){let o=new z().set("threshold",e.toString());return this.http.get(`${this.apiUrl}/low-stock`,{params:o})}getOutOfStockItems(){return this.http.get(`${this.apiUrl}/out-of-stock`)}adjustStock(e,o){return this.http.post(`${this.apiUrl}/adjust`,e)}getStatistics(){return this.http.get(`${this.apiUrl}/statistics`)}reconcileStock(e){return this.http.post(`${this.apiUrl}/reconcile/${e}`,{})}bulkAdjustStock(e){return this.http.post(`${this.apiUrl}/bulk-adjust`,e)}getInventoryStatus(e){return this.http.get(`${this.apiUrl}/status/${e}`)}bulkStockIn(e){return this.http.post(`${this.apiUrl}/import`,e)}recordDamage(e){return this.http.post(`${this.apiUrl}/damage`,e)}approveReturn(e,o){return this.http.post(`${this.apiUrl}/approve-return/${e}`,o??{})}commitOrderInventory(e){return this.http.post(`${this.apiUrl}/commit-order/${e}`,{})}static{this.\u0275fac=function(o){return new(o||r)(W(G))}}static{this.\u0275prov=O({token:r,factory:r.\u0275fac,providedIn:"root"})}}return r})();function Xn(r,d){r&1&&(i(0,"div",12)(1,"span",15),n(2,"sync"),t()())}function Zn(r,d){if(r&1){let e=S();i(0,"tr",22)(1,"td",23),n(2),F(3,"date"),t(),i(4,"td",24)(5,"div",25),g(6,"img",26),i(7,"div")(8,"div",27),n(9),t(),i(10,"div",28),n(11),t()()()(),i(12,"td",24)(13,"div",29)(14,"span",30),n(15),t(),i(16,"span",31),n(17),t()()(),i(18,"td",24)(19,"span",32),n(20),t()(),i(21,"td",33),n(22),t(),i(23,"td",34),n(24),t(),i(25,"td",35)(26,"div",36),n(27),t(),i(28,"div",37),n(29),t()(),i(30,"td",24)(31,"button",38),C("click",function(){let u=b(e).$implicit,s=l(2);return _(s.reconcileStock(u.variantId))}),i(32,"span",39),n(33,"sync"),t()()()()}if(r&2){let e=d.$implicit,o=l(2);a(2),x(" ",oe(3,18,e.createdAt,"yyyy/MM/dd HH:mm")," "),a(4),f("src",o.getMediaUrl(e.productImage),Se),a(3),v(e.productName),a(2),x(" ",e.variantName," "),a(4),x(" ",(e.userName||"?").charAt(0)," "),a(2),v(e.userName||"\u0633\u06CC\u0633\u062A\u0645"),a(2),f("ngClass",o.getTypeClass(e.transactionType)),a(),x(" ",e.transactionType," "),a(),B("text-success",e.quantityChange>0)("text-destructive",e.quantityChange<0),a(),ce(" ",e.quantityChange>0?"+":"","",e.quantityChange," "),a(2),v(e.stockAfter),a(2),f("title",e.notes),a(),v(e.notes),a(2),v(e.referenceNumber)}}function er(r,d){r&1&&(i(0,"tr")(1,"td",40)(2,"p"),n(3,"\u0647\u06CC\u0686 \u062A\u0631\u0627\u06A9\u0646\u0634\u06CC \u06CC\u0627\u0641\u062A \u0646\u0634\u062F."),t()()())}function tr(r,d){if(r&1&&(i(0,"div",13)(1,"table",16)(2,"thead",17)(3,"tr")(4,"th",18),n(5,"\u062A\u0627\u0631\u06CC\u062E"),t(),i(6,"th",18),n(7,"\u0645\u062D\u0635\u0648\u0644"),t(),i(8,"th",18),n(9,"\u06A9\u0627\u0631\u0628\u0631"),t(),i(10,"th",18),n(11,"\u0646\u0648\u0639"),t(),i(12,"th",19),n(13,"\u062A\u063A\u06CC\u06CC\u0631"),t(),i(14,"th",19),n(15,"\u0645\u0648\u062C\u0648\u062F\u06CC \u0646\u0647\u0627\u06CC\u06CC"),t(),i(16,"th",18),n(17,"\u06CC\u0627\u062F\u062F\u0627\u0634\u062A"),t(),g(18,"th",20),t()(),i(19,"tbody",21),A(20,Zn,34,21,"tr",22,T),m(22,er,4,0,"tr"),t()()()),r&2){let e=l();a(20),E(e.transactions),a(2),c(e.transactions.length===0?22:-1)}}function ir(r,d){if(r&1){let e=S();i(0,"div",14)(1,"div",29)(2,"button",41),C("click",function(){b(e);let u=l();return _(u.loadTransactions(u.currentPage-1))}),i(3,"span",39),n(4,"chevron_right"),t()(),i(5,"span",42),n(6),t(),i(7,"button",41),C("click",function(){b(e);let u=l();return _(u.loadTransactions(u.currentPage+1))}),i(8,"span",39),n(9,"chevron_left"),t()()()()}if(r&2){let e=l();a(2),f("disabled",e.currentPage===1),a(4),ce(" \u0635\u0641\u062D\u0647 ",e.currentPage," \u0627\u0632 ",e.pagination.totalPages," "),a(),f("disabled",e.currentPage===e.pagination.totalPages)}}var ri=(()=>{class r{constructor(e,o,u){this.inventoryService=e,this.mediaService=o,this.notificationService=u,this.transactions=[],this.pagination=null,this.isLoading=!0,this.filterType="",this.currentPage=1,this.pageSize=20}ngOnInit(){this.loadTransactions()}loadTransactions(e=1){this.isLoading=!0,this.currentPage=e,this.inventoryService.getTransactions(void 0,this.filterType||void 0,void 0,void 0,this.currentPage,this.pageSize).subscribe({next:o=>{this.transactions=o.items,this.pagination=o,this.isLoading=!1},error:()=>this.isLoading=!1})}reconcileStock(e){confirm("\u0622\u06CC\u0627 \u0645\u06CC\u200C\u062E\u0648\u0627\u0647\u06CC\u062F \u0645\u0648\u062C\u0648\u062F\u06CC \u0627\u06CC\u0646 \u0645\u062D\u0635\u0648\u0644 \u0631\u0627 \u0645\u062C\u062F\u062F\u0627\u064B \u0645\u062D\u0627\u0633\u0628\u0647 \u0648 \u0627\u0635\u0644\u0627\u062D \u06A9\u0646\u06CC\u062F\u061F")&&this.inventoryService.reconcileStock(e).subscribe({next:()=>{this.notificationService.show("\u0645\u0648\u062C\u0648\u062F\u06CC \u0628\u0627 \u0645\u0648\u0641\u0642\u06CC\u062A \u0627\u0635\u0644\u0627\u062D \u0634\u062F","success"),this.loadTransactions(this.currentPage)},error:o=>this.notificationService.show(o.error?.message||"\u062E\u0637\u0627 \u062F\u0631 \u0627\u0635\u0644\u0627\u062D \u0645\u0648\u062C\u0648\u062F\u06CC","error")})}getMediaUrl(e){return this.mediaService.getMediaUrl(e)}getTypeClass(e){switch(e.toLowerCase()){case"purchase":case"stockin":return"bg-success/10 text-success";case"sale":case"stockout":return"bg-destructive/10 text-destructive";case"adjustment":return"bg-warning/10 text-warning";default:return"bg-muted text-muted-foreground"}}static{this.\u0275fac=function(o){return new(o||r)(h(it),h(Fe),h(D))}}static{this.\u0275cmp=k({type:r,selectors:[["app-admin-inventory-transactions"]],decls:22,vars:4,consts:[[1,"space-y-6","animate-fade-in"],[1,"text-2xl","font-bold","text-heading-foreground"],[1,"card","p-4","bg-muted/20","flex","flex-wrap","gap-4","items-end","border","border-border"],[1,"space-y-1"],[1,"text-xs","font-medium","text-foreground"],[1,"input","w-40","bg-background",3,"ngModelChange","ngModel"],["value",""],["value","Purchase"],["value","Sale"],["value","Adjustment"],[1,"btn","btn-primary","shadow-sm",3,"click"],[1,"card","overflow-hidden","border","border-border","shadow-sm"],[1,"flex","justify-center","p-10"],[1,"overflow-x-auto"],[1,"flex","justify-center","p-4","border-t","border-border","bg-muted/5"],[1,"material-icons","animate-spin","text-primary","text-4xl"],[1,"w-full","text-sm","text-right"],[1,"bg-muted/50","border-b","border-border","text-muted-foreground"],[1,"p-4","font-medium"],[1,"p-4","font-medium","text-center"],[1,"p-4","font-medium","w-10"],[1,"divide-y","divide-border/50","bg-card"],[1,"border-b","border-border","hover:bg-muted/20","transition-colors"],[1,"p-4","whitespace-nowrap","text-muted-foreground","dir-ltr","text-right"],[1,"p-4"],[1,"flex","items-center","gap-3"],["alt","",1,"w-10","h-10","rounded","border","object-cover",3,"src"],[1,"font-medium","text-foreground"],[1,"text-xs","text-muted-foreground","font-mono","mt-0.5"],[1,"flex","items-center","gap-2"],[1,"w-6","h-6","rounded-full","bg-primary/10","flex","items-center","justify-center","text-xs","font-bold","text-primary"],[1,"text-sm","text-foreground"],[1,"px-2","py-1","rounded-full","text-xs","font-bold","badge",3,"ngClass"],[1,"p-4","font-bold","text-center","dir-ltr"],[1,"p-4","text-center","font-mono","text-foreground"],[1,"p-4","text-xs"],[1,"text-muted-foreground","truncate","max-w-[200px]",3,"title"],[1,"text-[10px]","text-muted-foreground/70","font-mono"],["title","\u0628\u0631\u0631\u0633\u06CC \u0645\u063A\u0627\u06CC\u0631\u062A",1,"btn","btn-ghost","btn-icon","btn-xs","text-info","hover:bg-info/10",3,"click"],[1,"material-icons","text-sm"],["colspan","8",1,"p-12","text-center","text-muted-foreground"],[1,"btn","btn-outline","btn-sm",3,"click","disabled"],[1,"text-sm","text-muted-foreground"]],template:function(o,u){o&1&&(i(0,"div",0)(1,"h1",1),n(2,"\u062A\u0627\u0631\u06CC\u062E\u0686\u0647 \u062A\u0631\u0627\u06A9\u0646\u0634\u200C\u0647\u0627\u06CC \u0627\u0646\u0628\u0627\u0631"),t(),i(3,"div",2)(4,"div",3)(5,"label",4),n(6,"\u0646\u0648\u0639 \u062A\u0631\u0627\u06A9\u0646\u0634"),t(),i(7,"select",5),X("ngModelChange",function(p){return Y(u.filterType,p)||(u.filterType=p),p}),i(8,"option",6),n(9,"\u0647\u0645\u0647"),t(),i(10,"option",7),n(11,"\u062E\u0631\u06CC\u062F (\u0627\u0641\u0632\u0627\u06CC\u0634)"),t(),i(12,"option",8),n(13,"\u0641\u0631\u0648\u0634 (\u06A9\u0627\u0647\u0634)"),t(),i(14,"option",9),n(15,"\u0627\u0635\u0644\u0627\u062D \u062F\u0633\u062A\u06CC"),t()()(),i(16,"button",10),C("click",function(){return u.loadTransactions(1)}),n(17,"\u0641\u06CC\u0644\u062A\u0631"),t()(),i(18,"div",11),m(19,Xn,3,0,"div",12),m(20,tr,23,1,"div",13),m(21,ir,10,4,"div",14),t()()),o&2&&(a(7),Q("ngModel",u.filterType),a(12),c(u.isLoading?19:-1),a(),c(u.isLoading?-1:20),a(),c(u.pagination&&u.pagination.totalPages>1?21:-1))},dependencies:[M,q,ge,ie,ne,te,$,Ce,fe],encapsulation:2})}}return r})();var Ge=(()=>{class r{constructor(e){this.http=e,this.apiUrl=`${R.API_URL}admin/orders`}getOrders(e){let o=new z().set("page",e.page.toString()).set("pageSize",e.pageSize.toString());return e.userId&&(o=o.set("userId",e.userId.toString())),e.status&&(o=o.set("status",e.status)),e.isPaid!==void 0&&(o=o.set("isPaid",e.isPaid.toString())),e.fromDate&&(o=o.set("fromDate",e.fromDate)),e.toDate&&(o=o.set("toDate",e.toDate)),this.http.get(this.apiUrl,{params:o})}getOrderById(e){return this.http.get(`${this.apiUrl}/${e}`)}updateOrderStatus(e,o){return this.http.patch(`${this.apiUrl}/${e}/status`,o)}updateOrder(e,o){return this.http.put(`${this.apiUrl}/${e}`,o)}markAsShipped(e,o){return this.http.patch(`${this.apiUrl}/${e}/ship`,{rowVersion:o})}expireOrders(){return this.http.post(`${this.apiUrl}/expire`,{})}getStatistics(e,o){let u=new z;return e&&(u=u.set("fromDate",e)),o&&(u=u.set("toDate",o)),this.http.get(`${this.apiUrl}/statistics`,{params:u})}deleteOrder(e){return this.http.delete(`${this.apiUrl}/${e}`)}static{this.\u0275fac=function(o){return new(o||r)(W(G))}}static{this.\u0275prov=O({token:r,factory:r.\u0275fac,providedIn:"root"})}}return r})();var De=(()=>{class r{constructor(e){this.http=e,this.publicUrl=`${R.API_URL}OrderStatus`,this.adminUrl=`${R.API_URL}admin/order-statuses`}getOrderStatuses(){return this.http.get(this.publicUrl)}getOrderStatus(e){return this.http.get(`${this.adminUrl}/${e}`)}createOrderStatus(e){return this.http.post(this.adminUrl,e)}updateOrderStatus(e,o){return this.http.put(`${this.adminUrl}/${e}`,o)}deleteOrderStatus(e){return this.http.delete(`${this.adminUrl}/${e}`)}static{this.\u0275fac=function(o){return new(o||r)(W(G))}}static{this.\u0275prov=O({token:r,factory:r.\u0275fac,providedIn:"root"})}}return r})();function nr(r,d){r&1&&(i(0,"div",0)(1,"span",3),n(2,"sync"),t()())}function rr(r,d){r&1&&(i(0,"div",1)(1,"span",4),n(2,"error_outline"),t(),i(3,"h2",5),n(4,"\u0633\u0641\u0627\u0631\u0634 \u06CC\u0627\u0641\u062A \u0646\u0634\u062F"),t(),i(5,"p",6),n(6," \u0645\u0645\u06A9\u0646 \u0627\u0633\u062A \u0627\u06CC\u0646 \u0633\u0641\u0627\u0631\u0634 \u062D\u0630\u0641 \u0634\u062F\u0647 \u06CC\u0627 \u0634\u0646\u0627\u0633\u0647 \u0622\u0646 \u0627\u0634\u062A\u0628\u0627\u0647 \u0628\u0627\u0634\u062F. "),t(),i(7,"a",7),n(8,"\u0628\u0627\u0632\u06AF\u0634\u062A \u0628\u0647 \u0644\u06CC\u0633\u062A \u0633\u0641\u0627\u0631\u0634\u0627\u062A"),t()())}function or(r,d){if(r&1&&(i(0,"span",62),n(1),t()),r&2){let e=d.$implicit;a(),x(" ",e.value.displayValue," ")}}function ur(r,d){if(r&1&&(i(0,"div",24)(1,"div",57),g(2,"img",58),t(),i(3,"div",59)(4,"p",60),n(5),t(),i(6,"div",61),A(7,or,2,1,"span",62,T),F(9,"keyvalue"),t(),i(10,"div",63)(11,"p"),n(12,"\u062A\u0639\u062F\u0627\u062F: "),i(13,"span",38),n(14),t()(),i(15,"p"),n(16,"\u0642\u06CC\u0645\u062A \u0648\u0627\u062D\u062F: "),i(17,"span",38),n(18),F(19,"number"),t(),n(20," \u062A\u0648\u0645\u0627\u0646"),t()()(),i(21,"div",64)(22,"p",65),n(23),F(24,"number"),t(),i(25,"p",66),n(26,"\u062A\u0648\u0645\u0627\u0646"),t()()()),r&2){let e=d.$implicit;a(2),f("src",e.product.icon||"assets/images/placeholder.png",Se)("alt",e.product.name),a(3),v(e.product.name),a(2),E(U(9,6,e.product.attributes)),a(7),v(e.quantity),a(4),v(U(19,8,e.sellingPrice)),a(5),x(" ",U(24,10,e.amount)," ")}}function ar(r,d){if(r&1&&(i(0,"div",37)(1,"span",30),n(2,"\u062A\u062E\u0641\u06CC\u0641:"),t(),i(3,"span",67),n(4),F(5,"number"),t()()),r&2){let e=l(2);a(4),x("",U(5,1,e.order.discountAmount)," - \u062A\u0648\u0645\u0627\u0646")}}function sr(r,d){if(r&1&&(i(0,"option",54),n(1),t()),r&2){let e=d.$implicit;f("ngValue",e.id),a(),x(" ",e.name," ")}}function dr(r,d){r&1&&(i(0,"span",56),n(1,"sync"),t())}function lr(r,d){if(r&1){let e=S();i(0,"div",2)(1,"div",8)(2,"div")(3,"h1",9)(4,"span",10),n(5,"receipt_long"),t(),n(6," \u062C\u0632\u0626\u06CC\u0627\u062A \u0633\u0641\u0627\u0631\u0634 "),i(7,"span",11),n(8),t()(),i(9,"p",12)(10,"span",13),n(11,"event"),t(),n(12," \u062A\u0627\u0631\u06CC\u062E \u062B\u0628\u062A: "),i(13,"span",14),n(14),F(15,"date"),t()()(),i(16,"a",15)(17,"span",16),n(18,"arrow_forward"),t(),n(19," \u0628\u0627\u0632\u06AF\u0634\u062A \u0628\u0647 \u0644\u06CC\u0633\u062A "),t()(),i(20,"div",17)(21,"div",18)(22,"div",19)(23,"div",20)(24,"h2",21)(25,"span",10),n(26,"shopping_cart"),t(),n(27," \u0645\u062D\u0635\u0648\u0644\u0627\u062A \u0633\u0641\u0627\u0631\u0634 "),i(28,"span",22),n(29),t()()(),i(30,"div",23),A(31,ur,27,12,"div",24,T),t()()(),i(33,"div",25)(34,"div",26)(35,"h2",27)(36,"span",10),n(37,"person"),t(),n(38," \u0627\u0637\u0644\u0627\u0639\u0627\u062A \u0645\u0634\u062A\u0631\u06CC "),t(),i(39,"div",28)(40,"div",29)(41,"span",30),n(42,"\u0646\u0627\u0645:"),t(),i(43,"span",31),n(44),t()(),i(45,"div",29)(46,"span",30),n(47,"\u0645\u0648\u0628\u0627\u06CC\u0644:"),t(),i(48,"span",32),n(49),t()(),i(50,"div",33)(51,"span",34),n(52,"\u0622\u062F\u0631\u0633:"),t(),i(53,"p",35),n(54),t()(),i(55,"div",29)(56,"span",30),n(57,"\u06A9\u062F\u067E\u0633\u062A\u06CC:"),t(),i(58,"span",32),n(59),t()()()(),i(60,"div",26)(61,"h2",27)(62,"span",36),n(63,"payments"),t(),n(64," \u062E\u0644\u0627\u0635\u0647 \u0645\u0627\u0644\u06CC "),t(),i(65,"div",28)(66,"div",37)(67,"span",30),n(68,"\u062C\u0645\u0639 \u06A9\u0644:"),t(),i(69,"span",38),n(70),F(71,"number"),t()(),i(72,"div",37)(73,"span",30),n(74,"\u0647\u0632\u06CC\u0646\u0647 \u0627\u0631\u0633\u0627\u0644:"),t(),i(75,"span",31),n(76),F(77,"number"),t()(),m(78,ar,6,3,"div",37),i(79,"div",39)(80,"span",40),n(81,"\u0645\u0628\u0644\u063A \u0646\u0647\u0627\u06CC\u06CC:"),t(),i(82,"span",41),n(83),F(84,"number"),t()(),i(85,"div",42)(86,"span",43),n(87,"\u0633\u0648\u062F \u0633\u0641\u0627\u0631\u0634:"),t(),i(88,"span",44),n(89),F(90,"number"),t()()()(),i(91,"div",26)(92,"h2",27)(93,"span",45),n(94,"edit_note"),t(),n(95," \u0645\u062F\u06CC\u0631\u06CC\u062A \u0648\u0636\u0639\u06CC\u062A "),t(),i(96,"div",46)(97,"div",47)(98,"span",48),n(99,"\u0648\u0636\u0639\u06CC\u062A \u0641\u0639\u0644\u06CC:"),t(),i(100,"span",49),F(101,"statusClass"),i(102,"span",13),n(103),t(),n(104),t()(),i(105,"div",50)(106,"label",51),n(107,"\u062A\u063A\u06CC\u06CC\u0631 \u0648\u0636\u0639\u06CC\u062A \u0628\u0647:"),t(),i(108,"select",52),X("ngModelChange",function(u){b(e);let s=l();return Y(s.selectedStatusId,u)||(s.selectedStatusId=u),_(u)}),i(109,"option",53),n(110,"\u0627\u0646\u062A\u062E\u0627\u0628 \u0648\u0636\u0639\u06CC\u062A..."),t(),A(111,sr,2,2,"option",54,T),t()(),i(113,"button",55),C("click",function(){b(e);let u=l();return _(u.updateStatus())}),m(114,dr,2,0,"span",56),n(115),t()()()()()()}if(r&2){let e=l();a(8),x("#",e.order.id),a(6),v(oe(15,21,e.order.createdAt,"yyyy/MM/dd HH:mm")),a(15),x("",e.order.orderItems.length," \u0645\u0648\u0631\u062F"),a(2),E(e.order.orderItems),a(13),ce("",e.order.user==null?null:e.order.user.firstName," ",e.order.user==null?null:e.order.user.lastName),a(5),v(e.order.user==null?null:e.order.user.phoneNumber),a(5),v(e.order.addressSnapshot==null?null:e.order.addressSnapshot.address),a(5),v(e.order.addressSnapshot==null?null:e.order.addressSnapshot.postalCode),a(11),x("",U(71,24,e.order.totalAmount)," \u062A\u0648\u0645\u0627\u0646"),a(6),x("",U(77,26,e.order.shippingCost)," \u062A\u0648\u0645\u0627\u0646"),a(2),c(e.order.discountAmount>0?78:-1),a(5),x("",U(84,28,e.order.finalAmount)," \u062A\u0648\u0645\u0627\u0646"),a(6),x("",U(90,30,e.order.totalProfit)," \u062A\u0648\u0645\u0627\u0646"),a(11),f("ngClass",U(101,32,e.order.orderStatus==null?null:e.order.orderStatus.name)),a(3),v(e.order.orderStatus==null?null:e.order.orderStatus.icon),a(),x(" ",e.order.orderStatus==null?null:e.order.orderStatus.name," "),a(4),Q("ngModel",e.selectedStatusId),a(),f("ngValue",null),a(2),E(e.orderStatuses),a(2),f("disabled",e.isUpdatingStatus||!e.selectedStatusId||e.selectedStatusId===e.order.orderStatusId),a(),c(e.isUpdatingStatus?114:-1),a(),x(" ",e.isUpdatingStatus?"\u062F\u0631 \u062D\u0627\u0644 \u0628\u0631\u0648\u0632\u0631\u0633\u0627\u0646\u06CC...":"\u0628\u0631\u0648\u0632\u0631\u0633\u0627\u0646\u06CC \u0648\u0636\u0639\u06CC\u062A"," ")}}var oi=(()=>{class r{constructor(e,o,u,s,p){this.route=e,this.adminOrderService=o,this.adminOrderStatusService=u,this.notificationService=s,this.authService=p,this.order=null,this.orderStatuses=[],this.isLoading=!0,this.isUpdatingStatus=!1}ngOnInit(){let e=this.route.snapshot.paramMap.get("id");e&&(this.orderId=Number(e),this.loadOrder(),this.loadOrderStatuses())}loadOrder(){this.isLoading=!0,this.adminOrderService.getOrderById(this.orderId).subscribe({next:e=>{this.order=e,this.selectedStatusId=e.orderStatusId,this.isLoading=!1},error:e=>{console.error("Error loading order:",e),this.notificationService.show("\u062E\u0637\u0627 \u062F\u0631 \u0628\u0627\u0631\u06AF\u0630\u0627\u0631\u06CC \u0633\u0641\u0627\u0631\u0634","error"),this.isLoading=!1}})}loadOrderStatuses(){this.adminOrderStatusService.getOrderStatuses().subscribe({next:e=>{this.orderStatuses=e},error:e=>{console.error("Error loading order statuses:",e),this.notificationService.show("\u062E\u0637\u0627 \u062F\u0631 \u0628\u0627\u0631\u06AF\u0630\u0627\u0631\u06CC \u0648\u0636\u0639\u06CC\u062A\u200C\u0647\u0627\u06CC \u0633\u0641\u0627\u0631\u0634","error")}})}updateStatus(){if(!this.orderId||!this.order||!this.selectedStatusId){this.notificationService.show("\u0627\u0637\u0644\u0627\u0639\u0627\u062A \u06A9\u0627\u0645\u0644 \u0646\u06CC\u0633\u062A","error");return}if(!this.order.rowVersion){this.notificationService.show("\u0627\u0637\u0644\u0627\u0639\u0627\u062A \u0633\u0641\u0627\u0631\u0634 \u0628\u0631\u0627\u06CC \u062A\u063A\u06CC\u06CC\u0631 \u0648\u0636\u0639\u06CC\u062A \u06A9\u0627\u0645\u0644 \u0646\u06CC\u0633\u062A (\u0646\u0633\u062E\u0647 \u0631\u062F\u06CC\u0641 \u0645\u0648\u062C\u0648\u062F \u0646\u06CC\u0633\u062A).","error");return}if(this.selectedStatusId===this.order.orderStatusId){this.notificationService.show("\u0648\u0636\u0639\u06CC\u062A \u0627\u0646\u062A\u062E\u0627\u0628\u06CC \u0628\u0627 \u0648\u0636\u0639\u06CC\u062A \u0641\u0639\u0644\u06CC \u06CC\u06A9\u0633\u0627\u0646 \u0627\u0633\u062A","info");return}this.isUpdatingStatus=!0;let e=this.order.rowVersion;this.adminOrderService.updateOrderStatus(this.orderId,{orderStatusId:this.selectedStatusId,rowVersion:e,updatedByUserId:this.authService.currentUserValue?.id||0}).pipe(L(()=>this.isUpdatingStatus=!1)).subscribe({next:()=>{this.notificationService.show("\u0648\u0636\u0639\u06CC\u062A \u0633\u0641\u0627\u0631\u0634 \u0628\u0627 \u0645\u0648\u0641\u0642\u06CC\u062A \u0628\u0631\u0648\u0632\u0631\u0633\u0627\u0646\u06CC \u0634\u062F","success"),this.loadOrder()},error:o=>{console.error("Error updating order status:",o),o?.status===409?this.notificationService.show("\u0633\u0641\u0627\u0631\u0634 \u062A\u0648\u0633\u0637 \u06A9\u0627\u0631\u0628\u0631 \u062F\u06CC\u06AF\u0631\u06CC \u062A\u063A\u06CC\u06CC\u0631 \u06A9\u0631\u062F\u0647 \u0627\u0633\u062A. \u062F\u0631 \u062D\u0627\u0644 \u0628\u0627\u0631\u06AF\u0630\u0627\u0631\u06CC \u0645\u062C\u062F\u062F...","error"):this.notificationService.show(o?.error?.message||"\u062E\u0637\u0627 \u062F\u0631 \u0628\u0631\u0648\u0632\u0631\u0633\u0627\u0646\u06CC \u0648\u0636\u0639\u06CC\u062A","error"),this.loadOrder()}})}static{this.\u0275fac=function(o){return new(o||r)(h(ue),h(Ge),h(De),h(D),h(Pt))}}static{this.\u0275cmp=k({type:r,selectors:[["app-admin-order-detail"]],decls:3,vars:3,consts:[[1,"flex","justify-center","items-center","py-20"],[1,"flex","flex-col","items-center","justify-center","py-20","text-center","animate-fade-in"],[1,"max-w-5xl","mx-auto","animate-fade-in-up"],[1,"material-icons","animate-spin","text-primary","text-5xl"],[1,"material-icons","text-6xl","text-muted-foreground","mb-4","opacity-20"],[1,"text-xl","font-bold","text-foreground"],[1,"text-muted-foreground","mt-2"],["routerLink","/admin/orders",1,"btn","btn-primary","mt-6"],[1,"flex","flex-col","sm:flex-row","sm:items-center","sm:justify-between","mb-6","gap-4"],[1,"text-2xl","font-bold","text-heading-foreground","flex","items-center","gap-2"],[1,"material-icons","text-primary"],[1,"font-mono","text-muted-foreground"],[1,"text-sm","text-muted-foreground","mt-1","flex","items-center","gap-1"],[1,"material-icons","text-[14px]"],[1,"dir-ltr"],["routerLink","/admin/orders",1,"btn","btn-outline","btn-sm","self-start","sm:self-center","gap-2"],[1,"material-icons","text-base"],[1,"grid","grid-cols-1","lg:grid-cols-3","gap-6","items-start"],[1,"lg:col-span-2","space-y-6"],[1,"card","border","border-border","shadow-sm"],[1,"p-6","border-b","border-border","bg-muted/5"],[1,"font-semibold","text-lg","text-foreground","flex","items-center","gap-2"],[1,"badge","badge-secondary","text-xs"],[1,"divide-y","divide-border"],[1,"p-4","flex","items-center","gap-4","hover:bg-muted/30","transition-colors"],[1,"space-y-6","lg:sticky","top-24"],[1,"card","p-6","border","border-border","shadow-sm"],[1,"font-semibold","text-lg","text-foreground","mb-4","flex","items-center","gap-2"],[1,"space-y-3","text-sm"],[1,"flex","justify-between"],[1,"text-muted-foreground"],[1,"font-medium","text-foreground"],[1,"font-medium","text-foreground","dir-ltr","font-mono"],[1,"border-t","border-border","my-2","pt-2"],[1,"text-muted-foreground","block","mb-1"],[1,"text-foreground","leading-relaxed"],[1,"material-icons","text-success"],[1,"flex","justify-between","items-center"],[1,"font-bold","text-foreground"],[1,"flex","justify-between","items-center","pt-3","border-t","border-border","mt-3"],[1,"font-bold","text-lg","text-foreground"],[1,"font-black","text-xl","text-primary"],[1,"bg-muted/30","p-3","rounded-lg","mt-4","flex","justify-between","items-center"],[1,"text-muted-foreground","text-xs"],[1,"font-bold","text-success"],[1,"material-icons","text-warning"],[1,"space-y-4"],[1,"p-3","rounded-lg","bg-muted/20","border","border-border","flex","items-center","justify-between"],[1,"text-sm","text-muted-foreground"],[1,"px-2.5","py-1","text-xs","font-semibold","rounded-full","flex","items-center","gap-1",3,"ngClass"],[1,"space-y-2"],[1,"text-sm","font-medium","text-foreground"],[1,"input","w-full",3,"ngModelChange","ngModel"],["disabled","",3,"ngValue"],[3,"ngValue"],[1,"btn","btn-primary","w-full","shadow-button",3,"click","disabled"],[1,"material-icons","animate-spin","me-2","text-lg"],[1,"w-20","h-20","rounded-lg","border","border-border","bg-background","p-1","shrink-0","overflow-hidden"],[1,"w-full","h-full","object-contain",3,"src","alt"],[1,"flex-1","min-w-0"],[1,"font-medium","text-foreground","truncate"],[1,"flex","flex-wrap","gap-2","mt-1"],[1,"badge","badge-outline","text-[10px]"],[1,"flex","items-center","gap-4","mt-2","text-sm","text-muted-foreground"],[1,"text-right","shrink-0"],[1,"font-bold","text-foreground","text-lg","tabular-nums"],[1,"text-xs","text-muted-foreground"],[1,"font-medium","text-destructive"]],template:function(o,u){o&1&&(m(0,nr,3,0,"div",0),m(1,rr,9,0,"div",1),m(2,lr,116,34,"div",2)),o&2&&(c(u.isLoading?0:-1),a(),c(!u.isLoading&&!u.order?1:-1),a(),c(u.order?2:-1))},dependencies:[M,q,j,N,ge,ie,ne,te,$,Ce,be,fe,Xe,Ze],encapsulation:2})}}return r})();var ui=(()=>{class r{transform(e){return e?.trim()||""}static{this.\u0275fac=function(o){return new(o||r)}}static{this.\u0275pipe=Et({name:"trim",type:r,pure:!0})}}return r})();var mr=r=>["/admin/orders",r];function cr(r,d){if(r&1&&(i(0,"option",12),n(1),t()),r&2){let e=d.$implicit;f("value",e.id),a(),x(" ",e.name," ")}}function pr(r,d){if(r&1&&(i(0,"div",21)(1,"div",26)(2,"div",27)(3,"p",28),n(4,"\u062A\u0639\u062F\u0627\u062F \u0633\u0641\u0627\u0631\u0634\u0627\u062A"),t(),i(5,"span",29),n(6,"shopping_cart"),t()(),i(7,"p",30),n(8),F(9,"number"),t()(),i(10,"div",31)(11,"div",27)(12,"p",28),n(13,"\u0645\u062C\u0645\u0648\u0639 \u062F\u0631\u0622\u0645\u062F"),t(),i(14,"span",32),n(15,"payments"),t()(),i(16,"p",30),n(17),F(18,"number"),i(19,"span",33),n(20,"\u062A\u0648\u0645\u0627\u0646"),t()()(),i(21,"div",34)(22,"div",27)(23,"p",28),n(24,"\u0645\u062C\u0645\u0648\u0639 \u0633\u0648\u062F"),t(),i(25,"span",35),n(26,"trending_up"),t()(),i(27,"p",30),n(28),F(29,"number"),i(30,"span",33),n(31,"\u062A\u0648\u0645\u0627\u0646"),t()()(),i(32,"div",36)(33,"div",27)(34,"p",28),n(35,"\u0645\u06CC\u0627\u0646\u06AF\u06CC\u0646 \u0633\u0641\u0627\u0631\u0634"),t(),i(36,"span",37),n(37,"analytics"),t()(),i(38,"p",30),n(39),F(40,"number"),i(41,"span",33),n(42,"\u062A\u0648\u0645\u0627\u0646"),t()()()()),r&2){let e=l();a(8),v(U(9,4,e.statistics.totalOrders)),a(9),x("",U(18,6,e.statistics.totalRevenue)," "),a(11),x("",U(29,8,e.statistics.totalProfit)," "),a(11),x("",oe(40,10,e.statistics.averageOrderValue,"1.0-0")," ")}}function fr(r,d){r&1&&(i(0,"div",23),g(1,"span",38),t())}function gr(r,d){r&1&&(i(0,"div",24)(1,"div",39)(2,"span",40),n(3,"receipt"),t(),i(4,"p"),n(5,"\u0647\u06CC\u0686 \u0633\u0641\u0627\u0631\u0634\u06CC \u06CC\u0627\u0641\u062A \u0646\u0634\u062F."),t()()())}function xr(r,d){if(r&1){let e=S();i(0,"tr",48)(1,"td",49),n(2),t(),i(3,"td",50)(4,"div",51)(5,"span",52),n(6),F(7,"trim"),t(),i(8,"span",53),n(9),t()()(),i(10,"td",54),n(11),F(12,"number"),i(13,"span",33),n(14,"\u062A\u0648\u0645\u0627\u0646"),t()(),i(15,"td",55)(16,"span",56),F(17,"statusClass"),i(18,"span",57),n(19),t(),n(20),t()(),i(21,"td",58),n(22),F(23,"date"),t(),i(24,"td",59)(25,"div",60)(26,"a",61)(27,"span",62),n(28,"visibility"),t()(),i(29,"button",63),C("click",function(){let u=b(e).$implicit,s=l(2);return _(s.deleteOrder(u.id))}),i(30,"span",62),n(31,"delete"),t()()()()()}if(r&2){let e=d.$implicit;a(2),x("#",e.id),a(4),v(U(7,9,((e.user==null?null:e.user.firstName)||"")+" "+((e.user==null?null:e.user.lastName)||""))),a(3),v(e.user==null?null:e.user.phoneNumber),a(2),x(" ",U(12,11,e.totalAmount)," "),a(5),f("ngClass",U(17,13,e.orderStatus==null?null:e.orderStatus.name)),a(3),v(e.orderStatus==null?null:e.orderStatus.icon),a(),x(" ",e.orderStatus==null?null:e.orderStatus.name," "),a(2),x(" ",oe(23,15,e.createdAt,"yyyy/MM/dd")," "),a(4),f("routerLink",J(18,mr,e.id))}}function hr(r,d){if(r&1&&(i(0,"div",25)(1,"table",41)(2,"thead",42)(3,"tr")(4,"th",43),n(5,"\u06A9\u062F \u0633\u0641\u0627\u0631\u0634"),t(),i(6,"th",44),n(7,"\u06A9\u0627\u0631\u0628\u0631"),t(),i(8,"th",44),n(9,"\u0645\u0628\u0644\u063A \u06A9\u0644"),t(),i(10,"th",45),n(11,"\u0648\u0636\u0639\u06CC\u062A"),t(),i(12,"th",44),n(13,"\u062A\u0627\u0631\u06CC\u062E"),t(),i(14,"th",46),n(15,"\u0639\u0645\u0644\u06CC\u0627\u062A"),t()()(),i(16,"tbody",47),A(17,xr,32,20,"tr",48,T),t()()()),r&2){let e=l();a(17),E(e.orders)}}var ai=(()=>{class r{constructor(e,o,u){this.adminOrderService=e,this.adminOrderStatusService=o,this.notificationService=u,this.orders=[],this.orderStatuses=[],this.pagination=null,this.statistics=null,this.isLoading=!0,this.currentPage=1,this.filterForm=new Ie({userId:new H(null),statusId:new H(null),fromDate:new H(null),toDate:new H(null)})}ngOnInit(){this.loadOrderStatuses(),this.loadOrders(),this.loadStatistics()}loadOrderStatuses(){this.adminOrderStatusService.getOrderStatuses().subscribe({next:e=>{this.orderStatuses=e},error:()=>{this.notificationService.show("\u062E\u0637\u0627 \u062F\u0631 \u0628\u0627\u0631\u06AF\u0630\u0627\u0631\u06CC \u0648\u0636\u0639\u06CC\u062A\u200C\u0647\u0627\u06CC \u0633\u0641\u0627\u0631\u0634","error")}})}loadOrders(e=1){this.isLoading=!0,this.currentPage=e;let o={page:this.currentPage,pageSize:10},u=this.filterForm.value;u.userId&&(o.userId=u.userId),u.statusId&&(o.statusId=u.statusId),u.fromDate&&(o.fromDate=new Date(u.fromDate).toISOString()),u.toDate&&(o.toDate=new Date(u.toDate).toISOString()),this.adminOrderService.getOrders(o).subscribe({next:s=>{this.orders=s.items??[],this.pagination=s,this.isLoading=!1},error:()=>{this.notificationService.show("\u062E\u0637\u0627 \u062F\u0631 \u0628\u0627\u0631\u06AF\u0630\u0627\u0631\u06CC \u0633\u0641\u0627\u0631\u0634\u0627\u062A","error"),this.isLoading=!1}})}loadStatistics(){let e=this.filterForm.value,o=e.fromDate?new Date(e.fromDate).toISOString():void 0,u=e.toDate?new Date(e.toDate).toISOString():void 0;this.adminOrderService.getStatistics(o,u).subscribe({next:s=>{this.statistics=s.generalStatistics},error:()=>{this.notificationService.show("\u062E\u0637\u0627 \u062F\u0631 \u0628\u0627\u0631\u06AF\u0630\u0627\u0631\u06CC \u0622\u0645\u0627\u0631","error")}})}applyFilters(){this.loadOrders(1),this.loadStatistics()}clearFilters(){this.filterForm.reset(),this.loadOrders(1),this.loadStatistics()}deleteOrder(e){confirm("\u0622\u06CC\u0627 \u0627\u0632 \u062D\u0630\u0641 \u0627\u06CC\u0646 \u0633\u0641\u0627\u0631\u0634 \u0627\u0637\u0645\u06CC\u0646\u0627\u0646 \u062F\u0627\u0631\u06CC\u062F\u061F")&&this.adminOrderService.deleteOrder(e).subscribe({next:()=>{this.notificationService.show("\u0633\u0641\u0627\u0631\u0634 \u0628\u0627 \u0645\u0648\u0641\u0642\u06CC\u062A \u062D\u0630\u0641 \u0634\u062F","success"),this.loadOrders(this.currentPage),this.loadStatistics()},error:o=>{this.notificationService.show(o?.error?.message||"\u062E\u0637\u0627 \u062F\u0631 \u062D\u0630\u0641 \u0633\u0641\u0627\u0631\u0634","error")}})}static{this.\u0275fac=function(o){return new(o||r)(h(Ge),h(De),h(D))}}static{this.\u0275cmp=k({type:r,selectors:[["app-admin-order-list"]],decls:44,vars:6,consts:[[1,"flex","items-center","justify-between","mb-6","animate-fade-in"],[1,"text-2xl","font-bold","text-heading-foreground","flex","items-center","gap-2"],[1,"material-icons","text-primary"],[1,"text-sm","text-muted-foreground","mt-1"],[1,"card","p-6","mb-6","border","border-border","shadow-sm","animate-fade-in"],[1,"grid","grid-cols-1","md:grid-cols-2","lg:grid-cols-4","gap-4",3,"formGroup"],[1,"space-y-2","form-group"],["for","userId",1,"form-label"],["type","number","id","userId","formControlName","userId","placeholder","\u0645\u062B\u0644\u0627: 1001",1,"input"],["for","statusId",1,"form-label"],["id","statusId","formControlName","statusId",1,"input"],[3,"ngValue"],[3,"value"],["for","fromDate",1,"form-label"],["type","date","id","fromDate","formControlName","fromDate",1,"input","ltr-input"],["for","toDate",1,"form-label"],["type","date","id","toDate","formControlName","toDate",1,"input","ltr-input"],[1,"flex","items-end","gap-2","col-span-full","pt-2"],["type","button",1,"btn","btn-primary","shadow-sm",3,"click"],[1,"material-icons","text-sm","me-1"],["type","button",1,"btn","btn-outline",3,"click"],[1,"grid","grid-cols-1","md:grid-cols-2","lg:grid-cols-4","gap-4","mb-6","animate-fade-in","delay-100"],[1,"card","overflow-hidden","border","border-border","shadow-sm","animate-fade-in","delay-200"],[1,"flex","justify-center","items-center","p-12"],[1,"text-center","p-12"],[1,"w-full","overflow-x-auto"],[1,"stat-card","border-r-4","border-r-primary","hover-lift"],[1,"flex","items-center","justify-between"],[1,"stat-label"],[1,"material-icons","text-primary/80"],[1,"mt-2","stat-value"],[1,"stat-card","border-r-4","border-r-success","hover-lift"],[1,"material-icons","text-success/80"],[1,"text-xs","font-normal","text-muted-foreground"],[1,"stat-card","border-r-4","border-r-info","hover-lift"],[1,"material-icons","text-info/80"],[1,"stat-card","border-r-4","border-r-warning","hover-lift"],[1,"material-icons","text-warning/80"],[1,"spinner","spinner-xl","text-primary"],[1,"flex","flex-col","items-center","gap-3","text-muted-foreground","opacity-50"],[1,"material-icons","text-5xl"],[1,"w-full","text-right","text-sm"],[1,"bg-muted/50","border-b","border-border","text-muted-foreground"],[1,"h-12","px-6","align-middle","font-medium","whitespace-nowrap","w-24"],[1,"h-12","px-6","align-middle","font-medium","whitespace-nowrap"],[1,"h-12","px-6","align-middle","font-medium","whitespace-nowrap","text-center"],[1,"h-12","px-6","align-middle","font-medium","whitespace-nowrap","w-32"],[1,"divide-y","divide-border/50","bg-card"],[1,"group","hover:bg-muted/30","transition-colors"],[1,"p-6","align-middle","font-mono","font-medium","text-primary","whitespace-nowrap","dir-ltr","text-right"],[1,"p-6","align-middle","text-foreground","whitespace-nowrap"],[1,"flex","flex-col"],[1,"font-medium"],[1,"text-xs","text-muted-foreground","font-mono","mt-0.5","dir-ltr","text-right"],[1,"p-6","align-middle","text-foreground","font-medium","whitespace-nowrap","tabular-nums"],[1,"p-6","align-middle","text-center"],[1,"px-2.5","py-1","text-xs","font-semibold","rounded-full","inline-flex","items-center","gap-1",3,"ngClass"],[1,"material-icons","text-[14px]"],[1,"p-6","align-middle","text-muted-foreground","whitespace-nowrap","dir-ltr","text-right","font-mono","text-xs"],[1,"p-6","align-middle","whitespace-nowrap"],[1,"flex","items-center","justify-end","gap-2","opacity-0","group-hover:opacity-100","transition-opacity"],["title","\u062C\u0632\u0626\u06CC\u0627\u062A",1,"btn","btn-ghost","btn-sm","btn-icon","text-primary","hover:text-primary-foreground","hover:bg-primary",3,"routerLink"],[1,"material-icons","text-lg"],["title","\u062D\u0630\u0641",1,"btn","btn-ghost","btn-sm","btn-icon","text-muted-foreground","hover:text-destructive-foreground","hover:bg-destructive",3,"click"]],template:function(o,u){o&1&&(i(0,"div",0)(1,"div")(2,"h1",1)(3,"span",2),n(4,"receipt_long"),t(),n(5," \u0645\u062F\u06CC\u0631\u06CC\u062A \u0633\u0641\u0627\u0631\u0634\u0627\u062A "),t(),i(6,"p",3),n(7,"\u0645\u0634\u0627\u0647\u062F\u0647 \u0648 \u0645\u062F\u06CC\u0631\u06CC\u062A \u062A\u0645\u0627\u0645\u06CC \u0633\u0641\u0627\u0631\u0634\u0627\u062A \u062B\u0628\u062A \u0634\u062F\u0647"),t()()(),i(8,"div",4)(9,"form",5)(10,"div",6)(11,"label",7),n(12,"\u0634\u0646\u0627\u0633\u0647 \u06A9\u0627\u0631\u0628\u0631"),t(),g(13,"input",8),t(),i(14,"div",6)(15,"label",9),n(16,"\u0648\u0636\u0639\u06CC\u062A"),t(),i(17,"select",10)(18,"option",11),n(19,"\u0647\u0645\u0647 \u0648\u0636\u0639\u06CC\u062A\u200C\u0647\u0627"),t(),A(20,cr,2,2,"option",12,T),t()(),i(22,"div",6)(23,"label",13),n(24,"\u0627\u0632 \u062A\u0627\u0631\u06CC\u062E"),t(),g(25,"input",14),t(),i(26,"div",6)(27,"label",15),n(28,"\u062A\u0627 \u062A\u0627\u0631\u06CC\u062E"),t(),g(29,"input",16),t(),i(30,"div",17)(31,"button",18),C("click",function(){return u.applyFilters()}),i(32,"span",19),n(33,"filter_list"),t(),n(34," \u0627\u0639\u0645\u0627\u0644 \u0641\u06CC\u0644\u062A\u0631 "),t(),i(35,"button",20),C("click",function(){return u.clearFilters()}),i(36,"span",19),n(37,"clear_all"),t(),n(38," \u067E\u0627\u06A9 \u06A9\u0631\u062F\u0646 "),t()()()(),m(39,pr,43,13,"div",21),i(40,"div",22),m(41,fr,2,0,"div",23),m(42,gr,6,0,"div",24),m(43,hr,19,0,"div",25),t()),o&2&&(a(9),f("formGroup",u.filterForm),a(9),f("ngValue",null),a(2),E(u.orderStatuses),a(19),c(u.statistics?39:-1),a(2),c(u.isLoading?41:-1),a(),c(!u.isLoading&&u.orders.length===0?42:-1),a(),c(!u.isLoading&&u.orders.length>0?43:-1))},dependencies:[M,q,j,N,me,se,ie,ne,Z,ee,te,$,ae,le,de,be,fe,ui,Ze],encapsulation:2})}}return r})();function Cr(r,d){r&1&&g(0,"span",20)}var ht=(()=>{class r{constructor(e,o,u,s){this.route=e,this.router=o,this.notificationService=u,this.adminOrderStatusService=s,this.isEditMode=!1,this.statusId=null,this.isSubmitting=!1,this.statusForm=new Ie({name:new H("",[I.required,I.maxLength(100)]),icon:new H("",[I.maxLength(50)])})}ngOnInit(){let e=this.route.snapshot.paramMap.get("id");e&&(this.statusId=Number(e),this.isEditMode=!0,this.loadStatusData())}loadStatusData(){this.statusId&&this.adminOrderStatusService.getOrderStatus(this.statusId).subscribe({next:e=>{this.statusForm.patchValue(e)},error:e=>this.notificationService.show(e?.error?.message||"\u062E\u0637\u0627 \u062F\u0631 \u0628\u0627\u0631\u06AF\u0630\u0627\u0631\u06CC \u0627\u0637\u0644\u0627\u0639\u0627\u062A","error")})}onSubmit(){if(this.statusForm.invalid||this.isSubmitting)return;this.isSubmitting=!0;let e=this.statusForm.value;(this.isEditMode&&this.statusId?this.adminOrderStatusService.updateOrderStatus(this.statusId,e):this.adminOrderStatusService.createOrderStatus(e)).pipe(L(()=>this.isSubmitting=!1)).subscribe({next:()=>{this.notificationService.show(`\u0648\u0636\u0639\u06CC\u062A \u0628\u0627 \u0645\u0648\u0641\u0642\u06CC\u062A ${this.isEditMode?"\u0648\u06CC\u0631\u0627\u06CC\u0634":"\u0627\u06CC\u062C\u0627\u062F"} \u0634\u062F`,"success"),this.router.navigate(["/admin/order-statuses"])},error:u=>this.notificationService.show(u?.error?.message||"\u062E\u0637\u0627 \u062F\u0631 \u062B\u0628\u062A \u062A\u063A\u06CC\u06CC\u0631\u0627\u062A","error")})}static{this.\u0275fac=function(o){return new(o||r)(h(ue),h(he),h(D),h(De))}}static{this.\u0275cmp=k({type:r,selectors:[["app-admin-order-status-form"]],decls:34,vars:6,consts:[[1,"max-w-md","mx-auto","animate-fade-in-up"],[1,"flex","items-center","justify-between","mb-6"],[1,"text-2xl","font-bold","text-heading-foreground","tracking-tight"],["routerLink","/admin/order-statuses",1,"btn","btn-ghost","btn-sm","text-muted-foreground","hover:text-foreground"],[1,"material-icons","text-sm","me-1"],[1,"card","p-6","space-y-6","shadow-md","border-border",3,"ngSubmit","formGroup"],[1,"space-y-4"],[1,"space-y-2","form-group"],["for","name",1,"form-label"],[1,"text-destructive"],["type","text","id","name","formControlName","name","placeholder","\u0645\u062B\u0627\u0644: \u062F\u0631 \u062D\u0627\u0644 \u067E\u0631\u062F\u0627\u0632\u0634",1,"input","w-full"],["for","icon",1,"form-label"],[1,"flex","gap-3"],["type","text","id","icon","formControlName","icon","placeholder","shopping_cart",1,"input","flex-1","ltr-input"],[1,"w-10","h-10","flex","items-center","justify-center","rounded-md","border","border-input","bg-muted/30","text-primary"],[1,"material-icons"],[1,"text-xs","text-muted-foreground","mt-1"],["href","https://fonts.google.com/icons","target","_blank",1,"text-primary","underline","hover:text-primary-600"],[1,"pt-6","border-t","border-border","flex","justify-end"],["type","submit",1,"btn","btn-primary","w-full","sm:w-auto","min-w-[120px]","shadow-button",3,"disabled"],[1,"spinner","spinner-sm","me-2","border-white"]],template:function(o,u){if(o&1&&(i(0,"div",0)(1,"div",1)(2,"h1",2),n(3),t(),i(4,"a",3)(5,"span",4),n(6,"arrow_forward"),t(),n(7," \u0628\u0627\u0632\u06AF\u0634\u062A "),t()(),i(8,"form",5),C("ngSubmit",function(){return u.onSubmit()}),i(9,"div",6)(10,"div",7)(11,"label",8),n(12," \u0646\u0627\u0645 \u0648\u0636\u0639\u06CC\u062A "),i(13,"span",9),n(14,"*"),t()(),g(15,"input",10),t(),i(16,"div",7)(17,"label",11),n(18,"\u0622\u06CC\u06A9\u0648\u0646 (Material Icons)"),t(),i(19,"div",12),g(20,"input",13),i(21,"div",14)(22,"span",15),n(23),t()()(),i(24,"p",16),n(25," \u0646\u0627\u0645 \u0622\u06CC\u06A9\u0648\u0646 \u0631\u0627 \u0627\u0632 "),i(26,"a",17),n(27,"Google Fonts"),t(),n(28," \u06A9\u067E\u06CC \u06A9\u0646\u06CC\u062F. "),t()()(),i(29,"div",18)(30,"button",19),m(31,Cr,1,0,"span",20),i(32,"span"),n(33),t()()()()()),o&2){let s;a(3),x(" ",u.isEditMode?"\u0648\u06CC\u0631\u0627\u06CC\u0634":"\u0627\u06CC\u062C\u0627\u062F"," \u0648\u0636\u0639\u06CC\u062A \u0633\u0641\u0627\u0631\u0634 "),a(5),f("formGroup",u.statusForm),a(15),v(((s=u.statusForm.get("icon"))==null?null:s.value)||"help_outline"),a(7),f("disabled",u.statusForm.invalid||u.isSubmitting),a(),c(u.isSubmitting?31:-1),a(2),v(u.isSubmitting?"\u062F\u0631 \u062D\u0627\u0644 \u0630\u062E\u06CC\u0631\u0647...":"\u0630\u062E\u06CC\u0631\u0647 \u0648\u0636\u0639\u06CC\u062A")}},dependencies:[me,se,Z,$,ae,le,de,j,N],encapsulation:2})}}return r})();var vr=r=>["/admin/order-statuses/edit",r];function br(r,d){r&1&&(i(0,"div",8),g(1,"span",11),t())}function _r(r,d){r&1&&(i(0,"div",9)(1,"p",12),n(2,"\u0647\u06CC\u0686 \u0648\u0636\u0639\u06CC\u062A\u06CC \u062A\u0639\u0631\u06CC\u0641 \u0646\u0634\u062F\u0647 \u0627\u0633\u062A."),t()())}function Sr(r,d){if(r&1){let e=S();i(0,"div",13)(1,"div",14)(2,"div",15)(3,"span",16),n(4),t()(),i(5,"div")(6,"h3",17),n(7),t(),i(8,"p",18),n(9),t()()(),i(10,"div",19)(11,"a",20)(12,"span",21),n(13,"edit"),t()(),i(14,"button",22),C("click",function(){let u=b(e).$implicit,s=l(2);return _(s.deleteStatus(u.id))}),i(15,"span",21),n(16,"delete"),t()()()()}if(r&2){let e=d.$implicit;a(4),v(e.icon||"circle"),a(3),v(e.name),a(2),x(" ",e.count||0," \u0633\u0641\u0627\u0631\u0634 "),a(2),f("routerLink",J(4,vr,e.id))}}function yr(r,d){if(r&1&&(i(0,"div",10),A(1,Sr,17,6,"div",13,T),t()),r&2){let e=l();a(),E(e.statuses)}}var si=(()=>{class r{constructor(e,o,u){this.adminOrderStatusService=e,this.adminOrderService=o,this.notificationService=u,this.statuses=[],this.isLoading=!0}ngOnInit(){this.loadData()}loadData(){this.isLoading=!0,je({statuses:this.adminOrderStatusService.getOrderStatuses(),stats:this.adminOrderService.getStatistics()}).subscribe({next:e=>{this.statuses=e.statuses;let o=e.stats.statusStatistics||[];this.statuses.forEach(u=>{let s=o.find(p=>p.orderStatusId===u.id);u.count=s?s.count:0}),this.isLoading=!1},error:()=>{this.notificationService.show("\u062E\u0637\u0627 \u062F\u0631 \u0628\u0627\u0631\u06AF\u0630\u0627\u0631\u06CC \u0627\u0637\u0644\u0627\u0639\u0627\u062A","error"),this.isLoading=!1}})}deleteStatus(e){confirm("\u0622\u06CC\u0627 \u0627\u0632 \u062D\u0630\u0641 \u0627\u06CC\u0646 \u0648\u0636\u0639\u06CC\u062A \u0627\u0637\u0645\u06CC\u0646\u0627\u0646 \u062F\u0627\u0631\u06CC\u062F\u061F")&&this.adminOrderStatusService.deleteOrderStatus(e).subscribe({next:()=>{this.notificationService.show("\u0648\u0636\u0639\u06CC\u062A \u0628\u0627 \u0645\u0648\u0641\u0642\u06CC\u062A \u062D\u0630\u0641 \u0634\u062F","success"),this.loadData()},error:o=>this.notificationService.show(o?.error?.message||"\u062E\u0637\u0627 \u062F\u0631 \u062D\u0630\u0641 \u0648\u0636\u0639\u06CC\u062A","error")})}static{this.\u0275fac=function(o){return new(o||r)(h(De),h(Ge),h(D))}}static{this.\u0275cmp=k({type:r,selectors:[["app-admin-order-status-list"]],decls:17,vars:3,consts:[[1,"space-y-6","animate-fade-in"],[1,"flex","items-center","justify-between"],[1,"text-2xl","font-bold","text-heading-foreground","tracking-tight","flex","items-center","gap-2"],[1,"material-icons","text-primary"],[1,"text-sm","text-muted-foreground","mt-1"],["routerLink","/admin/order-statuses/new",1,"btn","btn-primary","btn-sm","sm:btn-md","shadow-lg","shadow-primary/20"],[1,"material-icons","me-1","text-lg"],[1,"card","border","border-border","shadow-sm","overflow-hidden","bg-muted/5"],[1,"flex","justify-center","items-center","py-12"],[1,"text-center","py-12"],[1,"grid","grid-cols-1","sm:grid-cols-2","lg:grid-cols-3","gap-4","p-4"],[1,"spinner","spinner-xl","text-primary"],[1,"text-muted-foreground"],[1,"flex","items-center","justify-between","p-4","rounded-xl","border","border-border","bg-card","hover:border-primary/50","hover:shadow-md","transition-all","duration-300","group"],[1,"flex","items-center","gap-3"],[1,"w-12","h-12","rounded-full","bg-primary/10","text-primary","flex","items-center","justify-center","ring-2","ring-primary/20"],[1,"material-icons","text-2xl"],[1,"font-bold","text-foreground","text-lg"],[1,"text-xs","text-muted-foreground","mt-1","font-medium","bg-muted","px-2","py-0.5","rounded-md","inline-block"],[1,"flex","gap-1","opacity-0","group-hover:opacity-100","transition-opacity"],[1,"btn","btn-icon","btn-ghost","btn-sm","text-primary","hover:text-primary-foreground","hover:bg-primary","rounded-full",3,"routerLink"],[1,"material-icons","text-lg"],[1,"btn","btn-icon","btn-ghost","btn-sm","text-muted-foreground","hover:text-destructive-foreground","hover:bg-destructive","rounded-full",3,"click"]],template:function(o,u){o&1&&(i(0,"div",0)(1,"div",1)(2,"div")(3,"h1",2)(4,"span",3),n(5,"fact_check"),t(),n(6," \u0648\u0636\u0639\u06CC\u062A\u200C\u0647\u0627\u06CC \u0633\u0641\u0627\u0631\u0634 "),t(),i(7,"p",4),n(8,"\u0645\u062F\u06CC\u0631\u06CC\u062A \u0645\u0631\u0627\u062D\u0644 \u0645\u062E\u062A\u0644\u0641 \u0633\u0641\u0627\u0631\u0634\u0627\u062A"),t()(),i(9,"a",5)(10,"span",6),n(11,"add"),t(),n(12," \u0648\u0636\u0639\u06CC\u062A \u062C\u062F\u06CC\u062F "),t()(),i(13,"div",7),m(14,br,2,0,"div",8),m(15,_r,3,0,"div",9),m(16,yr,3,0,"div",10),t()()),o&2&&(a(14),c(u.isLoading?14:-1),a(),c(!u.isLoading&&u.statuses.length===0?15:-1),a(),c(!u.isLoading&&u.statuses.length>0?16:-1))},dependencies:[j,N],encapsulation:2})}}return r})();var Pe=(()=>{class r{constructor(e){this.http=e,this.apiUrl=`${R.API_URL}admin/products`,this.shippingApiUrl=`${R.API_URL}admin/shipping-methods`}getProducts(e){let o=new z().set("page",e.page.toString()).set("pageSize",e.pageSize.toString());return e.searchTerm&&(o=o.set("searchTerm",e.searchTerm)),e.categoryId&&(o=o.set("categoryId",e.categoryId.toString())),e.isActive!==void 0&&(o=o.set("isActive",e.isActive.toString())),e.includeDeleted&&(o=o.set("includeDeleted",e.includeDeleted.toString())),this.http.get(this.apiUrl,{params:o})}getAllShippingMethods(){return this.http.get(this.shippingApiUrl)}getProductById(e){return this.http.get(`${this.apiUrl}/${e}`)}createProduct(e){return this.http.post(this.apiUrl,e)}updateProduct(e,o){return this.http.put(`${this.apiUrl}/${e}`,o)}deleteProduct(e){return this.http.delete(`${this.apiUrl}/${e}`)}restoreProduct(e){return this.http.post(`${this.apiUrl}/${e}/restore`,{})}getAllAttributes(){return this.http.get(`${this.apiUrl}/attributes/with-values`)}addStock(e,o,u){return this.http.post(`${this.apiUrl}/stock/add`,{variantId:e,quantity:o,notes:u})}removeStock(e,o,u){return this.http.post(`${this.apiUrl}/stock/remove`,{variantId:e,quantity:o,notes:u})}setDiscount(e,o,u){return this.http.put(`${this.apiUrl}/variants/${e}/discount`,{originalPrice:o,discountedPrice:u})}removeDiscount(e){return this.http.delete(`${this.apiUrl}/variants/${e}/discount`)}bulkUpdatePrices(e,o){return this.http.post(`${this.apiUrl}/bulk-update-prices?isPurchasePrice=${o}`,e)}getProductStatistics(){return this.http.get(`${this.apiUrl}/statistics`)}getLowStockProducts(e=5){return this.http.get(`${this.apiUrl}/low-stock?threshold=${e}`)}static{this.\u0275fac=function(o){return new(o||r)(W(G))}}static{this.\u0275prov=O({token:r,factory:r.\u0275fac,providedIn:"root"})}}return r})();function Ar(r,d){r&1&&(i(0,"div",15),g(1,"span",18),t())}function Er(r,d){r&1&&(i(0,"div",16)(1,"p"),n(2,"\u0645\u062D\u0635\u0648\u0644\u06CC \u06CC\u0627\u0641\u062A \u0646\u0634\u062F"),t()())}function wr(r,d){if(r&1&&(i(0,"tr",30)(1,"td",31),g(2,"input",32),t(),i(3,"td",31)(4,"div",33)(5,"div",34),g(6,"img",35),t(),i(7,"div",36)(8,"span",37),n(9),t(),i(10,"span",38),n(11),t()()()(),i(12,"td",39),n(13),F(14,"number"),i(15,"span",40),n(16,"\u062A\u0648\u0645\u0627\u0646"),t()(),i(17,"td",31)(18,"div",41),g(19,"input",42),i(20,"span",43),n(21,"\u062A\u0648\u0645\u0627\u0646"),t()()()()),r&2){let e,o=d.$implicit,u=d.$index,s=l(2);B("bg-primary-50",(e=o.get("selected"))==null?null:e.value),f("formGroupName",u),a(6),f("src",o.value.productIcon||"assets/images/placeholder.png",Se)("alt",o.value.productName),a(3),v(o.value.productName),a(2),v(s.getVariantDisplayName(o.value.attributes)),a(2),x(" ",U(14,9,s.getCurrentPrice(o.value))," "),a(6),f("placeholder",s.getCurrentPrice(o.value).toString())}}function Fr(r,d){r&1&&g(0,"span",45)}function kr(r,d){if(r&1){let e=S();i(0,"div",29)(1,"button",44),m(2,Fr,1,0,"span",45),n(3),t(),i(4,"button",46),C("click",function(){b(e);let u=l(2);return _(u.resetForm())}),n(5," \u0628\u0627\u0632\u0646\u0634\u0627\u0646\u06CC "),t(),i(6,"div",47)(7,"span",48),n(8),t(),n(9," \u0645\u0648\u0631\u062F \u0627\u0646\u062A\u062E\u0627\u0628 \u0634\u062F\u0647 "),t()()}if(r&2){let e=l(2);a(),f("disabled",e.isSubmitting),a(),c(e.isSubmitting?2:-1),a(),x(" ",e.isSubmitting?"\u062F\u0631 \u062D\u0627\u0644 \u0628\u0631\u0648\u0632\u0631\u0633\u0627\u0646\u06CC...":"\u0628\u0631\u0648\u0632\u0631\u0633\u0627\u0646\u06CC \u0642\u06CC\u0645\u062A\u200C\u0647\u0627"," "),a(5),v(e.getSelectedCount())}}function Ir(r,d){if(r&1){let e=S();i(0,"form",19),C("ngSubmit",function(){b(e);let u=l();return _(u.updatePrices())}),i(1,"div",20)(2,"div",21)(3,"table",22)(4,"thead",23)(5,"tr")(6,"th",24)(7,"input",25),C("change",function(u){b(e);let s=l();return _(s.toggleAll(u))}),t()(),i(8,"th",26),n(9,"\u0646\u0627\u0645 \u0645\u062D\u0635\u0648\u0644 \u0648 \u062A\u0646\u0648\u0639"),t(),i(10,"th",26),n(11,"\u0642\u06CC\u0645\u062A \u0641\u0639\u0644\u06CC"),t(),i(12,"th",26),n(13,"\u0642\u06CC\u0645\u062A \u062C\u062F\u06CC\u062F"),t()()(),i(14,"tbody",27),A(15,wr,22,11,"tr",28,T),t()()()(),m(17,kr,10,4,"div",29),t()}if(r&2){let e=l();f("formGroup",e.priceForm),a(15),E(e.getVariantControls()),a(2),c(e.hasSelectedProducts()?17:-1)}}var di=(()=>{class r{constructor(e,o,u){this.productService=e,this.adminProductService=o,this.notificationService=u,this.products=[],this.isLoading=!1,this.isSubmitting=!1,this.searchTerm="",this.isPurchasePrice=!1,this.priceForm=new Ie({priceUpdates:new Ut([])})}ngOnInit(){this.loadProducts()}get priceUpdates(){return this.priceForm.get("priceUpdates")}getVariantControls(){return this.priceForm.get("priceUpdates").controls}loadProducts(){this.isLoading=!0,this.productService.getProducts({name:this.searchTerm,page:1,pageSize:500}).pipe(L(()=>this.isLoading=!1)).subscribe({next:e=>{this.products=e.items??[],this.buildForm()},error:()=>{this.notificationService.show("\u062E\u0637\u0627 \u062F\u0631 \u0628\u0627\u0631\u06AF\u0630\u0627\u0631\u06CC \u0645\u062D\u0635\u0648\u0644\u0627\u062A","error")}})}searchProducts(){this.loadProducts()}buildForm(){this.priceUpdates.clear(),this.products.forEach(e=>{e.variants.forEach(o=>{this.priceUpdates.push(new Ie({selected:new H(!1),variantId:new H(o.id),productName:new H(e.name),productIcon:new H(e.iconUrl),purchasePrice:new H(o.purchasePrice),sellingPrice:new H(o.sellingPrice),attributes:new H(o.attributes),newPrice:new H(null,[I.min(1)])}))})})}getCurrentPrice(e){return this.isPurchasePrice?e.purchasePrice:e.sellingPrice}getVariantDisplayName(e){return Object.values(e).map(o=>o.value).join(" / ")}toggleAll(e){let o=e.target.checked;this.priceUpdates.controls.forEach(u=>{u.get("selected")?.setValue(o)})}hasSelectedProducts(){return this.priceUpdates.controls.some(e=>e.get("selected")?.value&&e.get("newPrice")?.value)}getSelectedCount(){return this.priceUpdates.controls.filter(e=>e.get("selected")?.value).length}updatePrices(){let e={};if(this.priceUpdates.controls.forEach(o=>{if(o.get("selected")?.value&&o.get("newPrice")?.value){let u=o.get("variantId")?.value,s=o.get("newPrice")?.value;e[u]=s}}),Object.keys(e).length===0){this.notificationService.show("\u0644\u0637\u0641\u0627\u064B \u0645\u062D\u0635\u0648\u0644\u06CC \u0631\u0627 \u0627\u0646\u062A\u062E\u0627\u0628 \u06A9\u0631\u062F\u0647 \u0648 \u0642\u06CC\u0645\u062A \u062C\u062F\u06CC\u062F\u06CC \u0648\u0627\u0631\u062F \u06A9\u0646\u06CC\u062F","error");return}this.isSubmitting=!0,this.adminProductService.bulkUpdatePrices(e,this.isPurchasePrice).pipe(L(()=>this.isSubmitting=!1)).subscribe({next:()=>{this.notificationService.show("\u0642\u06CC\u0645\u062A\u200C\u0647\u0627 \u0628\u0627 \u0645\u0648\u0641\u0642\u06CC\u062A \u0628\u0631\u0648\u0632\u0631\u0633\u0627\u0646\u06CC \u0634\u062F\u0646\u062F","success"),this.loadProducts()},error:o=>{this.notificationService.show(o?.error?.message||"\u062E\u0637\u0627 \u062F\u0631 \u0628\u0631\u0648\u0632\u0631\u0633\u0627\u0646\u06CC \u0642\u06CC\u0645\u062A\u200C\u0647\u0627","error")}})}resetForm(){this.priceForm.reset(),this.buildForm()}static{this.\u0275fac=function(o){return new(o||r)(h($t),h(Pe),h(D))}}static{this.\u0275cmp=k({type:r,selectors:[["app-admin-bulk-price-update"]],decls:27,vars:7,consts:[[1,"space-y-6","animate-fade-in"],[1,"flex","items-center","justify-between"],[1,"text-2xl","font-bold","text-heading-foreground","flex","items-center","gap-2"],[1,"material-icons","text-primary"],[1,"card","p-6","space-y-4","border","border-border","shadow-sm"],[1,"grid","grid-cols-1","md:grid-cols-3","gap-4"],[1,"space-y-2","form-group"],["for","search",1,"form-label"],[1,"input-group"],[1,"input-addon"],[1,"material-icons","text-sm"],["type","text","id","search","placeholder","\u0646\u0627\u0645 \u0645\u062D\u0635\u0648\u0644 \u06CC\u0627 SKU...",1,"input",3,"ngModelChange","ngModel"],["for","priceType",1,"form-label"],["id","priceType",1,"input",3,"ngModelChange","ngModel"],[3,"ngValue"],[1,"flex","justify-center","items-center","py-12"],[1,"card","p-12","text-center","text-muted-foreground"],[3,"formGroup"],[1,"spinner","spinner-xl","text-primary"],[3,"ngSubmit","formGroup"],[1,"card","overflow-hidden","border","border-border","shadow-sm"],[1,"overflow-x-auto"],[1,"w-full","text-sm","text-right"],[1,"bg-muted/50","border-b","border-border","text-muted-foreground"],[1,"p-4","text-right","w-12"],["type","checkbox",1,"checkbox",3,"change"],[1,"p-4","text-right","font-medium"],["formArrayName","priceUpdates",1,"divide-y","divide-border/50","bg-card"],[1,"hover:bg-muted/20","transition-colors",3,"formGroupName","bg-primary-50"],[1,"flex","gap-3","mt-6","sticky","bottom-6","z-10","bg-background/80","backdrop-blur-sm","p-4","rounded-xl","border","border-border","shadow-lg"],[1,"hover:bg-muted/20","transition-colors",3,"formGroupName"],[1,"p-4","align-middle"],["type","checkbox","formControlName","selected",1,"checkbox"],[1,"flex","items-center","gap-3"],[1,"w-10","h-10","rounded-md","border","border-border","overflow-hidden","shrink-0"],[1,"w-full","h-full","object-cover",3,"src","alt"],[1,"flex","flex-col"],[1,"font-medium","text-foreground"],[1,"text-xs","text-muted-foreground","font-mono","mt-0.5"],[1,"p-4","align-middle","text-foreground","font-medium","tabular-nums"],[1,"text-xs","font-normal","text-muted-foreground"],[1,"input-group","w-48"],["type","number","formControlName","newPrice","min","1",1,"input",3,"placeholder"],[1,"input-addon","text-xs"],["type","submit",1,"btn","btn-primary","shadow-lg","shadow-primary/20",3,"disabled"],[1,"spinner","spinner-sm","mr-2","border-white"],["type","button",1,"btn","btn-outline",3,"click"],[1,"mr-auto","text-sm","text-muted-foreground","flex","items-center"],[1,"font-bold","text-primary","ml-1"]],template:function(o,u){o&1&&(i(0,"div",0)(1,"div",1)(2,"h1",2)(3,"span",3),n(4,"price_change"),t(),n(5," \u0628\u0631\u0648\u0632\u0631\u0633\u0627\u0646\u06CC \u0627\u0646\u0628\u0648\u0647 \u0642\u06CC\u0645\u062A "),t()(),i(6,"div",4)(7,"div",5)(8,"div",6)(9,"label",7),n(10,"\u062C\u0633\u062A\u062C\u0648"),t(),i(11,"div",8)(12,"span",9)(13,"span",10),n(14,"search"),t()(),i(15,"input",11),X("ngModelChange",function(p){return Y(u.searchTerm,p)||(u.searchTerm=p),p}),C("ngModelChange",function(){return u.searchProducts()}),t()()(),i(16,"div",6)(17,"label",12),n(18,"\u0646\u0648\u0639 \u0642\u06CC\u0645\u062A"),t(),i(19,"select",13),X("ngModelChange",function(p){return Y(u.isPurchasePrice,p)||(u.isPurchasePrice=p),p}),i(20,"option",14),n(21,"\u0642\u06CC\u0645\u062A \u0641\u0631\u0648\u0634"),t(),i(22,"option",14),n(23,"\u0642\u06CC\u0645\u062A \u062E\u0631\u06CC\u062F"),t()()()()(),m(24,Ar,2,0,"div",15),m(25,Er,3,0,"div",16),m(26,Ir,18,2,"form",17),t()),o&2&&(a(15),Q("ngModel",u.searchTerm),a(4),Q("ngModel",u.isPurchasePrice),a(),f("ngValue",!1),a(2),f("ngValue",!0),a(2),c(u.isLoading?24:-1),a(),c(!u.isLoading&&u.products.length===0?25:-1),a(),c(!u.isLoading&&u.products.length>0?26:-1))},dependencies:[M,me,se,ie,ne,Z,ee,_e,te,$,ae,Ee,le,de,$e,Be,ge,Ce,be],encapsulation:2})}}return r})();function Tr(r,d){if(r&1&&n(0),r&2){let e=d.$implicit,o=d.$index,u=d.$count;ce(" ",e.value.displayValue,"",o!==u-1?" / ":""," ")}}function Lr(r,d){if(r&1&&(i(0,"option",5),A(1,Tr,1,2,null,null,T),F(3,"keyvalue"),n(4),t()),r&2){let e=d.$implicit;f("value",e.id),a(),E(U(3,2,e.attributes)),a(3),x(" (\u0645\u0648\u062C\u0648\u062F\u06CC \u0641\u0639\u0644\u06CC: ",e.stock,") ")}}function Dr(r,d){r&1&&(i(0,"div",8),n(1," \u062A\u0639\u062F\u0627\u062F \u0628\u0627\u06CC\u062F \u0639\u062F\u062F\u06CC \u0628\u0632\u0631\u06AF\u062A\u0631 \u0627\u0632 \u0635\u0641\u0631 \u0628\u0627\u0634\u062F "),t())}function Pr(r,d){r&1&&g(0,"span",23)}var li=(()=>{class r{constructor(e,o){this.adminProductService=e,this.notificationService=o,this.stockUpdated=new st,this.cancelled=new st,this.isSubmitting=!1,this.stockForm=new Ie({variantId:new H(null,I.required),quantity:new H(1,[I.required,I.min(1),I.max(1e5)]),operation:new H("add",[I.required]),notes:new H("")})}ngOnInit(){this.setInitialVariant()}ngOnChanges(e){e.variants&&this.setInitialVariant()}setInitialVariant(){this.variants&&this.variants.length>0&&!this.stockForm.get("variantId")?.value&&this.stockForm.get("variantId")?.setValue(this.variants[0].id)}updateStock(){if(this.stockForm.invalid||!this.productId)return;this.isSubmitting=!0;let{variantId:e,quantity:o,operation:u,notes:s}=this.stockForm.value;(u==="add"?this.adminProductService.addStock(e,o,s):this.adminProductService.removeStock(e,o,s)).pipe(L(()=>this.isSubmitting=!1)).subscribe({next:()=>{let V=u==="add"?"\u0645\u0648\u062C\u0648\u062F\u06CC \u0628\u0627 \u0645\u0648\u0641\u0642\u06CC\u062A \u0627\u0641\u0632\u0648\u062F\u0647 \u0634\u062F":"\u0645\u0648\u062C\u0648\u062F\u06CC \u0628\u0627 \u0645\u0648\u0641\u0642\u06CC\u062A \u06A9\u0633\u0631 \u0634\u062F";this.notificationService.show(V,"success"),this.stockUpdated.emit(),this.stockForm.reset({variantId:this.variants?.[0].id,operation:"add",quantity:1,notes:""})},error:V=>{this.notificationService.show(V?.error?.message||"\u062E\u0637\u0627 \u062F\u0631 \u0628\u0631\u0648\u0632\u0631\u0633\u0627\u0646\u06CC \u0645\u0648\u062C\u0648\u062F\u06CC","error")}})}cancel(){this.cancelled.emit()}static{this.\u0275fac=function(o){return new(o||r)(h(Pe),h(D))}}static{this.\u0275cmp=k({type:r,selectors:[["app-admin-stock-management"]],inputs:{productId:"productId",variants:"variants"},outputs:{stockUpdated:"stockUpdated",cancelled:"cancelled"},features:[At],decls:39,vars:17,consts:[[1,"p-1"],[1,"space-y-5",3,"ngSubmit","formGroup"],[1,"space-y-2","form-group"],["for","variantStock",1,"form-label"],["id","variantStock","formControlName","variantId",1,"select","w-full","bg-background"],[3,"value"],["for","quantity",1,"form-label"],["type","number","id","quantity","formControlName","quantity","min","1","placeholder","\u062A\u0639\u062F\u0627\u062F \u0631\u0627 \u0648\u0627\u0631\u062F \u06A9\u0646\u06CC\u062F",1,"input","w-full"],[1,"form-error"],["for","operation",1,"form-label"],[1,"grid","grid-cols-2","gap-3"],[1,"cursor-pointer","border","border-border","rounded-lg","p-3","flex","items-center","justify-center","gap-2","hover:bg-success/5","hover:border-success/50","transition-colors"],["type","radio","formControlName","operation","value","add",1,"hidden"],[1,"material-icons","text-success"],[1,"text-sm","font-medium"],[1,"cursor-pointer","border","border-border","rounded-lg","p-3","flex","items-center","justify-center","gap-2","hover:bg-destructive/5","hover:border-destructive/50","transition-colors"],["type","radio","formControlName","operation","value","remove",1,"hidden"],[1,"material-icons","text-destructive"],["for","notes",1,"form-label"],["id","notes","formControlName","notes","placeholder","\u0639\u0644\u062A \u062A\u063A\u06CC\u06CC\u0631 \u0645\u0648\u062C\u0648\u062F\u06CC...",1,"input","w-full","min-h-[80px]","resize-y"],[1,"flex","gap-3","pt-4","border-t","border-border","mt-2"],["type","button",1,"btn","btn-outline","flex-1",3,"click"],["type","submit",1,"btn","btn-primary","flex-[2]","shadow-button",3,"disabled"],[1,"spinner","spinner-sm","mr-2","border-white"]],template:function(o,u){if(o&1&&(i(0,"div",0)(1,"form",1),C("ngSubmit",function(){return u.updateStock()}),i(2,"div",2)(3,"label",3),n(4,"\u0627\u0646\u062A\u062E\u0627\u0628 \u062A\u0646\u0648\u0639"),t(),i(5,"select",4),A(6,Lr,5,4,"option",5,T),t()(),i(8,"div",2)(9,"label",6),n(10,"\u062A\u0639\u062F\u0627\u062F"),t(),g(11,"input",7),m(12,Dr,2,0,"div",8),t(),i(13,"div",2)(14,"label",9),n(15,"\u0639\u0645\u0644\u06CC\u0627\u062A"),t(),i(16,"div",10)(17,"label",11),g(18,"input",12),i(19,"span",13),n(20,"add_circle"),t(),i(21,"span",14),n(22,"\u0627\u0641\u0632\u0627\u06CC\u0634 \u0645\u0648\u062C\u0648\u062F\u06CC"),t()(),i(23,"label",15),g(24,"input",16),i(25,"span",17),n(26,"remove_circle"),t(),i(27,"span",14),n(28,"\u06A9\u0633\u0631 \u0627\u0632 \u0645\u0648\u062C\u0648\u062F\u06CC"),t()()()(),i(29,"div",2)(30,"label",18),n(31,"\u06CC\u0627\u062F\u062F\u0627\u0634\u062A (\u0627\u062E\u062A\u06CC\u0627\u0631\u06CC)"),t(),g(32,"textarea",19),t(),i(33,"div",20)(34,"button",21),C("click",function(){return u.cancel()}),n(35," \u0627\u0646\u0635\u0631\u0627\u0641 "),t(),i(36,"button",22),m(37,Pr,1,0,"span",23),n(38),t()()()()),o&2){let s,p,V,K,ze,_t,St;a(),f("formGroup",u.stockForm),a(5),E(u.variants),a(6),c((s=u.stockForm.get("quantity"))!=null&&s.invalid&&((s=u.stockForm.get("quantity"))!=null&&s.touched)?12:-1),a(5),B("bg-success/10",((p=u.stockForm.get("operation"))==null?null:p.value)==="add")("border-success",((V=u.stockForm.get("operation"))==null?null:V.value)==="add"),a(4),B("text-success",((K=u.stockForm.get("operation"))==null?null:K.value)==="add"),a(2),B("bg-destructive/10",((ze=u.stockForm.get("operation"))==null?null:ze.value)==="remove")("border-destructive",((_t=u.stockForm.get("operation"))==null?null:_t.value)==="remove"),a(4),B("text-destructive",((St=u.stockForm.get("operation"))==null?null:St.value)==="remove"),a(9),f("disabled",u.stockForm.invalid||u.isSubmitting),a(),c(u.isSubmitting?37:-1),a(),x(" ",u.isSubmitting?"\u062F\u0631 \u062D\u0627\u0644 \u0627\u0639\u0645\u0627\u0644...":"\u0627\u0639\u0645\u0627\u0644 \u062A\u063A\u06CC\u06CC\u0631\u0627\u062A"," ")}},dependencies:[M,me,se,ie,ne,Z,ee,te,Vt,$,ae,Ee,le,de,Xe],encapsulation:2})}}return r})();var Mr=()=>[];function Vr(r,d){if(r&1&&(i(0,"option",23),n(1),t()),r&2){let e=d.$implicit;f("value",e.id),a(),ce(" ",e.name," (",e.categoryName,") ")}}function Ur(r,d){r&1&&(i(0,"div",55),n(1," \u0627\u0635\u0644\u06CC "),t())}function Nr(r,d){if(r&1){let e=S();i(0,"div",38),g(1,"img",52),i(2,"div",53)(3,"button",54),C("click",function(){let u=b(e).$implicit,s=l();return _(s.removeCurrentImage(u.id))}),i(4,"span",5),n(5,"close"),t()()(),m(6,Ur,2,0,"div",55),t()}if(r&2){let e=d.$implicit,o=l();a(),f("src",o.getMediaUrl(e.url),Se),a(5),c(e.isPrimary?6:-1)}}function jr(r,d){r&1&&(i(0,"div",61),n(1," \u0627\u0635\u0644\u06CC "),t())}function $r(r,d){if(r&1){let e=S();i(0,"div",39),g(1,"img",56),i(2,"div",57)(3,"div",58)(4,"button",54),C("click",function(){let u=b(e).$implicit,s=l();return _(s.removeNewImage(u.id))}),i(5,"span",5),n(6,"close"),t()()(),i(7,"button",59),C("click",function(){let u=b(e).$implicit,s=l();return _(s.setPrimaryNewImage(u.id))}),i(8,"span",5),n(9),t(),i(10,"span",60),n(11),t()()(),m(12,jr,2,0,"div",61),t()}if(r&2){let e=d.$implicit,o=l();a(),f("src",e.url,Se),a(6),B("bg-primary",o.primaryNewFileId===e.id),a(2),v(o.primaryNewFileId===e.id?"star":"star_border"),a(2),v(o.primaryNewFileId===e.id?"\u0627\u0635\u0644\u06CC":"\u0627\u0646\u062A\u062E\u0627\u0628 \u0627\u0635\u0644\u06CC"),a(),c(o.primaryNewFileId===e.id?12:-1)}}function Br(r,d){if(r&1){let e=S();i(0,"button",62),C("click",function(){b(e);let u=l();return _(u.openStockModal())}),i(1,"span",44),n(2,"inventory_2"),t(),n(3," \u0645\u062F\u06CC\u0631\u06CC\u062A \u0645\u0648\u062C\u0648\u062F\u06CC "),t()}}function Rr(r,d){if(r&1){let e=S();i(0,"button",92),C("click",function(){b(e);let u=l().$index,s=l();return _(s.removeVariant(u))}),i(1,"span",93),n(2,"delete"),t()()}}function Or(r,d){if(r&1&&(i(0,"option",23),n(1),t()),r&2){let e=d.$implicit;f("value",e.id),a(),x(" ",e.displayValue," ")}}function Wr(r,d){if(r&1&&(i(0,"div",66)(1,"label",94),n(2),t(),i(3,"select",95)(4,"option",96),n(5,"\u0627\u0646\u062A\u062E\u0627\u0628 \u06A9\u0646\u06CC\u062F"),t(),A(6,Or,2,2,"option",23,T),t()()),r&2){let e=d.$implicit;a(2),v(e.displayName),a(),f("formControlName","attr_"+e.id),a(),f("ngValue",null),a(2),E(e.values)}}function Gr(r,d){if(r&1){let e=S();i(0,"label",97)(1,"input",98),C("change",function(u){let s=b(e).$implicit,p=l().$index,V=l();return _(V.toggleShippingMethod(p,s.id,u.target.checked))}),t(),i(2,"span",99),n(3),t()()}if(r&2){let e=d.$implicit,o=l().$index,u=l();B("bg-primary/10",u.getVariantMethodIds(o).includes(e.id))("border-primary",u.getVariantMethodIds(o).includes(e.id)),a(),f("checked",u.getVariantMethodIds(o).includes(e.id)),a(2),v(e.name)}}function zr(r,d){r&1&&(i(0,"div",91),n(1," * \u0628\u0631\u0627\u06CC \u062A\u0646\u0638\u06CC\u0645 \u0631\u0648\u0634\u200C\u0647\u0627\u06CC \u0627\u0631\u0633\u0627\u0644\u060C \u0627\u0628\u062A\u062F\u0627 \u0645\u062D\u0635\u0648\u0644 \u0631\u0627 \u0630\u062E\u06CC\u0631\u0647 \u06A9\u0646\u06CC\u062F. "),t())}function qr(r,d){if(r&1&&(i(0,"div",46)(1,"div",63),n(2),t(),m(3,Rr,3,0,"button",64),i(4,"div",65)(5,"div",66)(6,"label",67),n(7,"\u06A9\u062F \u062A\u0646\u0648\u0639 (SKU)"),t(),g(8,"input",68),t(),i(9,"div",66)(10,"label",67),n(11,"\u0642\u06CC\u0645\u062A \u062E\u0631\u06CC\u062F (\u062A\u0648\u0645\u0627\u0646)"),t(),g(12,"input",69),t(),i(13,"div",66)(14,"label",67),n(15,"\u0642\u06CC\u0645\u062A \u0627\u0635\u0644\u06CC (\u062A\u0648\u0645\u0627\u0646)"),t(),g(16,"input",70),t(),i(17,"div",66)(18,"label",67),n(19,"\u0642\u06CC\u0645\u062A \u0641\u0631\u0648\u0634 (\u062A\u0648\u0645\u0627\u0646)"),t(),g(20,"input",71),t()(),i(21,"div",72)(22,"div",66)(23,"label",67),n(24,"\u0645\u0648\u062C\u0648\u062F\u06CC"),t(),g(25,"input",73),t(),A(26,Wr,8,3,"div",66,T),i(28,"div",74)(29,"div",75),g(30,"input",76),i(31,"label",77),n(32,"\u0645\u0648\u062C\u0648\u062F\u06CC \u0646\u0627\u0645\u062D\u062F\u0648\u062F"),t()(),i(33,"div",75),g(34,"input",78),i(35,"label",77),n(36,"\u062A\u0646\u0648\u0639 \u0641\u0639\u0627\u0644 \u0628\u0627\u0634\u062F"),t()()()(),i(37,"div",79)(38,"h4",80)(39,"span",81),n(40,"local_shipping"),t(),n(41," \u062A\u0646\u0638\u06CC\u0645\u0627\u062A \u0627\u0631\u0633\u0627\u0644 "),t(),i(42,"div",82)(43,"div",83)(44,"label",84),n(45,"\u0636\u0631\u06CC\u0628 \u0647\u0632\u06CC\u0646\u0647 \u0627\u0631\u0633\u0627\u0644"),t(),g(46,"input",85),i(47,"div",86),n(48," \u0645\u062B\u0627\u0644: 1.5 \u06CC\u0639\u0646\u06CC \u0647\u0632\u06CC\u0646\u0647 \u0627\u0631\u0633\u0627\u0644 \u0627\u06CC\u0646 \u062A\u0646\u0648\u0639 50% \u0628\u06CC\u0634\u062A\u0631 \u0627\u0633\u062A "),t()(),i(49,"div",83)(50,"label",87),n(51,"\u0631\u0648\u0634\u200C\u0647\u0627\u06CC \u0627\u0631\u0633\u0627\u0644 \u0645\u062C\u0627\u0632"),t(),i(52,"div",88),A(53,Gr,4,6,"label",89,T),t(),i(55,"div",90),n(56," \u062F\u0631 \u0635\u0648\u0631\u062A \u0639\u062F\u0645 \u0627\u0646\u062A\u062E\u0627\u0628\u060C \u062A\u0645\u0627\u0645 \u0631\u0648\u0634\u200C\u0647\u0627 \u0642\u0627\u0628\u0644 \u0627\u0633\u062A\u0641\u0627\u062F\u0647 \u062E\u0648\u0627\u0647\u0646\u062F \u0628\u0648\u062F "),t()()()(),m(57,zr,2,0,"div",91),t()),r&2){let e,o,u,s=d.$implicit,p=d.$index,V=l();f("formGroupName",p),a(2),x(" \u062A\u0646\u0648\u0639 #",p+1," "),a(),c(V.variants.length>1?3:-1),a(3),f("for","sku"+p),a(2),f("id","sku"+p),a(2),f("for","purchasePrice"+p),a(2),f("id","purchasePrice"+p),a(2),f("for","originalPrice"+p),a(2),f("id","originalPrice"+p),a(2),f("for","sellingPrice"+p),a(2),f("id","sellingPrice"+p),a(3),f("for","stock"+p),a(2),B("opacity-50",V.isEditMode||((e=s.get("isUnlimited"))==null?null:e.value)),f("id","stock"+p)("readonly",V.isEditMode||((o=s.get("isUnlimited"))==null?null:o.value)),a(),E(V.attributes),a(4),f("id","unlimited"+p),a(),f("for","unlimited"+p),a(3),f("id","active"+p),a(),f("for","active"+p),a(18),E(V.allShippingMethods),a(4),c(!V.isEditMode||!((u=s.get("id"))!=null&&u.value)?57:-1)}}function Hr(r,d){r&1&&g(0,"span",50)}function Kr(r,d){if(r&1){let e=S();i(0,"div",51)(1,"div",100)(2,"div",101)(3,"h3",102),n(4,"\u0645\u062F\u06CC\u0631\u06CC\u062A \u0645\u0648\u062C\u0648\u062F\u06CC"),t(),i(5,"button",103),C("click",function(){b(e);let u=l();return _(u.closeStockModal())}),i(6,"span",104),n(7,"close"),t()()(),i(8,"div",105)(9,"app-admin-stock-management",106),C("stockUpdated",function(){b(e);let u=l();return _(u.onStockUpdated())})("cancelled",function(){b(e);let u=l();return _(u.closeStockModal())}),t()()()()}if(r&2){let e=l();a(9),f("productId",e.productId)("variants",(e.product==null?null:e.product.variants)||Ye(2,Mr))}}var Ct=(()=>{class r{constructor(e,o,u,s,p,V,K,ze){this.fb=e,this.route=o,this.router=u,this.adminProductService=s,this.BrandService=p,this.notificationService=V,this.mediaService=K,this.cdr=ze,this.allShippingMethods=[],this.isEditMode=!1,this.productId=null,this.isSubmitting=!1,this.isLoading=!0,this.Brands=[],this.attributes=[],this.destroy$=new Te,this.product=null,this.currentImages=[],this.imagePreviews=[],this.newlyAddedFiles=[],this.deletedMediaIds=[],this.showStockModal=!1,this.primaryNewFileId=null,this.productForm=this.fb.group({name:["",[I.required,I.maxLength(200)]],sku:["",[I.maxLength(100)]],description:[""],BrandId:[null,I.required],isActive:[!0],rowVersion:[null],variants:this.fb.array([])})}get variants(){return this.productForm.get("variants")}ngOnInit(){this.loadInitialData()}loadInitialData(){this.isLoading=!0,je({Brands:this.BrandService.getBrands(void 0,void 0,1,500).pipe(Ne(e=>e.items??[]),Ae(e=>(console.error("Error loading category groups:",e),ke([])))),attributes:this.adminProductService.getAllAttributes().pipe(Ae(e=>(console.error("Error loading attributes:",e),ke([])))),shippingMethods:this.adminProductService.getAllShippingMethods().pipe(Ae(e=>(console.error("Error loading shipping methods:",e),ke([]))))}).subscribe({next:({Brands:e,attributes:o,shippingMethods:u})=>{this.Brands=e,this.attributes=o,this.allShippingMethods=u,this.Brands.length===0&&this.notificationService.show("\u0647\u06CC\u0686 \u062F\u0633\u062A\u0647\u200C\u0628\u0646\u062F\u06CC \u06CC\u0627\u0641\u062A \u0646\u0634\u062F. \u0644\u0637\u0641\u0627\u064B \u0627\u0628\u062A\u062F\u0627 \u06CC\u06A9 \u062F\u0633\u062A\u0647\u200C\u0628\u0646\u062F\u06CC \u0627\u06CC\u062C\u0627\u062F \u06A9\u0646\u06CC\u062F.","info"),this.isLoading=!1,this.cdr.markForCheck();let s=this.route.snapshot.paramMap.get("id");s?(this.isEditMode=!0,this.productId=Number(s),this.loadProductData()):this.addVariant()},error:e=>{console.error("Error loading initial data:",e),this.notificationService.show("\u062E\u0637\u0627 \u062F\u0631 \u0628\u0627\u0631\u06AF\u0630\u0627\u0631\u06CC \u0627\u0637\u0644\u0627\u0639\u0627\u062A \u0627\u0648\u0644\u06CC\u0647. \u0644\u0637\u0641\u0627\u064B \u0635\u0641\u062D\u0647 \u0631\u0627 \u0631\u0641\u0631\u0634 \u06A9\u0646\u06CC\u062F.","error"),this.isLoading=!1,this.cdr.markForCheck()}})}loadProductData(){this.productId&&this.adminProductService.getProductById(this.productId).subscribe({next:e=>{this.product=e,this.productForm.patchValue(Ue(Ve({},e),{sku:e.sku,rowVersion:e.rowVersion?e.rowVersion:null})),this.currentImages=[...e.images],this.deletedMediaIds=[],this.newlyAddedFiles=[],this.imagePreviews=[],this.primaryNewFileId=null,this.variants.clear(),e.variants.forEach(o=>{let u=this.createVariantGroup(o);this.variants.push(u)}),this.cdr.markForCheck()},error:e=>{console.error("Error loading product:",e),this.notificationService.show("\u062E\u0637\u0627 \u062F\u0631 \u0628\u0627\u0631\u06AF\u0630\u0627\u0631\u06CC \u0645\u062D\u0635\u0648\u0644","error"),this.router.navigate(["/admin/products"])}})}createVariantGroup(e){let o={id:[e?.id],sku:[e?.sku||""],purchasePrice:[e?.purchasePrice||0,[I.required,I.min(0)]],originalPrice:[e?.originalPrice||0,[I.required,I.min(0)]],sellingPrice:[e?.sellingPrice||0,[I.required,I.min(0)]],stock:[{value:e?.stock||0,disabled:this.isEditMode},[I.required,I.min(0)]],isUnlimited:[e?.isUnlimited||!1],isActive:[e?.isActive??!0],shippingMultiplier:[e?.shippingMultiplier||1,[I.min(0)]],enabledShippingMethodIds:[e?.enabledShippingMethodIds||[],[]]};return this.attributes.forEach(s=>{let p=e?.attributes?e.attributes[s.name.toLowerCase()]:null;o[`attr_${s.id}`]=new H(p?.id||null)}),this.fb.group(o)}addVariant(){this.variants.push(this.createVariantGroup()),this.cdr.markForCheck()}removeVariant(e){this.variants.length>1?this.variants.removeAt(e):this.notificationService.show("\u0645\u062D\u0635\u0648\u0644 \u0628\u0627\u06CC\u062F \u062D\u062F\u0627\u0642\u0644 \u06CC\u06A9 \u062A\u0646\u0648\u0639 \u062F\u0627\u0634\u062A\u0647 \u0628\u0627\u0634\u062F","info")}onFileChange(e){let o=e.target;o.files&&(Array.from(o.files).forEach(s=>{let p=this.generateUniqueId();this.newlyAddedFiles.push({file:s,id:p});let V=new FileReader;V.onload=K=>{this.imagePreviews.push({id:p,url:K.target.result}),this.currentImages.length===0&&!this.primaryNewFileId&&(this.primaryNewFileId=p),this.cdr.markForCheck()},V.readAsDataURL(s)}),o.value="")}setPrimaryNewImage(e){this.primaryNewFileId=e}generateUniqueId(){return`${Date.now()}-${Math.random().toString(36).substring(2,9)}`}removeNewImage(e){this.newlyAddedFiles=this.newlyAddedFiles.filter(o=>o.id!==e),this.imagePreviews=this.imagePreviews.filter(o=>o.id!==e),this.primaryNewFileId===e&&(this.primaryNewFileId=this.newlyAddedFiles.length>0?this.newlyAddedFiles[0].id:null)}removeCurrentImage(e){this.currentImages=this.currentImages.filter(o=>o.id!==e),this.deletedMediaIds.push(e)}getMediaUrl(e){return this.mediaService.getMediaUrl(e)}onSubmit(){if(this.productForm.invalid){this.productForm.markAllAsTouched(),this.notificationService.show("\u0644\u0637\u0641\u0627 \u062A\u0645\u0627\u0645 \u0641\u06CC\u0644\u062F\u0647\u0627\u06CC \u0627\u0644\u0632\u0627\u0645\u06CC \u0631\u0627 \u067E\u0631 \u06A9\u0646\u06CC\u062F","error");return}this.isSubmitting=!0;let e=this.productForm.getRawValue(),o=e.variants.map(p=>{let V=this.attributes.map(K=>p[`attr_${K.id}`]).filter(K=>K!==null);return{id:p.id,sku:p.sku,purchasePrice:p.purchasePrice,originalPrice:p.originalPrice,sellingPrice:p.sellingPrice,stock:p.isUnlimited?0:p.stock,isUnlimited:p.isUnlimited,isActive:p.isActive,attributeValueIds:V,shippingMultiplier:p.shippingMultiplier,enabledShippingMethodIds:p.enabledShippingMethodIds}}),u=new FormData;if(u.append("name",e.name),e.sku&&u.append("sku",e.sku),e.description&&u.append("description",e.description),u.append("BrandId",e.BrandId),u.append("isActive",e.isActive.toString()),u.append("variantsJson",JSON.stringify(o)),this.isEditMode&&e.rowVersion&&u.append("rowVersion",e.rowVersion),this.newlyAddedFiles.forEach(p=>{u.append("images",p.file,p.file.name)}),this.primaryNewFileId){let p=this.newlyAddedFiles.findIndex(V=>V.id===this.primaryNewFileId);p>-1&&u.append("primaryImageIndex",p.toString())}this.deletedMediaIds.length>0&&this.deletedMediaIds.forEach(p=>{u.append("deletedMediaIds",p.toString())}),(this.isEditMode&&this.productId?this.adminProductService.updateProduct(this.productId,u):this.adminProductService.createProduct(u)).pipe(L(()=>this.isSubmitting=!1)).subscribe({next:()=>{this.notificationService.show(`\u0645\u062D\u0635\u0648\u0644 \u0628\u0627 \u0645\u0648\u0641\u0642\u06CC\u062A ${this.isEditMode?"\u0648\u06CC\u0631\u0627\u06CC\u0634":"\u0627\u06CC\u062C\u0627\u062F"} \u0634\u062F`,"success"),this.router.navigate(["/admin/products"])},error:p=>{if(console.error("Error saving product:",p),p?.status===409)this.notificationService.show("\u0627\u0637\u0644\u0627\u0639\u0627\u062A \u0645\u062D\u0635\u0648\u0644 \u062A\u0648\u0633\u0637 \u06A9\u0627\u0631\u0628\u0631 \u062F\u06CC\u06AF\u0631\u06CC \u062A\u063A\u06CC\u06CC\u0631 \u06A9\u0631\u062F\u0647 \u0627\u0633\u062A. \u0644\u0637\u0641\u0627 \u0635\u0641\u062D\u0647 \u0631\u0627 \u0631\u0641\u0631\u0634 \u06A9\u0646\u06CC\u062F.","error");else if(p?.status===401)this.notificationService.show("\u0634\u0645\u0627 \u0645\u062C\u0648\u0632 \u062F\u0633\u062A\u0631\u0633\u06CC \u0628\u0647 \u0627\u06CC\u0646 \u0628\u062E\u0634 \u0631\u0627 \u0646\u062F\u0627\u0631\u06CC\u062F. \u0644\u0637\u0641\u0627\u064B \u062F\u0648\u0628\u0627\u0631\u0647 \u0648\u0627\u0631\u062F \u0634\u0648\u06CC\u062F.","error"),this.router.navigate(["/auth/login"]);else if(p?.status===403)this.notificationService.show("\u0634\u0645\u0627 \u062F\u0633\u062A\u0631\u0633\u06CC \u06A9\u0627\u0641\u06CC \u0628\u0631\u0627\u06CC \u0627\u0646\u062C\u0627\u0645 \u0627\u06CC\u0646 \u0639\u0645\u0644\u06CC\u0627\u062A \u0631\u0627 \u0646\u062F\u0627\u0631\u06CC\u062F.","error");else{let V=p?.error?.message||p?.message||"\u062E\u0637\u0627 \u062F\u0631 \u0630\u062E\u06CC\u0631\u0647 \u0645\u062D\u0635\u0648\u0644";this.notificationService.show(V,"error")}}})}toggleShippingMethod(e,o,u){let p=this.productForm.get("variants").at(e),V=p.get("enabledShippingMethodIds")?.value;u?p.patchValue({enabledShippingMethodIds:[...V,o]}):p.patchValue({enabledShippingMethodIds:V.filter(K=>K!==o)})}getVariantMethodIds(e){return this.variants.at(e).get("enabledShippingMethodIds")?.value||[]}openStockModal(){this.showStockModal=!0}closeStockModal(){this.showStockModal=!1}onStockUpdated(){this.closeStockModal(),this.loadProductData()}ngOnDestroy(){this.destroy$.next(),this.destroy$.complete()}static{this.\u0275fac=function(o){return new(o||r)(h(we),h(ue),h(he),h(Pe),h(Bt),h(D),h(Fe),h(Tt))}}static{this.\u0275cmp=k({type:r,selectors:[["app-admin-product-form"]],decls:94,vars:11,consts:[[1,"max-w-6xl","mx-auto","space-y-6","animate-fade-in-up"],[1,"flex","items-center","justify-between"],[1,"text-2xl","font-bold","text-heading-foreground","tracking-tight","flex","items-center","gap-2"],[1,"material-icons","text-primary"],["routerLink","/admin/products",1,"btn","btn-outline","btn-sm","gap-2"],[1,"material-icons","text-sm"],[1,"space-y-8",3,"ngSubmit","formGroup"],[1,"card","p-6","space-y-6","border","border-border","shadow-sm"],[1,"border-b","border-border","pb-4","mb-4"],[1,"text-lg","font-bold","text-foreground","flex","items-center","gap-2"],[1,"grid","grid-cols-1","md:grid-cols-3","gap-6"],[1,"space-y-2","md:col-span-2","form-group"],["for","name",1,"form-label"],[1,"text-destructive"],[1,"input-group"],[1,"input-addon"],["type","text","id","name","formControlName","name",1,"input","w-full"],[1,"space-y-2","form-group"],["for","sku",1,"form-label"],["type","text","id","sku","formControlName","sku",1,"input","w-full","ltr-input","font-mono"],["for","BrandId",1,"form-label"],["id","BrandId","formControlName","BrandId",1,"select","w-full"],["disabled","",3,"ngValue"],[3,"value"],[1,"space-y-2","md:col-span-2","flex","items-end","pb-2"],[1,"flex","items-center","gap-3","p-3","bg-muted/20","rounded-lg","border","border-border/50","w-full"],[1,"flex","items-center"],["type","checkbox","id","isActive","formControlName","isActive",1,"switch"],["for","isActive",1,"switch-thumb"],["for","isActive",1,"text-sm","font-medium","cursor-pointer","select-none","text-foreground"],["for","description",1,"form-label"],["id","description","formControlName","description","rows","4",1,"input","w-full","min-h-[120px]","resize-y"],[1,"grid","grid-cols-2","sm:grid-cols-3","md:grid-cols-4","lg:grid-cols-5","gap-4"],[1,"aspect-square","rounded-xl","border-2","border-dashed","border-border","bg-muted/10","hover:bg-muted/30","hover:border-primary/50","transition-all","cursor-pointer","flex","flex-col","items-center","justify-center","text-muted-foreground","hover:text-primary","group"],[1,"w-12","h-12","rounded-full","bg-background","flex","items-center","justify-center","mb-2","shadow-sm","group-hover:scale-110","transition-transform"],[1,"material-icons","text-2xl"],[1,"text-xs","font-bold"],["type","file","multiple","","accept","image/*",1,"hidden",3,"change"],[1,"group","relative","aspect-square","rounded-xl","border","border-border","overflow-hidden","bg-background","shadow-sm","hover:shadow-md","transition-all"],[1,"group","relative","aspect-square","rounded-xl","border","border-primary/50","overflow-hidden","bg-background","shadow-sm","ring-2","ring-primary/20"],[1,"flex","flex-col","sm:flex-row","sm:items-center","justify-between","gap-4","border-b","border-border","pb-4","mb-4"],[1,"flex","gap-2"],["type","button",1,"btn","btn-secondary","btn-sm","shadow-sm"],["type","button",1,"btn","btn-outline","btn-sm","shadow-sm",3,"click"],[1,"material-icons","text-sm","me-2"],["formArrayName","variants",1,"space-y-4"],[1,"relative","rounded-xl","border","border-border","bg-muted/20","p-4","sm:p-6","transition-all","hover:border-primary/30","hover:bg-muted/30","hover:shadow-sm","group",3,"formGroupName"],[1,"sticky","bottom-6","z-10","bg-background/80","backdrop-blur-md","border","border-border","p-4","rounded-xl","flex","justify-end","gap-4","shadow-2xl"],["routerLink","/admin/products",1,"btn","btn-outline","min-w-[100px]"],["type","submit",1,"btn","btn-primary","min-w-[160px]","shadow-button",3,"disabled"],[1,"spinner","spinner-sm","me-2","border-white"],[1,"modal-overlay"],["alt","Product",1,"w-full","h-full","object-cover",3,"src"],[1,"absolute","inset-0","bg-black/40","opacity-0","group-hover:opacity-100","transition-opacity","flex","items-start","justify-end","p-2","backdrop-blur-[2px]"],["type","button",1,"btn","btn-icon","btn-xs","btn-destructive","rounded-full","shadow-lg",3,"click"],[1,"absolute","bottom-2","right-2","bg-primary","text-primary-foreground","text-[10px]","px-2","py-0.5","rounded-full","font-bold","shadow-sm"],["alt","New Upload",1,"w-full","h-full","object-cover",3,"src"],[1,"absolute","inset-0","bg-black/40","opacity-0","group-hover:opacity-100","transition-opacity","flex","flex-col","justify-between","p-2","backdrop-blur-[2px]"],[1,"flex","justify-end"],["type","button",1,"self-start","btn","btn-xs","gap-1","bg-white/20","hover:bg-white/40","text-white","backdrop-blur-md","border","border-white/30","rounded-full","transition-colors",3,"click"],[1,"text-[10px]"],[1,"absolute","bottom-2","right-2","bg-primary","text-primary-foreground","text-[10px]","px-2","py-0.5","rounded-full","font-bold","shadow-sm","pointer-events-none"],["type","button",1,"btn","btn-secondary","btn-sm","shadow-sm",3,"click"],[1,"absolute","-top-3","right-4","bg-background","px-2","text-xs","font-bold","text-muted-foreground","border","border-border","rounded-full"],["type","button",1,"absolute","top-4","left-4","btn","btn-icon","btn-xs","btn-ghost","text-muted-foreground","hover:text-destructive","hover:bg-destructive/10","transition-colors"],[1,"grid","grid-cols-1","sm:grid-cols-2","lg:grid-cols-4","gap-4","mb-6","mt-2"],[1,"space-y-1.5","form-group"],[1,"form-label",3,"for"],["type","text","formControlName","sku",1,"input","w-full","bg-background","ltr-input","font-mono","text-sm",3,"id"],["type","number","formControlName","purchasePrice",1,"input","w-full","bg-background",3,"id"],["type","number","formControlName","originalPrice",1,"input","w-full","bg-background",3,"id"],["type","number","formControlName","sellingPrice",1,"input","w-full","bg-background","font-bold","text-foreground",3,"id"],[1,"grid","grid-cols-1","sm:grid-cols-2","lg:grid-cols-4","gap-4","border-t","border-border/50","pt-4"],["type","number","formControlName","stock",1,"input","w-full","bg-background",3,"id","readonly"],[1,"flex","flex-col","justify-end","gap-3","lg:col-span-1"],[1,"flex","items-center","gap-2"],["type","checkbox","formControlName","isUnlimited",1,"checkbox",3,"id"],[1,"text-xs","font-medium","text-foreground","cursor-pointer",3,"for"],["type","checkbox","formControlName","isActive",1,"checkbox",3,"id"],[1,"mt-4","pt-4","border-t","border-border/50"],[1,"text-sm","font-bold","mb-3","flex","items-center","gap-2"],[1,"material-icons","text-primary","text-sm"],[1,"grid","grid-cols-1","md:grid-cols-2","gap-4"],[1,"form-group"],[1,"form-label","text-xs"],["type","number","formControlName","shippingMultiplier","step","0.1","min","0",1,"input","w-full","bg-background"],[1,"form-hint","text-xs","mt-1"],[1,"form-label","text-xs","mb-2","block"],[1,"flex","flex-wrap","gap-3"],[1,"flex","items-center","gap-2","border","border-border","p-2","rounded","cursor-pointer","hover:bg-muted/50","transition-colors",3,"bg-primary/10","border-primary"],[1,"form-hint","text-xs","mt-2"],[1,"mt-2","text-xs","text-warning"],["type","button",1,"absolute","top-4","left-4","btn","btn-icon","btn-xs","btn-ghost","text-muted-foreground","hover:text-destructive","hover:bg-destructive/10","transition-colors",3,"click"],[1,"material-icons","text-lg"],[1,"form-label"],[1,"select","w-full","bg-background",3,"formControlName"],[3,"ngValue"],[1,"flex","items-center","gap-2","border","border-border","p-2","rounded","cursor-pointer","hover:bg-muted/50","transition-colors"],["type","checkbox",1,"checkbox","checkbox-sm",3,"change","checked"],[1,"text-xs","font-medium"],[1,"modal","animate-scale-in"],[1,"modal-header"],[1,"font-bold","text-lg","text-heading-foreground"],[1,"btn","btn-ghost","btn-icon","btn-sm","rounded-full",3,"click"],[1,"material-icons"],[1,"modal-body"],[3,"stockUpdated","cancelled","productId","variants"]],template:function(o,u){if(o&1&&(i(0,"div",0)(1,"div",1)(2,"h1",2)(3,"span",3),n(4),t(),n(5),t(),i(6,"a",4)(7,"span",5),n(8,"arrow_forward"),t(),n(9," \u0628\u0627\u0632\u06AF\u0634\u062A "),t()(),i(10,"form",6),C("ngSubmit",function(){return u.onSubmit()}),i(11,"div",7)(12,"div",8)(13,"h2",9)(14,"span",3),n(15,"info"),t(),n(16," \u0627\u0637\u0644\u0627\u0639\u0627\u062A \u067E\u0627\u06CC\u0647 "),t()(),i(17,"div",10)(18,"div",11)(19,"label",12),n(20,"\u0646\u0627\u0645 \u0645\u062D\u0635\u0648\u0644 "),i(21,"span",13),n(22,"*"),t()(),i(23,"div",14)(24,"span",15)(25,"span",5),n(26,"inventory_2"),t()(),g(27,"input",16),t()(),i(28,"div",17)(29,"label",18),n(30,"\u06A9\u062F \u0645\u062D\u0635\u0648\u0644 (SKU)"),t(),g(31,"input",19),t(),i(32,"div",17)(33,"label",20),n(34,"\u06AF\u0631\u0648\u0647 \u062F\u0633\u062A\u0647\u200C\u0628\u0646\u062F\u06CC "),i(35,"span",13),n(36,"*"),t()(),i(37,"select",21)(38,"option",22),n(39,"\u0627\u0646\u062A\u062E\u0627\u0628 \u06A9\u0646\u06CC\u062F"),t(),A(40,Vr,2,3,"option",23,T),t()(),i(42,"div",24)(43,"div",25)(44,"div",26),g(45,"input",27)(46,"label",28),t(),i(47,"label",29),n(48," \u0645\u062D\u0635\u0648\u0644 \u0641\u0639\u0627\u0644 \u0648 \u0642\u0627\u0628\u0644 \u0646\u0645\u0627\u06CC\u0634 \u0628\u0627\u0634\u062F "),t()()()(),i(49,"div",17)(50,"label",30),n(51,"\u062A\u0648\u0636\u06CC\u062D\u0627\u062A \u0645\u062D\u0635\u0648\u0644"),t(),g(52,"textarea",31),t()(),i(53,"div",7)(54,"div",8)(55,"h2",9)(56,"span",3),n(57,"image"),t(),n(58," \u062A\u0635\u0627\u0648\u06CC\u0631 \u0645\u062D\u0635\u0648\u0644 "),t()(),i(59,"div",32)(60,"label",33)(61,"div",34)(62,"span",35),n(63,"add_a_photo"),t()(),i(64,"span",36),n(65,"\u0627\u0641\u0632\u0648\u062F\u0646 \u062A\u0635\u0648\u06CC\u0631"),t(),i(66,"input",37),C("change",function(p){return u.onFileChange(p)}),t()(),A(67,Nr,7,2,"div",38,T),A(69,$r,13,6,"div",39,T),t()(),i(71,"div",7)(72,"div",40)(73,"h2",9)(74,"span",3),n(75,"style"),t(),n(76," \u062A\u0646\u0648\u0639 \u0648 \u0642\u06CC\u0645\u062A\u200C\u06AF\u0630\u0627\u0631\u06CC "),t(),i(77,"div",41),m(78,Br,4,0,"button",42),i(79,"button",43),C("click",function(){return u.addVariant()}),i(80,"span",44),n(81,"add"),t(),n(82," \u0627\u0641\u0632\u0648\u062F\u0646 \u062A\u0646\u0648\u0639 "),t()()(),i(83,"div",45),A(84,qr,58,21,"div",46,T),t()(),i(86,"div",47)(87,"a",48),n(88,"\u0627\u0646\u0635\u0631\u0627\u0641"),t(),i(89,"button",49),m(90,Hr,1,0,"span",50),i(91,"span"),n(92),t()()()()(),m(93,Kr,10,3,"div",51)),o&2){let s;a(4),v(u.isEditMode?"edit_note":"add_circle"),a(),x(" ",u.isEditMode?"\u0648\u06CC\u0631\u0627\u06CC\u0634 \u0645\u062D\u0635\u0648\u0644":"\u0627\u0641\u0632\u0648\u062F\u0646 \u0645\u062D\u0635\u0648\u0644 \u062C\u062F\u06CC\u062F"," "),a(5),f("formGroup",u.productForm),a(17),B("is-invalid",((s=u.productForm.get("name"))==null?null:s.invalid)&&((s=u.productForm.get("name"))==null?null:s.touched)),a(11),f("ngValue",null),a(2),E(u.Brands),a(27),E(u.currentImages),a(2),E(u.imagePreviews),a(9),c(u.isEditMode?78:-1),a(6),E(u.variants.controls),a(5),f("disabled",u.productForm.invalid||u.isSubmitting),a(),c(u.isSubmitting?90:-1),a(2),v(u.isSubmitting?"\u062F\u0631 \u062D\u0627\u0644 \u062B\u0628\u062A...":"\u0630\u062E\u06CC\u0631\u0647 \u0646\u0647\u0627\u06CC\u06CC"),a(),c(u.showStockModal?93:-1)}},dependencies:[me,se,ie,ne,Z,ee,_e,te,$,ae,Ee,le,de,$e,Be,j,N,li],encapsulation:2})}}return r})();var Jr=r=>["/admin/products/edit",r],Qr=(r,d)=>({"badge-destructive":r,"badge-success":d});function Yr(r,d){r&1&&(i(0,"div",8),g(1,"span",12),t())}function Xr(r,d){r&1&&(i(0,"div",9)(1,"span",13),n(2,"inventory_2"),t(),i(3,"p",14),n(4,"\u0647\u06CC\u0686 \u0645\u062D\u0635\u0648\u0644\u06CC \u06CC\u0627\u0641\u062A \u0646\u0634\u062F"),t(),i(5,"a",15),n(6,"\u062B\u0628\u062A \u0627\u0648\u0644\u06CC\u0646 \u0645\u062D\u0635\u0648\u0644"),t()())}function Zr(r,d){if(r&1&&(i(0,"div",30),n(1),t()),r&2){let e=l().$implicit;a(),x("SKU: ",e.sku," ")}}function e0(r,d){if(r&1&&(i(0,"span",36),n(1),F(2,"number"),t()),r&2){let e=l().$implicit,o=l(2);f("ngClass",Ft(4,Qr,o.getTotalStock(e)===0,o.getTotalStock(e)>0)),a(),x(" ",U(2,2,o.getTotalStock(e))," ")}}function t0(r,d){r&1&&(i(0,"span",37)(1,"span",42),n(2,"all_inclusive"),t(),n(3," \u0646\u0627\u0645\u062D\u062F\u0648\u062F "),t())}function i0(r,d){if(r&1){let e=S();i(0,"tr",24)(1,"td",25)(2,"div",26),g(3,"img",27),t()(),i(4,"td",25)(5,"div",28),n(6),t(),i(7,"div",29),n(8),t(),m(9,Zr,2,1,"div",30),t(),i(10,"td",31)(11,"span",32),n(12),t()(),i(13,"td",33),n(14),F(15,"number"),i(16,"span",34),n(17,"\u062A\u0648\u0645\u0627\u0646"),t()(),i(18,"td",35),m(19,e0,3,7,"span",36)(20,t0,4,0,"span",37),t(),i(21,"td",25)(22,"div",38)(23,"a",39)(24,"span",40),n(25,"edit"),t()(),i(26,"button",41),C("click",function(){let u=b(e).$implicit,s=l(2);return _(s.deleteProduct(u.id))}),i(27,"span",40),n(28,"delete"),t()()()()()}if(r&2){let e=d.$implicit,o=l(2);a(3),f("src",!(e.images==null||e.images[0]==null)&&e.images[0].url?o.getMediaUrl(e.images==null||e.images[0]==null?null:e.images[0].url):"assets/images/placeholder.png",Se)("alt",e.name),a(3),v(e.name),a(2),x("",e.brand==null?null:e.brand.categoryName," "),a(),c(e.sku?9:-1),a(3),v((e.brand==null?null:e.brand.categoryName)||"-"),a(2),x(" ",U(15,9,e.minPrice)," "),a(5),c(o.getTotalStock(e)!==o.Infinity?19:20),a(4),f("routerLink",J(11,Jr,e.id))}}function n0(r,d){if(r&1&&(i(0,"div",10)(1,"table",16)(2,"thead",17)(3,"tr")(4,"th",18),n(5,"\u062A\u0635\u0648\u06CC\u0631"),t(),i(6,"th",19),n(7,"\u0646\u0627\u0645 \u0645\u062D\u0635\u0648\u0644"),t(),i(8,"th",20),n(9,"\u062F\u0633\u062A\u0647\u200C\u0628\u0646\u062F\u06CC"),t(),i(10,"th",19),n(11,"\u0642\u06CC\u0645\u062A \u067E\u0627\u06CC\u0647"),t(),i(12,"th",21),n(13,"\u0645\u0648\u062C\u0648\u062F\u06CC \u06A9\u0644"),t(),i(14,"th",22),n(15,"\u0639\u0645\u0644\u06CC\u0627\u062A"),t()()(),i(16,"tbody",23),A(17,i0,29,13,"tr",24,T),t()()()),r&2){let e=l();a(17),E(e.products)}}function r0(r,d){if(r&1){let e=S();i(0,"div",11)(1,"nav",43)(2,"button",44),C("click",function(){b(e);let u=l();return _(u.loadProducts(u.currentPage-1))}),n(3," \u0642\u0628\u0644\u06CC "),t(),i(4,"span",45),n(5),t(),i(6,"button",46),C("click",function(){b(e);let u=l();return _(u.loadProducts(u.currentPage+1))}),n(7," \u0628\u0639\u062F\u06CC "),t()()()}if(r&2){let e=l();a(2),f("disabled",e.currentPage===1),a(3),ce(" ",e.currentPage," / ",e.pagination.totalPages," "),a(),f("disabled",e.currentPage===e.pagination.totalPages)}}var mi=(()=>{class r{constructor(e,o,u){this.adminProductService=e,this.notificationService=o,this.mediaService=u,this.products=[],this.pagination=null,this.isLoading=!0,this.currentPage=1,this.searchTerm="",this.showDeleted=!1,this.Infinity=1/0}ngOnInit(){this.loadProducts()}loadProducts(e=1){this.isLoading=!0,this.currentPage=e,this.adminProductService.getProducts({searchTerm:this.searchTerm,includeDeleted:this.showDeleted,page:this.currentPage,pageSize:10}).subscribe({next:o=>{this.products=o.items??[],this.pagination=o,this.isLoading=!1},error:()=>{this.notificationService.show("\u062E\u0637\u0627 \u062F\u0631 \u0628\u0627\u0631\u06AF\u0630\u0627\u0631\u06CC \u0645\u062D\u0635\u0648\u0644\u0627\u062A","error"),this.isLoading=!1}})}onSearch(){this.loadProducts(1)}toggleShowDeleted(){this.loadProducts(1)}getTotalStock(e){return e.totalStock===1/0?1/0:e.totalStock||0}deleteProduct(e){confirm("\u0622\u06CC\u0627 \u0627\u0632 \u062D\u0630\u0641 \u0627\u06CC\u0646 \u0645\u062D\u0635\u0648\u0644 \u0627\u0637\u0645\u06CC\u0646\u0627\u0646 \u062F\u0627\u0631\u06CC\u062F\u061F \u0627\u06CC\u0646 \u0639\u0645\u0644 \u062A\u0645\u0627\u0645 \u062A\u0646\u0648\u0639\u200C\u0647\u0627\u06CC \u0622\u0646 \u0631\u0627 \u0646\u06CC\u0632 \u062D\u0630\u0641 \u0645\u06CC\u200C\u06A9\u0646\u062F.")&&this.adminProductService.deleteProduct(e).subscribe({next:o=>{this.notificationService.show(o.message||"\u0645\u062D\u0635\u0648\u0644 \u0628\u0627 \u0645\u0648\u0641\u0642\u06CC\u062A \u062D\u0630\u0641 \u0634\u062F","success"),this.loadProducts(this.currentPage)},error:o=>this.notificationService.show(o?.error?.message||"\u062E\u0637\u0627 \u062F\u0631 \u062D\u0630\u0641 \u0645\u062D\u0635\u0648\u0644","error")})}restoreProduct(e){confirm("\u0622\u06CC\u0627 \u0627\u0632 \u0628\u0627\u0632\u06CC\u0627\u0628\u06CC \u0627\u06CC\u0646 \u0645\u062D\u0635\u0648\u0644 \u0627\u0637\u0645\u06CC\u0646\u0627\u0646 \u062F\u0627\u0631\u06CC\u062F\u061F")&&this.adminProductService.restoreProduct(e).subscribe({next:o=>{this.notificationService.show("\u0645\u062D\u0635\u0648\u0644 \u0628\u0627 \u0645\u0648\u0641\u0642\u06CC\u062A \u0628\u0627\u0632\u06CC\u0627\u0628\u06CC \u0634\u062F","success"),this.loadProducts(this.currentPage)},error:o=>this.notificationService.show(o?.error?.message||"\u062E\u0637\u0627 \u062F\u0631 \u0628\u0627\u0632\u06CC\u0627\u0628\u06CC \u0645\u062D\u0635\u0648\u0644","error")})}getMediaUrl(e){return this.mediaService.getMediaUrl(e)}static{this.\u0275fac=function(o){return new(o||r)(h(Pe),h(D),h(Fe))}}static{this.\u0275cmp=k({type:r,selectors:[["app-admin-product-list"]],decls:18,vars:4,consts:[[1,"space-y-6","animate-fade-in"],[1,"flex","flex-col","sm:flex-row","sm:items-center","justify-between","gap-4"],[1,"text-2xl","font-bold","text-heading-foreground","tracking-tight","flex","items-center","gap-2"],[1,"material-icons","text-primary"],[1,"text-sm","text-muted-foreground","mt-1"],["routerLink","/admin/products/new",1,"btn","btn-primary","shadow-lg","shadow-primary/20","hover:shadow-primary/40","transition-all"],[1,"material-icons","me-2"],[1,"card","border","border-border","shadow-sm","overflow-hidden"],[1,"flex","justify-center","items-center","py-20"],[1,"flex","flex-col","items-center","justify-center","py-16","text-center","text-muted-foreground"],[1,"w-full","overflow-x-auto"],[1,"flex","justify-center","p-4","border-t","border-border","bg-muted/5"],[1,"spinner","spinner-xl","text-primary"],[1,"material-icons","text-6xl","mb-4","opacity-20"],[1,"text-lg","font-medium","text-foreground"],["routerLink","/admin/products/new",1,"btn","btn-link","mt-2","text-primary"],[1,"w-full","caption-bottom","text-sm","text-right"],[1,"bg-muted/50","[&_tr]:border-b","[&_tr]:border-border","text-muted-foreground"],[1,"h-12","px-4","align-middle","font-medium","w-[80px]"],[1,"h-12","px-4","align-middle","font-medium"],[1,"h-12","px-4","align-middle","font-medium","hidden","md:table-cell"],[1,"h-12","px-4","align-middle","font-medium","text-center"],[1,"h-12","px-4","align-middle","font-medium","text-end","w-[100px]"],[1,"[&_tr:last-child]:border-0","bg-card"],[1,"border-b","border-border","transition-colors","hover:bg-muted/30","group"],[1,"p-4","align-middle"],[1,"w-12","h-12","rounded-lg","border","border-border","bg-background","overflow-hidden","flex","items-center","justify-center","relative"],["loading","lazy",1,"w-full","h-full","object-cover","transition-transform","group-hover:scale-110",3,"src","alt"],[1,"font-bold","text-foreground","line-clamp-1","text-base"],[1,"text-xs","text-muted-foreground","mt-0.5","md:hidden"],[1,"text-xs","text-muted-foreground","font-mono","mt-0.5"],[1,"p-4","align-middle","hidden","md:table-cell"],[1,"badge","badge-outline","bg-background"],[1,"p-4","align-middle","font-medium","text-foreground","whitespace-nowrap","tabular-nums"],[1,"text-[10px]","text-muted-foreground","font-normal"],[1,"p-4","align-middle","text-center"],[1,"badge","font-bold","font-mono",3,"ngClass"],[1,"badge","badge-primary","font-bold"],[1,"flex","items-center","justify-end","gap-2","opacity-0","group-hover:opacity-100","transition-opacity"],["title","\u0648\u06CC\u0631\u0627\u06CC\u0634",1,"btn","btn-ghost","btn-icon","btn-sm","text-primary","hover:text-primary-foreground","hover:bg-primary",3,"routerLink"],[1,"material-icons","text-lg"],["title","\u062D\u0630\u0641",1,"btn","btn-ghost","btn-icon","btn-sm","text-muted-foreground","hover:text-destructive-foreground","hover:bg-destructive",3,"click"],[1,"material-icons","text-[14px]","me-1"],[1,"flex","items-center","gap-2"],["aria-label","Previous",1,"btn","btn-outline","btn-sm",3,"click","disabled"],[1,"text-sm","text-muted-foreground","font-mono","bg-background","px-3","py-1","rounded-md","border","border-border"],["aria-label","Next",1,"btn","btn-outline","btn-sm",3,"click","disabled"]],template:function(o,u){o&1&&(i(0,"div",0)(1,"div",1)(2,"div")(3,"h1",2)(4,"span",3),n(5,"inventory_2"),t(),n(6," \u0645\u062F\u06CC\u0631\u06CC\u062A \u0645\u062D\u0635\u0648\u0644\u0627\u062A "),t(),i(7,"p",4),n(8," \u0645\u0634\u0627\u0647\u062F\u0647\u060C \u0648\u06CC\u0631\u0627\u06CC\u0634 \u0648 \u0645\u062F\u06CC\u0631\u06CC\u062A \u0645\u0648\u062C\u0648\u062F\u06CC \u0645\u062D\u0635\u0648\u0644\u0627\u062A "),t()(),i(9,"a",5)(10,"span",6),n(11,"add"),t(),n(12," \u0627\u0641\u0632\u0648\u062F\u0646 \u0645\u062D\u0635\u0648\u0644 "),t()(),i(13,"div",7),m(14,Yr,2,0,"div",8),m(15,Xr,7,0,"div",9),m(16,n0,19,0,"div",10),m(17,r0,8,4,"div",11),t()()),o&2&&(a(14),c(u.isLoading?14:-1),a(),c(!u.isLoading&&u.products.length===0?15:-1),a(),c(!u.isLoading&&u.products.length>0?16:-1),a(),c(u.pagination&&u.pagination.totalPages>1?17:-1))},dependencies:[M,q,j,N,ge,be],encapsulation:2})}}return r})();var o0=(r,d,e)=>({"bg-destructive/10 text-destructive":r,"bg-warning/10 text-warning":d,"bg-secondary/10 text-secondary":e}),u0=r=>["/admin/products/edit",r];function a0(r,d){r&1&&(i(0,"div",9),g(1,"span",11),t())}function s0(r,d){r&1&&(i(0,"div",10)(1,"div",12)(2,"span",13),n(3,"check_circle"),t(),i(4,"p",14),n(5,"\u0647\u0645\u0647 \u0645\u062D\u0635\u0648\u0644\u0627\u062A \u0645\u0648\u062C\u0648\u062F\u06CC \u06A9\u0627\u0641\u06CC \u062F\u0627\u0631\u0646\u062F"),t(),i(6,"p",15),n(7,"\u0647\u06CC\u0686 \u0645\u062D\u0635\u0648\u0644\u06CC \u0632\u06CC\u0631 \u0622\u0633\u062A\u0627\u0646\u0647 \u062A\u0639\u06CC\u06CC\u0646 \u0634\u062F\u0647 \u0646\u06CC\u0633\u062A."),t()()())}function d0(r,d){r&1&&(i(0,"span",34),n(1,"error"),t())}function l0(r,d){if(r&1&&(i(0,"tr",26)(1,"td",27)(2,"div",28)(3,"span"),n(4),t(),i(5,"span",29),n(6),t()()(),i(7,"td",30)(8,"span",31),n(9),t()(),i(10,"td",30),n(11),t(),i(12,"td",32)(13,"span",33),m(14,d0,2,0,"span",34),n(15),t()(),i(16,"td",35),n(17),F(18,"number"),i(19,"span",36),n(20,"\u062A\u0648\u0645\u0627\u0646"),t()(),i(21,"td",37)(22,"a",38),n(23," \u0645\u062F\u06CC\u0631\u06CC\u062A "),t()()()),r&2){let e=d.$implicit;a(4),v(e.productName),a(2),x("SKU: ",e.sku),a(3),v(e.variantDisplayName),a(2),x(" ",e.categoryName||"-"," "),a(2),f("ngClass",kt(11,o0,e.stock===0,e.stock>0&&e.stock<=5,e.stock>5)),a(),c(e.stock===0?14:-1),a(),x(" ",e.stock," \u0639\u062F\u062F "),a(2),x(" ",U(18,9,e.sellingPrice)," "),a(5),f("routerLink",J(15,u0,e.productId))}}function m0(r,d){if(r&1&&(i(0,"div")(1,"div",16)(2,"div",17)(3,"span",3),n(4,"notifications_active"),t(),i(5,"p",18),n(6),t()(),i(7,"div",19)(8,"table",20)(9,"thead",21)(10,"tr")(11,"th",22),n(12,"\u0646\u0627\u0645 \u0645\u062D\u0635\u0648\u0644"),t(),i(13,"th",22),n(14,"\u062A\u0646\u0648\u0639"),t(),i(15,"th",22),n(16,"\u062F\u0633\u062A\u0647\u200C\u0628\u0646\u062F\u06CC"),t(),i(17,"th",23),n(18,"\u0645\u0648\u062C\u0648\u062F\u06CC"),t(),i(19,"th",22),n(20,"\u0642\u06CC\u0645\u062A"),t(),i(21,"th",24),n(22,"\u0639\u0645\u0644\u06CC\u0627\u062A"),t()()(),i(23,"tbody",25),A(24,l0,24,17,"tr",26,T),t()()()()()),r&2){let e=l();a(6),x("",e.products.length," \u062A\u0646\u0648\u0639 \u0645\u062D\u0635\u0648\u0644 \u0646\u06CC\u0627\u0632 \u0628\u0647 \u062A\u0627\u0645\u06CC\u0646 \u0645\u0648\u062C\u0648\u062F\u06CC \u062F\u0627\u0631\u0646\u062F"),a(18),E(e.products)}}var ci=(()=>{class r{constructor(e){this.inventoryService=e,this.products=[],this.isLoading=!1,this.threshold=5}ngOnInit(){this.loadLowStockProducts()}loadLowStockProducts(){this.isLoading=!0,this.inventoryService.getLowStockItems(this.threshold).pipe(L(()=>this.isLoading=!1)).subscribe({next:e=>{this.products=e},error:()=>{this.products=[]}})}static{this.\u0275fac=function(o){return new(o||r)(h(it))}}static{this.\u0275cmp=k({type:r,selectors:[["app-low-stock-alerts"]],decls:22,vars:8,consts:[[1,"space-y-6","animate-fade-in"],[1,"flex","items-center","justify-between"],[1,"text-2xl","font-bold","text-heading-foreground","flex","items-center","gap-2"],[1,"material-icons","text-warning"],[1,"card","p-6","space-y-4","border","border-border","shadow-sm"],[1,"flex","items-center","gap-4"],["for","threshold",1,"text-sm","font-medium","text-foreground"],["id","threshold",1,"input","w-40",3,"ngModelChange","ngModel"],[3,"value"],[1,"flex","justify-center","items-center","py-12"],[1,"card","p-12","text-center","border","border-success/20","bg-success/5"],[1,"spinner","spinner-xl","text-primary"],[1,"flex","flex-col","items-center","gap-4"],[1,"material-icons","text-5xl","text-success"],[1,"text-foreground","font-bold","text-lg"],[1,"text-muted-foreground"],[1,"card","overflow-hidden","border","border-border","shadow-sm"],[1,"p-4","bg-warning/10","border-b","border-warning/20","flex","items-center","gap-3","text-warning-foreground"],[1,"font-bold"],[1,"overflow-x-auto"],[1,"w-full","text-sm","text-right"],[1,"bg-muted/50","border-b","border-border","text-muted-foreground"],[1,"p-4","font-medium"],[1,"p-4","font-medium","text-center"],[1,"p-4","font-medium","w-32"],[1,"divide-y","divide-border/50","bg-card"],[1,"hover:bg-muted/20","transition-colors","group"],[1,"p-4","font-medium","text-foreground"],[1,"flex","flex-col"],[1,"text-xs","text-muted-foreground","font-mono","mt-0.5"],[1,"p-4","text-muted-foreground"],[1,"badge","badge-outline","bg-background"],[1,"p-4","text-center"],[1,"px-2.5","py-1","rounded-full","text-xs","font-bold","inline-flex","items-center","gap-1",3,"ngClass"],[1,"material-icons","text-[14px]"],[1,"p-4","text-foreground","font-medium","tabular-nums"],[1,"text-xs","font-normal","text-muted-foreground"],[1,"p-4"],[1,"btn","btn-sm","btn-outline","btn-primary","opacity-0","group-hover:opacity-100","transition-opacity",3,"routerLink"]],template:function(o,u){o&1&&(i(0,"div",0)(1,"div",1)(2,"h1",2)(3,"span",3),n(4,"warning"),t(),n(5," \u0645\u062D\u0635\u0648\u0644\u0627\u062A \u0631\u0648 \u0628\u0647 \u0627\u062A\u0645\u0627\u0645 "),t()(),i(6,"div",4)(7,"div",5)(8,"label",6),n(9,"\u0622\u0633\u062A\u0627\u0646\u0647 \u0647\u0634\u062F\u0627\u0631:"),t(),i(10,"select",7),X("ngModelChange",function(p){return Y(u.threshold,p)||(u.threshold=p),p}),C("ngModelChange",function(){return u.loadLowStockProducts()}),i(11,"option",8),n(12,"5 \u0639\u062F\u062F"),t(),i(13,"option",8),n(14,"10 \u0639\u062F\u062F"),t(),i(15,"option",8),n(16,"20 \u0639\u062F\u062F"),t(),i(17,"option",8),n(18,"50 \u0639\u062F\u062F"),t()()()(),m(19,a0,2,0,"div",9),m(20,s0,8,0,"div",10),m(21,m0,26,1,"div"),t()),o&2&&(a(10),Q("ngModel",u.threshold),a(),f("value",5),a(2),f("value",10),a(2),f("value",20),a(2),f("value",50),a(2),c(u.isLoading?19:-1),a(),c(!u.isLoading&&u.products.length===0?20:-1),a(),c(!u.isLoading&&u.products.length>0?21:-1))},dependencies:[M,q,j,N,ge,ie,ne,te,$,Ce,be],encapsulation:2})}}return r})();var pi=(()=>{class r{constructor(e){this.http=e,this.apiUrl=`${R.API_URL}admin/reviews`}getReviewsByStatus(e="Pending",o=1,u=20){let s=new z().set("status",e).set("page",o.toString()).set("pageSize",u.toString());return this.http.get(this.apiUrl,{params:s})}getReviewById(e){return this.http.get(`${this.apiUrl}/${e}`)}updateReview(e,o){return this.http.put(`${this.apiUrl}/${e}`,o)}updateReviewStatus(e,o){let u={status:o};return this.http.patch(`${this.apiUrl}/${e}/status`,u)}deleteReview(e){return this.http.delete(`${this.apiUrl}/${e}`)}replyToReview(e,o){return this.http.post(`${this.apiUrl}/${e}/reply`,{reply:o})}static{this.\u0275fac=function(o){return new(o||r)(W(G))}}static{this.\u0275prov=O({token:r,factory:r.\u0275fac,providedIn:"root"})}}return r})();var p0=()=>[1,2,3,4,5];function f0(r,d){r&1&&(i(0,"div",11),g(1,"span",14),t())}function g0(r,d){r&1&&(i(0,"div",12)(1,"span",15),n(2,"chat_bubble_outline"),t(),i(3,"p"),n(4,"\u0646\u0638\u0631\u06CC \u0628\u0627 \u0627\u06CC\u0646 \u0648\u0636\u0639\u06CC\u062A \u06CC\u0627\u0641\u062A \u0646\u0634\u062F."),t()())}function x0(r,d){r&1&&(i(0,"span",22)(1,"span",35),n(2,"verified"),t(),n(3," \u062E\u0631\u06CC\u062F\u0627\u0631 "),t())}function h0(r,d){if(r&1&&(i(0,"span",34),n(1,"star"),t()),r&2){let e=d.$implicit,o=l().$implicit;B("text-muted",e>o.rating)}}function C0(r,d){if(r&1){let e=S();i(0,"button",36),C("click",function(){b(e);let u=l().$implicit,s=l(2);return _(s.updateStatus(u.id,"Approved"))}),i(1,"span",37),n(2,"check"),t(),n(3," \u062A\u0627\u06CC\u06CC\u062F "),t()}}function v0(r,d){if(r&1){let e=S();i(0,"button",38),C("click",function(){b(e);let u=l().$implicit,s=l(2);return _(s.updateStatus(u.id,"Rejected"))}),i(1,"span",37),n(2,"block"),t(),n(3," \u0631\u062F \u06A9\u0631\u062F\u0646 "),t()}}function b0(r,d){if(r&1){let e=S();i(0,"div",16)(1,"div",17)(2,"div",18)(3,"div",19),n(4),t(),i(5,"div")(6,"div",20)(7,"span",21),n(8),t(),m(9,x0,4,0,"span",22),t(),i(10,"div",23)(11,"div",24),A(12,h0,2,2,"span",25,T),t(),i(14,"span",26),n(15,"\u2022"),t(),i(16,"span",27),n(17),t()()()(),i(18,"span",28),n(19),F(20,"date"),t()(),i(21,"p",29),n(22),t(),i(23,"div",30),m(24,C0,4,0,"button",31),m(25,v0,4,0,"button",32),i(26,"button",33),C("click",function(){let u=b(e).$implicit,s=l(2);return _(s.deleteReview(u.id))}),i(27,"span",34),n(28,"delete"),t()()()()}if(r&2){let e=d.$implicit;a(4),x(" ",(e.userName||"?").charAt(0)," "),a(4),v(e.title),a(),c(e.isVerifiedPurchase?9:-1),a(3),E(Ye(11,p0)),a(5),v(e.userName),a(2),v(oe(20,8,e.createdAt,"yyyy/MM/dd HH:mm")),a(3),v(e.comment),a(2),c(e.status==="Pending"||e.status==="Rejected"?24:-1),a(),c(e.status==="Pending"||e.status==="Approved"?25:-1)}}function _0(r,d){if(r&1&&(i(0,"div",13),A(1,b0,29,12,"div",16,T),t()),r&2){let e=l();a(),E(e.reviews)}}var fi=(()=>{class r{constructor(e,o){this.reviewService=e,this.notificationService=o,this.reviews=[],this.isLoading=!0,this.statusFilter="Pending"}ngOnInit(){this.loadReviews()}loadReviews(){this.isLoading=!0,this.reviewService.getReviewsByStatus(this.statusFilter).subscribe({next:e=>{this.reviews=e.items,this.isLoading=!1},error:()=>this.isLoading=!1})}updateStatus(e,o){this.reviewService.updateReviewStatus(e,o).subscribe({next:()=>{this.notificationService.show(`\u0648\u0636\u0639\u06CC\u062A \u0628\u0647 ${o} \u062A\u063A\u06CC\u06CC\u0631 \u06A9\u0631\u062F`,"success"),this.loadReviews()},error:()=>this.notificationService.show("\u062E\u0637\u0627","error")})}deleteReview(e){confirm("\u062D\u0630\u0641 \u0634\u0648\u062F\u061F")&&this.reviewService.deleteReview(e).subscribe({next:()=>{this.notificationService.show("\u062D\u0630\u0641 \u0634\u062F","success"),this.loadReviews()},error:()=>this.notificationService.show("\u062E\u0637\u0627","error")})}static{this.\u0275fac=function(o){return new(o||r)(h(pi),h(D))}}static{this.\u0275cmp=k({type:r,selectors:[["app-admin-review-list"]],decls:20,vars:4,consts:[[1,"space-y-6","animate-fade-in"],[1,"flex","items-center","justify-between"],[1,"text-2xl","font-bold","text-heading-foreground","flex","items-center","gap-2"],[1,"material-icons","text-primary"],[1,"flex","items-center","gap-2","bg-card","p-1","rounded-lg","border","border-border","shadow-sm"],[1,"text-xs","text-muted-foreground","px-2"],[1,"h-9","rounded-md","border-0","bg-transparent","py-0","pl-2","pr-8","text-sm","focus:ring-0","cursor-pointer","hover:bg-muted/50","transition-colors",3,"ngModelChange","change","ngModel"],["value","Pending"],["value","Approved"],["value","Rejected"],[1,"card","overflow-hidden","border","border-border","shadow-sm"],[1,"flex","justify-center","p-12"],[1,"p-16","text-center","text-muted-foreground","flex","flex-col","items-center","gap-3"],[1,"divide-y","divide-border/50","bg-card"],[1,"spinner","spinner-xl","text-primary"],[1,"material-icons","text-5xl","opacity-20"],[1,"p-6","hover:bg-muted/10","transition-colors","group"],[1,"flex","flex-col","sm:flex-row","sm:justify-between","sm:items-start","gap-4","mb-3"],[1,"flex","items-start","gap-3"],[1,"w-10","h-10","rounded-full","bg-primary/10","flex","items-center","justify-center","text-primary","font-bold"],[1,"flex","items-center","gap-2"],[1,"font-bold","text-foreground"],[1,"badge","badge-success","text-[10px]","h-5","px-1.5","gap-0.5"],[1,"flex","items-center","gap-1","mt-1"],[1,"flex","text-warning"],[1,"material-icons","text-sm",3,"text-muted"],[1,"text-xs","text-muted-foreground","mx-1"],[1,"text-xs","text-muted-foreground"],[1,"text-xs","text-muted-foreground","font-mono","bg-muted/50","px-2","py-1","rounded-md"],[1,"text-sm","text-foreground/80","leading-relaxed","pr-[3.25rem]","pl-4","mb-4"],[1,"flex","justify-end","items-center","gap-2","border-t","border-border/30","pt-3","mt-2"],[1,"btn","btn-success","btn-sm","shadow-sm"],[1,"btn","btn-warning","btn-sm","shadow-sm"],[1,"btn","btn-destructive","btn-sm","btn-icon","shadow-sm","ml-2",3,"click"],[1,"material-icons","text-sm"],[1,"material-icons","text-[12px]"],[1,"btn","btn-success","btn-sm","shadow-sm",3,"click"],[1,"material-icons","text-sm","me-1"],[1,"btn","btn-warning","btn-sm","shadow-sm",3,"click"]],template:function(o,u){o&1&&(i(0,"div",0)(1,"div",1)(2,"h1",2)(3,"span",3),n(4,"reviews"),t(),n(5," \u0645\u062F\u06CC\u0631\u06CC\u062A \u0646\u0638\u0631\u0627\u062A "),t(),i(6,"div",4)(7,"span",5),n(8,"\u0641\u06CC\u0644\u062A\u0631:"),t(),i(9,"select",6),X("ngModelChange",function(p){return Y(u.statusFilter,p)||(u.statusFilter=p),p}),C("change",function(){return u.loadReviews()}),i(10,"option",7),n(11,"\u062F\u0631 \u0627\u0646\u062A\u0638\u0627\u0631 \u062A\u0627\u06CC\u06CC\u062F"),t(),i(12,"option",8),n(13,"\u062A\u0627\u06CC\u06CC\u062F \u0634\u062F\u0647"),t(),i(14,"option",9),n(15,"\u0631\u062F \u0634\u062F\u0647"),t()()()(),i(16,"div",10),m(17,f0,2,0,"div",11),m(18,g0,5,0,"div",12),m(19,_0,3,0,"div",13),t()()),o&2&&(a(9),Q("ngModel",u.statusFilter),a(8),c(u.isLoading?17:-1),a(),c(!u.isLoading&&u.reviews.length===0?18:-1),a(),c(!u.isLoading&&u.reviews.length>0?19:-1))},dependencies:[M,ge,ie,ne,te,$,Ce,fe],encapsulation:2})}}return r})();var gi=(()=>{class r{constructor(e){this.http=e,this.apiUrl=`${R.API_URL}admin/search`,this.requestTimeout=3e5}syncAllData(){let e=new dt({"Content-Type":"application/json"});return this.http.post(`${this.apiUrl}/sync`,{},{headers:e}).pipe(qe(this.requestTimeout),Ae(this.handleError))}recreateIndices(){let e=new dt({"Content-Type":"application/json"});return this.http.post(`${this.apiUrl}/recreate-indices`,{},{headers:e}).pipe(qe(this.requestTimeout),Ae(this.handleError))}getIndexStats(){return this.http.get(`${this.apiUrl}/stats`).pipe(qe(3e4),Ae(this.handleError))}handleError(e){let o="\u062E\u0637\u0627\u06CC \u0646\u0627\u0645\u0634\u062E\u0635 \u0631\u062E \u062F\u0627\u062F\u0647 \u0627\u0633\u062A";return e.error instanceof ErrorEvent?o=`\u062E\u0637\u0627\u06CC \u0634\u0628\u06A9\u0647: ${e.error.message}`:e.status===0?o="\u062E\u0637\u0627 \u062F\u0631 \u0627\u062A\u0635\u0627\u0644 \u0628\u0647 \u0633\u0631\u0648\u0631. \u0644\u0637\u0641\u0627\u064B \u0627\u062A\u0635\u0627\u0644 \u0627\u06CC\u0646\u062A\u0631\u0646\u062A \u062E\u0648\u062F \u0631\u0627 \u0628\u0631\u0631\u0633\u06CC \u06A9\u0646\u06CC\u062F.":e.status===404?o="\u0633\u0631\u0648\u06CC\u0633 \u0645\u0648\u0631\u062F \u0646\u0638\u0631 \u06CC\u0627\u0641\u062A \u0646\u0634\u062F":e.status===500?o="\u062E\u0637\u0627\u06CC \u062F\u0627\u062E\u0644\u06CC \u0633\u0631\u0648\u0631":e.status===503?o="\u0633\u0631\u0648\u06CC\u0633 \u0645\u0648\u0642\u062A\u0627\u064B \u062F\u0631 \u062F\u0633\u062A\u0631\u0633 \u0646\u06CC\u0633\u062A":e.error&&(typeof e.error=="string"?o=e.error:e.error.error?o=e.error.error:e.error.message&&(o=e.error.message)),console.error("Admin Search Service Error:",{status:e.status,message:o,error:e}),yt(()=>({error:o,statusCode:e.status,timestamp:new Date().toISOString()}))}static{this.\u0275fac=function(o){return new(o||r)(W(G))}}static{this.\u0275prov=O({token:r,factory:r.\u0275fac,providedIn:"root"})}}return r})();function y0(r,d){r&1&&(w(0,"div",6)(1,"div",9),Je(2,"span",10),w(3,"p",11),n(4,"\u062F\u0631 \u062D\u0627\u0644 \u0628\u0627\u0631\u06AF\u0630\u0627\u0631\u06CC \u0627\u0637\u0644\u0627\u0639\u0627\u062A..."),y()()())}function A0(r,d){if(r&1&&(w(0,"div",19)(1,"div",13)(2,"span",41),n(3),y(),w(4,"div")(5,"p",42),n(6),y(),w(7,"p",43),n(8,"Elasticsearch Index"),y()()(),w(9,"span",44),n(10),y()()),r&2){let e=d.$implicit,o=l(2);a(2),B("text-success",e.exists)("text-error",!e.exists),a(),x(" ",o.getStatusIcon(e.exists)," "),a(3),v(e.index),a(3),B("badge-success",e.exists)("badge-error",!e.exists),a(),x(" ",o.getStatusText(e.exists)," ")}}function E0(r,d){r&1&&(w(0,"div",20)(1,"span",45),n(2,"inbox"),y(),w(3,"p",46),n(4,"\u0647\u06CC\u0686 \u0627\u06CC\u0646\u062F\u06A9\u0633\u06CC \u06CC\u0627\u0641\u062A \u0646\u0634\u062F"),y(),w(5,"p",47),n(6,"\u0644\u0637\u0641\u0627\u064B \u0627\u0628\u062A\u062F\u0627 \u0627\u06CC\u0646\u062F\u06A9\u0633\u200C\u0647\u0627 \u0631\u0627 \u0627\u06CC\u062C\u0627\u062F \u06A9\u0646\u06CC\u062F"),y()())}function w0(r,d){if(r&1&&(w(0,"p",29),n(1),y()),r&2){let e=l(2);a(),x(" \u0622\u062E\u0631\u06CC\u0646 \u0647\u0645\u06AF\u0627\u0645\u200C\u0633\u0627\u0632\u06CC: ",e.formatLastActionTime(e.lastSyncTime)," ")}}function F0(r,d){if(r&1&&(w(0,"p",29),n(1),y()),r&2){let e=l(2);a(),x(" \u0622\u062E\u0631\u06CC\u0646 \u0628\u0627\u0632\u0633\u0627\u0632\u06CC: ",e.formatLastActionTime(e.lastRecreateTime)," ")}}function k0(r,d){if(r&1){let e=S();w(0,"div",7)(1,"div",12)(2,"div",13)(3,"div",14)(4,"span",15),n(5,"storage"),y()(),w(6,"div")(7,"h2",16),n(8,"\u0648\u0636\u0639\u06CC\u062A \u0627\u06CC\u0646\u062F\u06A9\u0633\u200C\u0647\u0627"),y(),w(9,"p",17),n(10,"\u0627\u0637\u0644\u0627\u0639\u0627\u062A \u0627\u06CC\u0646\u062F\u06A9\u0633\u200C\u0647\u0627\u06CC Elasticsearch"),y()()(),w(11,"div",18),A(12,A0,11,11,"div",19,T),m(14,E0,7,0,"div",20),y()(),w(15,"div",12)(16,"div",13)(17,"div",21)(18,"span",15),n(19,"settings"),y()(),w(20,"div")(21,"h2",16),n(22,"\u0639\u0645\u0644\u06CC\u0627\u062A \u0645\u062F\u06CC\u0631\u06CC\u062A\u06CC"),y(),w(23,"p",17),n(24,"\u0627\u0642\u062F\u0627\u0645\u0627\u062A \u0646\u06AF\u0647\u062F\u0627\u0631\u06CC \u0648 \u0628\u0647\u06CC\u0646\u0647\u200C\u0633\u0627\u0632\u06CC"),y()()(),w(25,"div",22)(26,"div",23)(27,"div",24)(28,"span",25),n(29,"sync"),y(),w(30,"div",26)(31,"h3",27),n(32,"\u0647\u0645\u06AF\u0627\u0645\u200C\u0633\u0627\u0632\u06CC \u062F\u0627\u062F\u0647\u200C\u0647\u0627"),y(),w(33,"p",28),n(34," \u062A\u0645\u0627\u0645 \u0645\u062D\u0635\u0648\u0644\u0627\u062A\u060C \u062F\u0633\u062A\u0647\u200C\u0628\u0646\u062F\u06CC\u200C\u0647\u0627 \u0648 \u06AF\u0631\u0648\u0647\u200C\u0647\u0627\u06CC \u062F\u0633\u062A\u0647\u200C\u0628\u0646\u062F\u06CC \u0631\u0627 \u0627\u0632 \u067E\u0627\u06CC\u06AF\u0627\u0647 \u062F\u0627\u062F\u0647 \u0627\u0635\u0644\u06CC \u0628\u0627 Elasticsearch \u0647\u0645\u06AF\u0627\u0645 \u0645\u06CC\u200C\u06A9\u0646\u062F. \u0627\u06CC\u0646 \u0639\u0645\u0644\u06CC\u0627\u062A \u0628\u0631\u0627\u06CC \u0628\u0647\u200C\u0631\u0648\u0632\u0631\u0633\u0627\u0646\u06CC \u062F\u0627\u062F\u0647\u200C\u0647\u0627\u06CC \u0645\u0648\u062C\u0648\u062F \u0627\u0633\u062A\u0641\u0627\u062F\u0647 \u0645\u06CC\u200C\u0634\u0648\u062F. "),y(),m(35,w0,2,1,"p",29),y()(),w(36,"button",30),Le("click",function(){b(e);let u=l();return _(u.syncAllData())}),w(37,"span",5),n(38," sync "),y(),n(39),y()(),w(40,"div",31)(41,"div",24)(42,"span",32),n(43,"refresh"),y(),w(44,"div",26)(45,"h3",27),n(46,"\u0628\u0627\u0632\u0633\u0627\u0632\u06CC \u0627\u06CC\u0646\u062F\u06A9\u0633\u200C\u0647\u0627"),y(),w(47,"p",28),n(48," \u062A\u0645\u0627\u0645 \u0627\u06CC\u0646\u062F\u06A9\u0633\u200C\u0647\u0627\u06CC Elasticsearch \u0631\u0627 \u062D\u0630\u0641 \u0648 \u0645\u062C\u062F\u062F\u0627\u064B \u0627\u06CC\u062C\u0627\u062F \u0645\u06CC\u200C\u06A9\u0646\u062F. \u0627\u06CC\u0646 \u0639\u0645\u0644\u06CC\u0627\u062A \u0628\u0631\u0627\u06CC \u0631\u0641\u0639 \u0645\u0634\u06A9\u0644\u0627\u062A \u0633\u0627\u062E\u062A\u0627\u0631\u06CC \u06CC\u0627 \u062A\u063A\u06CC\u06CC\u0631 \u062F\u0631 mapping \u0627\u0633\u062A\u0641\u0627\u062F\u0647 \u0645\u06CC\u200C\u0634\u0648\u062F. \u067E\u0633 \u0627\u0632 \u0628\u0627\u0632\u0633\u0627\u0632\u06CC\u060C \u0646\u06CC\u0627\u0632 \u0628\u0647 \u0647\u0645\u06AF\u0627\u0645\u200C\u0633\u0627\u0632\u06CC \u062F\u0627\u0631\u06CC\u062F. "),y(),m(49,F0,2,1,"p",29),y()(),w(50,"div",33)(51,"span",5),n(52,"warning"),y(),w(53,"span"),n(54,"\u0647\u0634\u062F\u0627\u0631: \u0627\u06CC\u0646 \u0639\u0645\u0644\u06CC\u0627\u062A \u062A\u0645\u0627\u0645 \u062F\u0627\u062F\u0647\u200C\u0647\u0627\u06CC Elasticsearch \u0631\u0627 \u062D\u0630\u0641 \u0645\u06CC\u200C\u06A9\u0646\u062F!"),y()(),w(55,"button",34),Le("click",function(){b(e);let u=l();return _(u.recreateIndices())}),w(56,"span",5),n(57," refresh "),y(),n(58),y()()(),w(59,"div",35)(60,"div",36)(61,"span",37),n(62,"info"),y(),w(63,"div",38)(64,"p",39),n(65,"\u0646\u06A9\u0627\u062A \u0645\u0647\u0645:"),y(),w(66,"ul",40)(67,"li"),n(68,"\u0639\u0645\u0644\u06CC\u0627\u062A \u0647\u0645\u06AF\u0627\u0645\u200C\u0633\u0627\u0632\u06CC \u0645\u0645\u06A9\u0646 \u0627\u0633\u062A \u0628\u0633\u062A\u0647 \u0628\u0647 \u062D\u062C\u0645 \u062F\u0627\u062F\u0647\u200C\u0647\u0627 \u0686\u0646\u062F \u062F\u0642\u06CC\u0642\u0647 \u0637\u0648\u0644 \u0628\u06A9\u0634\u062F"),y(),w(69,"li"),n(70,"\u0628\u0639\u062F \u0627\u0632 \u0628\u0627\u0632\u0633\u0627\u0632\u06CC \u0627\u06CC\u0646\u062F\u06A9\u0633\u200C\u0647\u0627\u060C \u062D\u062A\u0645\u0627\u064B \u0647\u0645\u06AF\u0627\u0645\u200C\u0633\u0627\u0632\u06CC \u0631\u0627 \u0627\u062C\u0631\u0627 \u06A9\u0646\u06CC\u062F"),y(),w(71,"li"),n(72,"\u062A\u0648\u0635\u06CC\u0647 \u0645\u06CC\u200C\u0634\u0648\u062F \u0627\u06CC\u0646 \u0639\u0645\u0644\u06CC\u0627\u062A \u0631\u0627 \u062F\u0631 \u0633\u0627\u0639\u0627\u062A \u06A9\u0645\u200C\u062A\u0631\u0627\u0641\u06CC\u06A9 \u0627\u0646\u062C\u0627\u0645 \u062F\u0647\u06CC\u062F"),y(),w(73,"li"),n(74,"\u0642\u0628\u0644 \u0627\u0632 \u0647\u0631 \u0639\u0645\u0644\u06CC\u0627\u062A\u060C \u0627\u0632 \u067E\u0634\u062A\u06CC\u0628\u0627\u0646\u200C\u06AF\u06CC\u0631\u06CC \u062F\u0627\u062F\u0647\u200C\u0647\u0627 \u0627\u0637\u0645\u06CC\u0646\u0627\u0646 \u062D\u0627\u0635\u0644 \u06A9\u0646\u06CC\u062F"),y()()()()()()()}if(r&2){let e=l();a(12),E(e.indexStats),a(2),c(e.indexStats.length===0?14:-1),a(21),c(e.lastSyncTime?35:-1),a(),B("opacity-50",!e.canPerformActions()||e.isSyncing)("cursor-not-allowed",!e.canPerformActions()||e.isSyncing),Me("disabled",!e.canPerformActions()||e.isSyncing),a(),B("animate-spin",e.isSyncing),a(2),x(" ",e.isSyncing?"\u062F\u0631 \u062D\u0627\u0644 \u0647\u0645\u06AF\u0627\u0645\u200C\u0633\u0627\u0632\u06CC...":"\u0634\u0631\u0648\u0639 \u0647\u0645\u06AF\u0627\u0645\u200C\u0633\u0627\u0632\u06CC"," "),a(10),c(e.lastRecreateTime?49:-1),a(6),B("opacity-50",!e.canPerformActions()||e.isRecreating)("cursor-not-allowed",!e.canPerformActions()||e.isRecreating),Me("disabled",!e.canPerformActions()||e.isRecreating),a(),B("animate-spin",e.isRecreating),a(2),x(" ",e.isRecreating?"\u062F\u0631 \u062D\u0627\u0644 \u0628\u0627\u0632\u0633\u0627\u0632\u06CC...":"\u0628\u0627\u0632\u0633\u0627\u0632\u06CC \u0627\u06CC\u0646\u062F\u06A9\u0633\u200C\u0647\u0627"," ")}}function I0(r,d){if(r&1&&(w(0,"div",62)(1,"div",63)(2,"span",5),n(3,"warning"),y(),w(4,"div",64)(5,"span",65),n(6,"\u062A\u0648\u062C\u0647:"),y(),n(7),y()()()),r&2){let e=l(2);a(7),x(" ",e.getInactiveCount()," \u0627\u06CC\u0646\u062F\u06A9\u0633 \u063A\u06CC\u0631\u0641\u0639\u0627\u0644 \u0627\u0633\u062A. \u0628\u0631\u0627\u06CC \u0641\u0639\u0627\u0644\u200C\u0633\u0627\u0632\u06CC\u060C \u0627\u0628\u062A\u062F\u0627 \u0627\u06CC\u0646\u062F\u06A9\u0633\u200C\u0647\u0627 \u0631\u0627 \u0628\u0627\u0632\u0633\u0627\u0632\u06CC \u0648 \u0633\u067E\u0633 \u0647\u0645\u06AF\u0627\u0645\u200C\u0633\u0627\u0632\u06CC \u06A9\u0646\u06CC\u062F. ")}}function T0(r,d){if(r&1&&(w(0,"div",8)(1,"h3",48)(2,"span",49),n(3,"analytics"),y(),n(4," \u062E\u0644\u0627\u0635\u0647 \u0648\u0636\u0639\u06CC\u062A "),y(),w(5,"div",50)(6,"div",51)(7,"div",52)(8,"div")(9,"p",53),n(10,"\u06A9\u0644 \u0627\u06CC\u0646\u062F\u06A9\u0633\u200C\u0647\u0627"),y(),w(11,"p",54),n(12),y()(),w(13,"span",55),n(14,"storage"),y()()(),w(15,"div",56)(16,"div",52)(17,"div")(18,"p",53),n(19,"\u0627\u06CC\u0646\u062F\u06A9\u0633\u200C\u0647\u0627\u06CC \u0641\u0639\u0627\u0644"),y(),w(20,"p",57),n(21),y()(),w(22,"span",58),n(23,"check_circle"),y()()(),w(24,"div",59)(25,"div",52)(26,"div")(27,"p",53),n(28,"\u0627\u06CC\u0646\u062F\u06A9\u0633\u200C\u0647\u0627\u06CC \u063A\u06CC\u0631\u0641\u0639\u0627\u0644"),y(),w(29,"p",60),n(30),y()(),w(31,"span",61),n(32,"cancel"),y()()()(),m(33,I0,8,1,"div",62),y()),r&2){let e=l();a(12),v(e.getTotalCount()),a(9),v(e.getActiveCount()),a(9),v(e.getInactiveCount()),a(3),c(e.getInactiveCount()>0?33:-1)}}var xi=(()=>{class r{constructor(e,o){this.searchService=e,this.notification=o,this.isLoading=!1,this.indexStats=[],this.isSyncing=!1,this.isRecreating=!1,this.lastSyncTime=null,this.lastRecreateTime=null,this.destroy$=new Te}ngOnInit(){this.loadIndexStats()}ngOnDestroy(){this.destroy$.next(),this.destroy$.complete()}loadIndexStats(){this.isLoading=!0,this.searchService.getIndexStats().pipe(He(this.destroy$),L(()=>this.isLoading=!1),Ae(e=>{let o=this.extractErrorMessage(e);return console.error("Error loading index stats:",e),this.notification.show(`\u062E\u0637\u0627 \u062F\u0631 \u062F\u0631\u06CC\u0627\u0641\u062A \u0627\u0637\u0644\u0627\u0639\u0627\u062A: ${o}`,"error"),ke([])})).subscribe({next:e=>{this.indexStats=e,e.length===0&&this.notification.show("\u0647\u06CC\u0686 \u0627\u06CC\u0646\u062F\u06A9\u0633\u06CC \u06CC\u0627\u0641\u062A \u0646\u0634\u062F","info")}})}syncAllData(){if(this.isSyncing){this.notification.show("\u0647\u0645\u06AF\u0627\u0645\u200C\u0633\u0627\u0632\u06CC \u062F\u0631 \u062D\u0627\u0644 \u0627\u062C\u0631\u0627 \u0627\u0633\u062A","info");return}let o=this.indexStats.some(u=>!u.exists)?"\u0628\u0631\u062E\u06CC \u0627\u06CC\u0646\u062F\u06A9\u0633\u200C\u0647\u0627 \u063A\u06CC\u0631\u0641\u0639\u0627\u0644 \u0647\u0633\u062A\u0646\u062F. \u0622\u06CC\u0627 \u0627\u0632 \u0647\u0645\u06AF\u0627\u0645\u200C\u0633\u0627\u0632\u06CC \u0627\u0637\u0645\u06CC\u0646\u0627\u0646 \u062F\u0627\u0631\u06CC\u062F\u061F":"\u0622\u06CC\u0627 \u0627\u0632 \u0647\u0645\u06AF\u0627\u0645\u200C\u0633\u0627\u0632\u06CC \u062A\u0645\u0627\u0645 \u062F\u0627\u062F\u0647\u200C\u0647\u0627 \u0627\u0637\u0645\u06CC\u0646\u0627\u0646 \u062F\u0627\u0631\u06CC\u062F\u061F \u0627\u06CC\u0646 \u0639\u0645\u0644\u06CC\u0627\u062A \u0645\u0645\u06A9\u0646 \u0627\u0633\u062A \u0686\u0646\u062F \u062F\u0642\u06CC\u0642\u0647 \u0637\u0648\u0644 \u0628\u06A9\u0634\u062F.";confirm(o)&&(this.isSyncing=!0,this.notification.show("\u0647\u0645\u06AF\u0627\u0645\u200C\u0633\u0627\u0632\u06CC \u0634\u0631\u0648\u0639 \u0634\u062F...","info"),this.searchService.syncAllData().pipe(He(this.destroy$),L(()=>this.isSyncing=!1),Ae(u=>{let s=this.extractErrorMessage(u);return console.error("Error syncing data:",u),this.notification.show(`\u062E\u0637\u0627 \u062F\u0631 \u0647\u0645\u06AF\u0627\u0645\u200C\u0633\u0627\u0632\u06CC: ${s}`,"error"),ke(null)})).subscribe({next:u=>{u&&(this.lastSyncTime=new Date,this.notification.show(u.message||"\u0647\u0645\u06AF\u0627\u0645\u200C\u0633\u0627\u0632\u06CC \u0628\u0627 \u0645\u0648\u0641\u0642\u06CC\u062A \u0627\u0646\u062C\u0627\u0645 \u0634\u062F","success"),this.loadIndexStats())}}))}recreateIndices(){if(this.isRecreating){this.notification.show("\u0628\u0627\u0632\u0633\u0627\u0632\u06CC \u062F\u0631 \u062D\u0627\u0644 \u0627\u062C\u0631\u0627 \u0627\u0633\u062A","info");return}confirm(`\u0622\u06CC\u0627 \u0627\u0632 \u0628\u0627\u0632\u0633\u0627\u0632\u06CC \u0627\u06CC\u0646\u062F\u06A9\u0633\u200C\u0647\u0627 \u0627\u0637\u0645\u06CC\u0646\u0627\u0646 \u062F\u0627\u0631\u06CC\u062F\u061F

\u26A0\uFE0F \u0647\u0634\u062F\u0627\u0631: \u0627\u06CC\u0646 \u0639\u0645\u0644\u06CC\u0627\u062A \u062A\u0645\u0627\u0645 \u062F\u0627\u062F\u0647\u200C\u0647\u0627\u06CC \u0645\u0648\u062C\u0648\u062F \u062F\u0631 Elasticsearch \u0631\u0627 \u062D\u0630\u0641 \u06A9\u0631\u062F\u0647 \u0648 \u062F\u0648\u0628\u0627\u0631\u0647 \u0627\u06CC\u062C\u0627\u062F \u0645\u06CC\u200C\u06A9\u0646\u062F.
\u067E\u0633 \u0627\u0632 \u0628\u0627\u0632\u0633\u0627\u0632\u06CC\u060C \u0628\u0627\u06CC\u062F \u0647\u0645\u06AF\u0627\u0645\u200C\u0633\u0627\u0632\u06CC \u0631\u0627 \u0627\u062C\u0631\u0627 \u06A9\u0646\u06CC\u062F.

\u0622\u06CC\u0627 \u0627\u062F\u0627\u0645\u0647 \u0645\u06CC\u200C\u062F\u0647\u06CC\u062F\u061F`)&&(this.isRecreating=!0,this.notification.show("\u0628\u0627\u0632\u0633\u0627\u0632\u06CC \u0627\u06CC\u0646\u062F\u06A9\u0633\u200C\u0647\u0627 \u0634\u0631\u0648\u0639 \u0634\u062F...","info"),this.searchService.recreateIndices().pipe(He(this.destroy$),L(()=>this.isRecreating=!1),Ae(o=>{let u=this.extractErrorMessage(o);return console.error("Error recreating indices:",o),this.notification.show(`\u062E\u0637\u0627 \u062F\u0631 \u0628\u0627\u0632\u0633\u0627\u0632\u06CC: ${u}`,"error"),ke(null)})).subscribe({next:o=>{o&&(this.lastRecreateTime=new Date,this.notification.show(o.message||"\u0628\u0627\u0632\u0633\u0627\u0632\u06CC \u0628\u0627 \u0645\u0648\u0641\u0642\u06CC\u062A \u0627\u0646\u062C\u0627\u0645 \u0634\u062F","success"),this.loadIndexStats(),(this.indexStats.every(s=>!s.exists)||this.indexStats.length===0)&&setTimeout(()=>{confirm("\u0627\u06CC\u0646\u062F\u06A9\u0633\u200C\u0647\u0627 \u0628\u0627\u0632\u0633\u0627\u0632\u06CC \u0634\u062F\u0646\u062F. \u0622\u06CC\u0627 \u0645\u06CC\u200C\u062E\u0648\u0627\u0647\u06CC\u062F \u0627\u06A9\u0646\u0648\u0646 \u0647\u0645\u06AF\u0627\u0645\u200C\u0633\u0627\u0632\u06CC \u0631\u0627 \u0634\u0631\u0648\u0639 \u06A9\u0646\u06CC\u062F\u061F")&&this.syncAllData()},1e3))}}))}getStatusColor(e){return e?"success":"error"}getStatusText(e){return e?"\u0641\u0639\u0627\u0644":"\u063A\u06CC\u0631\u0641\u0639\u0627\u0644"}getStatusIcon(e){return e?"check_circle":"cancel"}getActiveCount(){return this.indexStats.filter(e=>e.exists).length}getInactiveCount(){return this.indexStats.filter(e=>!e.exists).length}getTotalCount(){return this.indexStats.length}canPerformActions(){return!this.isLoading&&!this.isSyncing&&!this.isRecreating}formatLastActionTime(e){if(!e)return"\u0647\u0631\u06AF\u0632";let u=new Date().getTime()-e.getTime(),s=Math.floor(u/1e3),p=Math.floor(s/60),V=Math.floor(p/60);return s<60?"\u0644\u062D\u0638\u0627\u062A\u06CC \u067E\u06CC\u0634":p<60?`${p} \u062F\u0642\u06CC\u0642\u0647 \u067E\u06CC\u0634`:V<24?`${V} \u0633\u0627\u0639\u062A \u067E\u06CC\u0634`:e.toLocaleDateString("fa-IR")}extractErrorMessage(e){if(!e)return"\u062E\u0637\u0627\u06CC \u0646\u0627\u0645\u0634\u062E\u0635";if(e.error){if(typeof e.error=="string")return e.error;if(e.error.error)return e.error.error;if(e.error.message)return e.error.message}return e.message?e.message:e.statusText?e.statusText:"\u062E\u0637\u0627 \u062F\u0631 \u0627\u0631\u062A\u0628\u0627\u0637 \u0628\u0627 \u0633\u0631\u0648\u0631"}static{this.\u0275fac=function(o){return new(o||r)(h(gi),h(D))}}static{this.\u0275cmp=k({type:r,selectors:[["app-admin-search-form"]],decls:14,vars:10,consts:[[1,"space-y-6","animate-fade-in"],[1,"flex","flex-col","sm:flex-row","items-start","sm:items-center","justify-between","gap-4"],[1,"text-3xl","font-black","tracking-tight","text-heading-foreground"],[1,"text-sm","text-muted-foreground","mt-1"],[1,"btn","btn-outline","btn-sm","gap-2",3,"click","disabled"],[1,"material-icons","text-sm"],[1,"flex","justify-center","items-center","min-h-[300px]"],[1,"grid","gap-6","lg:grid-cols-2"],[1,"card","p-6"],[1,"flex","flex-col","items-center","gap-3"],[1,"spinner","spinner-xl","text-primary"],[1,"text-sm","text-muted-foreground","animate-pulse"],[1,"card","p-6","space-y-6"],[1,"flex","items-center","gap-3"],[1,"icon-wrapper","icon-wrapper-primary"],[1,"material-icons"],[1,"text-xl","font-bold","text-heading-foreground"],[1,"text-sm","text-muted-foreground"],[1,"space-y-3"],[1,"flex","items-center","justify-between","p-4","rounded-lg","border","border-border","bg-muted/30","hover:bg-muted/50","transition-colors"],[1,"text-center","py-8","text-muted-foreground"],[1,"icon-wrapper","icon-wrapper-info"],[1,"space-y-4"],[1,"p-4","rounded-lg","border-2","border-primary/20","bg-primary/5","space-y-3"],[1,"flex","items-start","gap-3"],[1,"material-icons","text-primary","mt-0.5"],[1,"flex-1","min-w-0"],[1,"font-bold","text-foreground","mb-1"],[1,"text-sm","text-muted-foreground","leading-relaxed"],[1,"text-xs","text-muted-foreground","mt-2"],[1,"btn","btn-primary","w-full","gap-2",3,"click","disabled"],[1,"p-4","rounded-lg","border-2","border-warning/20","bg-warning/5","space-y-3"],[1,"material-icons","text-warning","mt-0.5"],[1,"alert","alert-warning","gap-2","text-xs"],[1,"btn","btn-warning","w-full","gap-2",3,"click","disabled"],[1,"p-4","rounded-lg","border","border-info/30","bg-info/5","space-y-2"],[1,"flex","items-start","gap-2","text-info"],[1,"material-icons","text-sm","mt-0.5"],[1,"text-xs","leading-relaxed"],[1,"font-semibold","mb-1"],[1,"space-y-1","mr-4","list-disc"],[1,"material-icons","text-[20px]"],[1,"font-semibold","text-foreground"],[1,"text-xs","text-muted-foreground"],[1,"badge","text-xs","px-3","py-1"],[1,"material-icons","text-4xl","opacity-30"],[1,"mt-2","text-sm"],[1,"mt-1","text-xs"],[1,"text-lg","font-bold","text-heading-foreground","mb-4","flex","items-center","gap-2"],[1,"material-icons","text-primary"],[1,"grid","gap-4","md:grid-cols-3"],[1,"stat-card","border-r-4","border-r-primary","hover:shadow-md","transition-shadow"],[1,"flex","items-center","justify-between"],[1,"stat-label"],[1,"stat-value","text-primary"],[1,"material-icons","text-primary","text-3xl","opacity-20"],[1,"stat-card","border-r-4","border-r-success","hover:shadow-md","transition-shadow"],[1,"stat-value","text-success"],[1,"material-icons","text-success","text-3xl","opacity-20"],[1,"stat-card","border-r-4","border-r-error","hover:shadow-md","transition-shadow"],[1,"stat-value","text-error"],[1,"material-icons","text-error","text-3xl","opacity-20"],[1,"mt-4"],[1,"alert","alert-warning","gap-2"],[1,"text-sm"],[1,"font-semibold"]],template:function(o,u){o&1&&(w(0,"div",0)(1,"div",1)(2,"div")(3,"h1",2),n(4," \u0645\u062F\u06CC\u0631\u06CC\u062A \u062C\u0633\u062A\u062C\u0648 "),y(),w(5,"p",3),n(6," \u0645\u062F\u06CC\u0631\u06CC\u062A \u0648 \u0646\u06AF\u0647\u062F\u0627\u0631\u06CC Elasticsearch \u0628\u0631\u0627\u06CC \u062C\u0633\u062A\u062C\u0648\u06CC \u0645\u062D\u0635\u0648\u0644\u0627\u062A "),y()(),w(7,"button",4),Le("click",function(){return u.loadIndexStats()}),w(8,"span",5),n(9,"refresh"),y(),n(10," \u0628\u0631\u0648\u0632\u0631\u0633\u0627\u0646\u06CC "),y()(),m(11,y0,5,0,"div",6),m(12,k0,75,19,"div",7),m(13,T0,34,4,"div",8),y()),o&2&&(a(7),B("opacity-50",!u.canPerformActions())("cursor-not-allowed",!u.canPerformActions()),Me("disabled",!u.canPerformActions()),a(),B("animate-spin",u.isLoading),a(3),c(u.isLoading?11:-1),a(),c(u.isLoading?-1:12),a(),c(!u.isLoading&&u.indexStats.length>0?13:-1))},encapsulation:2})}}return r})();var ot=(()=>{class r{constructor(e){this.http=e,this.baseUrl=`${R.API_URL}admin/shipping`}getShippings(e=!1){return this.http.get(`${this.baseUrl}?includeDeleted=${e}`)}getShippingById(e){return this.http.get(`${this.baseUrl}/${e}`)}createShipping(e){return this.http.post(this.baseUrl,e)}updateShipping(e,o){return this.http.put(`${this.baseUrl}/${e}`,o)}deleteShipping(e){return this.http.delete(`${this.baseUrl}/${e}`)}restoreShipping(e){return this.http.post(`${this.baseUrl}/${e}/restore`,{})}static{this.\u0275fac=function(o){return new(o||r)(W(G))}}static{this.\u0275prov=O({token:r,factory:r.\u0275fac,providedIn:"root"})}}return r})();function L0(r,d){r&1&&(i(0,"div",12),n(1," \u0646\u0627\u0645 \u0631\u0648\u0634 \u0627\u0631\u0633\u0627\u0644 \u0627\u0644\u0632\u0627\u0645\u06CC \u0627\u0633\u062A. "),t())}function D0(r,d){r&1&&(i(0,"div",12),n(1," \u0647\u0632\u06CC\u0646\u0647 \u0627\u0644\u0632\u0627\u0645\u06CC \u0648 \u0628\u0627\u06CC\u062F \u06CC\u06A9 \u0639\u062F\u062F \u0645\u062B\u0628\u062A \u0628\u0627\u0634\u062F. "),t())}function P0(r,d){r&1&&g(0,"span",27)}var vt=(()=>{class r{constructor(e,o,u,s,p){this.fb=e,this.route=o,this.router=u,this.adminShippingService=s,this.notificationService=p,this.isEditMode=!1,this.shippingId=null,this.isSubmitting=!1,this.shippingForm=this.fb.group({name:["",[I.required,I.maxLength(100)]],cost:[0,[I.required,I.min(0)]],description:["",I.maxLength(500)],estimatedDeliveryTime:["",I.maxLength(100)],isActive:[!0],rowVersion:[null]})}ngOnInit(){let e=this.route.snapshot.paramMap.get("id");e&&(this.shippingId=+e,this.isEditMode=!0,this.loadData())}loadData(){this.shippingId&&this.adminShippingService.getShippingById(this.shippingId).subscribe({next:e=>{this.shippingForm.patchValue(e)},error:e=>{this.notificationService.show(e?.error?.message||"\u062E\u0637\u0627 \u062F\u0631 \u0628\u0627\u0631\u06AF\u0630\u0627\u0631\u06CC \u0627\u0637\u0644\u0627\u0639\u0627\u062A","error"),this.router.navigate(["/admin/shippings"])}})}onSubmit(){if(this.shippingForm.invalid){this.shippingForm.markAllAsTouched();return}this.isSubmitting=!0;let e=this.shippingForm.getRawValue();(this.isEditMode&&this.shippingId?this.adminShippingService.updateShipping(this.shippingId,e):this.adminShippingService.createShipping(e)).pipe(L(()=>this.isSubmitting=!1)).subscribe({next:()=>{this.notificationService.show(`\u0631\u0648\u0634 \u0627\u0631\u0633\u0627\u0644 \u0628\u0627 \u0645\u0648\u0641\u0642\u06CC\u062A ${this.isEditMode?"\u0648\u06CC\u0631\u0627\u06CC\u0634":"\u0627\u06CC\u062C\u0627\u062F"} \u0634\u062F`,"success"),this.router.navigate(["/admin/shippings"])},error:u=>{u.status===409?(this.notificationService.show("\u0627\u06CC\u0646 \u0631\u06A9\u0648\u0631\u062F \u062A\u0648\u0633\u0637 \u06A9\u0627\u0631\u0628\u0631 \u062F\u06CC\u06AF\u0631\u06CC \u062A\u063A\u06CC\u06CC\u0631 \u06A9\u0631\u062F\u0647 \u0627\u0633\u062A. \u0644\u0637\u0641\u0627 \u0635\u0641\u062D\u0647 \u0631\u0627 \u0631\u0641\u0631\u0634 \u06A9\u0646\u06CC\u062F.","error"),this.loadData()):this.notificationService.show(u?.error?.message||"\u062E\u0637\u0627 \u062F\u0631 \u062B\u0628\u062A \u062A\u063A\u06CC\u06CC\u0631\u0627\u062A","error")}})}static{this.\u0275fac=function(o){return new(o||r)(h(we),h(ue),h(he),h(ot),h(D))}}static{this.\u0275cmp=k({type:r,selectors:[["app-admin-shipping--form"]],decls:47,vars:7,consts:[[1,"max-w-2xl","mx-auto","animate-fade-in-up"],[1,"flex","items-center","justify-between","mb-6"],[1,"text-2xl","font-bold","text-heading-foreground","flex","items-center","gap-2"],[1,"material-icons","text-primary"],["routerLink","/admin/shippings",1,"btn","btn-outline","btn-sm","gap-2"],[1,"material-icons","text-sm"],[1,"card","p-6","space-y-6","shadow-md","border-border",3,"ngSubmit","formGroup"],[1,"grid","md:grid-cols-2","gap-6"],[1,"space-y-2","form-group"],["for","name",1,"form-label"],[1,"text-destructive"],["type","text","id","name","formControlName","name","placeholder","\u0645\u062B\u0627\u0644: \u067E\u0633\u062A \u067E\u06CC\u0634\u062A\u0627\u0632","maxlength","100",1,"input","w-full"],[1,"form-error"],["for","cost",1,"form-label"],["type","number","id","cost","formControlName","cost","placeholder","0",1,"input","w-full"],["for","estimatedDeliveryTime",1,"form-label"],["type","text","id","estimatedDeliveryTime","formControlName","estimatedDeliveryTime","placeholder","\u0645\u062B\u0627\u0644: \u06F2 \u062A\u0627 \u06F4 \u0631\u0648\u0632 \u06A9\u0627\u0631\u06CC","maxlength","100",1,"input","w-full"],["for","description",1,"form-label"],["id","description","formControlName","description","placeholder","\u062A\u0648\u0636\u06CC\u062D\u0627\u062A \u062A\u06A9\u0645\u06CC\u0644\u06CC \u062F\u0631 \u0645\u0648\u0631\u062F \u0627\u06CC\u0646 \u0631\u0648\u0634 \u0627\u0631\u0633\u0627\u0644...","maxlength","500",1,"input","w-full","min-h-[100px]"],[1,"flex","items-center","gap-3","p-4","bg-muted/20","rounded-lg","border","border-border/50"],[1,"flex","items-center"],["type","checkbox","id","isActive","formControlName","isActive",1,"switch"],["for","isActive",1,"switch-thumb"],["for","isActive",1,"text-sm","font-medium","cursor-pointer","select-none","text-foreground"],[1,"flex","justify-end","gap-3","border-t","border-border","pt-6","mt-2"],["routerLink","/admin/shippings",1,"btn","btn-ghost","text-muted-foreground","hover:text-foreground"],["type","submit",1,"btn","btn-primary","min-w-[120px]","shadow-button",3,"disabled"],[1,"spinner","spinner-sm","mr-2","border-white"]],template:function(o,u){if(o&1&&(i(0,"div",0)(1,"div",1)(2,"h1",2)(3,"span",3),n(4,"local_shipping"),t(),n(5),t(),i(6,"a",4)(7,"span",5),n(8,"arrow_forward"),t(),n(9," \u0628\u0627\u0632\u06AF\u0634\u062A "),t()(),i(10,"form",6),C("ngSubmit",function(){return u.onSubmit()}),i(11,"div",7)(12,"div",8)(13,"label",9),n(14,"\u0646\u0627\u0645 \u0631\u0648\u0634 \u0627\u0631\u0633\u0627\u0644 "),i(15,"span",10),n(16,"*"),t()(),g(17,"input",11),m(18,L0,2,0,"div",12),t(),i(19,"div",8)(20,"label",13),n(21,"\u0647\u0632\u06CC\u0646\u0647 (\u062A\u0648\u0645\u0627\u0646) "),i(22,"span",10),n(23,"*"),t()(),g(24,"input",14),m(25,D0,2,0,"div",12),t()(),i(26,"div",8)(27,"label",15),n(28,"\u0632\u0645\u0627\u0646 \u062A\u062E\u0645\u06CC\u0646\u06CC \u062A\u062D\u0648\u06CC\u0644"),t(),g(29,"input",16),t(),i(30,"div",8)(31,"label",17),n(32,"\u062A\u0648\u0636\u06CC\u062D\u0627\u062A (\u0627\u062E\u062A\u06CC\u0627\u0631\u06CC)"),t(),g(33,"textarea",18),t(),i(34,"div",19)(35,"div",20),g(36,"input",21)(37,"label",22),t(),i(38,"label",23),n(39," \u0641\u0639\u0627\u0644 \u0633\u0627\u0632\u06CC \u0631\u0648\u0634 \u0627\u0631\u0633\u0627\u0644 "),t()(),i(40,"div",24)(41,"a",25),n(42,"\u0627\u0646\u0635\u0631\u0627\u0641"),t(),i(43,"button",26),m(44,P0,1,0,"span",27),i(45,"span"),n(46),t()()()()()),o&2){let s,p;a(5),x(" ",u.isEditMode?"\u0648\u06CC\u0631\u0627\u06CC\u0634":"\u0627\u06CC\u062C\u0627\u062F"," \u0631\u0648\u0634 \u0627\u0631\u0633\u0627\u0644 "),a(5),f("formGroup",u.shippingForm),a(8),c((s=u.shippingForm.get("name"))!=null&&s.invalid&&((s=u.shippingForm.get("name"))!=null&&s.touched)?18:-1),a(7),c((p=u.shippingForm.get("cost"))!=null&&p.invalid&&((p=u.shippingForm.get("cost"))!=null&&p.touched)?25:-1),a(18),f("disabled",u.shippingForm.invalid||u.isSubmitting),a(),c(u.isSubmitting?44:-1),a(2),v(u.isSubmitting?"\u062F\u0631 \u062D\u0627\u0644 \u0630\u062E\u06CC\u0631\u0647...":"\u0630\u062E\u06CC\u0631\u0647")}},dependencies:[me,se,Z,ee,_e,$,ae,jt,le,de,j,N],encapsulation:2})}}return r})();var M0=r=>["/admin/shippings/edit",r];function V0(r,d){r&1&&(i(0,"div",11),g(1,"span",14),t())}function U0(r,d){r&1&&(i(0,"div",12)(1,"span",15),n(2,"local_shipping"),t(),i(3,"p"),n(4,"\u0647\u06CC\u0686 \u0631\u0648\u0634 \u0627\u0631\u0633\u0627\u0644\u06CC \u06CC\u0627\u0641\u062A \u0646\u0634\u062F."),t()())}function N0(r,d){if(r&1){let e=S();i(0,"button",38),C("click",function(){b(e);let u=l().$implicit,s=l(2);return _(s.deleteShipping(u.id))}),i(1,"span",35),n(2,"delete"),t()()}}function j0(r,d){if(r&1){let e=S();i(0,"button",39),C("click",function(){b(e);let u=l().$implicit,s=l(2);return _(s.restoreShipping(u.id))}),i(1,"span",35),n(2,"restore_from_trash"),t()()}}function $0(r,d){if(r&1&&(i(0,"tr",23)(1,"td",24)(2,"div",25)(3,"span"),n(4),t(),i(5,"span",26),n(6),t()()(),i(7,"td",27),n(8),F(9,"number"),i(10,"span",28),n(11,"\u062A\u0648\u0645\u0627\u0646"),t()(),i(12,"td",29)(13,"span",30),g(14,"span",31),n(15),t()(),i(16,"td",32)(17,"div",33)(18,"a",34)(19,"span",35),n(20,"edit"),t()(),m(21,N0,3,0,"button",36),m(22,j0,3,0,"button",37),t()()()),r&2){let e=d.$implicit;B("opacity-50",e.isDeleted),a(4),v(e.name),a(2),v(e.estimatedDeliveryTime),a(2),x(" ",U(9,11,e.cost)," "),a(5),f("ngClass",e.isDeleted?"bg-destructive/10 text-destructive":e.isActive?"bg-success/10 text-success":"bg-muted text-muted-foreground"),a(),f("ngClass",e.isDeleted?"bg-destructive":e.isActive?"bg-success":"bg-muted-foreground"),a(),x(" ",e.isDeleted?"\u062D\u0630\u0641 \u0634\u062F\u0647":e.isActive?"\u0641\u0639\u0627\u0644":"\u063A\u06CC\u0631\u0641\u0639\u0627\u0644"," "),a(3),f("routerLink",J(13,M0,e.id)),a(3),c(e.isDeleted?-1:21),a(),c(e.isDeleted?22:-1)}}function B0(r,d){if(r&1&&(i(0,"div",13)(1,"table",16)(2,"thead",17)(3,"tr")(4,"th",18),n(5,"\u0646\u0627\u0645"),t(),i(6,"th",18),n(7,"\u0647\u0632\u06CC\u0646\u0647"),t(),i(8,"th",19),n(9,"\u0648\u0636\u0639\u06CC\u062A"),t(),i(10,"th",20),n(11,"\u0639\u0645\u0644\u06CC\u0627\u062A"),t()()(),i(12,"tbody",21),A(13,$0,23,15,"tr",22,T),t()()()),r&2){let e=l();a(13),E(e.shippings)}}var Ci=(()=>{class r{constructor(e,o){this.adminShippingService=e,this.notificationService=o,this.shippings=[],this.isLoading=!0,this.includeDeleted=!1}ngOnInit(){this.loadShippings()}loadShippings(){this.isLoading=!0,this.adminShippingService.getShippings(this.includeDeleted).pipe(L(()=>this.isLoading=!1)).subscribe({next:e=>{this.shippings=e},error:e=>{this.notificationService.show(e?.error?.message||"\u062E\u0637\u0627 \u062F\u0631 \u0628\u0627\u0631\u06AF\u0630\u0627\u0631\u06CC \u0631\u0648\u0634\u200C\u0647\u0627\u06CC \u0627\u0631\u0633\u0627\u0644","error")}})}deleteShipping(e){confirm("\u0622\u06CC\u0627 \u0627\u0632 \u062D\u0630\u0641 \u0627\u06CC\u0646 \u0631\u0648\u0634 \u0627\u0631\u0633\u0627\u0644 \u0627\u0637\u0645\u06CC\u0646\u0627\u0646 \u062F\u0627\u0631\u06CC\u062F\u061F")&&this.adminShippingService.deleteShipping(e).subscribe({next:()=>{this.notificationService.show("\u0631\u0648\u0634 \u0627\u0631\u0633\u0627\u0644 \u0628\u0627 \u0645\u0648\u0641\u0642\u06CC\u062A \u062D\u0630\u0641 \u0634\u062F","success"),this.loadShippings()},error:o=>this.notificationService.show(o?.error?.message||"\u062E\u0637\u0627 \u062F\u0631 \u062D\u0630\u0641","error")})}restoreShipping(e){this.adminShippingService.restoreShipping(e).subscribe({next:()=>{this.notificationService.show("\u0631\u0648\u0634 \u0627\u0631\u0633\u0627\u0644 \u0628\u0627 \u0645\u0648\u0641\u0642\u06CC\u062A \u0628\u0627\u0632\u06CC\u0627\u0628\u06CC \u0634\u062F","success"),this.loadShippings()},error:o=>this.notificationService.show(o?.error?.message||"\u062E\u0637\u0627 \u062F\u0631 \u0628\u0627\u0632\u06CC\u0627\u0628\u06CC","error")})}static{this.\u0275fac=function(o){return new(o||r)(h(ot),h(D))}}static{this.\u0275cmp=k({type:r,selectors:[["app-admin-shipping-list"]],decls:19,vars:4,consts:[[1,"space-y-6","animate-fade-in"],[1,"flex","items-center","justify-between"],[1,"text-2xl","font-bold","text-heading-foreground","flex","items-center","gap-2"],[1,"material-icons","text-primary"],["routerLink","/admin/shippings/new",1,"btn","btn-primary","shadow-lg","shadow-primary/20","hover:shadow-primary/40","transition-all"],[1,"material-icons","text-sm","me-1"],[1,"card","overflow-hidden","border","border-border","shadow-sm"],[1,"flex","items-center","p-4","border-b","border-border","bg-muted/5"],[1,"inline-flex","items-center","cursor-pointer"],["type","checkbox","id","includeDeleted",1,"checkbox",3,"ngModelChange","ngModel"],[1,"ms-2","text-sm","font-medium","text-foreground"],[1,"flex","justify-center","items-center","p-12"],[1,"text-center","p-12","text-muted-foreground"],[1,"w-full","overflow-x-auto"],[1,"spinner","spinner-xl","text-primary"],[1,"material-icons","text-4xl","opacity-20","mb-2"],[1,"w-full","caption-bottom","text-base","min-w-[600px]","text-right"],[1,"bg-muted/50","border-b","border-border","text-muted-foreground"],[1,"h-12","px-6","align-middle","font-medium"],[1,"h-12","px-6","align-middle","font-medium","text-center"],[1,"h-12","px-6","align-middle","font-medium","w-40","text-left"],[1,"divide-y","divide-border/50","bg-card"],[1,"hover:bg-muted/30","transition-colors","group",3,"opacity-50"],[1,"hover:bg-muted/30","transition-colors","group"],[1,"p-6","align-middle","font-medium","text-foreground"],[1,"flex","flex-col"],[1,"text-xs","text-muted-foreground","mt-0.5"],[1,"p-6","align-middle","tabular-nums","font-medium"],[1,"text-xs","font-normal","text-muted-foreground"],[1,"p-6","align-middle","text-center"],[1,"px-2.5","py-1","text-xs","font-semibold","rounded-full","inline-flex","items-center","gap-1",3,"ngClass"],[1,"w-1.5","h-1.5","rounded-full",3,"ngClass"],[1,"p-6","align-middle"],[1,"flex","items-center","justify-end","gap-2","opacity-0","group-hover:opacity-100","transition-opacity"],[1,"btn","btn-ghost","btn-sm","btn-icon","text-primary","hover:text-primary-foreground","hover:bg-primary","rounded-full",3,"routerLink"],[1,"material-icons","text-lg"],[1,"btn","btn-ghost","btn-sm","btn-icon","text-muted-foreground","hover:text-destructive-foreground","hover:bg-destructive","rounded-full"],["title","\u0628\u0627\u0632\u06CC\u0627\u0628\u06CC",1,"btn","btn-ghost","btn-sm","btn-icon","text-success","hover:text-success-foreground","hover:bg-success","rounded-full"],[1,"btn","btn-ghost","btn-sm","btn-icon","text-muted-foreground","hover:text-destructive-foreground","hover:bg-destructive","rounded-full",3,"click"],["title","\u0628\u0627\u0632\u06CC\u0627\u0628\u06CC",1,"btn","btn-ghost","btn-sm","btn-icon","text-success","hover:text-success-foreground","hover:bg-success","rounded-full",3,"click"]],template:function(o,u){o&1&&(i(0,"div",0)(1,"div",1)(2,"h1",2)(3,"span",3),n(4,"local_shipping"),t(),n(5," \u0645\u062F\u06CC\u0631\u06CC\u062A \u0631\u0648\u0634\u200C\u0647\u0627\u06CC \u0627\u0631\u0633\u0627\u0644 "),t(),i(6,"a",4)(7,"span",5),n(8,"add"),t(),n(9," \u0627\u0641\u0632\u0648\u062F\u0646 \u0631\u0648\u0634 \u062C\u062F\u06CC\u062F "),t()(),i(10,"div",6)(11,"div",7)(12,"label",8)(13,"input",9),X("ngModelChange",function(p){return Y(u.includeDeleted,p)||(u.includeDeleted=p),p}),C("ngModelChange",function(){return u.loadShippings()}),t(),i(14,"span",10),n(15,"\u0646\u0645\u0627\u06CC\u0634 \u062D\u0630\u0641 \u0634\u062F\u0647\u200C\u0647\u0627"),t()()(),m(16,V0,2,0,"div",11),m(17,U0,5,0,"div",12),m(18,B0,15,0,"div",13),t()()),o&2&&(a(13),Q("ngModel",u.includeDeleted),a(3),c(u.isLoading?16:-1),a(),c(!u.isLoading&&u.shippings.length===0?17:-1),a(),c(!u.isLoading&&u.shippings.length>0?18:-1))},dependencies:[M,q,j,N,ge,_e,$,Ce,be],encapsulation:2})}}return r})();var vi=(()=>{class r{constructor(e){this.http=e,this.usersUrl=`${R.API_URL}admin/user`}getUsers(e=!1,o=1,u=20){let s=new z().set("includeDeleted",e.toString()).set("page",o.toString()).set("pageSize",u.toString());return this.http.get(this.usersUrl,{params:s})}GetUserByIdAsync(e){return this.http.get(`${this.usersUrl}/${e}`)}updateUser(e,o,u){return this.http.put(`${this.usersUrl}/${e}`,o)}changeUserStatus(e,o){return this.http.patch(`${this.usersUrl}/${e}/status`,{isActive:o})}deleteUser(e){return this.http.delete(`${this.usersUrl}/${e}`)}restoreUser(e){return this.http.post(`${this.usersUrl}/${e}/restore`,{})}static{this.\u0275fac=function(o){return new(o||r)(W(G))}}static{this.\u0275prov=O({token:r,factory:r.\u0275fac,providedIn:"root"})}}return r})();var O0=r=>["/admin/users",r,"wallet"],W0=r=>["/admin/users",r,"sessions"];function G0(r,d){r&1&&(i(0,"div",8),g(1,"span",12),t())}function z0(r,d){r&1&&(i(0,"div",9)(1,"span",13),n(2,"people_outline"),t(),i(3,"p"),n(4,"\u0647\u06CC\u0686 \u06A9\u0627\u0631\u0628\u0631\u06CC \u06CC\u0627\u0641\u062A \u0646\u0634\u062F."),t()())}function q0(r,d){if(r&1){let e=S();i(0,"button",35),C("click",function(){b(e);let u=l().$implicit,s=l(2);return _(s.changeUserStatus(u,!u.isActive))}),i(1,"span",36),n(2),t()()}if(r&2){let e=l().$implicit;B("text-success",!e.isActive)("text-warning",e.isActive),f("title",e.isActive?"\u063A\u06CC\u0631\u0641\u0639\u0627\u0644 \u06A9\u0631\u062F\u0646":"\u0641\u0639\u0627\u0644 \u06A9\u0631\u062F\u0646"),a(2),v(e.isActive?"block":"check_circle")}}function H0(r,d){if(r&1){let e=S();i(0,"button",37),C("click",function(){b(e);let u=l().$implicit,s=l(2);return _(s.deleteUser(u.id))}),i(1,"span",36),n(2,"delete"),t()()}}function K0(r,d){if(r&1){let e=S();i(0,"button",38),C("click",function(){b(e);let u=l().$implicit,s=l(2);return _(s.restoreUser(u.id))}),i(1,"span",36),n(2,"restore_from_trash"),t()()}}function J0(r,d){if(r&1&&(i(0,"a",39)(1,"span",36),n(2,"account_balance_wallet"),t()(),i(3,"a",40)(4,"span",36),n(5,"devices"),t()()),r&2){let e=l().$implicit;f("routerLink",J(2,O0,e.id)),a(3),f("routerLink",J(4,W0,e.id))}}function Q0(r,d){if(r&1&&(i(0,"tr",21)(1,"td",22)(2,"div",23)(3,"div",24),n(4),t(),i(5,"span"),n(6),t()()(),i(7,"td",25),n(8),t(),i(9,"td",26)(10,"span",27),g(11,"span",28),n(12),t()(),i(13,"td",29),n(14),F(15,"date"),t(),i(16,"td",30)(17,"div",31),m(18,q0,3,6,"button",32),m(19,H0,3,0,"button",33),m(20,K0,3,0,"button",34),m(21,J0,6,6),t()()()),r&2){let e=d.$implicit;B("opacity-50",e.isDeleted),a(4),x(" ",(e.firstName||e.phoneNumber).charAt(0)," "),a(2),ce("",e.firstName||""," ",e.lastName||""),a(2),x(" ",e.phoneNumber," "),a(2),f("ngClass",e.isActive&&!e.isDeleted?"bg-success/10 text-success":"bg-destructive/10 text-destructive"),a(),f("ngClass",e.isActive&&!e.isDeleted?"bg-success":"bg-destructive"),a(),x(" ",e.isDeleted?"\u062D\u0630\u0641 \u0634\u062F\u0647":e.isActive?"\u0641\u0639\u0627\u0644":"\u063A\u06CC\u0631\u0641\u0639\u0627\u0644"," "),a(2),x(" ",oe(15,14,e.createdAt,"yyyy/MM/dd")," "),a(4),c(e.isDeleted?-1:18),a(),c(e.isDeleted?-1:19),a(),c(e.isDeleted?20:-1),a(),c(e.isDeleted?-1:21)}}function Y0(r,d){if(r&1&&(i(0,"div",10)(1,"table",14)(2,"thead",15)(3,"tr")(4,"th",16),n(5,"\u0646\u0627\u0645 \u0648 \u0646\u0627\u0645 \u062E\u0627\u0646\u0648\u0627\u062F\u06AF\u06CC"),t(),i(6,"th",16),n(7,"\u0634\u0645\u0627\u0631\u0647 \u0645\u0648\u0628\u0627\u06CC\u0644"),t(),i(8,"th",17),n(9,"\u0648\u0636\u0639\u06CC\u062A"),t(),i(10,"th",16),n(11,"\u062A\u0627\u0631\u06CC\u062E \u0639\u0636\u0648\u06CC\u062A"),t(),i(12,"th",18),n(13,"\u0639\u0645\u0644\u06CC\u0627\u062A"),t()()(),i(14,"tbody",19),A(15,Q0,22,17,"tr",20,T),t()()()),r&2){let e=l();a(15),E(e.users)}}function X0(r,d){if(r&1){let e=S();i(0,"div",11)(1,"nav",41)(2,"button",42),C("click",function(){b(e);let u=l();return _(u.loadUsers(u.currentPage-1))}),n(3," \u0642\u0628\u0644\u06CC "),t(),i(4,"span",43),n(5),t(),i(6,"button",42),C("click",function(){b(e);let u=l();return _(u.loadUsers(u.currentPage+1))}),n(7," \u0628\u0639\u062F\u06CC "),t()()()}if(r&2){let e=l();a(2),f("disabled",e.currentPage===1),a(3),ce(" ",e.currentPage," / ",e.pagination.totalPages," "),a(),f("disabled",e.currentPage===e.pagination.totalPages)}}var bi=(()=>{class r{constructor(e,o){this.adminUserService=e,this.notificationService=o,this.users=[],this.isLoading=!0,this.showDeleted=!1,this.pagination=null,this.currentPage=1}ngOnInit(){this.loadUsers()}loadUsers(e=1){this.isLoading=!0,this.currentPage=e,this.adminUserService.getUsers(this.showDeleted,e,20).pipe(L(()=>this.isLoading=!1)).subscribe({next:o=>{this.users=o.items??[],this.pagination=o},error:o=>{this.notificationService.show(o?.error?.message||"\u062E\u0637\u0627 \u062F\u0631 \u0628\u0627\u0631\u06AF\u0630\u0627\u0631\u06CC \u06A9\u0627\u0631\u0628\u0631\u0627\u0646","error")}})}toggleShowDeleted(){this.showDeleted=!this.showDeleted,this.loadUsers(1)}changeUserStatus(e,o){this.adminUserService.changeUserStatus(e.id,o).subscribe({next:()=>{e.isActive=o,this.notificationService.show("\u0648\u0636\u0639\u06CC\u062A \u06A9\u0627\u0631\u0628\u0631 \u0628\u0627 \u0645\u0648\u0641\u0642\u06CC\u062A \u062A\u063A\u06CC\u06CC\u0631 \u06A9\u0631\u062F","success")},error:()=>this.notificationService.show("\u062E\u0637\u0627 \u062F\u0631 \u062A\u063A\u06CC\u06CC\u0631 \u0648\u0636\u0639\u06CC\u062A \u06A9\u0627\u0631\u0628\u0631","error")})}deleteUser(e){confirm("\u0622\u06CC\u0627 \u0627\u0632 \u062D\u0630\u0641 \u0627\u06CC\u0646 \u06A9\u0627\u0631\u0628\u0631 \u0627\u0637\u0645\u06CC\u0646\u0627\u0646 \u062F\u0627\u0631\u06CC\u062F\u061F \u0627\u06CC\u0646 \u0639\u0645\u0644 \u063A\u06CC\u0631\u0642\u0627\u0628\u0644 \u0628\u0627\u0632\u06AF\u0634\u062A \u0627\u0633\u062A.")&&this.adminUserService.deleteUser(e).subscribe({next:()=>{this.notificationService.show("\u06A9\u0627\u0631\u0628\u0631 \u0628\u0627 \u0645\u0648\u0641\u0642\u06CC\u062A \u062D\u0630\u0641 \u0634\u062F","success"),this.loadUsers(this.currentPage)},error:o=>this.notificationService.show(o?.error?.message||"\u062E\u0637\u0627 \u062F\u0631 \u062D\u0630\u0641 \u06A9\u0627\u0631\u0628\u0631","error")})}restoreUser(e){this.adminUserService.restoreUser(e).subscribe({next:()=>{this.notificationService.show("\u06A9\u0627\u0631\u0628\u0631 \u0628\u0627 \u0645\u0648\u0641\u0642\u06CC\u062A \u0628\u0627\u0632\u06CC\u0627\u0628\u06CC \u0634\u062F","success"),this.loadUsers(this.currentPage)},error:o=>this.notificationService.show(o?.error?.message||"\u062E\u0637\u0627 \u062F\u0631 \u0628\u0627\u0632\u06CC\u0627\u0628\u06CC \u06A9\u0627\u0631\u0628\u0631","error")})}static{this.\u0275fac=function(o){return new(o||r)(h(vi),h(D))}}static{this.\u0275cmp=k({type:r,selectors:[["app-admin-user-list"]],decls:15,vars:5,consts:[[1,"space-y-6","animate-fade-in"],[1,"flex","items-center","justify-between"],[1,"text-2xl","font-bold","text-heading-foreground","flex","items-center","gap-2"],[1,"material-icons","text-primary"],[1,"flex","items-center","gap-2","bg-card","p-2","rounded-lg","border","border-border","shadow-sm"],["for","showDeleted",1,"text-sm","font-medium","text-foreground","cursor-pointer"],["type","checkbox","id","showDeleted",1,"checkbox",3,"change","checked"],[1,"card","overflow-hidden","border","border-border","shadow-sm"],[1,"flex","justify-center","items-center","p-12"],[1,"text-center","p-12","text-muted-foreground"],[1,"w-full","overflow-x-auto"],[1,"flex","justify-center","p-4","border-t","border-border","bg-muted/5"],[1,"spinner","spinner-xl","text-primary"],[1,"material-icons","text-5xl","opacity-20","mb-2"],[1,"w-full","text-right","text-sm"],[1,"bg-muted/50","border-b","border-border","text-muted-foreground"],[1,"h-12","px-6","align-middle","font-medium"],[1,"h-12","px-6","align-middle","font-medium","text-center"],[1,"h-12","px-6","align-middle","font-medium","w-40","text-left"],[1,"divide-y","divide-border/50","bg-card"],[1,"hover:bg-muted/30","transition-colors","group",3,"opacity-50"],[1,"hover:bg-muted/30","transition-colors","group"],[1,"p-6","align-middle","font-medium","text-foreground"],[1,"flex","items-center","gap-3"],[1,"w-8","h-8","rounded-full","bg-primary/10","flex","items-center","justify-center","text-primary","text-xs","font-bold"],[1,"p-6","align-middle","text-muted-foreground","font-mono","dir-ltr","text-right"],[1,"p-6","align-middle","text-center"],[1,"px-2.5","py-1","text-xs","font-semibold","rounded-full","inline-flex","items-center","gap-1",3,"ngClass"],[1,"w-1.5","h-1.5","rounded-full",3,"ngClass"],[1,"p-6","align-middle","text-muted-foreground","font-mono","dir-ltr","text-right","text-xs"],[1,"p-6","align-middle"],[1,"flex","items-center","justify-end","gap-2","opacity-0","group-hover:opacity-100","transition-opacity"],[1,"btn","btn-ghost","btn-sm","btn-icon","rounded-full",3,"text-success","text-warning","title"],["title","\u062D\u0630\u0641",1,"btn","btn-ghost","btn-sm","btn-icon","text-muted-foreground","hover:text-destructive-foreground","hover:bg-destructive","rounded-full"],["title","\u0628\u0627\u0632\u06CC\u0627\u0628\u06CC",1,"btn","btn-ghost","btn-sm","btn-icon","text-success","hover:text-success-foreground","hover:bg-success","rounded-full"],[1,"btn","btn-ghost","btn-sm","btn-icon","rounded-full",3,"click","title"],[1,"material-icons","text-lg"],["title","\u062D\u0630\u0641",1,"btn","btn-ghost","btn-sm","btn-icon","text-muted-foreground","hover:text-destructive-foreground","hover:bg-destructive","rounded-full",3,"click"],["title","\u0628\u0627\u0632\u06CC\u0627\u0628\u06CC",1,"btn","btn-ghost","btn-sm","btn-icon","text-success","hover:text-success-foreground","hover:bg-success","rounded-full",3,"click"],["title","\u06A9\u06CC\u0641 \u067E\u0648\u0644",1,"btn","btn-ghost","btn-sm","btn-icon","text-muted-foreground","hover:text-primary","rounded-full",3,"routerLink"],["title","\u0646\u0634\u0633\u062A\u200C\u0647\u0627\u06CC \u0641\u0639\u0627\u0644",1,"btn","btn-ghost","btn-sm","btn-icon","text-muted-foreground","hover:text-primary","rounded-full",3,"routerLink"],[1,"flex","items-center","gap-2"],[1,"btn","btn-outline","btn-sm",3,"click","disabled"],[1,"text-sm","text-muted-foreground","font-mono","bg-background","px-3","py-1","rounded-md","border","border-border"]],template:function(o,u){o&1&&(i(0,"div",0)(1,"div",1)(2,"h1",2)(3,"span",3),n(4,"group"),t(),n(5," \u0645\u062F\u06CC\u0631\u06CC\u062A \u06A9\u0627\u0631\u0628\u0631\u0627\u0646 "),t(),i(6,"div",4)(7,"label",5),n(8,"\u0646\u0645\u0627\u06CC\u0634 \u062D\u0630\u0641 \u0634\u062F\u0647\u200C\u0647\u0627"),t(),i(9,"input",6),C("change",function(){return u.toggleShowDeleted()}),t()()(),i(10,"div",7),m(11,G0,2,0,"div",8),m(12,z0,5,0,"div",9),m(13,Y0,17,0,"div",10),m(14,X0,8,4,"div",11),t()()),o&2&&(a(9),f("checked",u.showDeleted),a(2),c(u.isLoading?11:-1),a(),c(!u.isLoading&&u.users.length===0?12:-1),a(),c(!u.isLoading&&u.users.length>0?13:-1),a(),c(u.pagination&&u.pagination.totalPages>1?14:-1))},dependencies:[M,q,j,N,fe],encapsulation:2})}}return r})();var _i=(()=>{class r{constructor(e){this.http=e,this.apiUrl=`${R.API_URL}admin/tickets`}getTickets(e){let o=new z;return e.status&&(o=o.set("status",e.status)),e.priority&&(o=o.set("priority",e.priority)),e.userId!=null&&(o=o.set("userId",e.userId.toString())),o=o.set("page",(e.page??1).toString()),o=o.set("pageSize",(e.pageSize??20).toString()),this.http.get(this.apiUrl,{params:o})}getTicketDetails(e){return this.http.get(`${this.apiUrl}/${e}`)}replyToTicket(e,o){return this.http.post(`${this.apiUrl}/${e}/reply`,o)}closeTicket(e){return this.http.patch(`${this.apiUrl}/${e}/close`,{})}static{this.\u0275fac=function(o){return new(o||r)(W(G))}}static{this.\u0275prov=O({token:r,factory:r.\u0275fac,providedIn:"root"})}}return r})();function eo(r,d){r&1&&(i(0,"tr")(1,"td",34),g(2,"span",35),t()())}function to(r,d){if(r&1){let e=S();i(0,"tr",31)(1,"td",36),n(2),t(),i(3,"td",37),n(4),t(),i(5,"td",38)(6,"span",39),n(7),t()(),i(8,"td",38)(9,"span",39),n(10),t()(),i(11,"td",40),n(12),F(13,"date"),t(),i(14,"td",38)(15,"button",41),C("click",function(){let u=b(e).$implicit,s=l();return _(s.openDetail(u.id))}),i(16,"span",6),n(17,"open_in_new"),t(),n(18," \u0645\u0634\u0627\u0647\u062F\u0647 "),t()()()}if(r&2){let e=d.$implicit,o=l();a(2),v(e.id),a(),f("title",e.subject),a(),x(" ",e.subject," "),a(2),f("ngClass",o.statusClass(e.status)),a(),x(" ",o.statusLabel(e.status)," "),a(2),f("ngClass",o.priorityClass(e.priority)),a(),x(" ",o.priorityLabel(e.priority)," "),a(2),x(" ",oe(13,8,e.createdAt,"yyyy/MM/dd HH:mm")," ")}}function io(r,d){r&1&&(i(0,"tr")(1,"td",42)(2,"div",43)(3,"span",44),n(4,"inbox"),t(),i(5,"p"),n(6,"\u0647\u06CC\u0686 \u062A\u06CC\u06A9\u062A\u06CC \u06CC\u0627\u0641\u062A \u0646\u0634\u062F"),t()()()())}function no(r,d){if(r&1){let e=S();i(0,"div",32)(1,"button",45),C("click",function(){b(e);let u=l();return _(u.changePage(u.tickets.page-1))}),n(2,"\u0642\u0628\u0644\u06CC"),t(),i(3,"span",46),n(4),t(),i(5,"button",45),C("click",function(){b(e);let u=l();return _(u.changePage(u.tickets.page+1))}),n(6,"\u0628\u0639\u062F\u06CC"),t()()}if(r&2){let e=l();a(),f("disabled",e.tickets.page===1),a(3),ce("\u0635\u0641\u062D\u0647 ",e.tickets.page," \u0627\u0632 ",e.tickets.totalPages),a(),f("disabled",e.tickets.page===e.tickets.totalPages)}}function ro(r,d){if(r&1&&(i(0,"div",60)(1,"div",61),n(2),t(),i(3,"div",62)(4,"div",63),n(5),t(),i(6,"p",64),n(7),F(8,"date"),t()()()),r&2){let e=d.$implicit;B("flex-row-reverse",e.isAdminResponse),a(),B("bg-primary",e.isAdminResponse)("text-primary-foreground",e.isAdminResponse)("bg-muted",!e.isAdminResponse)("text-muted-foreground",!e.isAdminResponse),a(),x(" ",e.isAdminResponse?"A":"U"," "),a(2),B("bg-primary",e.isAdminResponse)("text-primary-foreground",e.isAdminResponse)("bg-muted",!e.isAdminResponse)("text-foreground",!e.isAdminResponse),a(),x(" ",e.message," "),a(),B("text-right",e.isAdminResponse)("text-left",!e.isAdminResponse),a(),x(" ",oe(8,25,e.createdAt,"yyyy/MM/dd HH:mm")," ")}}function oo(r,d){r&1&&g(0,"span",58)}function uo(r,d){r&1&&g(0,"span",58)}function ao(r,d){if(r&1){let e=S();i(0,"button",65),C("click",function(){b(e);let u=l(2);return _(u.closeTicket())}),m(1,uo,1,0,"span",58),n(2," \u0628\u0633\u062A\u0646 \u062A\u06CC\u06A9\u062A "),t()}if(r&2){let e=l(2);f("disabled",e.isClosing),a(),c(e.isClosing?1:-1)}}function so(r,d){if(r&1){let e=S();i(0,"div",33)(1,"div",47)(2,"div",48)(3,"div")(4,"h2",49),n(5),t(),i(6,"div",50)(7,"span",39),n(8),t(),i(9,"span",39),n(10),t()()(),i(11,"button",51),C("click",function(){b(e);let u=l();return _(u.closeDetail())}),i(12,"span",6),n(13,"close"),t()()(),i(14,"div",52),A(15,ro,9,28,"div",53,T),t(),i(17,"div",54)(18,"textarea",55),X("ngModelChange",function(u){b(e);let s=l();return Y(s.replyText,u)||(s.replyText=u),_(u)}),t(),i(19,"div",56)(20,"button",57),C("click",function(){b(e);let u=l();return _(u.sendReply())}),m(21,oo,1,0,"span",58),n(22," \u0627\u0631\u0633\u0627\u0644 \u067E\u0627\u0633\u062E "),t(),m(23,ao,3,2,"button",59),t()()()()}if(r&2){let e=l();a(5),v(e.selectedTicket.subject),a(2),f("ngClass",e.statusClass(e.selectedTicket.status)),a(),x(" ",e.statusLabel(e.selectedTicket.status)," "),a(),f("ngClass",e.priorityClass(e.selectedTicket.priority)),a(),x(" ",e.priorityLabel(e.selectedTicket.priority)," "),a(5),E(e.selectedTicket.messages),a(3),Q("ngModel",e.replyText),a(2),f("disabled",!e.replyText.trim()||e.isReplying),a(),c(e.isReplying?21:-1),a(2),c(e.selectedTicket.status!=="Closed"?23:-1)}}var Si=(()=>{class r{constructor(e,o){this.supportService=e,this.notificationService=o,this.tickets=null,this.selectedTicket=null,this.isLoading=!1,this.isReplying=!1,this.isClosing=!1,this.replyText="",this.filters={page:1,pageSize:20,status:null,priority:null,userId:null}}ngOnInit(){this.loadTickets()}loadTickets(){this.isLoading=!0,this.supportService.getTickets(this.filters).pipe(L(()=>this.isLoading=!1)).subscribe({next:e=>this.tickets=e,error:()=>this.notificationService.show("\u062E\u0637\u0627 \u062F\u0631 \u0628\u0627\u0631\u06AF\u0630\u0627\u0631\u06CC \u062A\u06CC\u06A9\u062A\u200C\u0647\u0627","error")})}applyFilters(){this.filters.page=1,this.loadTickets()}changePage(e){this.filters.page=e,this.loadTickets()}openDetail(e){this.supportService.getTicketDetails(e).subscribe({next:o=>{this.selectedTicket=o,this.replyText=""},error:()=>this.notificationService.show("\u062E\u0637\u0627 \u062F\u0631 \u0628\u0627\u0631\u06AF\u0630\u0627\u0631\u06CC \u062C\u0632\u0626\u06CC\u0627\u062A \u062A\u06CC\u06A9\u062A","error")})}closeDetail(){this.selectedTicket=null,this.replyText=""}sendReply(){!this.selectedTicket||!this.replyText.trim()||(this.isReplying=!0,this.supportService.replyToTicket(this.selectedTicket.id,{message:this.replyText}).pipe(L(()=>this.isReplying=!1)).subscribe({next:()=>{this.notificationService.show("\u067E\u0627\u0633\u062E \u0627\u0631\u0633\u0627\u0644 \u0634\u062F","success"),this.openDetail(this.selectedTicket.id)},error:()=>this.notificationService.show("\u062E\u0637\u0627 \u062F\u0631 \u0627\u0631\u0633\u0627\u0644 \u067E\u0627\u0633\u062E","error")}))}closeTicket(){this.selectedTicket&&(this.isClosing=!0,this.supportService.closeTicket(this.selectedTicket.id).pipe(L(()=>this.isClosing=!1)).subscribe({next:()=>{this.notificationService.show("\u062A\u06CC\u06A9\u062A \u0628\u0633\u062A\u0647 \u0634\u062F","success"),this.closeDetail(),this.loadTickets()},error:()=>this.notificationService.show("\u062E\u0637\u0627 \u062F\u0631 \u0628\u0633\u062A\u0646 \u062A\u06CC\u06A9\u062A","error")}))}statusLabel(e){return{Open:"\u0628\u0627\u0632",InProgress:"\u062F\u0631 \u062D\u0627\u0644 \u0628\u0631\u0631\u0633\u06CC",Closed:"\u0628\u0633\u062A\u0647"}[e]??e}statusClass(e){return{Open:"bg-success/10 text-success border-success/20",InProgress:"bg-warning/10 text-warning border-warning/20",Closed:"bg-muted text-muted-foreground"}[e]??"badge-outline"}priorityLabel(e){return{Low:"\u06A9\u0645",Normal:"\u0645\u0639\u0645\u0648\u0644\u06CC",High:"\u0632\u06CC\u0627\u062F",Critical:"\u0628\u062D\u0631\u0627\u0646\u06CC"}[e]??e}priorityClass(e){return{Low:"badge-outline",Normal:"bg-primary/10 text-primary border-primary/20",High:"bg-warning/10 text-warning border-warning/20",Critical:"bg-destructive/10 text-destructive border-destructive/20"}[e]??"badge-outline"}static{this.\u0275fac=function(o){return new(o||r)(h(_i),h(D))}}static{this.\u0275cmp=k({type:r,selectors:[["app-admin-ticket-list"]],decls:74,vars:9,consts:[[1,"space-y-6","animate-fade-in"],[1,"flex","items-center","justify-between"],[1,"text-2xl","font-bold","tracking-tight","text-heading-foreground","flex","items-center","gap-2"],[1,"material-icons","text-primary"],[1,"text-sm","text-muted-foreground","mt-1"],[1,"btn","btn-outline","btn-sm","gap-2",3,"click"],[1,"material-icons","text-sm"],[1,"card","p-4","border","border-border","shadow-sm","bg-muted/10"],[1,"grid","grid-cols-1","sm:grid-cols-4","gap-4"],[1,"space-y-1.5"],[1,"text-xs","font-medium","text-muted-foreground"],[1,"input","input-sm","w-full","bg-background",3,"ngModelChange","ngModel"],[3,"ngValue"],["value","Open"],["value","InProgress"],["value","Closed"],["value","Low"],["value","Normal"],["value","High"],["value","Critical"],["type","number","placeholder","User ID",1,"input","input-sm","w-full","bg-background",3,"ngModelChange","ngModel"],[1,"flex","items-end"],[1,"btn","btn-primary","btn-sm","w-full","shadow-sm",3,"click"],[1,"material-icons","text-sm","mr-1"],[1,"card","overflow-hidden","border","border-border","shadow-sm"],[1,"overflow-x-auto"],[1,"w-full","text-sm","text-right"],[1,"bg-muted/50","border-b","border-border","text-muted-foreground"],[1,"px-5","py-4","font-medium"],[1,"px-5","py-4","font-medium","text-center"],[1,"divide-y","divide-border/50","bg-card"],[1,"group","hover:bg-muted/30","transition-colors"],[1,"p-4","border-t","border-border","flex","items-center","justify-between","bg-muted/10"],[1,"fixed","inset-0","z-50","flex","items-center","justify-center","bg-black/50","backdrop-blur-sm","p-4"],["colspan","6",1,"p-8","text-center"],[1,"spinner","spinner-md","text-primary"],[1,"px-5","py-4","font-mono","text-muted-foreground"],[1,"px-5","py-4","font-medium","text-foreground","max-w-[250px]","truncate",3,"title"],[1,"px-5","py-4","text-center"],[1,"badge","badge-sm",3,"ngClass"],[1,"px-5","py-4","text-muted-foreground","text-xs","whitespace-nowrap"],[1,"btn","btn-outline","btn-xs","gap-1",3,"click"],["colspan","6",1,"p-12","text-center","text-muted-foreground"],[1,"flex","flex-col","items-center","gap-3","opacity-50"],[1,"material-icons","text-4xl"],[1,"btn","btn-outline","btn-sm",3,"click","disabled"],[1,"text-xs","text-muted-foreground"],[1,"card","w-full","max-w-2xl","max-h-[80vh]","flex","flex-col","shadow-2xl","border","border-border","animate-fade-in-up"],[1,"p-5","border-b","border-border","flex","items-center","justify-between"],[1,"font-bold","text-foreground"],[1,"flex","items-center","gap-2","mt-1"],[1,"icon-wrapper","icon-wrapper-sm","hover:bg-muted",3,"click"],[1,"flex-1","overflow-y-auto","p-5","space-y-3"],[1,"flex","gap-3",3,"flex-row-reverse"],[1,"p-4","border-t","border-border","space-y-3"],["rows","3","placeholder","\u067E\u0627\u0633\u062E \u062E\u0648\u062F \u0631\u0627 \u0627\u06CC\u0646\u062C\u0627 \u0648\u0627\u0631\u062F \u06A9\u0646\u06CC\u062F...",1,"input","w-full","resize-none","text-sm",3,"ngModelChange","ngModel"],[1,"flex","items-center","gap-2"],[1,"btn","btn-primary","btn-sm","flex-1","shadow-sm",3,"click","disabled"],[1,"spinner","spinner-xs","me-1"],[1,"btn","btn-outline","btn-sm","text-destructive","border-destructive/30",3,"disabled"],[1,"flex","gap-3"],[1,"w-8","h-8","rounded-full","flex-shrink-0","flex","items-center","justify-center","text-xs","font-bold"],[1,"flex-1","max-w-[80%]"],[1,"rounded-xl","px-4","py-3","text-sm"],[1,"text-[10px]","text-muted-foreground","mt-1"],[1,"btn","btn-outline","btn-sm","text-destructive","border-destructive/30",3,"click","disabled"]],template:function(o,u){o&1&&(i(0,"div",0)(1,"div",1)(2,"div")(3,"h1",2)(4,"span",3),n(5,"support_agent"),t(),n(6," \u062A\u06CC\u06A9\u062A\u200C\u0647\u0627\u06CC \u067E\u0634\u062A\u06CC\u0628\u0627\u0646\u06CC "),t(),i(7,"p",4),n(8,"\u0645\u062F\u06CC\u0631\u06CC\u062A \u062F\u0631\u062E\u0648\u0627\u0633\u062A\u200C\u0647\u0627\u06CC \u067E\u0634\u062A\u06CC\u0628\u0627\u0646\u06CC \u06A9\u0627\u0631\u0628\u0631\u0627\u0646"),t()(),i(9,"button",5),C("click",function(){return u.loadTickets()}),i(10,"span",6),n(11,"refresh"),t(),n(12," \u0628\u0631\u0648\u0632\u0631\u0633\u0627\u0646\u06CC "),t()(),i(13,"div",7)(14,"div",8)(15,"div",9)(16,"label",10),n(17,"\u0648\u0636\u0639\u06CC\u062A"),t(),i(18,"select",11),X("ngModelChange",function(p){return Y(u.filters.status,p)||(u.filters.status=p),p}),i(19,"option",12),n(20,"\u0647\u0645\u0647"),t(),i(21,"option",13),n(22,"\u0628\u0627\u0632"),t(),i(23,"option",14),n(24,"\u062F\u0631 \u062D\u0627\u0644 \u0628\u0631\u0631\u0633\u06CC"),t(),i(25,"option",15),n(26,"\u0628\u0633\u062A\u0647"),t()()(),i(27,"div",9)(28,"label",10),n(29,"\u0627\u0648\u0644\u0648\u06CC\u062A"),t(),i(30,"select",11),X("ngModelChange",function(p){return Y(u.filters.priority,p)||(u.filters.priority=p),p}),i(31,"option",12),n(32,"\u0647\u0645\u0647"),t(),i(33,"option",16),n(34,"\u06A9\u0645"),t(),i(35,"option",17),n(36,"\u0645\u0639\u0645\u0648\u0644\u06CC"),t(),i(37,"option",18),n(38,"\u0632\u06CC\u0627\u062F"),t(),i(39,"option",19),n(40,"\u0628\u062D\u0631\u0627\u0646\u06CC"),t()()(),i(41,"div",9)(42,"label",10),n(43,"\u0634\u0646\u0627\u0633\u0647 \u06A9\u0627\u0631\u0628\u0631"),t(),i(44,"input",20),X("ngModelChange",function(p){return Y(u.filters.userId,p)||(u.filters.userId=p),p}),t()(),i(45,"div",21)(46,"button",22),C("click",function(){return u.applyFilters()}),i(47,"span",23),n(48,"filter_list"),t(),n(49," \u0627\u0639\u0645\u0627\u0644 \u0641\u06CC\u0644\u062A\u0631 "),t()()()(),i(50,"div",24)(51,"div",25)(52,"table",26)(53,"thead",27)(54,"tr")(55,"th",28),n(56,"#"),t(),i(57,"th",28),n(58,"\u0645\u0648\u0636\u0648\u0639"),t(),i(59,"th",29),n(60,"\u0648\u0636\u0639\u06CC\u062A"),t(),i(61,"th",29),n(62,"\u0627\u0648\u0644\u0648\u06CC\u062A"),t(),i(63,"th",28),n(64,"\u062A\u0627\u0631\u06CC\u062E \u062B\u0628\u062A"),t(),i(65,"th",29),n(66,"\u0639\u0645\u0644\u06CC\u0627\u062A"),t()()(),i(67,"tbody",30),m(68,eo,3,0,"tr"),A(69,to,19,11,"tr",31,T),m(71,io,7,0,"tr"),t()()(),m(72,no,7,4,"div",32),t(),m(73,so,24,9,"div",33),t()),o&2&&(a(18),Q("ngModel",u.filters.status),a(),f("ngValue",null),a(11),Q("ngModel",u.filters.priority),a(),f("ngValue",null),a(13),Q("ngModel",u.filters.userId),a(24),c(u.isLoading?68:-1),a(),E(u.tickets==null?null:u.tickets.items),a(2),c(!u.isLoading&&(!(u.tickets!=null&&u.tickets.items)||(u.tickets==null||u.tickets.items==null?null:u.tickets.items.length)===0)?71:-1),a(),c(u.tickets&&u.tickets.totalPages>1?72:-1),a(),c(u.selectedTicket?73:-1))},dependencies:[M,q,ge,ie,ne,Z,ee,te,$,Ce,fe],encapsulation:2})}}return r})();var yi=(()=>{class r{constructor(e){this.http=e,this.apiUrl=`${R.API_URL}admin/payments`}getPayments(e={}){let o=new z;return e.userId&&(o=o.set("userId",e.userId.toString())),e.status&&(o=o.set("status",e.status)),e.fromDate&&(o=o.set("fromDate",e.fromDate)),e.toDate&&(o=o.set("toDate",e.toDate)),o=o.set("page",(e.page??1).toString()),o=o.set("pageSize",(e.pageSize??20).toString()),this.http.get(this.apiUrl,{params:o})}refundPayment(e,o){return this.http.post(`${this.apiUrl}/${e}/refund`,o)}expireStalePayments(e=30){let o=new z().set("minutesOld",e.toString());return this.http.post(`${this.apiUrl}/expire-stale`,{},{params:o})}static{this.\u0275fac=function(o){return new(o||r)(W(G))}}static{this.\u0275prov=O({token:r,factory:r.\u0275fac,providedIn:"root"})}}return r})();var mo=(r,d,e,o)=>({"bg-success/10 text-success":r,"bg-destructive/10 text-destructive":d,"bg-warning/10 text-warning":e,"bg-muted text-muted-foreground":o}),co=(r,d)=>d.id;function po(r,d){r&1&&(i(0,"div",16),g(1,"span",21),t())}function fo(r,d){r&1&&(i(0,"div",17)(1,"span",22),n(2,"receipt_long"),t(),i(3,"p"),n(4,"\u062A\u0631\u0627\u06A9\u0646\u0634\u06CC \u06CC\u0627\u0641\u062A \u0646\u0634\u062F."),t()())}function go(r,d){if(r&1){let e=S();i(0,"button",35),C("click",function(){b(e);let u=l().$implicit,s=l(2);return _(s.openRefundModal(u))}),i(1,"span",36),n(2,"undo"),t(),n(3," \u0627\u0633\u062A\u0631\u062F\u0627\u062F "),t()}}function xo(r,d){if(r&1&&(i(0,"tr",28)(1,"td",29),n(2),t(),i(3,"td",30),n(4),t(),i(5,"td",31),n(6),F(7,"number"),t(),i(8,"td",30)(9,"span",32),n(10),t()(),i(11,"td",33),n(12),F(13,"date"),t(),i(14,"td",30),m(15,go,4,0,"button",34),t()()),r&2){let e=d.$implicit,o=l(2);a(2),x("#",e.orderId),a(2),v(e.userName),a(2),x("",U(7,7,e.amount)," \u062A\u0648\u0645\u0627\u0646"),a(3),f("ngClass",It(12,mo,e.status==="Paid",e.status==="Failed",e.status==="Pending",e.status==="Refunded")),a(),x(" ",o.getStatusLabel(e.status)," "),a(2),x(" ",oe(13,9,e.createdAt,"yyyy/MM/dd HH:mm")," "),a(3),c(e.status==="Paid"?15:-1)}}function ho(r,d){if(r&1&&(i(0,"div",18)(1,"table",23)(2,"thead",24)(3,"tr")(4,"th",25),n(5,"\u0634\u0646\u0627\u0633\u0647 \u0633\u0641\u0627\u0631\u0634"),t(),i(6,"th",25),n(7,"\u06A9\u0627\u0631\u0628\u0631"),t(),i(8,"th",25),n(9,"\u0645\u0628\u0644\u063A"),t(),i(10,"th",25),n(11,"\u0648\u0636\u0639\u06CC\u062A"),t(),i(12,"th",25),n(13,"\u062A\u0627\u0631\u06CC\u062E"),t(),i(14,"th",26),n(15,"\u0639\u0645\u0644\u06CC\u0627\u062A"),t()()(),i(16,"tbody",27),A(17,xo,16,17,"tr",28,co),t()()()),r&2){let e=l();a(17),E(e.payments)}}function Co(r,d){if(r&1){let e=S();i(0,"div",19)(1,"nav",37)(2,"button",38),C("click",function(){b(e);let u=l();return _(u.loadPayments(u.currentPage-1))}),n(3,"\u0642\u0628\u0644\u06CC"),t(),i(4,"span",39),n(5),t(),i(6,"button",38),C("click",function(){b(e);let u=l();return _(u.loadPayments(u.currentPage+1))}),n(7,"\u0628\u0639\u062F\u06CC"),t()()()}if(r&2){let e=l();a(2),f("disabled",e.currentPage===1),a(3),ce(" ",e.currentPage," / ",e.pagination.totalPages," "),a(),f("disabled",e.currentPage===e.pagination.totalPages)}}function vo(r,d){r&1&&g(0,"span",55)}function bo(r,d){if(r&1){let e=S();i(0,"div",20)(1,"div",40)(2,"div",41)(3,"h2",42)(4,"span",43),n(5,"undo"),t(),n(6," \u0627\u0633\u062A\u0631\u062F\u0627\u062F \u0648\u062C\u0647 "),t(),i(7,"button",44),C("click",function(){b(e);let u=l();return _(u.closeRefundModal())}),i(8,"span",45),n(9,"close"),t()()(),i(10,"div",46)(11,"div",47)(12,"p"),n(13,"\u0633\u0641\u0627\u0631\u0634: "),i(14,"span",48),n(15),t()(),i(16,"p"),n(17,"\u0645\u0628\u0644\u063A: "),i(18,"span",48),n(19),F(20,"number"),t()()(),i(21,"div",6)(22,"label",7),n(23,"\u062F\u0644\u06CC\u0644 \u0627\u0633\u062A\u0631\u062F\u0627\u062F "),i(24,"span",49),n(25,"*"),t()(),i(26,"textarea",50),X("ngModelChange",function(u){b(e);let s=l();return Y(s.refundReason,u)||(s.refundReason=u),_(u)}),t()(),i(27,"div",6)(28,"label",7),n(29,"\u0645\u0628\u0644\u063A \u0627\u0633\u062A\u0631\u062F\u0627\u062F (\u0627\u062E\u062A\u06CC\u0627\u0631\u06CC - \u062E\u0627\u0644\u06CC = \u06A9\u0644 \u0645\u0628\u0644\u063A)"),t(),i(30,"input",51),X("ngModelChange",function(u){b(e);let s=l();return Y(s.partialAmount,u)||(s.partialAmount=u),_(u)}),t()()(),i(31,"div",52)(32,"button",53),C("click",function(){b(e);let u=l();return _(u.closeRefundModal())}),n(33,"\u0627\u0646\u0635\u0631\u0627\u0641"),t(),i(34,"button",54),C("click",function(){b(e);let u=l();return _(u.submitRefund())}),m(35,vo,1,0,"span",55),n(36),t()()()()}if(r&2){let e=l();a(15),x("#",e.selectedPayment.orderId),a(4),x("",U(20,7,e.selectedPayment.amount)," \u062A\u0648\u0645\u0627\u0646"),a(7),Q("ngModel",e.refundReason),a(4),Q("ngModel",e.partialAmount),a(4),f("disabled",!e.refundReason||e.isRefunding),a(),c(e.isRefunding?35:-1),a(),x(" ",e.isRefunding?"\u062F\u0631 \u062D\u0627\u0644 \u0627\u0633\u062A\u0631\u062F\u0627\u062F...":"\u062A\u0627\u06CC\u06CC\u062F \u0627\u0633\u062A\u0631\u062F\u0627\u062F"," ")}}var Ai=(()=>{class r{constructor(e,o){this.paymentService=e,this.notificationService=o,this.payments=[],this.isLoading=!0,this.pagination=null,this.currentPage=1,this.statusFilter="",this.fromDate="",this.toDate="",this.showRefundModal=!1,this.selectedPayment=null,this.refundReason="",this.partialAmount=null,this.isRefunding=!1}ngOnInit(){this.loadPayments()}loadPayments(e=1){this.isLoading=!0,this.currentPage=e,this.paymentService.getPayments({status:this.statusFilter||void 0,fromDate:this.fromDate||void 0,toDate:this.toDate||void 0,page:e,pageSize:20}).pipe(L(()=>this.isLoading=!1)).subscribe({next:o=>{this.payments=o.items??[],this.pagination=o},error:()=>this.notificationService.show("\u062E\u0637\u0627 \u062F\u0631 \u0628\u0627\u0631\u06AF\u0630\u0627\u0631\u06CC \u062A\u0631\u0627\u06A9\u0646\u0634\u200C\u0647\u0627","error")})}getStatusLabel(e){return{Paid:"\u067E\u0631\u062F\u0627\u062E\u062A \u0634\u062F\u0647",Pending:"\u062F\u0631 \u0627\u0646\u062A\u0638\u0627\u0631",Failed:"\u0646\u0627\u0645\u0648\u0641\u0642",Refunded:"\u0627\u0633\u062A\u0631\u062F\u0627\u062F \u0634\u062F\u0647"}[e]??e}openRefundModal(e){this.selectedPayment=e,this.refundReason="",this.partialAmount=null,this.showRefundModal=!0}closeRefundModal(){this.showRefundModal=!1,this.selectedPayment=null}submitRefund(){!this.selectedPayment||!this.refundReason||(this.isRefunding=!0,this.paymentService.refundPayment(this.selectedPayment.orderId,{reason:this.refundReason,partialAmount:this.partialAmount??void 0}).pipe(L(()=>this.isRefunding=!1)).subscribe({next:()=>{this.notificationService.show("\u0627\u0633\u062A\u0631\u062F\u0627\u062F \u0628\u0627 \u0645\u0648\u0641\u0642\u06CC\u062A \u0627\u0646\u062C\u0627\u0645 \u0634\u062F","success"),this.closeRefundModal(),this.loadPayments(this.currentPage)},error:e=>this.notificationService.show(e?.error?.message||"\u062E\u0637\u0627 \u062F\u0631 \u0627\u0633\u062A\u0631\u062F\u0627\u062F","error")}))}static{this.\u0275fac=function(o){return new(o||r)(h(yi),h(D))}}static{this.\u0275cmp=k({type:r,selectors:[["app-admin-payment-list"]],decls:36,vars:8,consts:[[1,"space-y-6","animate-fade-in"],[1,"flex","items-center","justify-between"],[1,"text-2xl","font-bold","text-heading-foreground","flex","items-center","gap-2"],[1,"material-icons","text-primary"],[1,"card","p-4","border","border-border","shadow-sm"],[1,"grid","grid-cols-1","sm:grid-cols-3","gap-4"],[1,"form-group"],[1,"form-label"],[1,"select","w-full",3,"ngModelChange","change","ngModel"],["value",""],["value","Pending"],["value","Paid"],["value","Failed"],["value","Refunded"],["type","date",1,"input","w-full",3,"ngModelChange","change","ngModel"],[1,"card","overflow-hidden","border","border-border","shadow-sm"],[1,"flex","justify-center","p-12"],[1,"p-16","text-center","text-muted-foreground","flex","flex-col","items-center","gap-3"],[1,"w-full","overflow-x-auto"],[1,"flex","justify-center","p-4","border-t","border-border","bg-muted/5"],[1,"fixed","inset-0","bg-black/50","z-50","flex","items-center","justify-center","p-4"],[1,"spinner","spinner-xl","text-primary"],[1,"material-icons","text-5xl","opacity-20"],[1,"w-full","text-right","text-sm"],[1,"bg-muted/50","border-b","border-border","text-muted-foreground"],[1,"h-12","px-4","align-middle","font-medium"],[1,"h-12","px-4","align-middle","font-medium","text-left"],[1,"divide-y","divide-border/50","bg-card"],[1,"hover:bg-muted/30","transition-colors"],[1,"p-4","align-middle","font-mono"],[1,"p-4","align-middle"],[1,"p-4","align-middle","font-bold"],[1,"px-2","py-1","text-xs","rounded-full","font-semibold",3,"ngClass"],[1,"p-4","align-middle","text-muted-foreground","text-xs","font-mono"],[1,"btn","btn-outline","btn-sm","text-destructive","border-destructive","hover:bg-destructive","hover:text-white"],[1,"btn","btn-outline","btn-sm","text-destructive","border-destructive","hover:bg-destructive","hover:text-white",3,"click"],[1,"material-icons","text-sm","me-1"],[1,"flex","items-center","gap-2"],[1,"btn","btn-outline","btn-sm",3,"click","disabled"],[1,"text-sm","text-muted-foreground","font-mono","bg-background","px-3","py-1","rounded-md","border","border-border"],[1,"bg-card","rounded-xl","shadow-xl","w-full","max-w-md","border","border-border","animate-fade-in-up"],[1,"flex","items-center","justify-between","p-6","border-b","border-border"],[1,"text-lg","font-bold","flex","items-center","gap-2"],[1,"material-icons","text-destructive"],[1,"btn","btn-ghost","btn-sm","btn-icon",3,"click"],[1,"material-icons"],[1,"p-6","space-y-4"],[1,"bg-muted/30","p-3","rounded-lg","text-sm"],[1,"font-bold"],[1,"text-destructive"],["rows","3","placeholder","\u062F\u0644\u06CC\u0644 \u0627\u0633\u062A\u0631\u062F\u0627\u062F \u0631\u0627 \u0648\u0627\u0631\u062F \u06A9\u0646\u06CC\u062F...",1,"input","w-full",3,"ngModelChange","ngModel"],["type","number","placeholder","\u0645\u0628\u0644\u063A \u062C\u0632\u0626\u06CC...",1,"input","w-full",3,"ngModelChange","ngModel"],[1,"flex","gap-3","p-6","border-t","border-border"],[1,"btn","btn-ghost","flex-1",3,"click"],[1,"btn","btn-destructive","flex-[2]",3,"click","disabled"],[1,"spinner","spinner-sm","mr-2","border-white"]],template:function(o,u){o&1&&(i(0,"div",0)(1,"div",1)(2,"h1",2)(3,"span",3),n(4,"payments"),t(),n(5," \u0645\u062F\u06CC\u0631\u06CC\u062A \u062A\u0631\u0627\u06A9\u0646\u0634\u200C\u0647\u0627\u06CC \u0645\u0627\u0644\u06CC "),t()(),i(6,"div",4)(7,"div",5)(8,"div",6)(9,"label",7),n(10,"\u0648\u0636\u0639\u06CC\u062A"),t(),i(11,"select",8),X("ngModelChange",function(p){return Y(u.statusFilter,p)||(u.statusFilter=p),p}),C("change",function(){return u.loadPayments()}),i(12,"option",9),n(13,"\u0647\u0645\u0647"),t(),i(14,"option",10),n(15,"\u062F\u0631 \u0627\u0646\u062A\u0638\u0627\u0631"),t(),i(16,"option",11),n(17,"\u067E\u0631\u062F\u0627\u062E\u062A \u0634\u062F\u0647"),t(),i(18,"option",12),n(19,"\u0646\u0627\u0645\u0648\u0641\u0642"),t(),i(20,"option",13),n(21,"\u0627\u0633\u062A\u0631\u062F\u0627\u062F \u0634\u062F\u0647"),t()()(),i(22,"div",6)(23,"label",7),n(24,"\u0627\u0632 \u062A\u0627\u0631\u06CC\u062E"),t(),i(25,"input",14),X("ngModelChange",function(p){return Y(u.fromDate,p)||(u.fromDate=p),p}),C("change",function(){return u.loadPayments()}),t()(),i(26,"div",6)(27,"label",7),n(28,"\u062A\u0627 \u062A\u0627\u0631\u06CC\u062E"),t(),i(29,"input",14),X("ngModelChange",function(p){return Y(u.toDate,p)||(u.toDate=p),p}),C("change",function(){return u.loadPayments()}),t()()()(),i(30,"div",15),m(31,po,2,0,"div",16),m(32,fo,5,0,"div",17),m(33,ho,19,0,"div",18),m(34,Co,8,4,"div",19),t()(),m(35,bo,37,9,"div",20)),o&2&&(a(11),Q("ngModel",u.statusFilter),a(14),Q("ngModel",u.fromDate),a(4),Q("ngModel",u.toDate),a(2),c(u.isLoading?31:-1),a(),c(!u.isLoading&&u.payments.length===0?32:-1),a(),c(!u.isLoading&&u.payments.length>0?33:-1),a(),c(u.pagination&&u.pagination.totalPages>1?34:-1),a(),c(u.showRefundModal&&u.selectedPayment?35:-1))},dependencies:[M,q,ge,ie,ne,Z,ee,te,$,Ce,be,fe],encapsulation:2})}}return r})();var ut=(()=>{class r{constructor(e){this.http=e,this.apiUrl=`${R.API_URL}admin/warehouses`}getWarehouses(){return this.http.get(this.apiUrl)}getWarehouseById(e){return this.http.get(`${this.apiUrl}/${e}`)}createWarehouse(e){return this.http.post(this.apiUrl,e)}updateWarehouse(e,o){return this.http.put(`${this.apiUrl}/${e}`,o)}deleteWarehouse(e){return this.http.delete(`${this.apiUrl}/${e}`)}setDefault(e){return this.http.patch(`${this.apiUrl}/${e}/set-default`,{})}toggleActive(e,o){return this.http.patch(`${this.apiUrl}/${e}/status`,{isActive:o})}static{this.\u0275fac=function(o){return new(o||r)(W(G))}}static{this.\u0275prov=O({token:r,factory:r.\u0275fac,providedIn:"root"})}}return r})();var _o=r=>["/admin/warehouses/edit",r],So=(r,d)=>d.id;function yo(r,d){r&1&&(i(0,"div",7),g(1,"span",10),t())}function Ao(r,d){r&1&&(i(0,"div",8)(1,"span",11),n(2,"warehouse"),t(),i(3,"p"),n(4,"\u0627\u0646\u0628\u0627\u0631\u06CC \u062A\u0639\u0631\u06CC\u0641 \u0646\u0634\u062F\u0647 \u0627\u0633\u062A."),t(),i(5,"a",12),n(6,"\u0627\u0641\u0632\u0648\u062F\u0646 \u0627\u0648\u0644\u06CC\u0646 \u0627\u0646\u0628\u0627\u0631"),t()())}function Eo(r,d){r&1&&(i(0,"span",26),n(1,"\u067E\u06CC\u0634\u200C\u0641\u0631\u0636"),t())}function wo(r,d){if(r&1){let e=S();i(0,"button",34),C("click",function(){b(e);let u=l().$implicit,s=l(2);return _(s.setDefault(u.id))}),n(1," \u062A\u0646\u0638\u06CC\u0645 \u067E\u06CC\u0634\u200C\u0641\u0631\u0636 "),t()}}function Fo(r,d){if(r&1){let e=S();i(0,"button",35),C("click",function(){b(e);let u=l().$implicit,s=l(2);return _(s.deleteWarehouse(u.id))}),i(1,"span",31),n(2,"delete"),t()()}}function ko(r,d){if(r&1){let e=S();i(0,"tr",19)(1,"td",20),n(2),t(),i(3,"td",21),n(4),t(),i(5,"td",22),n(6),t(),i(7,"td",23)(8,"span",24),g(9,"span",25),n(10),t()(),i(11,"td",23),m(12,Eo,2,0,"span",26)(13,wo,2,0,"button",27),t(),i(14,"td",28)(15,"div",29)(16,"a",30)(17,"span",31),n(18,"edit"),t()(),i(19,"button",32),C("click",function(){let u=b(e).$implicit,s=l(2);return _(s.toggleActive(u))}),i(20,"span",31),n(21),t()(),m(22,Fo,3,0,"button",33),t()()()}if(r&2){let e=d.$implicit;a(2),v(e.name),a(2),v(e.code),a(2),v(e.city),a(2),f("ngClass",e.isActive?"bg-success/10 text-success":"bg-destructive/10 text-destructive"),a(),f("ngClass",e.isActive?"bg-success":"bg-destructive"),a(),x(" ",e.isActive?"\u0641\u0639\u0627\u0644":"\u063A\u06CC\u0631\u0641\u0639\u0627\u0644"," "),a(2),c(e.isDefault?12:13),a(4),f("routerLink",J(15,_o,e.id)),a(3),B("text-warning",e.isActive)("text-success",!e.isActive),f("title",e.isActive?"\u063A\u06CC\u0631\u0641\u0639\u0627\u0644 \u06A9\u0631\u062F\u0646":"\u0641\u0639\u0627\u0644 \u06A9\u0631\u062F\u0646"),a(2),v(e.isActive?"block":"check_circle"),a(),c(e.isDefault?-1:22)}}function Io(r,d){if(r&1&&(i(0,"div",9)(1,"table",13)(2,"thead",14)(3,"tr")(4,"th",15),n(5,"\u0646\u0627\u0645 \u0627\u0646\u0628\u0627\u0631"),t(),i(6,"th",15),n(7,"\u06A9\u062F"),t(),i(8,"th",15),n(9,"\u0634\u0647\u0631"),t(),i(10,"th",16),n(11,"\u0648\u0636\u0639\u06CC\u062A"),t(),i(12,"th",16),n(13,"\u067E\u06CC\u0634\u200C\u0641\u0631\u0636"),t(),i(14,"th",17),n(15,"\u0639\u0645\u0644\u06CC\u0627\u062A"),t()()(),i(16,"tbody",18),A(17,ko,23,17,"tr",19,So),t()()()),r&2){let e=l();a(17),E(e.warehouses)}}var wi=(()=>{class r{constructor(e,o){this.warehouseService=e,this.notificationService=o,this.warehouses=[],this.isLoading=!0}ngOnInit(){this.loadWarehouses()}loadWarehouses(){this.isLoading=!0,this.warehouseService.getWarehouses().subscribe({next:e=>{this.warehouses=e,this.isLoading=!1},error:()=>{this.notificationService.show("\u062E\u0637\u0627 \u062F\u0631 \u0628\u0627\u0631\u06AF\u0630\u0627\u0631\u06CC \u0627\u0646\u0628\u0627\u0631\u0647\u0627","error"),this.isLoading=!1}})}setDefault(e){this.warehouseService.setDefault(e).subscribe({next:()=>{this.notificationService.show("\u0627\u0646\u0628\u0627\u0631 \u067E\u06CC\u0634\u200C\u0641\u0631\u0636 \u062A\u0646\u0638\u06CC\u0645 \u0634\u062F","success"),this.loadWarehouses()},error:()=>this.notificationService.show("\u062E\u0637\u0627","error")})}toggleActive(e){this.warehouseService.toggleActive(e.id,!e.isActive).subscribe({next:()=>{e.isActive=!e.isActive,this.notificationService.show("\u0648\u0636\u0639\u06CC\u062A \u0627\u0646\u0628\u0627\u0631 \u062A\u063A\u06CC\u06CC\u0631 \u06A9\u0631\u062F","success")},error:()=>this.notificationService.show("\u062E\u0637\u0627","error")})}deleteWarehouse(e){confirm("\u0622\u06CC\u0627 \u0627\u0632 \u062D\u0630\u0641 \u0627\u06CC\u0646 \u0627\u0646\u0628\u0627\u0631 \u0627\u0637\u0645\u06CC\u0646\u0627\u0646 \u062F\u0627\u0631\u06CC\u062F\u061F")&&this.warehouseService.deleteWarehouse(e).subscribe({next:()=>{this.notificationService.show("\u0627\u0646\u0628\u0627\u0631 \u062D\u0630\u0641 \u0634\u062F","success"),this.loadWarehouses()},error:o=>this.notificationService.show(o?.error?.message||"\u062E\u0637\u0627 \u062F\u0631 \u062D\u0630\u0641 \u0627\u0646\u0628\u0627\u0631","error")})}static{this.\u0275fac=function(o){return new(o||r)(h(ut),h(D))}}static{this.\u0275cmp=k({type:r,selectors:[["app-admin-warehouse-list"]],decls:14,vars:3,consts:[[1,"space-y-6","animate-fade-in"],[1,"flex","items-center","justify-between"],[1,"text-2xl","font-bold","text-heading-foreground","flex","items-center","gap-2"],[1,"material-icons","text-primary"],["routerLink","/admin/warehouses/new",1,"btn","btn-primary","gap-2","shadow-button"],[1,"material-icons","text-sm"],[1,"card","overflow-hidden","border","border-border","shadow-sm"],[1,"flex","justify-center","p-12"],[1,"p-16","text-center","text-muted-foreground","flex","flex-col","items-center","gap-3"],[1,"w-full","overflow-x-auto"],[1,"spinner","spinner-xl","text-primary"],[1,"material-icons","text-5xl","opacity-20"],["routerLink","/admin/warehouses/new",1,"btn","btn-primary","btn-sm"],[1,"w-full","text-right","text-sm"],[1,"bg-muted/50","border-b","border-border","text-muted-foreground"],[1,"h-12","px-6","align-middle","font-medium"],[1,"h-12","px-6","align-middle","font-medium","text-center"],[1,"h-12","px-6","align-middle","font-medium","text-left"],[1,"divide-y","divide-border/50","bg-card"],[1,"hover:bg-muted/30","transition-colors","group"],[1,"p-6","align-middle","font-bold"],[1,"p-6","align-middle","font-mono","text-muted-foreground"],[1,"p-6","align-middle","text-muted-foreground"],[1,"p-6","align-middle","text-center"],[1,"px-2.5","py-1","text-xs","font-semibold","rounded-full","inline-flex","items-center","gap-1",3,"ngClass"],[1,"w-1.5","h-1.5","rounded-full",3,"ngClass"],[1,"badge","badge-primary","text-xs"],[1,"btn","btn-ghost","btn-sm","text-xs","text-muted-foreground","hover:text-primary"],[1,"p-6","align-middle"],[1,"flex","items-center","justify-end","gap-2","opacity-0","group-hover:opacity-100","transition-opacity"],["title","\u0648\u06CC\u0631\u0627\u06CC\u0634",1,"btn","btn-ghost","btn-sm","btn-icon","rounded-full","text-primary",3,"routerLink"],[1,"material-icons","text-lg"],[1,"btn","btn-ghost","btn-sm","btn-icon","rounded-full",3,"click","title"],["title","\u062D\u0630\u0641",1,"btn","btn-ghost","btn-sm","btn-icon","text-muted-foreground","hover:text-destructive-foreground","hover:bg-destructive","rounded-full"],[1,"btn","btn-ghost","btn-sm","text-xs","text-muted-foreground","hover:text-primary",3,"click"],["title","\u062D\u0630\u0641",1,"btn","btn-ghost","btn-sm","btn-icon","text-muted-foreground","hover:text-destructive-foreground","hover:bg-destructive","rounded-full",3,"click"]],template:function(o,u){o&1&&(i(0,"div",0)(1,"div",1)(2,"h1",2)(3,"span",3),n(4,"warehouse"),t(),n(5," \u0645\u062F\u06CC\u0631\u06CC\u062A \u0627\u0646\u0628\u0627\u0631\u0647\u0627 "),t(),i(6,"a",4)(7,"span",5),n(8,"add"),t(),n(9," \u0627\u0646\u0628\u0627\u0631 \u062C\u062F\u06CC\u062F "),t()(),i(10,"div",6),m(11,yo,2,0,"div",7),m(12,Ao,7,0,"div",8),m(13,Io,19,0,"div",9),t()()),o&2&&(a(11),c(u.isLoading?11:-1),a(),c(!u.isLoading&&u.warehouses.length===0?12:-1),a(),c(!u.isLoading&&u.warehouses.length>0?13:-1))},dependencies:[M,q,j,N],encapsulation:2})}}return r})();function To(r,d){r&1&&(i(0,"div",6),g(1,"span",8),t())}function Lo(r,d){r&1&&(i(0,"p",15),n(1,"\u0646\u0627\u0645 \u0627\u0646\u0628\u0627\u0631 \u0627\u0644\u0632\u0627\u0645\u06CC \u0627\u0633\u062A"),t())}function Do(r,d){r&1&&(i(0,"p",15),n(1,"\u06A9\u062F \u0627\u0646\u0628\u0627\u0631 \u0627\u0644\u0632\u0627\u0645\u06CC \u0627\u0633\u062A"),t())}function Po(r,d){r&1&&(i(0,"p",15),n(1,"\u0634\u0647\u0631 \u0627\u0644\u0632\u0627\u0645\u06CC \u0627\u0633\u062A"),t())}function Mo(r,d){r&1&&(i(0,"div",22),g(1,"input",27),i(2,"label",28),n(3,"\u062A\u0646\u0638\u06CC\u0645 \u0628\u0647 \u0639\u0646\u0648\u0627\u0646 \u0627\u0646\u0628\u0627\u0631 \u067E\u06CC\u0634\u200C\u0641\u0631\u0636"),t()())}function Vo(r,d){r&1&&g(0,"span",26)}function Uo(r,d){if(r&1){let e=S();i(0,"form",9),C("ngSubmit",function(){b(e);let u=l();return _(u.onSubmit())}),i(1,"div",10)(2,"div",11)(3,"label",12),n(4,"\u0646\u0627\u0645 \u0627\u0646\u0628\u0627\u0631 "),i(5,"span",13),n(6,"*"),t()(),g(7,"input",14),m(8,Lo,2,0,"p",15),t(),i(9,"div",11)(10,"label",12),n(11,"\u06A9\u062F \u0627\u0646\u0628\u0627\u0631 "),i(12,"span",13),n(13,"*"),t()(),g(14,"input",16),m(15,Do,2,0,"p",15),t(),i(16,"div",11)(17,"label",12),n(18,"\u0634\u0647\u0631 "),i(19,"span",13),n(20,"*"),t()(),g(21,"input",17),m(22,Po,2,0,"p",15),t(),i(23,"div",11)(24,"label",12),n(25,"\u062A\u0644\u0641\u0646"),t(),g(26,"input",18),t(),i(27,"div",19)(28,"label",12),n(29,"\u0622\u062F\u0631\u0633"),t(),g(30,"textarea",20),t(),i(31,"div",11)(32,"label",12),n(33,"\u0627\u0648\u0644\u0648\u06CC\u062A"),t(),g(34,"input",21),t(),m(35,Mo,4,0,"div",22),t(),i(36,"div",23)(37,"a",24),n(38,"\u0627\u0646\u0635\u0631\u0627\u0641"),t(),i(39,"button",25),m(40,Vo,1,0,"span",26),n(41),t()()()}if(r&2){let e,o,u,s=l();f("formGroup",s.warehouseForm),a(8),c((e=s.warehouseForm.get("name"))!=null&&e.invalid&&((e=s.warehouseForm.get("name"))!=null&&e.touched)?8:-1),a(6),Ke("disabled",s.isEditMode?!0:null),a(),c((o=s.warehouseForm.get("code"))!=null&&o.invalid&&((o=s.warehouseForm.get("code"))!=null&&o.touched)?15:-1),a(7),c((u=s.warehouseForm.get("city"))!=null&&u.invalid&&((u=s.warehouseForm.get("city"))!=null&&u.touched)?22:-1),a(13),c(s.isEditMode?-1:35),a(4),f("disabled",s.warehouseForm.invalid||s.isSubmitting),a(),c(s.isSubmitting?40:-1),a(),x(" ",s.isSubmitting?"\u062F\u0631 \u062D\u0627\u0644 \u0630\u062E\u06CC\u0631\u0647...":s.isEditMode?"\u0630\u062E\u06CC\u0631\u0647 \u062A\u063A\u06CC\u06CC\u0631\u0627\u062A":"\u0627\u06CC\u062C\u0627\u062F \u0627\u0646\u0628\u0627\u0631"," ")}}var bt=(()=>{class r{constructor(e,o,u,s,p){this.fb=e,this.route=o,this.router=u,this.warehouseService=s,this.notificationService=p,this.warehouseId=null,this.isEditMode=!1,this.isLoading=!1,this.isSubmitting=!1,this.warehouseForm=this.fb.group({code:["",[I.required,I.maxLength(20)]],name:["",[I.required,I.maxLength(100)]],city:["",[I.required,I.maxLength(50)]],address:[""],phone:[""],priority:[0],isDefault:[!1]})}ngOnInit(){let e=this.route.snapshot.paramMap.get("id");e&&(this.warehouseId=+e,this.isEditMode=!0,this.loadWarehouse())}loadWarehouse(){this.warehouseId&&(this.isLoading=!0,this.warehouseService.getWarehouseById(this.warehouseId).subscribe({next:e=>{this.warehouseForm.patchValue(e),this.warehouseForm.get("code")?.disable(),this.isLoading=!1},error:()=>{this.notificationService.show("\u0627\u0646\u0628\u0627\u0631 \u06CC\u0627\u0641\u062A \u0646\u0634\u062F","error"),this.router.navigate(["/admin/warehouses"])}}))}onSubmit(){if(this.warehouseForm.invalid)return;this.isSubmitting=!0;let e=this.warehouseForm.getRawValue();(this.isEditMode&&this.warehouseId?this.warehouseService.updateWarehouse(this.warehouseId,{name:e.name,city:e.city,address:e.address,phone:e.phone,priority:e.priority}):this.warehouseService.createWarehouse(e)).pipe(L(()=>this.isSubmitting=!1)).subscribe({next:()=>{this.notificationService.show(this.isEditMode?"\u0627\u0646\u0628\u0627\u0631 \u0628\u0627 \u0645\u0648\u0641\u0642\u06CC\u062A \u0648\u06CC\u0631\u0627\u06CC\u0634 \u0634\u062F":"\u0627\u0646\u0628\u0627\u0631 \u0628\u0627 \u0645\u0648\u0641\u0642\u06CC\u062A \u0627\u06CC\u062C\u0627\u062F \u0634\u062F","success"),this.router.navigate(["/admin/warehouses"])},error:u=>this.notificationService.show(u?.error?.message||"\u062E\u0637\u0627 \u062F\u0631 \u0630\u062E\u06CC\u0631\u0647 \u0627\u0646\u0628\u0627\u0631","error")})}static{this.\u0275fac=function(o){return new(o||r)(h(we),h(ue),h(he),h(ut),h(D))}}static{this.\u0275cmp=k({type:r,selectors:[["app-admin-warehouse-form"]],decls:12,vars:3,consts:[[1,"max-w-2xl","mx-auto","animate-fade-in-up"],[1,"flex","items-center","justify-between","mb-6"],[1,"text-2xl","font-bold","text-heading-foreground","flex","items-center","gap-2"],[1,"material-icons","text-primary"],["routerLink","/admin/warehouses",1,"btn","btn-outline","btn-sm","gap-2"],[1,"material-icons","text-sm"],[1,"flex","justify-center","p-12"],[1,"card","p-6","space-y-5","shadow-md","border-border",3,"formGroup"],[1,"spinner","spinner-xl","text-primary"],[1,"card","p-6","space-y-5","shadow-md","border-border",3,"ngSubmit","formGroup"],[1,"grid","grid-cols-1","sm:grid-cols-2","gap-5"],[1,"form-group"],[1,"form-label"],[1,"text-destructive"],["type","text","formControlName","name","placeholder","\u0645\u062B\u0627\u0644: \u0627\u0646\u0628\u0627\u0631 \u0645\u0631\u06A9\u0632\u06CC \u062A\u0647\u0631\u0627\u0646",1,"input","w-full"],[1,"form-error"],["type","text","formControlName","code","placeholder","\u0645\u062B\u0627\u0644: WH-01",1,"input","w-full"],["type","text","formControlName","city","placeholder","\u0645\u062B\u0627\u0644: \u062A\u0647\u0631\u0627\u0646",1,"input","w-full"],["type","text","formControlName","phone","placeholder","\u0634\u0645\u0627\u0631\u0647 \u062A\u0645\u0627\u0633 \u0627\u0646\u0628\u0627\u0631",1,"input","w-full"],[1,"form-group","sm:col-span-2"],["formControlName","address","rows","2","placeholder","\u0622\u062F\u0631\u0633 \u06A9\u0627\u0645\u0644 \u0627\u0646\u0628\u0627\u0631",1,"input","w-full"],["type","number","formControlName","priority","min","0",1,"input","w-full"],[1,"form-group","flex","items-center","gap-3","pt-6"],[1,"flex","justify-end","gap-3","border-t","border-border","pt-5"],["routerLink","/admin/warehouses",1,"btn","btn-ghost","text-muted-foreground"],["type","submit",1,"btn","btn-primary","min-w-[120px]","shadow-button",3,"disabled"],[1,"spinner","spinner-sm","mr-2","border-white"],["type","checkbox","formControlName","isDefault","id","isDefault",1,"checkbox"],["for","isDefault",1,"form-label","cursor-pointer"]],template:function(o,u){o&1&&(i(0,"div",0)(1,"div",1)(2,"h1",2)(3,"span",3),n(4,"warehouse"),t(),n(5),t(),i(6,"a",4)(7,"span",5),n(8,"arrow_forward"),t(),n(9," \u0628\u0627\u0632\u06AF\u0634\u062A "),t()(),m(10,To,2,0,"div",6),m(11,Uo,42,9,"form",7),t()),o&2&&(a(5),x(" ",u.isEditMode?"\u0648\u06CC\u0631\u0627\u06CC\u0634 \u0627\u0646\u0628\u0627\u0631":"\u0627\u0646\u0628\u0627\u0631 \u062C\u062F\u06CC\u062F"," "),a(5),c(u.isLoading?10:-1),a(),c(u.isLoading?-1:11))},dependencies:[M,me,se,Z,ee,_e,$,ae,Ee,le,de,j,N],encapsulation:2})}}return r})();var Fi=(()=>{class r{constructor(e){this.http=e,this.apiUrl=`${R.API_URL}admin/wallet`}getBalance(e){return this.http.get(`${this.apiUrl}/${e}/balance`)}credit(e,o){return this.http.post(`${this.apiUrl}/${e}/credit`,o)}debit(e,o){return this.http.post(`${this.apiUrl}/${e}/debit`,o)}static{this.\u0275fac=function(o){return new(o||r)(W(G))}}static{this.\u0275prov=O({token:r,factory:r.\u0275fac,providedIn:"root"})}}return r})();var jo=(r,d)=>d.id;function $o(r,d){r&1&&(i(0,"div",6),g(1,"span",12),t())}function Bo(r,d){r&1&&g(0,"span",32)}function Ro(r,d){if(r&1){let e=S();i(0,"div",13)(1,"div",14)(2,"p",15),n(3,"\u0645\u0648\u062C\u0648\u062F\u06CC \u06A9\u0644"),t(),i(4,"p",16),n(5),F(6,"number"),t(),i(7,"p",17),n(8,"\u062A\u0648\u0645\u0627\u0646"),t()(),i(9,"div",14)(10,"p",15),n(11,"\u0645\u0648\u062C\u0648\u062F\u06CC \u0642\u0627\u0628\u0644 \u0628\u0631\u062F\u0627\u0634\u062A"),t(),i(12,"p",18),n(13),F(14,"number"),t(),i(15,"p",17),n(16,"\u062A\u0648\u0645\u0627\u0646"),t()(),i(17,"div",14)(18,"p",15),n(19,"\u0645\u0648\u062C\u0648\u062F\u06CC \u0631\u0632\u0631\u0648 \u0634\u062F\u0647"),t(),i(20,"p",19),n(21),F(22,"number"),t(),i(23,"p",17),n(24,"\u062A\u0648\u0645\u0627\u0646"),t()()(),i(25,"div",20)(26,"h2",21),n(27,"\u062A\u0646\u0638\u06CC\u0645 \u0645\u0648\u062C\u0648\u062F\u06CC \u062F\u0633\u062A\u06CC"),t(),i(28,"div",22)(29,"div",23)(30,"label",24),n(31,"\u0645\u0628\u0644\u063A (\u062A\u0648\u0645\u0627\u0646) "),i(32,"span",25),n(33,"*"),t()(),i(34,"input",26),X("ngModelChange",function(u){b(e);let s=l();return Y(s.adjustAmount,u)||(s.adjustAmount=u),_(u)}),t()(),i(35,"div",23)(36,"label",24),n(37,"\u062F\u0644\u06CC\u0644 "),i(38,"span",25),n(39,"*"),t()(),i(40,"input",27),X("ngModelChange",function(u){b(e);let s=l();return Y(s.adjustReason,u)||(s.adjustReason=u),_(u)}),t()(),i(41,"div",28)(42,"label",24),n(43,"\u062A\u0648\u0636\u06CC\u062D\u0627\u062A (\u0627\u062E\u062A\u06CC\u0627\u0631\u06CC)"),t(),i(44,"input",29),X("ngModelChange",function(u){b(e);let s=l();return Y(s.adjustDescription,u)||(s.adjustDescription=u),_(u)}),t()()(),i(45,"div",30)(46,"button",31),C("click",function(){b(e);let u=l();return _(u.credit())}),m(47,Bo,1,0,"span",32),i(48,"span",33),n(49,"add"),t(),n(50," \u0634\u0627\u0631\u0698 \u06A9\u06CC\u0641 \u067E\u0648\u0644 "),t(),i(51,"button",34),C("click",function(){b(e);let u=l();return _(u.debit())}),i(52,"span",33),n(53,"remove"),t(),n(54," \u06A9\u0633\u0631 \u0627\u0632 \u06A9\u06CC\u0641 \u067E\u0648\u0644 "),t()()()}if(r&2){let e=l();a(5),v(U(6,9,e.wallet.currentBalance)),a(8),v(U(14,11,e.wallet.availableBalance)),a(8),v(U(22,13,e.wallet.reservedBalance)),a(13),Q("ngModel",e.adjustAmount),a(6),Q("ngModel",e.adjustReason),a(4),Q("ngModel",e.adjustDescription),a(2),f("disabled",!e.adjustAmount||!e.adjustReason||e.isAdjusting),a(),c(e.isAdjusting?47:-1),a(4),f("disabled",!e.adjustAmount||!e.adjustReason||e.isAdjusting)}}function Oo(r,d){r&1&&(i(0,"div",10),g(1,"span",12),t())}function Wo(r,d){r&1&&(i(0,"p",11),n(1,"\u062A\u0631\u0627\u06A9\u0646\u0634\u06CC \u06CC\u0627\u0641\u062A \u0646\u0634\u062F."),t())}function Go(r,d){if(r&1&&(i(0,"p",39),n(1),t()),r&2){let e=l().$implicit;a(),v(e.description)}}function zo(r,d){if(r&1&&(i(0,"div",36)(1,"div")(2,"p",38),n(3),t(),m(4,Go,2,1,"p",39),i(5,"p",40),n(6),F(7,"date"),t()(),i(8,"div",41)(9,"p",9),n(10),F(11,"number"),t(),i(12,"p",17),n(13),F(14,"number"),t()()()),r&2){let e=d.$implicit;a(3),v(e.transactionType),a(),c(e.description?4:-1),a(2),v(oe(7,10,e.createdAt,"yyyy/MM/dd HH:mm")),a(3),B("text-success",e.amountDelta>0)("text-destructive",e.amountDelta<0),a(),ce(" ",e.amountDelta>0?"+":"","",U(11,13,e.amountDelta)," \u062A\u0648\u0645\u0627\u0646 "),a(3),x("\u0645\u0648\u062C\u0648\u062F\u06CC: ",U(14,15,e.balanceAfter))}}function qo(r,d){if(r&1){let e=S();i(0,"div",37)(1,"nav",42)(2,"button",43),C("click",function(){b(e);let u=l(2);return _(u.loadLedger(u.ledgerPage-1))}),n(3,"\u0642\u0628\u0644\u06CC"),t(),i(4,"span",44),n(5),t(),i(6,"button",43),C("click",function(){b(e);let u=l(2);return _(u.loadLedger(u.ledgerPage+1))}),n(7,"\u0628\u0639\u062F\u06CC"),t()()()}if(r&2){let e=l(2);a(2),f("disabled",e.ledgerPage===1),a(3),ce("",e.ledgerPage," / ",e.ledgerPagination.totalPages),a(),f("disabled",e.ledgerPage===e.ledgerPagination.totalPages)}}function Ho(r,d){if(r&1&&(i(0,"div",35),A(1,zo,15,17,"div",36,jo),t(),m(3,qo,8,4,"div",37)),r&2){let e=l();a(),E(e.ledger),a(2),c(e.ledgerPagination&&e.ledgerPagination.totalPages>1?3:-1)}}var ki=(()=>{class r{constructor(e,o,u,s,p){this.route=e,this.router=o,this.adminWalletService=u,this.walletService=s,this.notificationService=p,this.wallet=null,this.isLoading=!0,this.ledger=[],this.isLedgerLoading=!1,this.ledgerPage=1,this.ledgerPagination=null,this.adjustAmount=null,this.adjustReason="",this.adjustDescription="",this.isAdjusting=!1}ngOnInit(){let e=this.route.snapshot.paramMap.get("id");if(!e){this.router.navigate(["/admin/users"]);return}this.userId=+e,this.loadBalance(),this.loadLedger()}loadBalance(){this.isLoading=!0,this.walletService.getBalance().pipe(L(()=>this.isLoading=!1)).subscribe({next:e=>this.wallet=e,error:()=>this.notificationService.show("\u062E\u0637\u0627 \u062F\u0631 \u0628\u0627\u0631\u06AF\u0630\u0627\u0631\u06CC \u06A9\u06CC\u0641 \u067E\u0648\u0644","error")})}loadLedger(e=1){this.isLedgerLoading=!0,this.ledgerPage=e,this.walletService.getLedger(this.userId,e).pipe(L(()=>this.isLedgerLoading=!1)).subscribe({next:o=>{this.ledger=o.items??[],this.ledgerPagination=o},error:()=>this.notificationService.show("\u062E\u0637\u0627 \u062F\u0631 \u0628\u0627\u0631\u06AF\u0630\u0627\u0631\u06CC \u062A\u0627\u0631\u06CC\u062E\u0686\u0647","error")})}credit(){!this.adjustAmount||!this.adjustReason||(this.isAdjusting=!0,this.adminWalletService.credit(this.userId,{amount:this.adjustAmount,reason:this.adjustReason,description:this.adjustDescription}).pipe(L(()=>this.isAdjusting=!1)).subscribe({next:()=>{this.notificationService.show("\u06A9\u06CC\u0641 \u067E\u0648\u0644 \u0634\u0627\u0631\u0698 \u0634\u062F","success"),this.resetForm(),this.loadBalance(),this.loadLedger()},error:e=>this.notificationService.show(e?.error?.message||"\u062E\u0637\u0627","error")}))}debit(){!this.adjustAmount||!this.adjustReason||(this.isAdjusting=!0,this.adminWalletService.debit(this.userId,{amount:this.adjustAmount,reason:this.adjustReason,description:this.adjustDescription}).pipe(L(()=>this.isAdjusting=!1)).subscribe({next:()=>{this.notificationService.show("\u0645\u0648\u062C\u0648\u062F\u06CC \u06A9\u0633\u0631 \u0634\u062F","success"),this.resetForm(),this.loadBalance(),this.loadLedger()},error:e=>this.notificationService.show(e?.error?.message||"\u062E\u0637\u0627","error")}))}resetForm(){this.adjustAmount=null,this.adjustReason="",this.adjustDescription=""}goBack(){this.router.navigate(["/admin/users"])}static{this.\u0275fac=function(o){return new(o||r)(h(ue),h(he),h(Fi),h(Rt),h(D))}}static{this.\u0275cmp=k({type:r,selectors:[["app-admin-user-wallet"]],decls:19,vars:5,consts:[[1,"space-y-6","animate-fade-in"],[1,"flex","items-center","justify-between"],[1,"text-2xl","font-bold","text-heading-foreground","flex","items-center","gap-2"],[1,"material-icons","text-primary"],[1,"btn","btn-outline","btn-sm","gap-2",3,"click"],[1,"material-icons","text-sm"],[1,"flex","justify-center","p-12"],[1,"card","overflow-hidden","border","border-border","shadow-sm"],[1,"p-4","border-b","border-border"],[1,"font-bold"],[1,"flex","justify-center","p-8"],[1,"text-center","p-8","text-muted-foreground"],[1,"spinner","spinner-xl","text-primary"],[1,"grid","grid-cols-1","sm:grid-cols-3","gap-4"],[1,"card","p-5","border","border-border","shadow-sm","text-center"],[1,"text-sm","text-muted-foreground","mb-1"],[1,"text-2xl","font-bold","text-foreground"],[1,"text-xs","text-muted-foreground"],[1,"text-2xl","font-bold","text-success"],[1,"text-2xl","font-bold","text-warning"],[1,"card","p-6","border","border-border","shadow-sm","space-y-5"],[1,"text-lg","font-bold"],[1,"grid","grid-cols-1","sm:grid-cols-2","gap-5"],[1,"form-group"],[1,"form-label"],[1,"text-destructive"],["type","number","placeholder","\u0645\u0628\u0644\u063A \u0628\u0647 \u062A\u0648\u0645\u0627\u0646","min","1",1,"input","w-full",3,"ngModelChange","ngModel"],["type","text","placeholder","\u062F\u0644\u06CC\u0644 \u062A\u0646\u0638\u06CC\u0645 \u0645\u0648\u062C\u0648\u062F\u06CC",1,"input","w-full",3,"ngModelChange","ngModel"],[1,"form-group","sm:col-span-2"],["type","text","placeholder","\u062A\u0648\u0636\u06CC\u062D\u0627\u062A \u0628\u06CC\u0634\u062A\u0631...",1,"input","w-full",3,"ngModelChange","ngModel"],[1,"flex","gap-3"],[1,"btn","btn-success","flex-1",3,"click","disabled"],[1,"spinner","spinner-sm","mr-2","border-white"],[1,"material-icons","text-sm","me-1"],[1,"btn","btn-destructive","flex-1",3,"click","disabled"],[1,"divide-y","divide-border/50"],[1,"flex","items-center","justify-between","p-4","hover:bg-muted/20","transition-colors"],[1,"flex","justify-center","p-4","border-t","border-border"],[1,"text-sm","font-medium"],[1,"text-xs","text-muted-foreground","mt-0.5"],[1,"text-xs","text-muted-foreground","font-mono"],[1,"text-left"],[1,"flex","items-center","gap-2"],[1,"btn","btn-outline","btn-sm",3,"click","disabled"],[1,"text-sm","font-mono"]],template:function(o,u){o&1&&(i(0,"div",0)(1,"div",1)(2,"h1",2)(3,"span",3),n(4,"account_balance_wallet"),t(),n(5," \u0645\u062F\u06CC\u0631\u06CC\u062A \u06A9\u06CC\u0641 \u067E\u0648\u0644 \u06A9\u0627\u0631\u0628\u0631 "),t(),i(6,"button",4),C("click",function(){return u.goBack()}),i(7,"span",5),n(8,"arrow_forward"),t(),n(9," \u0628\u0627\u0632\u06AF\u0634\u062A "),t()(),m(10,$o,2,0,"div",6),m(11,Ro,55,15),i(12,"div",7)(13,"div",8)(14,"h2",9),n(15,"\u062A\u0627\u0631\u06CC\u062E\u0686\u0647 \u062A\u0631\u0627\u06A9\u0646\u0634\u200C\u0647\u0627"),t()(),m(16,Oo,2,0,"div",10),m(17,Wo,2,0,"p",11),m(18,Ho,4,1),t()()),o&2&&(a(10),c(u.isLoading?10:-1),a(),c(!u.isLoading&&u.wallet?11:-1),a(5),c(u.isLedgerLoading?16:-1),a(),c(!u.isLedgerLoading&&u.ledger.length===0?17:-1),a(),c(!u.isLedgerLoading&&u.ledger.length>0?18:-1))},dependencies:[M,ge,Z,ee,$,Ee,Ce,be,fe],encapsulation:2})}}return r})();var Ii=(()=>{class r{constructor(e){this.http=e,this.apiUrl=`${R.API_URL}admin/user`}getUserSessions(e){return this.http.get(`${this.apiUrl}/${e}/sessions`)}revokeSession(e,o){return this.http.delete(`${this.apiUrl}/${e}/sessions/${o}`)}revokeAllSessions(e){return this.http.delete(`${this.apiUrl}/${e}/sessions`)}static{this.\u0275fac=function(o){return new(o||r)(W(G))}}static{this.\u0275prov=O({token:r,factory:r.\u0275fac,providedIn:"root"})}}return r})();var Jo=(r,d)=>d.id;function Qo(r,d){if(r&1){let e=S();w(0,"button",12),Le("click",function(){b(e);let u=l();return _(u.revokeAll())}),w(1,"span",7),n(2,"logout"),y(),n(3," \u062E\u0631\u0648\u062C \u0627\u0632 \u0647\u0645\u0647 \u062F\u0633\u062A\u06AF\u0627\u0647\u200C\u0647\u0627 "),y()}if(r&2){let e=l();Me("disabled",e.isRevoking)}}function Yo(r,d){r&1&&(w(0,"div",9),Je(1,"span",13),y())}function Xo(r,d){r&1&&(w(0,"div",10)(1,"span",14),n(2,"devices"),y(),w(3,"p"),n(4,"\u0646\u0634\u0633\u062A \u0641\u0639\u0627\u0644\u06CC \u06CC\u0627\u0641\u062A \u0646\u0634\u062F."),y()())}function Zo(r,d){if(r&1){let e=S();w(0,"div",15)(1,"div",16)(2,"div",17)(3,"span",18),n(4),y()(),w(5,"div")(6,"p",19),n(7),y(),w(8,"p",20),n(9),y(),w(10,"p",21),n(11),F(12,"date"),y()()(),w(13,"button",22),Le("click",function(){let u=b(e).$implicit,s=l(2);return _(s.revokeSession(u.id))}),w(14,"span",23),n(15,"logout"),y(),n(16," \u062E\u0631\u0648\u062C "),y()()}if(r&2){let e=d.$implicit,o=l(2);a(4),v(o.getDeviceIcon(e.deviceInfo)),a(3),v(e.deviceInfo||"\u062F\u0633\u062A\u06AF\u0627\u0647 \u0646\u0627\u0634\u0646\u0627\u0633"),a(2),x("\u0622\u062F\u0631\u0633 IP: ",e.ip),a(2),x(" \u0622\u062E\u0631\u06CC\u0646 \u0641\u0639\u0627\u0644\u06CC\u062A: ",oe(12,5,e.lastActivityAt,"yyyy/MM/dd HH:mm")," "),a(2),Me("disabled",o.isRevoking)}}function eu(r,d){if(r&1&&(w(0,"div",11),A(1,Zo,17,8,"div",15,Jo),y()),r&2){let e=l();a(),E(e.sessions)}}var Ti=(()=>{class r{constructor(e,o,u,s){this.route=e,this.router=o,this.sessionsService=u,this.notificationService=s,this.sessions=[],this.isLoading=!0,this.isRevoking=!1}ngOnInit(){let e=this.route.snapshot.paramMap.get("id");if(!e){this.router.navigate(["/admin/users"]);return}this.userId=+e,this.loadSessions()}loadSessions(){this.isLoading=!0,this.sessionsService.getUserSessions(this.userId).pipe(L(()=>this.isLoading=!1)).subscribe({next:e=>this.sessions=e,error:()=>this.notificationService.show("\u062E\u0637\u0627 \u062F\u0631 \u0628\u0627\u0631\u06AF\u0630\u0627\u0631\u06CC \u0646\u0634\u0633\u062A\u200C\u0647\u0627","error")})}revokeSession(e){confirm("\u0622\u06CC\u0627 \u0627\u0632 \u062E\u0631\u0648\u062C \u0627\u06CC\u0646 \u0646\u0634\u0633\u062A \u0627\u0637\u0645\u06CC\u0646\u0627\u0646 \u062F\u0627\u0631\u06CC\u062F\u061F")&&(this.isRevoking=!0,this.sessionsService.revokeSession(this.userId,e).pipe(L(()=>this.isRevoking=!1)).subscribe({next:()=>{this.notificationService.show("\u0646\u0634\u0633\u062A \u0628\u0627 \u0645\u0648\u0641\u0642\u06CC\u062A \u067E\u0627\u06CC\u0627\u0646 \u06CC\u0627\u0641\u062A","success"),this.sessions=this.sessions.filter(o=>o.id!==e)},error:()=>this.notificationService.show("\u062E\u0637\u0627 \u062F\u0631 \u067E\u0627\u06CC\u0627\u0646 \u062F\u0627\u062F\u0646 \u0628\u0647 \u0646\u0634\u0633\u062A","error")}))}revokeAll(){confirm("\u0622\u06CC\u0627 \u0627\u0632 \u062E\u0631\u0648\u062C \u06A9\u0627\u0631\u0628\u0631 \u0627\u0632 \u062A\u0645\u0627\u0645 \u062F\u0633\u062A\u06AF\u0627\u0647\u200C\u0647\u0627 \u0627\u0637\u0645\u06CC\u0646\u0627\u0646 \u062F\u0627\u0631\u06CC\u062F\u061F")&&(this.isRevoking=!0,this.sessionsService.revokeAllSessions(this.userId).pipe(L(()=>this.isRevoking=!1)).subscribe({next:()=>{this.notificationService.show("\u062E\u0631\u0648\u062C \u0627\u0632 \u062A\u0645\u0627\u0645 \u062F\u0633\u062A\u06AF\u0627\u0647\u200C\u0647\u0627 \u0627\u0646\u062C\u0627\u0645 \u0634\u062F","success"),this.sessions=[]},error:()=>this.notificationService.show("\u062E\u0637\u0627","error")}))}getDeviceIcon(e){if(!e)return"device_unknown";let o=e.toLowerCase();return o.includes("mobile")||o.includes("android")||o.includes("ios")||o.includes("iphone")?"smartphone":o.includes("tablet")||o.includes("ipad")?"tablet":"computer"}goBack(){this.router.navigate(["/admin/users"])}static{this.\u0275fac=function(o){return new(o||r)(h(ue),h(he),h(Ii),h(D))}}static{this.\u0275cmp=k({type:r,selectors:[["app-admin-user-sessions"]],decls:16,vars:4,consts:[[1,"space-y-6","animate-fade-in"],[1,"flex","items-center","justify-between"],[1,"text-2xl","font-bold","text-heading-foreground","flex","items-center","gap-2"],[1,"material-icons","text-primary"],[1,"flex","gap-2"],[1,"btn","btn-destructive","btn-sm","gap-2",3,"disabled"],[1,"btn","btn-outline","btn-sm","gap-2",3,"click"],[1,"material-icons","text-sm"],[1,"card","overflow-hidden","border","border-border","shadow-sm"],[1,"flex","justify-center","p-12"],[1,"p-16","text-center","text-muted-foreground","flex","flex-col","items-center","gap-3"],[1,"divide-y","divide-border/50"],[1,"btn","btn-destructive","btn-sm","gap-2",3,"click","disabled"],[1,"spinner","spinner-xl","text-primary"],[1,"material-icons","text-5xl","opacity-20"],[1,"p-5","flex","items-center","justify-between","hover:bg-muted/20","transition-colors","group"],[1,"flex","items-start","gap-4"],[1,"w-10","h-10","rounded-full","bg-primary/10","flex","items-center","justify-center","text-primary"],[1,"material-icons"],[1,"font-medium","text-foreground"],[1,"text-xs","text-muted-foreground","font-mono","mt-0.5"],[1,"text-xs","text-muted-foreground","mt-0.5"],[1,"btn","btn-ghost","btn-sm","text-destructive","hover:bg-destructive","hover:text-white","opacity-0","group-hover:opacity-100","transition-opacity",3,"click","disabled"],[1,"material-icons","text-sm","me-1"]],template:function(o,u){o&1&&(w(0,"div",0)(1,"div",1)(2,"h1",2)(3,"span",3),n(4,"devices"),y(),n(5," \u0646\u0634\u0633\u062A\u200C\u0647\u0627\u06CC \u0641\u0639\u0627\u0644 \u06A9\u0627\u0631\u0628\u0631 "),y(),w(6,"div",4),m(7,Qo,4,1,"button",5),w(8,"button",6),Le("click",function(){return u.goBack()}),w(9,"span",7),n(10,"arrow_forward"),y(),n(11," \u0628\u0627\u0632\u06AF\u0634\u062A "),y()()(),w(12,"div",8),m(13,Yo,2,0,"div",9),m(14,Xo,5,0,"div",10),m(15,eu,3,0,"div",11),y()()),o&2&&(a(7),c(u.sessions.length>0?7:-1),a(6),c(u.isLoading?13:-1),a(),c(!u.isLoading&&u.sessions.length===0?14:-1),a(),c(!u.isLoading&&u.sessions.length>0?15:-1))},dependencies:[M,fe],encapsulation:2})}}return r})();var at=(()=>{class r{constructor(e){this.http=e,this.apiUrl=`${R.API_URL}admin/notifications`}getNotifications(e=1,o=20){let u=new z().set("page",e.toString()).set("pageSize",o.toString());return this.http.get(this.apiUrl,{params:u})}sendNotification(e){return this.http.post(`${this.apiUrl}/send`,e)}deleteNotification(e){return this.http.delete(`${this.apiUrl}/${e}`)}static{this.\u0275fac=function(o){return new(o||r)(W(G))}}static{this.\u0275prov=O({token:r,factory:r.\u0275fac,providedIn:"root"})}}return r})();var tu=(r,d)=>d.id;function iu(r,d){r&1&&(i(0,"div",7),g(1,"span",9),t())}function nu(r,d){r&1&&(i(0,"div",8)(1,"span",10),n(2,"notifications_none"),t(),i(3,"p"),n(4,"\u0627\u0639\u0644\u0627\u0646\u06CC \u06CC\u0627\u0641\u062A \u0646\u0634\u062F."),t()())}function ru(r,d){if(r&1){let e=S();i(0,"div",14)(1,"div",15)(2,"div",16)(3,"span",17),n(4),t()(),i(5,"div")(6,"p",18),n(7),t(),i(8,"p",19),n(9),t(),i(10,"div",20)(11,"span",21),n(12),t(),i(13,"span",22),n(14),F(15,"date"),t()()()(),i(16,"button",23),C("click",function(){let u=b(e).$implicit,s=l(2);return _(s.deleteNotification(u.id))}),i(17,"span",17),n(18,"delete"),t()()()}if(r&2){let e=d.$implicit,o=l(2);B("opacity-60",e.isRead),a(2),f("ngClass",o.getTypeClass(e.type)),a(2),v(o.getTypeIcon(e.type)),a(3),v(e.title),a(2),v(e.message),a(3),v(e.type),a(2),v(oe(15,8,e.createdAt,"yyyy/MM/dd HH:mm"))}}function ou(r,d){if(r&1){let e=S();i(0,"div",13)(1,"nav",24)(2,"button",25),C("click",function(){b(e);let u=l(2);return _(u.loadNotifications(u.currentPage-1))}),n(3,"\u0642\u0628\u0644\u06CC"),t(),i(4,"span",26),n(5),t(),i(6,"button",25),C("click",function(){b(e);let u=l(2);return _(u.loadNotifications(u.currentPage+1))}),n(7,"\u0628\u0639\u062F\u06CC"),t()()()}if(r&2){let e=l(2);a(2),f("disabled",e.currentPage===1),a(3),ce("",e.currentPage," / ",e.pagination.totalPages),a(),f("disabled",e.currentPage===e.pagination.totalPages)}}function uu(r,d){if(r&1&&(i(0,"div",11),A(1,ru,19,11,"div",12,tu),t(),m(3,ou,8,4,"div",13)),r&2){let e=l();a(),E(e.notifications),a(2),c(e.pagination&&e.pagination.totalPages>1?3:-1)}}var Di=(()=>{class r{constructor(e,o){this.adminNotificationService=e,this.notificationService=o,this.notifications=[],this.isLoading=!0,this.currentPage=1,this.pagination=null}ngOnInit(){this.loadNotifications()}loadNotifications(e=1){this.isLoading=!0,this.currentPage=e,this.adminNotificationService.getNotifications(e).pipe(L(()=>this.isLoading=!1)).subscribe({next:o=>{this.notifications=o.items??[],this.pagination=o},error:()=>this.notificationService.show("\u062E\u0637\u0627 \u062F\u0631 \u0628\u0627\u0631\u06AF\u0630\u0627\u0631\u06CC \u0627\u0639\u0644\u0627\u0646\u200C\u0647\u0627","error")})}deleteNotification(e){confirm("\u0627\u06CC\u0646 \u0627\u0639\u0644\u0627\u0646 \u062D\u0630\u0641 \u0634\u0648\u062F\u061F")&&this.adminNotificationService.deleteNotification(e).subscribe({next:()=>{this.notificationService.show("\u0627\u0639\u0644\u0627\u0646 \u062D\u0630\u0641 \u0634\u062F","success"),this.loadNotifications(this.currentPage)},error:()=>this.notificationService.show("\u062E\u0637\u0627 \u062F\u0631 \u062D\u0630\u0641 \u0627\u0639\u0644\u0627\u0646","error")})}getTypeIcon(e){return{SystemAlert:"warning",DiscountCode:"local_offer",Marketing:"campaign",Order:"shopping_bag"}[e]??"notifications"}getTypeClass(e){return{SystemAlert:"bg-warning/10 text-warning",DiscountCode:"bg-success/10 text-success",Marketing:"bg-primary/10 text-primary",Order:"bg-blue-500/10 text-blue-500"}[e]??"bg-muted text-muted-foreground"}static{this.\u0275fac=function(o){return new(o||r)(h(at),h(D))}}static{this.\u0275cmp=k({type:r,selectors:[["app-admin-notification-list"]],decls:14,vars:3,consts:[[1,"space-y-6","animate-fade-in"],[1,"flex","items-center","justify-between"],[1,"text-2xl","font-bold","text-heading-foreground","flex","items-center","gap-2"],[1,"material-icons","text-primary"],["routerLink","/admin/notifications/send",1,"btn","btn-primary","gap-2","shadow-button"],[1,"material-icons","text-sm"],[1,"card","overflow-hidden","border","border-border","shadow-sm"],[1,"flex","justify-center","p-12"],[1,"p-16","text-center","text-muted-foreground","flex","flex-col","items-center","gap-3"],[1,"spinner","spinner-xl","text-primary"],[1,"material-icons","text-5xl","opacity-20"],[1,"divide-y","divide-border/50"],[1,"p-5","flex","items-start","justify-between","hover:bg-muted/20","transition-colors","group",3,"opacity-60"],[1,"flex","justify-center","p-4","border-t","border-border"],[1,"p-5","flex","items-start","justify-between","hover:bg-muted/20","transition-colors","group"],[1,"flex","items-start","gap-4"],[1,"w-9","h-9","rounded-full","flex","items-center","justify-center","text-sm","font-bold",3,"ngClass"],[1,"material-icons","text-lg"],[1,"font-bold","text-foreground"],[1,"text-sm","text-muted-foreground","mt-0.5"],[1,"flex","items-center","gap-2","mt-1"],[1,"text-xs","bg-muted","px-2","py-0.5","rounded-full"],[1,"text-xs","text-muted-foreground","font-mono"],[1,"btn","btn-ghost","btn-sm","btn-icon","text-muted-foreground","hover:text-destructive-foreground","hover:bg-destructive","rounded-full","opacity-0","group-hover:opacity-100","transition-opacity",3,"click"],[1,"flex","items-center","gap-2"],[1,"btn","btn-outline","btn-sm",3,"click","disabled"],[1,"text-sm","font-mono"]],template:function(o,u){o&1&&(i(0,"div",0)(1,"div",1)(2,"h1",2)(3,"span",3),n(4,"notifications"),t(),n(5," \u0645\u062F\u06CC\u0631\u06CC\u062A \u0627\u0639\u0644\u0627\u0646\u200C\u0647\u0627 "),t(),i(6,"a",4)(7,"span",5),n(8,"send"),t(),n(9," \u0627\u0631\u0633\u0627\u0644 \u0627\u0639\u0644\u0627\u0646 \u062C\u062F\u06CC\u062F "),t()(),i(10,"div",6),m(11,iu,2,0,"div",7),m(12,nu,5,0,"div",8),m(13,uu,4,1),t()()),o&2&&(a(11),c(u.isLoading?11:-1),a(),c(!u.isLoading&&u.notifications.length===0?12:-1),a(),c(!u.isLoading&&u.notifications.length>0?13:-1))},dependencies:[M,q,j,N,fe],encapsulation:2})}}return r})();function au(r,d){r&1&&(i(0,"p",11),n(1,"\u0639\u0646\u0648\u0627\u0646 \u0627\u0644\u0632\u0627\u0645\u06CC \u0627\u0633\u062A"),t())}function su(r,d){r&1&&(i(0,"p",11),n(1,"\u0645\u062A\u0646 \u0627\u0639\u0644\u0627\u0646 \u0627\u0644\u0632\u0627\u0645\u06CC \u0627\u0633\u062A"),t())}function du(r,d){r&1&&(i(0,"div",7)(1,"label",8),n(2,"\u0634\u0646\u0627\u0633\u0647 \u06A9\u0627\u0631\u0628\u0631 "),i(3,"span",9),n(4,"*"),t()(),g(5,"input",29),t())}function lu(r,d){r&1&&g(0,"span",28)}var Pi=(()=>{class r{constructor(e,o,u,s){this.fb=e,this.router=o,this.adminNotificationService=u,this.notificationService=s,this.isSubmitting=!1,this.sendForm=this.fb.group({title:["",[I.required,I.maxLength(150)]],message:["",[I.required,I.maxLength(1e3)]],type:["SystemAlert",I.required],actionUrl:[""],sendToAll:[!1],userId:[null]})}onSendToAllChange(){let e=this.sendForm.get("sendToAll")?.value,o=this.sendForm.get("userId");e?(o?.clearValidators(),o?.setValue(null)):o?.setValidators(I.required),o?.updateValueAndValidity()}onSubmit(){this.sendForm.invalid||(this.isSubmitting=!0,this.adminNotificationService.sendNotification(this.sendForm.value).pipe(L(()=>this.isSubmitting=!1)).subscribe({next:()=>{this.notificationService.show("\u0627\u0639\u0644\u0627\u0646 \u0628\u0627 \u0645\u0648\u0641\u0642\u06CC\u062A \u0627\u0631\u0633\u0627\u0644 \u0634\u062F","success"),this.router.navigate(["/admin/notifications"])},error:e=>this.notificationService.show(e?.error?.message||"\u062E\u0637\u0627 \u062F\u0631 \u0627\u0631\u0633\u0627\u0644 \u0627\u0639\u0644\u0627\u0646","error")}))}static{this.\u0275fac=function(o){return new(o||r)(h(we),h(he),h(at),h(D))}}static{this.\u0275cmp=k({type:r,selectors:[["app-admin-notification-send"]],decls:58,vars:7,consts:[[1,"max-w-2xl","mx-auto","animate-fade-in-up"],[1,"flex","items-center","justify-between","mb-6"],[1,"text-2xl","font-bold","text-heading-foreground","flex","items-center","gap-2"],[1,"material-icons","text-primary"],["routerLink","/admin/notifications",1,"btn","btn-outline","btn-sm","gap-2"],[1,"material-icons","text-sm"],[1,"card","p-6","space-y-5","shadow-md","border-border",3,"ngSubmit","formGroup"],[1,"form-group"],[1,"form-label"],[1,"text-destructive"],["type","text","formControlName","title","placeholder","\u0639\u0646\u0648\u0627\u0646 \u0627\u0639\u0644\u0627\u0646",1,"input","w-full"],[1,"form-error"],["formControlName","message","rows","4","placeholder","\u0645\u062A\u0646 \u067E\u06CC\u0627\u0645...",1,"input","w-full"],[1,"grid","grid-cols-1","sm:grid-cols-2","gap-5"],["formControlName","type",1,"select","w-full"],["value","SystemAlert"],["value","DiscountCode"],["value","Marketing"],["value","Order"],["type","text","formControlName","actionUrl","placeholder","\u0645\u062B\u0627\u0644: /products/123",1,"input","w-full"],[1,"border","border-border","rounded-lg","p-4","space-y-3"],[1,"font-medium","text-sm"],[1,"flex","items-center","gap-3"],["type","checkbox","formControlName","sendToAll","id","sendToAll",1,"checkbox",3,"change"],["for","sendToAll",1,"text-sm","cursor-pointer"],[1,"flex","justify-end","gap-3","border-t","border-border","pt-5"],["routerLink","/admin/notifications",1,"btn","btn-ghost","text-muted-foreground"],["type","submit",1,"btn","btn-primary","min-w-[140px]","shadow-button",3,"disabled"],[1,"spinner","spinner-sm","mr-2","border-white"],["type","number","formControlName","userId","placeholder","\u0634\u0646\u0627\u0633\u0647 \u06A9\u0627\u0631\u0628\u0631 \u0645\u0634\u062E\u0635",1,"input","w-full"]],template:function(o,u){if(o&1&&(i(0,"div",0)(1,"div",1)(2,"h1",2)(3,"span",3),n(4,"send"),t(),n(5," \u0627\u0631\u0633\u0627\u0644 \u0627\u0639\u0644\u0627\u0646 \u062C\u062F\u06CC\u062F "),t(),i(6,"a",4)(7,"span",5),n(8,"arrow_forward"),t(),n(9," \u0628\u0627\u0632\u06AF\u0634\u062A "),t()(),i(10,"form",6),C("ngSubmit",function(){return u.onSubmit()}),i(11,"div",7)(12,"label",8),n(13,"\u0639\u0646\u0648\u0627\u0646 "),i(14,"span",9),n(15,"*"),t()(),g(16,"input",10),m(17,au,2,0,"p",11),t(),i(18,"div",7)(19,"label",8),n(20,"\u0645\u062A\u0646 \u0627\u0639\u0644\u0627\u0646 "),i(21,"span",9),n(22,"*"),t()(),g(23,"textarea",12),m(24,su,2,0,"p",11),t(),i(25,"div",13)(26,"div",7)(27,"label",8),n(28,"\u0646\u0648\u0639 \u0627\u0639\u0644\u0627\u0646 "),i(29,"span",9),n(30,"*"),t()(),i(31,"select",14)(32,"option",15),n(33,"\u0647\u0634\u062F\u0627\u0631 \u0633\u06CC\u0633\u062A\u0645\u06CC"),t(),i(34,"option",16),n(35,"\u06A9\u062F \u062A\u062E\u0641\u06CC\u0641"),t(),i(36,"option",17),n(37,"\u0645\u0627\u0631\u06A9\u062A\u06CC\u0646\u06AF"),t(),i(38,"option",18),n(39,"\u0633\u0641\u0627\u0631\u0634"),t()()(),i(40,"div",7)(41,"label",8),n(42,"\u0644\u06CC\u0646\u06A9 (\u0627\u062E\u062A\u06CC\u0627\u0631\u06CC)"),t(),g(43,"input",19),t()(),i(44,"div",20)(45,"label",21),n(46,"\u06AF\u06CC\u0631\u0646\u062F\u06AF\u0627\u0646"),t(),i(47,"div",22)(48,"input",23),C("change",function(){return u.onSendToAllChange()}),t(),i(49,"label",24),n(50,"\u0627\u0631\u0633\u0627\u0644 \u0628\u0647 \u0647\u0645\u0647 \u06A9\u0627\u0631\u0628\u0631\u0627\u0646"),t()(),m(51,du,6,0,"div",7),t(),i(52,"div",25)(53,"a",26),n(54,"\u0627\u0646\u0635\u0631\u0627\u0641"),t(),i(55,"button",27),m(56,lu,1,0,"span",28),n(57),t()()()()),o&2){let s,p,V;a(10),f("formGroup",u.sendForm),a(7),c((s=u.sendForm.get("title"))!=null&&s.invalid&&((s=u.sendForm.get("title"))!=null&&s.touched)?17:-1),a(7),c((p=u.sendForm.get("message"))!=null&&p.invalid&&((p=u.sendForm.get("message"))!=null&&p.touched)?24:-1),a(27),c((V=u.sendForm.get("sendToAll"))!=null&&V.value?-1:51),a(4),f("disabled",u.sendForm.invalid||u.isSubmitting),a(),c(u.isSubmitting?56:-1),a(),x(" ",u.isSubmitting?"\u062F\u0631 \u062D\u0627\u0644 \u0627\u0631\u0633\u0627\u0644...":"\u0627\u0631\u0633\u0627\u0644 \u0627\u0639\u0644\u0627\u0646"," ")}},dependencies:[M,me,se,ie,ne,Z,ee,_e,te,$,ae,le,de,j,N],encapsulation:2})}}return r})();var bl=[{path:"",component:Wt,canActivate:[Mt],children:[{path:"",redirectTo:"dashboard",pathMatch:"full"},{path:"dashboard",component:zt},{path:"products",component:mi},{path:"products/new",component:Ct},{path:"products/edit/:id",component:Ct},{path:"products/bulk-price-update",component:di},{path:"products/low-stock",component:ci},{path:"attributes",component:Ht},{path:"attributes/new",component:mt},{path:"attributes/edit/:id",component:mt},{path:"attributes/:id/values",component:Kt},{path:"categories",component:ei},{path:"categories/new",component:ft},{path:"categories/edit/:id",component:ft},{path:"category-groups",component:Zt},{path:"category-groups/new",component:pt},{path:"category-groups/edit/:id",component:pt},{path:"orders",component:ai},{path:"orders/:id",component:oi},{path:"order-statuses",component:si},{path:"order-statuses/new",component:ht},{path:"order-statuses/edit/:id",component:ht},{path:"discounts",component:ii},{path:"discounts/new",component:gt},{path:"discounts/edit/:id",component:gt},{path:"reviews",component:fi},{path:"inventory/transactions",component:ri},{path:"users",component:bi},{path:"users/:id/wallet",component:ki},{path:"users/:id/sessions",component:Ti},{path:"audit-logs",component:Qt},{path:"shippings",component:Ci},{path:"shippings/new",component:vt},{path:"shippings/edit/:id",component:vt},{path:"search-management",component:xi},{path:"support/tickets",component:Si},{path:"payments",component:Ai},{path:"warehouses",component:wi},{path:"warehouses/new",component:bt},{path:"warehouses/edit/:id",component:bt},{path:"notifications",component:Di},{path:"notifications/send",component:Pi}]}];export{bl as ADMIN_ROUTES};
