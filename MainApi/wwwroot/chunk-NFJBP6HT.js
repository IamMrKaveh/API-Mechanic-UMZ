import{a as Ae}from"./chunk-SXYEZPCO.js";import{a as V,b as we}from"./chunk-ELVL3YSU.js";import{a as Ee}from"./chunk-HPJP2VN4.js";import{a as ve}from"./chunk-GNQTMVA5.js";import{a as q}from"./chunk-5W5LZDWP.js";import{a as he,b as G,c as m,d as H,e as U,f as ee,g as S,i as z,m as J,p as K,q as be,r as Se,s as _e,v as ye,x as Ce,z as Q}from"./chunk-7OLIJ6IO.js";import"./chunk-GTLAKDJZ.js";import{a as O}from"./chunk-I4Q63QBA.js";import"./chunk-WNMS36QR.js";import{A as ge,F as M,b as me,c as L,d as w,e as $,f as ce,h as pe,i as A,w as fe,x as xe,y as D,z as T}from"./chunk-KEVVMOUP.js";import{Ab as i,Bb as b,Cb as x,Db as ae,Ea as u,Eb as de,F as C,Jb as ue,Kb as le,Nb as _,O as se,Ob as F,Pa as c,Pb as Z,Ua as E,Za as f,ba as N,ca as k,g as re,gb as l,hb as t,ib as e,j as ne,jb as p,nb as B,ob as R,pb as P,sb as h,tb as v,z as oe}from"./chunk-RYHSS54R.js";import{a as y,b as I}from"./chunk-4CLCTAJ7.js";var je=()=>({exact:!0});function Pe(r,s){if(r&1&&(B(0),t(1,"h2",20),i(2),e(),t(3,"p",21),i(4),e(),R()),r&2){let o=s.ngIf;u(2),ae(" ",o.firstName," ",o.lastName," "),u(2),x(" ",o.phoneNumber," ")}}function Te(r,s){if(r&1&&(t(0,"li")(1,"a",22)(2,"span",17),i(3),e(),t(4,"span"),i(5),e()()()),r&2){let o=s.$implicit;u(),l("routerLink",o.link)("routerLinkActiveOptions",ue(4,je)),u(2),b(o.icon),u(2),b(o.title)}}var Fe=(()=>{let s=class s{constructor(n,a){this.authService=n,this.router=a,this.menuItems=[{title:"\u067E\u0631\u0648\u0641\u0627\u06CC\u0644",link:"/dashboard/profile",icon:"account_circle"},{title:"\u062A\u0627\u0631\u06CC\u062E\u0686\u0647 \u0633\u0641\u0627\u0631\u0634\u0627\u062A",link:"/dashboard/order-history",icon:"history"},{title:"\u0622\u062F\u0631\u0633\u200C\u0647\u0627\u06CC \u0645\u0646",icon:"home",link:"/dashboard/addresses"}],this.user$=this.authService.userProfile$}ngOnInit(){}logout(){this.authService.logout(),this.router.navigate(["/"])}};s.\u0275fac=function(a){return new(a||s)(c(q),c(D))},s.\u0275cmp=E({type:s,selectors:[["app-dashboard-page"]],decls:27,vars:4,consts:[[1,"min-h-screen","bg-background","pb-12"],[1,"container","py-8","md:py-10"],[1,"md:hidden","mb-6","flex","justify-between","items-center"],[1,"text-xl","font-bold","text-foreground"],[1,"grid","grid-cols-1","md:grid-cols-12","gap-6","lg:gap-8"],[1,"md:col-span-4","lg:col-span-3"],[1,"sticky","top-24","space-y-6"],[1,"card","p-6","flex","flex-col","items-center","text-center"],[1,"relative","w-20","h-20","mb-4"],[1,"w-full","h-full","rounded-full","bg-muted","flex","items-center","justify-center","text-muted-foreground","border","border-border"],[1,"material-icons","text-4xl"],[4,"ngIf"],[1,"card","overflow-hidden","p-2"],[1,"space-y-1"],[4,"ngFor","ngForOf"],[1,"pt-2","mt-2","border-t","border-border"],[1,"w-full","flex","items-center","gap-3","px-4","py-3","rounded-lg","text-sm","text-destructive","hover:bg-destructive/10","transition-colors",3,"click"],[1,"material-icons-outlined","text-lg"],[1,"md:col-span-8","lg:col-span-9"],[1,"card","min-h-[500px]","overflow-hidden"],[1,"font-bold","text-lg","text-foreground","mb-1"],[1,"text-sm","text-muted-foreground","font-mono"],["routerLinkActive","bg-primary/10 text-primary font-semibold",1,"flex","items-center","gap-3","px-4","py-3","rounded-lg","text-sm","text-muted-foreground","hover:bg-muted/50","hover:text-foreground","transition-colors",3,"routerLink","routerLinkActiveOptions"]],template:function(a,d){a&1&&(t(0,"div",0)(1,"div",1)(2,"div",2)(3,"h1",3),i(4,"\u062D\u0633\u0627\u0628 \u06A9\u0627\u0631\u0628\u0631\u06CC"),e()(),t(5,"div",4)(6,"aside",5)(7,"div",6)(8,"div",7)(9,"div",8)(10,"div",9)(11,"span",10),i(12,"person"),e()()(),f(13,Pe,5,3,"ng-container",11),_(14,"async"),e(),t(15,"nav",12)(16,"ul",13),f(17,Te,6,5,"li",14),t(18,"li",15)(19,"button",16),h("click",function(){return d.logout()}),t(20,"span",17),i(21,"logout"),e(),t(22,"span"),i(23,"\u062E\u0631\u0648\u062C"),e()()()()()()(),t(24,"main",18)(25,"div",19),p(26,"router-outlet"),e()()()()()),a&2&&(u(13),l("ngIf",F(14,2,d.user$)),u(4),l("ngForOf",d.menuItems))},dependencies:[A,L,w,M,xe,T,ge,$],encapsulation:2});let r=s;return r})();function Ve(r,s){r&1&&(t(0,"div",8),p(1,"span",9),e())}function Be(r,s){if(r&1&&(t(0,"div",10),i(1),e()),r&2){let o=v().ngIf;u(),x(" ",o.error," ")}}function Re(r,s){r&1&&p(0,"span",26)}function $e(r,s){if(r&1){let o=P();t(0,"form",11),h("ngSubmit",function(){N(o);let a=v(2);return k(a.updateProfile())}),t(1,"div",12)(2,"div",13)(3,"span",14),i(4,"person"),e()()(),t(5,"div",15)(6,"div",16)(7,"label",17),i(8,"\u0646\u0627\u0645"),e(),p(9,"input",18),e(),t(10,"div",16)(11,"label",17),i(12,"\u0646\u0627\u0645 \u062E\u0627\u0646\u0648\u0627\u062F\u06AF\u06CC"),e(),p(13,"input",19),e(),t(14,"div",16)(15,"label",17),i(16,"\u0634\u0645\u0627\u0631\u0647 \u0645\u0648\u0628\u0627\u06CC\u0644"),e(),p(17,"input",20),e(),t(18,"div",16)(19,"label",17),i(20,"\u062A\u0627\u0631\u06CC\u062E \u0639\u0636\u0648\u06CC\u062A"),e(),p(21,"input",21),e()(),t(22,"div",22)(23,"button",23),h("click",function(){N(o);let a=v(2);return k(a.deleteAccount())}),i(24," \u062D\u0630\u0641 \u062D\u0633\u0627\u0628 \u06A9\u0627\u0631\u0628\u0631\u06CC "),e(),t(25,"button",24),f(26,Re,1,0,"span",25),t(27,"span"),i(28),e()()()()}if(r&2){let o=v().ngIf,n=v();l("formGroup",n.profileForm),u(25),l("disabled",n.profileForm.pristine||o.isSubmitting),u(),l("ngIf",o.isSubmitting),u(2),b(o.isSubmitting?"\u062F\u0631 \u062D\u0627\u0644 \u0630\u062E\u06CC\u0631\u0647...":"\u062B\u0628\u062A \u062A\u063A\u06CC\u06CC\u0631\u0627\u062A")}}function qe(r,s){if(r&1&&(B(0),f(1,Ve,2,0,"div",5)(2,Be,2,1,"div",6)(3,$e,29,4,"form",7),R()),r&2){let o=s.ngIf,n=v();u(),l("ngIf",o.isLoading),u(),l("ngIf",o.error),u(),l("ngIf",!o.isLoading&&n.profileForm)}}var Ne=(()=>{let s=class s{constructor(n,a,d,g){this.profileService=n,this.authService=a,this.notificationService=d,this.router=g,this.showAddressModal=!1,this.editingAddress=null,this.store=new re({profile:null,isLoading:!0,isSubmitting:!1,error:null}),this.vm$=this.store.asObservable()}ngOnInit(){this.profileForm=new ee({phoneNumber:new S({value:"",disabled:!0}),createdAt:new S({value:"",disabled:!0}),firstName:new S("",[m.maxLength(100)]),lastName:new S("",[m.maxLength(100)]),isAdmin:new S({value:!1,disabled:!0})}),this.addressForm=new ee({title:new S("",m.required),receiverName:new S("",m.required),phoneNumber:new S("",m.required),province:new S("",m.required),city:new S("",m.required),address:new S("",m.required),postalCode:new S("",m.required)}),this.loadProfile()}loadProfile(){this.store.next(I(y({},this.store.value),{isLoading:!0})),this.profileService.getProfile().pipe(se(n=>{this.profileForm.patchValue({phoneNumber:n.phoneNumber,createdAt:n.createdAt?new Date(n.createdAt).toLocaleDateString("fa-IR"):"",firstName:n.firstName,lastName:n.lastName,isAdmin:n.isAdmin}),this.authService.updateUserProfile(n),this.store.next(I(y({},this.store.value),{profile:n,isLoading:!1,error:null})),this.profileForm.markAsPristine()}),oe(n=>{let a=n?.error?.message||"\u062E\u0637\u0627 \u062F\u0631 \u062F\u0631\u06CC\u0627\u0641\u062A \u0627\u0637\u0644\u0627\u0639\u0627\u062A \u067E\u0631\u0648\u0641\u0627\u06CC\u0644";return this.store.next(I(y({},this.store.value),{isLoading:!1,error:a})),ne(null)})).subscribe()}updateProfile(){if(this.profileForm.invalid||this.profileForm.pristine)return;this.store.next(I(y({},this.store.value),{isSubmitting:!0}));let n={firstName:this.profileForm.value.firstName?.trim()||void 0,lastName:this.profileForm.value.lastName?.trim()||void 0};this.profileService.updateProfile(n).pipe(C(()=>this.store.next(I(y({},this.store.value),{isSubmitting:!1})))).subscribe({next:()=>{this.notificationService.show("\u067E\u0631\u0648\u0641\u0627\u06CC\u0644 \u0628\u0627 \u0645\u0648\u0641\u0642\u06CC\u062A \u0628\u0647\u200C\u0631\u0648\u0632\u0631\u0633\u0627\u0646\u06CC \u0634\u062F","success"),this.loadProfile()},error:a=>{let d=a?.error?.message||"\u062E\u0637\u0627 \u062F\u0631 \u0628\u0647\u200C\u0631\u0648\u0632\u0631\u0633\u0627\u0646\u06CC \u067E\u0631\u0648\u0641\u0627\u06CC\u0644";this.notificationService.show(d,"error")}})}deleteAccount(){confirm("\u0622\u06CC\u0627 \u0627\u0632 \u062D\u0630\u0641 \u062D\u0633\u0627\u0628 \u06A9\u0627\u0631\u0628\u0631\u06CC \u062E\u0648\u062F \u0627\u0637\u0645\u06CC\u0646\u0627\u0646 \u062F\u0627\u0631\u06CC\u062F\u061F \u0627\u06CC\u0646 \u0639\u0645\u0644 \u063A\u06CC\u0631\u0642\u0627\u0628\u0644 \u0628\u0627\u0632\u06AF\u0634\u062A \u0627\u0633\u062A.")&&(this.store.next(I(y({},this.store.value),{isSubmitting:!0})),this.profileService.deleteAccount().pipe(C(()=>this.store.next(I(y({},this.store.value),{isSubmitting:!1})))).subscribe({next:()=>{this.notificationService.show("\u062D\u0633\u0627\u0628 \u06A9\u0627\u0631\u0628\u0631\u06CC \u0634\u0645\u0627 \u0628\u0627 \u0645\u0648\u0641\u0642\u06CC\u062A \u062D\u0630\u0641 \u0634\u062F.","success"),this.authService.logout(),this.router.navigate(["/"])},error:n=>{let a=n?.error?.message||"\u062E\u0637\u0627 \u062F\u0631 \u062D\u0630\u0641 \u062D\u0633\u0627\u0628 \u06A9\u0627\u0631\u0628\u0631\u06CC.";this.notificationService.show(a,"error")}}))}};s.\u0275fac=function(a){return new(a||s)(c(V),c(q),c(O),c(D))},s.\u0275cmp=E({type:s,selectors:[["app-profile"]],decls:7,vars:3,consts:[[1,"flex","flex-col","h-full"],[1,"p-6","border-b","border-border","flex","items-center","justify-between"],[1,"text-lg","font-bold","text-foreground"],[1,"p-6","max-w-2xl","mx-auto","w-full","flex-1"],[4,"ngIf"],["class","flex justify-center py-12",4,"ngIf"],["class","alert alert-destructive mb-6",4,"ngIf"],["class","space-y-8",3,"formGroup","ngSubmit",4,"ngIf"],[1,"flex","justify-center","py-12"],[1,"spinner","spinner-lg","text-primary"],[1,"alert","alert-destructive","mb-6"],[1,"space-y-8",3,"ngSubmit","formGroup"],[1,"flex","flex-col","items-center","mb-8"],[1,"w-24","h-24","rounded-full","bg-muted","flex","items-center","justify-center","text-muted-foreground","border","border-border","mb-2"],[1,"material-icons","text-4xl"],[1,"grid","grid-cols-1","sm:grid-cols-2","gap-6"],[1,"space-y-2"],[1,"text-sm","font-medium","text-foreground"],["type","text","formControlName","firstName",1,"input","w-full"],["type","text","formControlName","lastName",1,"input","w-full"],["type","text","formControlName","phoneNumber","readonly","",1,"input","w-full","bg-muted/30","text-muted-foreground","dir-ltr"],["type","text","formControlName","createdAt","readonly","",1,"input","w-full","bg-muted/30","text-muted-foreground","text-center"],[1,"pt-6","border-t","border-border","flex","flex-col-reverse","sm:flex-row","justify-between","gap-4"],["type","button",1,"btn","btn-outline","text-destructive","border-destructive/30","hover:bg-destructive/10","w-full","sm:w-auto",3,"click"],["type","submit",1,"btn","btn-primary","w-full","sm:w-auto","min-w-[120px]",3,"disabled"],["class","spinner spinner-sm me-2",4,"ngIf"],[1,"spinner","spinner-sm","me-2"]],template:function(a,d){a&1&&(t(0,"div",0)(1,"div",1)(2,"h2",2),i(3,"\u0648\u06CC\u0631\u0627\u06CC\u0634 \u067E\u0631\u0648\u0641\u0627\u06CC\u0644"),e()(),t(4,"div",3),f(5,qe,4,3,"ng-container",4),_(6,"async"),e()()),a&2&&(u(5),l("ngIf",F(6,1,d.vm$)))},dependencies:[A,w,Q,z,G,H,U,J,K,$],encapsulation:2});let r=s;return r})();function Ge(r,s){r&1&&(t(0,"div",7),p(1,"span",8),t(2,"span",9),i(3,"\u062F\u0631 \u062D\u0627\u0644 \u0628\u0627\u0631\u06AF\u0630\u0627\u0631\u06CC..."),e()())}function He(r,s){r&1&&(t(0,"div",10)(1,"span",11),i(2,"receipt_long"),e(),t(3,"p",9),i(4,"\u0647\u0646\u0648\u0632 \u0633\u0641\u0627\u0631\u0634\u06CC \u062B\u0628\u062A \u0646\u06A9\u0631\u062F\u0647\u200C\u0627\u06CC\u062F"),e(),t(5,"a",12),i(6,"\u0634\u0631\u0648\u0639 \u062E\u0631\u06CC\u062F"),e()())}function Ue(r,s){if(r&1){let o=P();t(0,"tr",23)(1,"td",24),i(2),e(),t(3,"td",25),i(4),_(5,"date"),e(),t(6,"td",26),i(7),_(8,"number"),e(),t(9,"td",27)(10,"span",28),_(11,"statusClass"),i(12),e()(),t(13,"td",29)(14,"button",30),h("click",function(){let a=N(o).$implicit,d=v(2);return k(d.viewOrderDetails(a.id))}),i(15," \u062C\u0632\u0626\u06CC\u0627\u062A "),e()()()}if(r&2){let o=s.$implicit;u(2),x("#",o.id),u(2),b(Z(5,5,o.createdAt,"yyyy/MM/dd")),u(3),b(F(8,8,o.totalAmount)),u(3),l("ngClass",F(11,10,o.orderStatus==null?null:o.orderStatus.name)),u(2),x(" ",(o.orderStatus==null?null:o.orderStatus.name)||"\u0646\u0627\u0645\u0634\u062E\u0635"," ")}}function ze(r,s){if(r&1){let o=P();t(0,"div",31),h("click",function(){let a=N(o).$implicit,d=v(2);return k(d.viewOrderDetails(a.id))}),t(1,"div",32)(2,"div")(3,"span",33),i(4,"\u0634\u0645\u0627\u0631\u0647 \u0633\u0641\u0627\u0631\u0634"),e(),t(5,"span",34),i(6),e()(),t(7,"span",28),_(8,"statusClass"),i(9),e()(),t(10,"div",35)(11,"span",36),i(12),_(13,"date"),e(),t(14,"div",37),i(15),_(16,"number"),t(17,"span",38),i(18,"\u062A\u0648\u0645\u0627\u0646"),e()()()()}if(r&2){let o=s.$implicit;u(6),x("#",o.id),u(),l("ngClass",F(8,5,o.orderStatus==null?null:o.orderStatus.name)),u(2),x(" ",o.orderStatus==null?null:o.orderStatus.name," "),u(3),b(Z(13,7,o.createdAt,"yyyy/MM/dd")),u(3),x(" ",F(16,10,o.totalAmount)," ")}}function Je(r,s){if(r&1&&(t(0,"div",13)(1,"div",14)(2,"table",15)(3,"thead",16)(4,"tr")(5,"th",17),i(6,"\u0634\u0645\u0627\u0631\u0647 \u0633\u0641\u0627\u0631\u0634"),e(),t(7,"th",17),i(8,"\u062A\u0627\u0631\u06CC\u062E"),e(),t(9,"th",17),i(10,"\u0645\u0628\u0644\u063A (\u062A\u0648\u0645\u0627\u0646)"),e(),t(11,"th",17),i(12,"\u0648\u0636\u0639\u06CC\u062A"),e(),t(13,"th",18),i(14,"\u0639\u0645\u0644\u06CC\u0627\u062A"),e()()(),t(15,"tbody",19),f(16,Ue,16,12,"tr",20),e()()(),t(17,"div",21),f(18,ze,19,12,"div",22),e()()),r&2){let o=v();u(16),l("ngForOf",o.orders),u(2),l("ngForOf",o.orders)}}var ke=(()=>{let s=class s{constructor(n,a,d){this.orderService=n,this.notificationService=a,this.router=d,this.orders=[],this.isLoading=!0,this.paginationInfo=null}ngOnInit(){this.loadOrders()}loadOrders(n=1,a=10){this.isLoading=!0,this.orderService.getOrders(n,a).pipe(C(()=>this.isLoading=!1)).subscribe({next:d=>{this.orders=d.items??[],this.paginationInfo=d},error:()=>{this.notificationService.show("\u062E\u0637\u0627 \u062F\u0631 \u062F\u0631\u06CC\u0627\u0641\u062A \u062A\u0627\u0631\u06CC\u062E\u0686\u0647 \u0633\u0641\u0627\u0631\u0634\u0627\u062A","error")}})}viewOrderDetails(n){this.router.navigate(["/dashboard/order",n])}};s.\u0275fac=function(a){return new(a||s)(c(Ee),c(O),c(D))},s.\u0275cmp=E({type:s,selectors:[["app-order-history"]],decls:8,vars:3,consts:[[1,"flex","flex-col","h-full"],[1,"p-6","border-b","border-border","flex","justify-between","items-center"],[1,"text-lg","font-bold","text-foreground"],[1,"p-6","flex-1"],["class","flex flex-col items-center justify-center h-64 space-y-4",4,"ngIf"],["class","empty-state border-2 border-dashed border-border rounded-xl",4,"ngIf"],["class","space-y-4",4,"ngIf"],[1,"flex","flex-col","items-center","justify-center","h-64","space-y-4"],[1,"spinner","spinner-lg","text-primary"],[1,"text-muted-foreground","text-sm"],[1,"empty-state","border-2","border-dashed","border-border","rounded-xl"],[1,"material-icons","text-4xl","text-muted-foreground/40","mb-4"],["routerLink","/products",1,"btn","btn-link","mt-2"],[1,"space-y-4"],[1,"hidden","md:block","overflow-hidden","rounded-xl","border","border-border"],[1,"w-full","text-sm"],[1,"bg-muted/30","border-b","border-border"],[1,"px-6","py-4","font-semibold","text-muted-foreground","text-right"],[1,"px-6","py-4","font-semibold","text-muted-foreground","text-left"],[1,"divide-y","divide-border"],["class","hover:bg-muted/10 transition-colors",4,"ngFor","ngForOf"],[1,"md:hidden","grid","gap-4"],["class","card-hover p-4 active:scale-[0.99] cursor-pointer border border-border",3,"click",4,"ngFor","ngForOf"],[1,"hover:bg-muted/10","transition-colors"],[1,"px-6","py-4","font-mono","text-foreground"],[1,"px-6","py-4","text-muted-foreground"],[1,"px-6","py-4","font-medium","text-foreground"],[1,"px-6","py-4"],[1,"badge",3,"ngClass"],[1,"px-6","py-4","text-left"],[1,"btn","btn-ghost","btn-sm",3,"click"],[1,"card-hover","p-4","active:scale-[0.99]","cursor-pointer","border","border-border",3,"click"],[1,"flex","justify-between","items-start","mb-3"],[1,"text-xs","text-muted-foreground","block","mb-1"],[1,"font-mono","font-bold","text-foreground"],[1,"flex","justify-between","items-end","border-t","border-border","pt-3"],[1,"text-xs","text-muted-foreground"],[1,"font-bold","text-primary"],[1,"text-xs","font-normal","text-muted-foreground"]],template:function(a,d){a&1&&(t(0,"div",0)(1,"div",1)(2,"h2",2),i(3,"\u062A\u0627\u0631\u06CC\u062E\u0686\u0647 \u0633\u0641\u0627\u0631\u0634\u0627\u062A"),e()(),t(4,"div",3),f(5,Ge,4,0,"div",4)(6,He,7,0,"div",5)(7,Je,19,2,"div",6),e()()),a&2&&(u(5),l("ngIf",d.isLoading),u(),l("ngIf",!d.isLoading&&(!d.orders||d.orders.length===0)),u(),l("ngIf",!d.isLoading&&d.orders&&d.orders.length>0))},dependencies:[A,me,L,w,pe,ce,Ae],encapsulation:2});let r=s;return r})();function Ke(r,s){if(r&1&&(t(0,"option",27),i(1),e()),r&2){let o=s.$implicit;l("value",o.name),u(),b(o.name)}}function Qe(r,s){if(r&1&&(t(0,"option",27),i(1),e()),r&2){let o=s.$implicit;l("value",o.name),u(),b(o.name)}}function We(r,s){r&1&&p(0,"span",28)}var ie=(()=>{let s=class s{constructor(n,a,d,g,j,De){this.fb=n,this.route=a,this.router=d,this.profileService=g,this.locationService=j,this.notificationService=De,this.isEditMode=!1,this.addressId=null,this.isSubmitting=!1,this.states=[],this.cities=[],this.citiesLoading=!1,this.addressForm=this.fb.group({title:["",[m.required,m.maxLength(100)]],receiverName:["",[m.required,m.maxLength(100)]],phoneNumber:["",[m.required,m.pattern(/^\+?\d{10,15}$/)]],postalCode:["",[m.required,m.pattern(/^\d{10}$/),m.minLength(10),m.maxLength(10)]],province:[null,m.required],city:[{value:null,disabled:!0},m.required],address:["",[m.required,m.maxLength(500)]],isDefault:[!1]})}ngOnInit(){this.loadStates();let n=this.route.snapshot.paramMap.get("id");n&&(this.addressId=+n,this.isEditMode=!0,this.loadAddressData())}loadStates(){this.locationService.getStates().subscribe(n=>this.states=n)}onProvinceChange(n){let d=n.target.value,g=this.states.find(j=>j.name===d);this.cities=[],this.addressForm.get("city")?.reset(),this.addressForm.get("city")?.disable(),g&&(this.citiesLoading=!0,this.addressForm.get("city")?.enable(),this.locationService.getCitiesByState(g.id).pipe(C(()=>this.citiesLoading=!1)).subscribe(j=>this.cities=j))}loadAddressData(){this.addressId&&this.profileService.getProfile().subscribe(n=>{let a=n.userAddresses?.find(d=>d.id===this.addressId);if(a){this.addressForm.patchValue(a);let d=this.states.find(g=>g.name===a.province);d&&(this.addressForm.get("city")?.enable(),this.locationService.getCitiesByState(d.id).subscribe(g=>{this.cities=g,this.addressForm.get("city")?.patchValue(a.city)}))}else this.notificationService.show("\u0622\u062F\u0631\u0633 \u0645\u0648\u0631\u062F \u0646\u0638\u0631 \u06CC\u0627\u0641\u062A \u0646\u0634\u062F","error"),this.router.navigate(["/dashboard/addresses"])})}onSubmit(){if(this.addressForm.invalid){this.addressForm.markAllAsTouched();return}this.isSubmitting=!0;let n=this.addressForm.getRawValue();(this.isEditMode&&this.addressId?this.profileService.updateAddress(this.addressId,y({id:this.addressId},n)):this.profileService.addAddress(n)).pipe(C(()=>this.isSubmitting=!1)).subscribe({next:()=>{this.notificationService.show(`\u0622\u062F\u0631\u0633 \u0628\u0627 \u0645\u0648\u0641\u0642\u06CC\u062A ${this.isEditMode?"\u0648\u06CC\u0631\u0627\u06CC\u0634":"\u0627\u0641\u0632\u0648\u062F\u0647"} \u0634\u062F`,"success"),this.router.navigate(["/dashboard/addresses"])},error:d=>this.notificationService.show(d?.error?.message||"\u062E\u0637\u0627 \u062F\u0631 \u062B\u0628\u062A \u0622\u062F\u0631\u0633","error")})}};s.\u0275fac=function(a){return new(a||s)(c(Ce),c(fe),c(D),c(V),c(we),c(O))},s.\u0275cmp=E({type:s,selectors:[["app-address-form"]],decls:56,vars:10,consts:[[1,"flex","flex-col","h-full","bg-background"],[1,"p-6","border-b","border-border","flex","items-center","justify-between"],[1,"text-lg","font-bold","text-foreground"],["routerLink","/dashboard/addresses",1,"btn","btn-ghost","btn-sm","text-muted-foreground","hover:text-foreground"],[1,"material-icons","text-sm","me-1"],[1,"p-6","max-w-2xl","mx-auto","w-full","flex-1"],[1,"space-y-6",3,"ngSubmit","formGroup"],[1,"space-y-2"],[1,"text-sm","font-medium","text-foreground"],["type","text","formControlName","title","placeholder","\u0645\u062B\u0627\u0644: \u0645\u0646\u0632\u0644\u060C \u0645\u062D\u0644 \u06A9\u0627\u0631",1,"input","w-full"],[1,"grid","grid-cols-1","sm:grid-cols-2","gap-6"],["type","text","formControlName","receiverName",1,"input","w-full"],["type","tel","formControlName","phoneNumber","placeholder","09xxxxxxxxx","maxlength","11",1,"input","w-full","ltr-input"],["formControlName","province",1,"input","w-full",3,"change"],["disabled","",3,"ngValue"],[3,"value",4,"ngFor","ngForOf"],["formControlName","city",1,"input","w-full",3,"disabled"],[1,"grid","grid-cols-1","sm:grid-cols-3","gap-6"],[1,"sm:col-span-2","space-y-2"],["formControlName","address","rows","2",1,"input","w-full","min-h-[50px]"],["type","text","formControlName","postalCode","maxlength","10",1,"input","w-full","ltr-input"],[1,"flex","items-center","gap-2"],["type","checkbox","id","isDefault","formControlName","isDefault",1,"checkbox"],["for","isDefault",1,"text-sm","text-foreground","cursor-pointer"],[1,"pt-6","border-t","border-border","flex","justify-end"],["type","submit",1,"btn","btn-primary","w-full","sm:w-auto","min-w-[140px]",3,"disabled"],["class","spinner spinner-sm me-2",4,"ngIf"],[3,"value"],[1,"spinner","spinner-sm","me-2"]],template:function(a,d){if(a&1&&(t(0,"div",0)(1,"div",1)(2,"h2",2),i(3),e(),t(4,"a",3)(5,"span",4),i(6,"arrow_forward"),e(),i(7," \u0628\u0627\u0632\u06AF\u0634\u062A "),e()(),t(8,"div",5)(9,"form",6),h("ngSubmit",function(){return d.onSubmit()}),t(10,"div",7)(11,"label",8),i(12,"\u0639\u0646\u0648\u0627\u0646 \u0622\u062F\u0631\u0633"),e(),p(13,"input",9),e(),t(14,"div",10)(15,"div",7)(16,"label",8),i(17,"\u0646\u0627\u0645 \u06AF\u06CC\u0631\u0646\u062F\u0647"),e(),p(18,"input",11),e(),t(19,"div",7)(20,"label",8),i(21,"\u0634\u0645\u0627\u0631\u0647 \u062A\u0645\u0627\u0633"),e(),p(22,"input",12),e()(),t(23,"div",10)(24,"div",7)(25,"label",8),i(26,"\u0627\u0633\u062A\u0627\u0646"),e(),t(27,"select",13),h("change",function(j){return d.onProvinceChange(j)}),t(28,"option",14),i(29,"\u0627\u0646\u062A\u062E\u0627\u0628 \u0627\u0633\u062A\u0627\u0646"),e(),f(30,Ke,2,2,"option",15),e()(),t(31,"div",7)(32,"label",8),i(33,"\u0634\u0647\u0631"),e(),t(34,"select",16)(35,"option",14),i(36,"\u0627\u0646\u062A\u062E\u0627\u0628 \u0634\u0647\u0631"),e(),f(37,Qe,2,2,"option",15),e()()(),t(38,"div",17)(39,"div",18)(40,"label",8),i(41,"\u0622\u062F\u0631\u0633 \u067E\u0633\u062A\u06CC"),e(),p(42,"textarea",19),e(),t(43,"div",7)(44,"label",8),i(45,"\u06A9\u062F \u067E\u0633\u062A\u06CC"),e(),p(46,"input",20),e()(),t(47,"div",21),p(48,"input",22),t(49,"label",23),i(50,"\u0627\u06CC\u0646 \u0622\u062F\u0631\u0633 \u0628\u0647 \u0639\u0646\u0648\u0627\u0646 \u067E\u06CC\u0634\u200C\u0641\u0631\u0636 \u062A\u0646\u0638\u06CC\u0645 \u0634\u0648\u062F"),e()(),t(51,"div",24)(52,"button",25),f(53,We,1,0,"span",26),t(54,"span"),i(55),e()()()()()()),a&2){let g;u(3),x(" ",d.isEditMode?"\u0648\u06CC\u0631\u0627\u06CC\u0634 \u0622\u062F\u0631\u0633":"\u0622\u062F\u0631\u0633 \u062C\u062F\u06CC\u062F"," "),u(6),l("formGroup",d.addressForm),u(19),l("ngValue",null),u(2),l("ngForOf",d.states),u(4),l("disabled",d.citiesLoading||!((g=d.addressForm.get("province"))!=null&&g.value)),u(),l("ngValue",null),u(2),l("ngForOf",d.cities),u(15),l("disabled",d.addressForm.invalid||d.isSubmitting),u(),l("ngIf",d.isSubmitting),u(2),b(d.isSubmitting?"\u062F\u0631 \u062D\u0627\u0644 \u0630\u062E\u06CC\u0631\u0647...":"\u062B\u0628\u062A \u0622\u062F\u0631\u0633")}},dependencies:[A,L,w,Q,z,Se,_e,G,he,be,H,U,ye,J,K,M,T],encapsulation:2});let r=s;return r})();var Xe=r=>["/dashboard/addresses/edit",r];function Ye(r,s){r&1&&(t(0,"div",9),p(1,"span",10),e())}function Ze(r,s){r&1&&(t(0,"div",11)(1,"span",12),i(2,"location_off"),e(),t(3,"p",13),i(4,"\u0647\u0646\u0648\u0632 \u0622\u062F\u0631\u0633\u06CC \u062B\u0628\u062A \u0646\u06A9\u0631\u062F\u0647\u200C\u0627\u06CC\u062F"),e(),t(5,"a",14),i(6,"\u062B\u0628\u062A \u0627\u0648\u0644\u06CC\u0646 \u0622\u062F\u0631\u0633"),e()())}function et(r,s){r&1&&(t(0,"span",29),i(1,"\u067E\u06CC\u0634\u200C\u0641\u0631\u0636"),e())}function tt(r,s){if(r&1){let o=P();t(0,"div",17)(1,"div")(2,"div",18)(3,"h3",19)(4,"span",20),i(5,"place"),e(),i(6),e(),f(7,et,2,0,"span",21),e(),t(8,"p",22),i(9),e(),t(10,"div",23)(11,"span",24)(12,"span",25),i(13,"person"),e(),i(14),e(),t(15,"span",24)(16,"span",25),i(17,"phone"),e(),i(18),e(),t(19,"span",24)(20,"span",25),i(21,"markunread_mailbox"),e(),i(22),e()()(),t(23,"div",26)(24,"a",27)(25,"span",4),i(26,"edit"),e(),i(27," \u0648\u06CC\u0631\u0627\u06CC\u0634 "),e(),t(28,"button",28),h("click",function(){let a=N(o).$implicit,d=v(2);return k(d.deleteAddress(a.id))}),t(29,"span",4),i(30,"delete"),e(),i(31," \u062D\u0630\u0641 "),e()()()}if(r&2){let o=s.$implicit;u(6),x(" ",o.title," "),u(),l("ngIf",o.isDefault),u(2),de(" ",o.province,"\u060C ",o.city,"\u060C ",o.address," "),u(5),x(" ",o.receiverName),u(4),x(" ",o.phoneNumber),u(4),x(" ",o.postalCode),u(2),l("routerLink",le(9,Xe,o.id))}}function it(r,s){if(r&1&&(t(0,"div",15),f(1,tt,32,11,"div",16),e()),r&2){let o=v();u(),l("ngForOf",o.addresses)}}var Le=(()=>{let s=class s{constructor(n,a){this.profileService=n,this.notificationService=a,this.addresses=[],this.isLoading=!0}ngOnInit(){this.loadAddresses()}loadAddresses(){this.isLoading=!0,this.profileService.getProfile().pipe(C(()=>this.isLoading=!1)).subscribe({next:n=>{this.addresses=n.userAddresses||[]},error:()=>this.notificationService.show("\u062E\u0637\u0627 \u062F\u0631 \u0628\u0627\u0631\u06AF\u0630\u0627\u0631\u06CC \u0622\u062F\u0631\u0633\u200C\u0647\u0627","error")})}deleteAddress(n){confirm("\u0622\u06CC\u0627 \u0627\u0632 \u062D\u0630\u0641 \u0627\u06CC\u0646 \u0622\u062F\u0631\u0633 \u0627\u0637\u0645\u06CC\u0646\u0627\u0646 \u062F\u0627\u0631\u06CC\u062F\u061F")&&this.profileService.deleteAddress(n).subscribe({next:()=>{this.notificationService.show("\u0622\u062F\u0631\u0633 \u0628\u0627 \u0645\u0648\u0641\u0642\u06CC\u062A \u062D\u0630\u0641 \u0634\u062F","success"),this.loadAddresses()},error:a=>this.notificationService.show(a?.error?.message||"\u062E\u0637\u0627 \u062F\u0631 \u062D\u0630\u0641 \u0622\u062F\u0631\u0633","error")})}};s.\u0275fac=function(a){return new(a||s)(c(V),c(O))},s.\u0275cmp=E({type:s,selectors:[["app-user-addresses"]],decls:12,vars:3,consts:[[1,"flex","flex-col","h-full"],[1,"p-6","border-b","border-border","flex","items-center","justify-between"],[1,"text-lg","font-bold","text-foreground"],["routerLink","/dashboard/addresses/new",1,"btn","btn-primary","btn-sm"],[1,"material-icons","text-sm","me-1"],[1,"p-6","flex-1"],["class","flex justify-center py-12",4,"ngIf"],["class","empty-state border-2 border-dashed border-border rounded-xl",4,"ngIf"],["class","grid grid-cols-1 lg:grid-cols-2 gap-6",4,"ngIf"],[1,"flex","justify-center","py-12"],[1,"spinner","spinner-lg","text-primary"],[1,"empty-state","border-2","border-dashed","border-border","rounded-xl"],[1,"material-icons","text-4xl","text-muted-foreground/40","mb-4"],[1,"text-foreground","font-medium"],["routerLink","/dashboard/addresses/new",1,"btn","btn-link","mt-2"],[1,"grid","grid-cols-1","lg:grid-cols-2","gap-6"],["class","card-hover p-5 flex flex-col justify-between",4,"ngFor","ngForOf"],[1,"card-hover","p-5","flex","flex-col","justify-between"],[1,"flex","items-center","justify-between","mb-3"],[1,"font-bold","text-foreground","flex","items-center","gap-2"],[1,"material-icons","text-primary","text-lg"],["class","badge badge-primary",4,"ngIf"],[1,"text-sm","text-muted-foreground","leading-relaxed","mb-4"],[1,"flex","flex-wrap","gap-4","text-xs","text-muted-foreground"],[1,"flex","items-center","gap-1"],[1,"material-icons","text-sm"],[1,"border-t","border-border","mt-4","pt-3","flex","justify-end","gap-2"],[1,"btn","btn-ghost","btn-sm","text-muted-foreground","hover:text-primary",3,"routerLink"],[1,"btn","btn-ghost","btn-sm","text-muted-foreground","hover:text-destructive",3,"click"],[1,"badge","badge-primary"]],template:function(a,d){a&1&&(t(0,"div",0)(1,"div",1)(2,"h2",2),i(3,"\u0622\u062F\u0631\u0633\u200C\u0647\u0627\u06CC \u0645\u0646"),e(),t(4,"a",3)(5,"span",4),i(6,"add"),e(),i(7," \u0627\u0641\u0632\u0648\u062F\u0646 \u0622\u062F\u0631\u0633 "),e()(),t(8,"div",5),f(9,Ye,2,0,"div",6)(10,Ze,7,0,"div",7)(11,it,2,1,"div",8),e()()),a&2&&(u(9),l("ngIf",d.isLoading),u(),l("ngIf",!d.isLoading&&(!d.addresses||d.addresses.length===0)),u(),l("ngIf",!d.isLoading&&d.addresses.length>0))},dependencies:[A,L,w,M,T],encapsulation:2});let r=s;return r})();var Pt=[{path:"",component:Fe,canActivate:[ve],children:[{path:"",redirectTo:"profile",pathMatch:"full"},{path:"profile",component:Ne},{path:"order-history",component:ke},{path:"order/:id",loadComponent:()=>import("./chunk-CDINMGOZ.js").then(r=>r.OrderDetailPage)},{path:"addresses",component:Le},{path:"addresses/new",component:ie},{path:"addresses/edit/:id",component:ie}]}];export{Pt as DASHBOARD_ROUTES};
